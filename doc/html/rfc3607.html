<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    rfc3607
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.33.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.33.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/draft-leech-chinese-lottery/">
  <meta name="description" content="Chinese Lottery Cryptanalysis Revisited: The Internet as a Codebreaking Tool (RFC )">
  <script src="https://www.ietf.org/lib/dt/7.33.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.33.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.33.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.33.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bgorange"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc3607.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc3607.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/pdfrfc/rfc3607.txt.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/rfc3607/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/rfc3607/" title="Datatracker information for this document">Tracker</a>] [<a href="/group/gen/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-leech-chinese-lottery@ietf.org?subject=draft-leech-chinese-lottery" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=draft-leech-chinese-lottery-04.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-leech-chinese-lottery-04.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-leech-chinese-lottery-04.txt" title="Run an idnits check of this document">Nits</a>]

From: <a href="/doc/html/draft-leech-chinese-lottery-04">draft-leech-chinese-lottery-04</a>                       Informational</pre>
      </div>
    

    <div class="draftcontent">
    <pre>Network Working Group                                           M. Leech
Request for Comments: 3607                               Nortel Networks
Category: Informational                                   September 2003


               <span class="h1">Chinese Lottery Cryptanalysis Revisited:</span>
                  <span class="h1">The Internet as a Codebreaking Tool</span>

Status of this Memo

   This memo provides information for the Internet community.  It does
   not specify an Internet standard of any kind.  Distribution of this
   memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2003).  All Rights Reserved.

Abstract

   This document revisits the so-called Chinese Lottery
   massively-parallel cryptanalytic attack.  It explores Internet-based
   analogues to the Chinese Lottery, and their potentially-serious
   consequences.

<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>.  Introduction</span>

   In 1991, Quisquater and Desmedt [<a href="#ref-DESMEDT91">DESMEDT91</a>] proposed an esoteric, but
   technically sound, attack against DES or similar ciphers.  They
   termed this attack the Chinese Lottery.  It was based on a
   massively-parallel hardware approach, using consumer electronics as
   the &quot;hosts&quot; of the cipher-breaking hardware.

   In the decade since Quisquater and Desmedt proposed their Chinese
   Lottery thought experiment, there has been considerable growth in a
   number of areas that make their thought experiment worth revisiting.

   In 1991, the Internet had approximately 8 million reachable hosts
   attached to it and in 2002, the number is a staggering 100 million
   reachable hosts.  In the time since the Chinese Lottery paper,
   computer power available to the average desktop user has grown by a
   factor of approximately 150.









<span class="grey">Leech                        Informational                      [Page 1]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-2" ></span>
<span class="grey"><a href="/doc/html/rfc3607">RFC 3607</a>        Chinese Lottery Cryptanalysis Revisited   September 2003</span>


<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  Dangerous Synergy</span>

   The combined growth of the Internet, and the unstoppable march of
   Moore&#x27;s Law have combined to create a dangerous potential for
   brute-force cryptanalysis of existing crypto systems.

   In the last few years, several widescsale attacks by so-called
   Internet Worms [<a href="#ref-SPAFF91">SPAFF91</a>] have successfully compromised and infected
   surprisingly-large numbers of Internet-attached hosts.  In 2001, The
   Cooperative Association for Internet Data Analysis [<a href="#ref-CAIDA2001">CAIDA2001</a>]
   reported that the Code Red v2 worm was able to infect over 350,000
   hosts in its first 14 hours of operation.  The payload of the Code
   Red worm was mischief: the defacement of the host website with a
   political message.  It was bold, brash, and drew attention to itself
   nearly immediately.

   Consider for a moment, an Internet worm with a darker and ultimately
   more dangerous purpose: to brute-force cryptanalyse a message, in
   order to determine the key used with that message.  In order for the
   worm to be successful, it must avoid detection for long enough to
   build up a significant level of infected systems, in order to have
   enough aggregate CPU cycles to complete the cryptanalysis.
   Furthermore, our worm would need to avoid detection for long enough
   for the cracked key to be useful to the owners of the worm.  Recent
   research [<a href="#ref-USEN2002">USEN2002</a>] on stealthy worms paints a very dark picture
   indeed.

   Even after such a worm is detected it would be nearly impossible to
   tell whose key the worm was attacking.  Any realistic attack payload
   will have one or two pieces of ciphertext, and some known plaintext,
   or probable-plaintext characteristics associated with it; hardly
   enough data to determine the likely victim.

<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>.  Winner phone home</span>

   When a given instance of the worm determines the key, it needs to
   contact the originator in order to give them the key.  It has to do
   this in such a way as to minimize the probability that the originator
   will get caught.

   One such technique would be for the worm to public-key encrypt the
   key, under the public key(s) of the originator(s), and place this in
   some innocuous spot on the website of the compromised host.  The worm
   could also back-propagate so that a number of compromised websites in
   the topological neighborhood of the worm will also contain the data.
   The file containing the key would be identified with some unique
   keyword which the originators occasionally look for using Internet




<span class="grey">Leech                        Informational                      [Page 2]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-3" ></span>
<span class="grey"><a href="/doc/html/rfc3607">RFC 3607</a>        Chinese Lottery Cryptanalysis Revisited   September 2003</span>


   search engines.  The worm could make the process more efficient by
   using the &quot;keyword registry&quot; services of various Internet search
   engines.

   Another approach would be to post a (possibly PGP-encrypted) message
   to several newsgroups, through an anonymous posting service.
   Similarly, Internet &quot;chat&quot; services like IRC could be used; indeed
   there&#x27;s an emerging tradition of using IRC and similar services for
   real-time, anonymous, control of worms and viruses.

   Any of these methods can be used both to allow the &quot;winning&quot; worm
   instance to send results and for the originator to send new work for
   the amassed army of compromised systems.

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>.  Evaluating the threat</span>

   Both Internet growth and CPU performance follow a reasonably
   predictable doubling interval.  Performance of computing hardware
   appears to still be following Moore&#x27;s Law, in which performance
   doubles every 1.5 years.  Internet growth appears to be following a
   doubling period of 3 years.

   By establishing a common epoch for both performance and Internet
   growth, we can easily determine the likely attack time for any given
   year, based on a purely arithmetic approach.

   A simplifying assumption is that it is indeed possible to construct a
   suitably-stealthy worm and that it can achieve a steady-state
   infection of about 0.5% of all attached hosts on the Internet.

   In 1995, J. Touch, at ISI, published a detailed performance analysis
   of MD5 [<a href="/doc/html/rfc1810">RFC1810</a>].  At that time MD5 software performance peaked at
   87mbits/second, or an equivalent of 170,000 single-block MD5
   operations per second.  In the same year, peak DES performance was
   about 50,000 setkey/encrypt operations per second.

   In 1995, the Internet had about 20,000,000 attached hosts.  In 2002,
   there are a staggering 100,000,000 attached hosts.

   A simple C program, given in <a href="#appendix-A">Appendix A</a> can be used to predict the
   performance of our hypothetical worm for any given year.  Running
   this program for 2002 gives:

       Year of estimate: 2002
       For a total number of infected hosts of 503968
       aggregate performance: MD5 9.79e+11/sec DES 2.88e+11/sec
       DES could be cracked in about 1.45 days




<span class="grey">Leech                        Informational                      [Page 3]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-4" ></span>
<span class="grey"><a href="/doc/html/rfc3607">RFC 3607</a>        Chinese Lottery Cryptanalysis Revisited   September 2003</span>


       DES with 8 character passwords could be cracked in 16.29 minutes
       MD5 with 64-bit keys could be cracked in about 218.04 days
       MD5 with 8 character passwords could be cracked in 4.79 minutes

   The numbers given above suggest that an undetected attack against
   MD5, for a reasonable key length, isn&#x27;t likely in 2002.  A successful
   attack against DES, however, appears to be a near-certainty.

<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>.  Security Considerations</span>

   DES has been shown to be weak in the recent past.  The success of the
   EFF machine, described in [<a href="#ref-EFF98">EFF98</a>] shows how a massively-parallel
   hardware effort can succeed relatively economically.  That this level
   of brute-force cryptanalytic strength could be made available without
   custom hardware is a sobering thought.  It is clear that DES needs to
   be abandoned; in favor of either 3DES or the newer AES [<a href="#ref-FIPS197">FIPS197</a>].

   The picture for MD5 (when used in simple MAC constructions) is much
   brighter.  For short messages long keys with MD5 are effectively
   free, computationally, so it makes sense to use the longest
   architecturally-practical key lengths with MD5.

   Operating system software is becoming more complex and the
   perpetrators of Internet Worms, Viruses, Trojan Horses, and other
   malware, are becoming more sophisticated.  While their aim has
   largely been widescale vandalism, it seems reasonable to assume that
   their methods could be turned to a more focussed and perhaps more
   sinister activity.

   As of February 2003, at least one worm, known as W32/Opaserv.A has a
   payload designed to implement a distributed DES cracker.

<span class="h2"><a class="selflink" id="section-6" href="#section-6">6</a>.  Acknowledgements</span>

   John Morris, of Nortel IS, contributed the idea of anonymous
   newsgroup posting.















<span class="grey">Leech                        Informational                      [Page 4]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-5" ></span>
<span class="grey"><a href="/doc/html/rfc3607">RFC 3607</a>        Chinese Lottery Cryptanalysis Revisited   September 2003</span>


Appendix A: Source Code

   /*
    * This program calculates the performance of a hypothetical
    *  &quot;Chinese Lottery&quot; brute-force cryptanalysis worm, based on
    *  the current date, estimates of Internet growth rate and
    *  Moores Law.
    *
    */ #include &lt;stdio.h&gt; #include &lt;math.h&gt; /*
    * EPOCH for the calculations
    */ #define EPOCH 1995.0 /*
    * Size of the Internet (ca 1995)
    */ #define INTERNET_SIZE 20000000.0

   /*
    * Software MD5 performance (ca 1995)
    */ #define MD5PERF 170000.0

   /*
    * Software DES performance (ca 1995)
    */ #define DESPERF 50000.0

   main (argc, argv) int argc; char **argv; {
        double yeardiff;
        double cryptoperf, multiplier;
        double cracktime;

        yeardiff = (double)atoi(argv[1]) - EPOCH;

        /*
         * Moores Law performance double interval is 1.5 years
         */
        cryptoperf = yeardiff / 1.5;
        cryptoperf = pow(2.0, cryptoperf);

        /*
         * Some fuzz here--not all hosts will be the fastest available
         */
        cryptoperf *= 0.450;

        /*
         * Internet size doubling interval is every 3 years
         */
        multiplier = yeardiff / 3.0;
        multiplier = pow(2.0, multiplier);
        multiplier *= (INTERNET_SIZE*0.0050);

        fprintf (stderr, &quot;Year of estimate: %d\n&quot;, atoi(argv[1]));



<span class="grey">Leech                        Informational                      [Page 5]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-6" ></span>
<span class="grey"><a href="/doc/html/rfc3607">RFC 3607</a>        Chinese Lottery Cryptanalysis Revisited   September 2003</span>


        fprintf (stdout, &quot;For a total number of infected hosts of %d\n&quot;,
             (int)multiplier);
       fprintf (stdout, &quot;aggregate performance: MD5 %5.2e/sec DES
            %5.2e/sec\n&quot;,
            MD5PERF*cryptoperf*multiplier,
            DESPERF*cryptoperf*multiplier);

       cracktime = pow(2.0, 55.0);
       cracktime /= (DESPERF*cryptoperf*multiplier);
       fprintf (stdout,
            &quot;DES could be cracked in about %3.2lf days\n&quot;,
            cracktime/86400.0);

       cracktime = pow(2.0, 8.0*6.0);
       cracktime /= (DESPERF*cryptoperf*multiplier);
       fprintf (stdout,
            &quot;DES with 8 character passwords could be cracked in
            %3.2lf minutes\n&quot;,cracktime/60);

       cracktime = pow(2.0, 64.0);
       cracktime /= (MD5PERF*cryptoperf*multiplier);
       fprintf (stdout,
            &quot;MD5 with 64-bit keys could be cracked in about
            %3.2lf days\n&quot;, cracktime/86400.0);

       cracktime = pow(2.0, 8.0*6.0);
       cracktime /= (MD5PERF*cryptoperf*multiplier);
       fprintf (stdout,
            &quot;MD5 with 8 character passwords could be cracked in
            %3.2lf minutes\n&quot;, cracktime/60); }





















<span class="grey">Leech                        Informational                      [Page 6]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-7" ></span>
<span class="grey"><a href="/doc/html/rfc3607">RFC 3607</a>        Chinese Lottery Cryptanalysis Revisited   September 2003</span>


Normative References

   [<a id="ref-DESMEDT91">DESMEDT91</a>] &quot;Chinese Lotto as an Exhaustive Code-Breaking Machine&quot;.
               J. Quisquater, Y. Desmedt, Computer, v. 24, n. 11, Nov
               1991, pp. 14-22.

   [<a id="ref-RFC1810">RFC1810</a>]   Touch, J., &quot;Report on MD5 Performance&quot;, <a href="/doc/html/rfc1810">RFC 1810</a>, June
               1995.

   [<a id="ref-EFF98">EFF98</a>]     &quot;Cracking DES: Secrets of Encryption Research, Wiretap
               Politics &amp; Chip Design&quot;, Electronic Frontier Foundation,
               1998.

   [<a id="ref-CAIDA2001">CAIDA2001</a>] &quot;CAIDA Analysis of Code Red&quot;
               <a href="http://www.caida.org/analysis/security/code-red/">http://www.caida.org/analysis/security/code-red/</a>

   [<a id="ref-SPAFF91">SPAFF91</a>]   &quot;The Internet Worm Program: An Analysis&quot;, Eugene
               Spafford, 1991.

   [<a id="ref-FIPS197">FIPS197</a>]   &quot;Advanced Encryption Standard&quot;, US FIPS197, November,
               2001.

   [<a id="ref-USEN2002">USEN2002</a>]  &quot;How to 0wn the Internet in Your Spare Time&quot;, Proc. 11th
               Usenix Security Symposium, 2002.

Author&#x27;s Address

   Marcus D. Leech
   Nortel Networks
   P.O. Box 3511, Station C
   Ottawa, ON
   Canada, K1Y 4H7

   Phone: +1 613-763-9145
   EMail: mleech@nortelnetworks.com
















<span class="grey">Leech                        Informational                      [Page 7]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-8" ></span>
<span class="grey"><a href="/doc/html/rfc3607">RFC 3607</a>        Chinese Lottery Cryptanalysis Revisited   September 2003</span>


Full Copyright Statement

   Copyright (C) The Internet Society (2003).  All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assignees.

   This document and the information contained herein is provided on an
   &quot;AS IS&quot; basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.



















Leech                        Informational                      [Page 8]
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

