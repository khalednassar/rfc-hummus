<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    rfc6088
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.34.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.34.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/draft-ietf-mext-binary-ts/">
  <meta name="description" content="Traffic Selectors for Flow Bindings (RFC )">
  <script src="https://www.ietf.org/lib/dt/7.34.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.34.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bgblue"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc6088.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc6088.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/pdfrfc/rfc6088.txt.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/rfc6088/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/rfc6088/" title="Datatracker information for this document">Tracker</a>] [<a href="/group/mext/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-mext-binary-ts@ietf.org?subject=draft-ietf-mext-binary-ts" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=draft-ietf-mext-binary-ts-05.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-ietf-mext-binary-ts-05.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-ietf-mext-binary-ts-05.txt" title="Run an idnits check of this document">Nits</a>]

From: <a href="/doc/html/draft-ietf-mext-binary-ts-05">draft-ietf-mext-binary-ts-05</a>                     Proposed Standard</pre>
      </div>
    

    <div class="draftcontent">
    <pre>Internet Engineering Task Force (IETF)                       G. Tsirtsis
Request for Comments: 6088                                   G. Giaretta
Category: Standards Track                                       Qualcomm
ISSN: 2070-1721                                               H. Soliman
                                                    Elevate Technologies
                                                            N. Montavont
                                                                   IT/TB
                                                            January 2011


                  <span class="h1">Traffic Selectors for Flow Bindings</span>

Abstract

   This document defines binary formats for IPv4 and IPv6 traffic
   selectors to be used in conjunction with flow bindings for Mobile
   IPv6.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="/doc/html/rfc5741#section-2">Section&nbsp;2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6088">http://www.rfc-editor.org/info/rfc6088</a>.

Copyright Notice

   Copyright (c) 2011 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="/doc/html/bcp78">BCP 78</a> and the IETF Trust&#x27;s Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.





<span class="grey">Tsirtsis, et al.             Standards Track                    [Page 1]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-2" ></span>
<span class="grey"><a href="/doc/html/rfc6088">RFC 6088</a>           Traffic Selectors for Flow Bindings      January 2011</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-2">2</a>
   <a href="#section-2">2</a>.  Requirements Notation  . . . . . . . . . . . . . . . . . . . .  <a href="#page-2">2</a>
   <a href="#section-3">3</a>.  Traffic Selector Sub-Options . . . . . . . . . . . . . . . . .  <a href="#page-2">2</a>
     <a href="#section-3.1">3.1</a>.  IPv4 Binary Traffic Selector . . . . . . . . . . . . . . .  <a href="#page-2">2</a>
     <a href="#section-3.2">3.2</a>.  IPv6 Binary Traffic Selector . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
   <a href="#section-4">4</a>.  Security Considerations  . . . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
   <a href="#section-5">5</a>.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
   <a href="#section-6">6</a>.  Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
   <a href="#section-7">7</a>.  References . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
     <a href="#section-7.1">7.1</a>.  Normative References . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
     <a href="#section-7.2">7.2</a>.  Informative References . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>

<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>.  Introduction</span>

   This document defines binary formats for IPv4 and IPv6 traffic
   selector sub-options, as defined in [<a href="/doc/html/rfc6089" title="&quot;Flow Bindings in Mobile IPv6 and Network Mobility (NEMO) Basic Support&quot;">RFC6089</a>].

   The binary traffic selector format defined here, allows for efficient
   identification of flow(s) based on well-known fields in IPv4
   [<a href="/doc/html/rfc0791" title="&quot;Internet Protocol&quot;">RFC0791</a>], IPv6 [<a href="/doc/html/rfc2460" title="&quot;Internet Protocol, Version 6 (IPv6) Specification&quot;">RFC2460</a>], and transport layer headers like TCP
   [<a href="/doc/html/rfc0793" title="&quot;Transmission Control Protocol&quot;">RFC0793</a>] and UDP [<a href="/doc/html/rfc0768" title="&quot;User Datagram Protocol&quot;">RFC0768</a>].

<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  Requirements Notation</span>

   The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;,
   &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;MAY&quot;, and &quot;OPTIONAL&quot; in this
   document are to be interpreted as described in [<a href="/doc/html/rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].

<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>.  Traffic Selector Sub-Options</span>

   [<a id="ref-RFC6089">RFC6089</a>] defines the format for the traffic selector sub-option.

   The following values of the TS Format field are defined in this
   specification for binary traffic selectors.

   TS Format:

      1 IPv4 binary traffic selector

      2 IPv6 binary traffic selector

<span class="h3"><a class="selflink" id="section-3.1" href="#section-3.1">3.1</a>.  IPv4 Binary Traffic Selector</span>

   If the TS Format field of the traffic selector sub-option indicates
   &quot;IPv4 binary traffic selector&quot;, then the traffic selector is
   formatted as shown below.



<span class="grey">Tsirtsis, et al.             Standards Track                    [Page 2]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-3" ></span>
<span class="grey"><a href="/doc/html/rfc6088">RFC 6088</a>           Traffic Selectors for Flow Bindings      January 2011</span>


   The alignment requirement for this sub-option is:

      4n if A, B, C, D, E, or F is set

      2n if G, H, I, or J is set

      n if K, L, M, or N is set

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Sub-opt Type   |  Sub-Opt Len  |   TS Format   |   Reserved    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |A|B|C|D|E|F|G|H|I|J|K|L|M|N|          Reserved                 |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                 (A)Start Source Address                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                 (B)End Source Address                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                 (C)Start Destination Address                  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                 (D)End Destination Address                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     (E)Start IPsec SPI                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      (F)End IPsec SPI                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   (G)Start Source port        |   (H)End Source port          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   (I)Start Destination port   |   (J)End Destination port     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  (K)Start DS  |  (L)End DS    |(M)Start Prot. | (N) End Prot. |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                  Figure 1: IPv4 binary traffic selector

   Flags (A-N)

      Each flag indicates whether the corresponding field is present in
      the message.

   (A)Start Source Address

      This field identifies the first source address, from the range of
      32-bit IPv4 addresses to be matched, on data packets sent from a
      corresponding node to the mobile node as seen by the home agent.
      In other words, this is one of the addresses of the correspondent
      node.



<span class="grey">Tsirtsis, et al.             Standards Track                    [Page 3]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-4" ></span>
<span class="grey"><a href="/doc/html/rfc6088">RFC 6088</a>           Traffic Selectors for Flow Bindings      January 2011</span>


   (B)End Source Address

      If more than one contiguous source address needs to be matched,
      then this field can be used to indicate the end value of a range
      starting from the value of the Start Source Address field.  This
      field MUST NOT be included unless the Start Source Address field
      is included.  When this field is included, the receiver will match
      all of the addresses between fields (A) and (B), inclusive of (A)
      and (B).

   (C)Start Destination Address

      This field identifies the first destination address, from the
      range of 32-bit IPv4 addresses to be matched, on data packets sent
      from a corresponding node to the mobile node as seen by the home
      agent.  In other words, this is one of the registered home
      addresses of the mobile node.

   (D)End Destination Address

      If more than one contiguous destination address needs to be
      matched, then this field can be used to indicate the end value of
      a range starting from the value of the Start Destination Address
      field.  This field MUST NOT be included unless the Start
      Destination Address field is included.  When this field is
      included, the receiver will match all of the addresses between
      fields (C) and (D), inclusive of (C) and (D).

   (E)Start IPsec SPI - Security Parameter Index

      This field identifies the first 32-bit IPsec SPI value, from the
      range of SPI values to be matched, on data packets sent from a
      corresponding node to the mobile node as seen by the home agent.
      This field is defined in [<a href="/doc/html/rfc4303" title="&quot;IP Encapsulating Security Payload (ESP)&quot;">RFC4303</a>].

   (F)End IPsec SPI - Security Parameter Index

      If more than one contiguous SPI value needs to be matched, then
      this field can be used to indicate the end value of a range
      starting from the value of the Start IPsec SPI field.  This field
      MUST NOT be included unless the Start IPsec SPI field is included.
      When this field is included, the receiver will match all of the
      SPI values between fields (E) and (F), inclusive of (E) and (F).








<span class="grey">Tsirtsis, et al.             Standards Track                    [Page 4]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-5" ></span>
<span class="grey"><a href="/doc/html/rfc6088">RFC 6088</a>           Traffic Selectors for Flow Bindings      January 2011</span>


   (G)Start Source Port

      This field identifies the first 16-bit source port number, from
      the range of port numbers to be matched, on data packets sent from
      a corresponding node to the mobile node as seen by the home agent.
      This is from the range of port numbers defined by IANA
      (<a href="http://www.iana.org">http://www.iana.org</a>).

   (H)End Source Port

      If more than one contiguous source port number needs to be
      matched, then this field can be used to indicate the end value of
      a range starting from the value of the Start Source Port field.
      This field MUST NOT be included unless the Start Source Port field
      is included.  When this field is included, the receiver will match
      all of the port numbers between fields (G) and (H), inclusive of
      (G) and (H).

   (I)Start Destination Port

      This field identifies the first 16-bit destination port number,
      from the range of port numbers to be matched, on data packets sent
      from a corresponding node to the mobile node as seen by the home
      agent.

   (J)End Destination Port

      If more than one contiguous destination port number needs to be
      matched, then this field can be used to indicate the end value of
      a range starting from the value of the Start Destination Port
      field.  This field MUST NOT be included unless the Start
      Destination Port field is included.  When this field is included,
      the receiver will match all of the port numbers between fields (I)
      and (J), inclusive of (I) and (J).

   (K)Start DS - Differential Services

      This field identifies the first differential services value, from
      the range of differential services values to be matched, on data
      packets sent from a corresponding node to the mobile node as seen
      by the home agent.  Note that this field is called a &quot;Type of
      Service field&quot; in [<a href="/doc/html/rfc0791" title="&quot;Internet Protocol&quot;">RFC0791</a>].  [<a href="/doc/html/rfc3260" title="&quot;New Terminology and Clarifications for Diffserv&quot;">RFC3260</a>] then clarified that the
      field has been redefined as a 6-bit DS field with 2 bits reserved,
      later claimed by Explicit Congestion Notification (ECN) [<a href="/doc/html/rfc3168" title="&quot;The Addition of Explicit Congestion Notification (ECN) to IP&quot;">RFC3168</a>].
      For the purpose of this specification, the (K)Start DS field is 8
      bits long, where the 6 most significant bits indicate the DS field
      to be matched and the 2 least significant bits&#x27; values MUST be
      ignored in any comparison.



<span class="grey">Tsirtsis, et al.             Standards Track                    [Page 5]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-6" ></span>
<span class="grey"><a href="/doc/html/rfc6088">RFC 6088</a>           Traffic Selectors for Flow Bindings      January 2011</span>


   (L)End DS - Differential Services

      If more than one contiguous DS value needs to be matched, then
      this field can be used to indicate the end value of a range
      starting from the value of the Start DS field.  This field MUST
      NOT be included unless the Start DS field is included.  When this
      field is included, it MUST be coded the same way as defined for
      (K).  When this field is included, the receiver will match all of
      the values between fields (K) and (L), inclusive of (K) and (L).

   (M)Start Protocol

      This field identifies the first 8-bit protocol value, from the
      range of protocol values to be matched, on data packets sent from
      a corresponding node to the mobile node as seen by the home agent.

   (N)End Protocol

      If more than one contiguous protocol value needs to be matched,
      then this field can be used to indicate the end value of a range
      starting from the value of the Start Protocol field.  This field
      MUST NOT be included unless the Start Protocol field is included.
      When this field is included, the receiver will match all of the
      values between fields (M) and (N), inclusive of (M) and (N).

   Reserved

      Reserved for future use.  These bits MUST be set to zero by the
      sender and ignored by the receiver.

<span class="h3"><a class="selflink" id="section-3.2" href="#section-3.2">3.2</a>.  IPv6 Binary Traffic Selector</span>

   If the TS Format field of the traffic selector sub-option indicates
   &quot;IPv6 binary traffic selector&quot;, then the traffic selector is
   formatted as follows:

   The alignment requirement for this sub-option is:

      8n if A, B, C, or D is set

      4n if E, F, G, or H is set

      2n if I, J, K, or L is set

      n if M, N, O, or P is set






<span class="grey">Tsirtsis, et al.             Standards Track                    [Page 6]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-7" ></span>
<span class="grey"><a href="/doc/html/rfc6088">RFC 6088</a>           Traffic Selectors for Flow Bindings      January 2011</span>


     0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Sub-opt Type   |  Sub-Opt Len  |   TS Format   |   Reserved    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |A|B|C|D|E|F|G|H|I|J|K|L|M|N|O|P|          Reserved             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   +                                                               +
   |                                                               |
   +                  (A)Start Source Address                      +
   |                                                               |
   +                                                               +
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   +                                                               +
   |                                                               |
   +                  (B)End Source Address                        +
   |                                                               |
   +                                                               +
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   +                                                               +
   |                                                               |
   +               (C)Start Destination Address                    +
   |                                                               |
   +                                                               +
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   +                                                               +
   |                                                               |
   +                (D)End Destination Address                     +
   |                                                               |
   +                                                               +
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     (E)Start IPsec SPI                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      (F)End IPsec SPI                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      (G)Start Flow Label                      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       (H)End Flow Label                       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   (I)Start Source port        |   (J)End Source port          |



<span class="grey">Tsirtsis, et al.             Standards Track                    [Page 7]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-8" ></span>
<span class="grey"><a href="/doc/html/rfc6088">RFC 6088</a>           Traffic Selectors for Flow Bindings      January 2011</span>


   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   (K)Start Destination port   |   (L)End Destination port     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  (M)Start TC  |  (N)End TC    | (O)Start NH   | (P) End NH    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                  Figure 2: IPv6 binary traffic selector

   Flags (A-P)

      Each flag indicates whether the corresponding field is present in
      the message

   (A)Start Source Address

      This field identifies the first source address, from the range of
      128-bit IPv6 addresses to be matched, on data packets sent from a
      corresponding node to the mobile node as seen by the home agent.
      In other words, this is one of the addresses of the correspondent
      node.

   (B)End Source Address

      If more than one contiguous source address needs to be matched,
      then this field can be used to indicate the end value of a range
      starting from the value of the Start Source Address field.  This
      field MUST NOT be included unless the Start Source Address field
      is included.  When this field is included, the receiver will match
      all of the addresses between fields (A) and (B), inclusive of (A)
      and (B).

   (C)Start Destination Address

      This field identifies the first destination address, from the
      range of 128-bit IPv6 addresses to be matched, on data packets
      sent from a corresponding node to the mobile node as seen by the
      home agent.  In other words, this is one of the registered home
      addresses of the mobile node.

   (D)End Destination Address

      If more than one contiguous destination address needs to be
      matched, then this field can be used to indicate the end value of
      a range starting from the value of the Start Destination Address
      field.  This field MUST NOT be included unless the Start
      Destination Address field is included.  When this field is
      included, the receiver will match all of the addresses between
      fields (C) and (D), inclusive of (C) and (D).



<span class="grey">Tsirtsis, et al.             Standards Track                    [Page 8]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-9" ></span>
<span class="grey"><a href="/doc/html/rfc6088">RFC 6088</a>           Traffic Selectors for Flow Bindings      January 2011</span>


   (E)Start IPsec SPI - Security Parameter Index

      This field identifies the first 32-bit IPsec SPI value, from the
      range of SPI values to be matched, on data packets sent from a
      corresponding node to the mobile node as seen by the home agent.
      This field is defined in [<a href="/doc/html/rfc4303" title="&quot;IP Encapsulating Security Payload (ESP)&quot;">RFC4303</a>].

   (F)End IPsec SPI - Security Parameter Index

      If more than one contiguous SPI value needs to be matched, then
      this field can be used to indicate the end value of a range
      starting from the value of the Start IPsec SPI field.  This field
      MUST NOT be included unless the Start IPsec SPI field is included.
      When this field is included, the receiver will match all of the
      SPI values between fields (E) and (F), inclusive of (E) and (F).

   (G)Start Flow Label

      This field identifies the first flow label value, from the range
      of flow label values to be matched, on data packets sent from a
      corresponding node to the mobile node as seen by the home agent.
      According to [<a href="/doc/html/rfc2460" title="&quot;Internet Protocol, Version 6 (IPv6) Specification&quot;">RFC2460</a>], the flow label is 24 bits long.  For the
      purpose of this specification, the sender of this option MUST
      prefix the flow label value with 8 bits of &quot;0&quot; before inserting it
      in the (G)Start Flow Label field.  The receiver SHOULD ignore the
      first 8 bits of this field before using it in comparisons with
      flow labels in packets.

   (H)End Flow Label

      If more than one contiguous flow label value needs to be matched,
      then this field can be used to indicate the end value of a range
      starting from the value of the Start Flow Label field.  This field
      MUST NOT be included unless the Start Flow Label field is
      included.  When this field is included, the receiver will match
      all of the flow label values between fields (G) and (H), inclusive
      of (G) and (H).  When this field is included, it MUST be coded the
      same way as defined for (G).

   (I)Start Source Port

      This field identifies the first 16-bit source port number, from
      the range of port numbers to be matched, on data packets sent from
      a corresponding node to the mobile node as seen by the home agent.







<span class="grey">Tsirtsis, et al.             Standards Track                    [Page 9]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-10" ></span>
<span class="grey"><a href="/doc/html/rfc6088">RFC 6088</a>           Traffic Selectors for Flow Bindings      January 2011</span>


   (J)End Source Port

      If more than one contiguous source port number needs to be
      matched, then this field can be used to indicate the end value of
      a range starting from the value of the Start Source Port field.
      This field MUST NOT be included unless the Start Source Port field
      is included.  When this field is included, the receiver will match
      all of the port numbers between fields (I) and (J), inclusive of
      (I) and (J).

   (K)Start Destination Port

      This field identifies the first 16-bit destination port number,
      from the range of port numbers to be matched, on data packets sent
      from a corresponding node to the mobile node as seen by the home
      agent.

   (L)End Destination Port

      If more than one contiguous destination port number needs to be
      matched, then this field can be used to indicate the end value of
      a range starting from the value of the Start Destination Port
      field.  This field MUST NOT be included unless the Start
      Destination Port field is included.  When this field is included,
      the receiver will match all of the port numbers between fields (K)
      and (L), inclusive of (K) and (L).

   (M)Start TC - Traffic Class

      This field identifies the first traffic class value, from the
      range of traffic class values to be matched, on data packets sent
      from a corresponding node to the mobile node as seen by the home
      agent.  This field is equivalent to the Start DS field in the IPv4
      traffic selector in Figure 1.  As per [<a href="/doc/html/rfc3260" title="&quot;New Terminology and Clarifications for Diffserv&quot;">RFC3260</a>], the field is
      defined as a 6-bit DS field with 2 bits reserved, later claimed by
      Explicit Congestion Notification (ECN) [<a href="/doc/html/rfc3168" title="&quot;The Addition of Explicit Congestion Notification (ECN) to IP&quot;">RFC3168</a>].  For the purpose
      of this specification, the (M)Start TC field is 8 bits long, where
      the 6 most significant bits indicate the DS field to be matched
      and the 2 least significant bits&#x27; values MUST be ignored in any
      comparison.

   (N)End TC - Traffic Class

      If more than one contiguous TC value needs to be matched, then
      this field can be used to indicate the end value of a range
      starting from the value of the Start TC field.  This field MUST
      NOT be included unless the Start TC field is included.  When this




<span class="grey">Tsirtsis, et al.             Standards Track                   [Page 10]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-11" ></span>
<span class="grey"><a href="/doc/html/rfc6088">RFC 6088</a>           Traffic Selectors for Flow Bindings      January 2011</span>


      field is included, it MUST be coded the same way as defined for
      (M).  When this field is included, the receiver will match all of
      the values between fields (M) and (N), inclusive of (M) and (N).

   (O)Start NH - Next Header

      This field identifies the first 8-bit next header value, from the
      range of next header values to be matched, on data packets sent
      from a corresponding node to the mobile node as seen by the home
      agent.

   (P)End NH - Next Header

      If more than one contiguous next header value needs to be matched,
      then this field can be used to indicate the end value of a range
      starting from the value of the Start NH field.  This field MUST
      NOT be included unless the Start next header field is included.
      When this field is included, the receiver will match all of the
      values between fields (O) and (P), inclusive of (O) and (P).

   Reserved

      Reserved for future use.  These bits MUST be set to zero by the
      sender and ignored by the receiver.

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>.  Security Considerations</span>

   This document defines the format of the traffic selector field of a
   sub-option defined for flow bindings [<a href="/doc/html/rfc6089" title="&quot;Flow Bindings in Mobile IPv6 and Network Mobility (NEMO) Basic Support&quot;">RFC6089</a>].  The authors have not
   identified any security concerns pertaining to this document beyond
   what is already identified in [<a href="/doc/html/rfc6089" title="&quot;Flow Bindings in Mobile IPv6 and Network Mobility (NEMO) Basic Support&quot;">RFC6089</a>].

<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>.  IANA Considerations</span>

   The following new TS format values have been assigned from the
   &quot;Traffic Selector Format&quot; namespace for the traffic selector sub-
   option defined in [<a href="/doc/html/rfc6089" title="&quot;Flow Bindings in Mobile IPv6 and Network Mobility (NEMO) Basic Support&quot;">RFC6089</a>].

      1 IPv4 Binary Traffic Selector

      2 IPv6 Binary Traffic Selector

<span class="h2"><a class="selflink" id="section-6" href="#section-6">6</a>.  Acknowledgements</span>

   The authors would like to thank Patrick Stupar and Julien Laganier
   for their contributions to this document.  We would also like to
   thank Benjamin Lim, Dave Craig, Patrick Stupar, and Basavaraj Patil
   for their reviews and comments.



<span class="grey">Tsirtsis, et al.             Standards Track                   [Page 11]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-12" ></span>
<span class="grey"><a href="/doc/html/rfc6088">RFC 6088</a>           Traffic Selectors for Flow Bindings      January 2011</span>


<span class="h2"><a class="selflink" id="section-7" href="#section-7">7</a>.  References</span>

<span class="h3"><a class="selflink" id="section-7.1" href="#section-7.1">7.1</a>.  Normative References</span>

   [<a id="ref-RFC0768">RFC0768</a>]  Postel, J., &quot;User Datagram Protocol&quot;, STD 6, <a href="/doc/html/rfc768">RFC 768</a>,
              August 1980.

   [<a id="ref-RFC0791">RFC0791</a>]  Postel, J., &quot;Internet Protocol&quot;, STD 5, <a href="/doc/html/rfc791">RFC 791</a>,
              September 1981.

   [<a id="ref-RFC0793">RFC0793</a>]  Postel, J., &quot;Transmission Control Protocol&quot;, STD 7,
              <a href="/doc/html/rfc793">RFC 793</a>, September 1981.

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., &quot;Key words for use in RFCs to Indicate
              Requirement Levels&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc2119">RFC 2119</a>, March 1997.

   [<a id="ref-RFC2460">RFC2460</a>]  Deering, S. and R. Hinden, &quot;Internet Protocol, Version 6
              (IPv6) Specification&quot;, <a href="/doc/html/rfc2460">RFC 2460</a>, December 1998.

   [<a id="ref-RFC3168">RFC3168</a>]  Ramakrishnan, K., Floyd, S., and D. Black, &quot;The Addition
              of Explicit Congestion Notification (ECN) to IP&quot;,
              <a href="/doc/html/rfc3168">RFC 3168</a>, September 2001.

   [<a id="ref-RFC4303">RFC4303</a>]  Kent, S., &quot;IP Encapsulating Security Payload (ESP)&quot;,
              <a href="/doc/html/rfc4303">RFC 4303</a>, December 2005.

   [<a id="ref-RFC6089">RFC6089</a>]  Tsirtsis, G., Soliman, H., Montavont, N., Giaretta, G.,
              and K. Kuladinithi, &quot;Flow Bindings in Mobile IPv6 and
              Network Mobility (NEMO) Basic Support&quot;, <a href="/doc/html/rfc6089">RFC 6089</a>,
              January 2011.

<span class="h3"><a class="selflink" id="section-7.2" href="#section-7.2">7.2</a>.  Informative References</span>

   [<a id="ref-RFC3260">RFC3260</a>]  Grossman, D., &quot;New Terminology and Clarifications for
              Diffserv&quot;, <a href="/doc/html/rfc3260">RFC 3260</a>, April 2002.
















<span class="grey">Tsirtsis, et al.             Standards Track                   [Page 12]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-13" ></span>
<span class="grey"><a href="/doc/html/rfc6088">RFC 6088</a>           Traffic Selectors for Flow Bindings      January 2011</span>


Authors&#x27; Addresses

   George Tsirtsis
   Qualcomm

   EMail: tsirtsis@qualcomm.com


   Gerardo Giaretta
   Qualcomm

   EMail: gerardog@qualcomm.com


   Hesham Soliman
   Elevate Technologies

   EMail: hesham@elevatemobile.com


   Nicolas Montavont
   Institut Telecom / Telecom Bretagne
   2, rue de la chataigneraie
   Cesson Sevigne  35576
   France

   Phone: (+33) 2 99 12 70 23
   EMail: nicolas.montavont@telecom-bretagne.eu
   URI:   <a href="http://www.rennes.enst-bretagne.fr/~nmontavo//">http://www.rennes.enst-bretagne.fr/~nmontavo//</a>






















Tsirtsis, et al.             Standards Track                   [Page 13]
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

