<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    rfc7909
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.34.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.34.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/draft-ietf-sidr-rpsl-sig/">
  <meta name="description" content="Securing Routing Policy Specification Language (RPSL) Objects with Resource Public Key Infrastructure (RPKI) Signatures (RFC )">
  <script src="https://www.ietf.org/lib/dt/7.34.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.34.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bgblue"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc7909.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc7909.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/pdfrfc/rfc7909.txt.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/rfc7909/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/rfc7909/" title="Datatracker information for this document">Tracker</a>] [<a href="/group/sidr/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-sidr-rpsl-sig@ietf.org?subject=draft-ietf-sidr-rpsl-sig" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=draft-ietf-sidr-rpsl-sig-12.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-ietf-sidr-rpsl-sig-12.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-ietf-sidr-rpsl-sig-12.txt" title="Run an idnits check of this document">Nits</a>]

From: <a href="/doc/html/draft-ietf-sidr-rpsl-sig-12">draft-ietf-sidr-rpsl-sig-12</a>                      Proposed Standard</pre>
      </div>
    

    <div class="draftcontent">
    <pre>Internet Engineering Task Force (IETF)                      R. Kisteleki
Request for Comments: 7909                                      RIPE NCC
Updates: <a href="/doc/html/rfc2622">2622</a>, <a href="/doc/html/rfc4012">4012</a>                                          B. Haberman
Category: Standards Track                                        JHU APL
ISSN: 2070-1721                                                June 2016


     <span class="h1">Securing Routing Policy Specification Language (RPSL) Objects</span>
       <span class="h1">with Resource Public Key Infrastructure (RPKI) Signatures</span>

Abstract

   This document describes a method that allows parties to
   electronically sign Routing Policy Specification Language objects and
   validate such electronic signatures.  This allows relying parties to
   detect accidental or malicious modifications of such objects.  It
   also allows parties who run Internet Routing Registries or similar
   databases, but do not yet have authentication (based on Routing
   Policy System Security) of the maintainers of certain objects, to
   verify that the additions or modifications of such database objects
   are done by the legitimate holder(s) of the Internet resources
   mentioned in those objects.  This document updates RFCs 2622 and 4012
   to add the signature attribute to supported RPSL objects.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="/doc/html/rfc7841#section-2">Section&nbsp;2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7909">http://www.rfc-editor.org/info/rfc7909</a>.














<span class="grey">Kisteleki &amp; Haberman         Standards Track                    [Page 1]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-2" ></span>
<span class="grey"><a href="/doc/html/rfc7909">RFC 7909</a>                      Securing RPSL                    June 2016</span>


Copyright Notice

   Copyright (c) 2016 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="/doc/html/bcp78">BCP 78</a> and the IETF Trust&#x27;s Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  Signature Syntax and Semantics  . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
     <a href="#section-2.1">2.1</a>.  General Attributes and Meta Information . . . . . . . . .   <a href="#page-4">4</a>
     <a href="#section-2.2">2.2</a>.  Signed Attributes . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-2.3">2.3</a>.  Storage of the Signature Data . . . . . . . . . . . . . .   <a href="#page-6">6</a>
     <a href="#section-2.4">2.4</a>.  Number Resource Coverage  . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
     <a href="#section-2.5">2.5</a>.  Validity Time of the Signature  . . . . . . . . . . . . .   <a href="#page-6">6</a>
   <a href="#section-3">3</a>.  Signature Creation and Validation Steps . . . . . . . . . . .   <a href="#page-6">6</a>
     <a href="#section-3.1">3.1</a>.  Canonicalization  . . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
     <a href="#section-3.2">3.2</a>.  Signature Creation  . . . . . . . . . . . . . . . . . . .   <a href="#page-8">8</a>
     <a href="#section-3.3">3.3</a>.  Signature Validation  . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
   <a href="#section-4">4</a>.  Signed Object Types and Set of Signed Attributes  . . . . . .   <a href="#page-9">9</a>
   <a href="#section-5">5</a>.  Keys and Certificates Used for Signature and Verification . .  <a href="#page-11">11</a>
   <a href="#section-6">6</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
   <a href="#section-7">7</a>.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
     <a href="#section-7.1">7.1</a>.  Normative References  . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
     <a href="#section-7.2">7.2</a>.  Informative References  . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
   Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
   Authors&#x27; Addresses  . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>















<span class="grey">Kisteleki &amp; Haberman         Standards Track                    [Page 2]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-3" ></span>
<span class="grey"><a href="/doc/html/rfc7909">RFC 7909</a>                      Securing RPSL                    June 2016</span>


<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>.  Introduction</span>

   Objects stored in resource databases, like the RIPE DB, are generally
   protected by an authentication mechanism: anyone creating or
   modifying an object in the database has to have proper authorization
   to do so, and therefore has to go through an authentication procedure
   (provide a password, certificate, email signature, etc.).  However,
   for objects transferred between resource databases, the
   authentication is not guaranteed.  This means that when a Routing
   Policy Specification Language (RPSL) object is downloaded from a
   database, the consumer can reasonably claim that the object is
   authentic if it was locally created, but cannot make the same claim
   for an object imported from a different database.  Also, once such an
   object is downloaded from the database, it becomes a simple (but
   still structured) text file with no integrity protection.  More
   importantly, the authentication and integrity guarantees associated
   with these objects do not always ensure that the entity that
   generated them is authorized to make the assertions implied by the
   data contained in the objects.

   A potential use for resource certificates [<a href="/doc/html/rfc6487" title="&quot;A Profile for X.509 PKIX Resource Certificates&quot;">RFC6487</a>] is to use them to
   secure such (both imported and downloaded) database objects, by
   applying a digital signature over the object contents in lieu of
   methods such as Routing Policy System Security [<a href="/doc/html/rfc2725" title="&quot;Routing Policy System Security&quot;">RFC2725</a>].  The signer
   of such signed database objects MUST possess a relevant resource
   certificate, which shows him/her as the legitimate holder of an
   Internet number resource.  This mechanism allows the users of such
   database objects to verify that the contents are in fact produced by
   the legitimate holder(s) of the Internet resources mentioned in those
   objects.  It also allows the signatures to cover whole RPSL objects,
   or just selected attributes of them.  In other words, a digital
   signature created using the private key associated with a resource
   certificate can offer object security in addition to the channel
   security already present in most resource databases.  Object security
   in turn allows such objects to be hosted in different databases and
   still be independently verifiable.

   While the approach outlined in this document mandates the use of the
   Resource Public Key Infrastructure (RPKI) for certificate
   distribution, it is not dependent upon the RPKI for correct
   functionality.  Equivalent functionality can be achieved with a more
   traditional Certification Authority (CA), using the extensions
   described in [<a href="/doc/html/rfc3779" title="&quot;X.509 Extensions for IP Addresses and AS Identifiers&quot;">RFC3779</a>] within the certificates, and the appropriate
   trust anchor material to verify the digital signature.







<span class="grey">Kisteleki &amp; Haberman         Standards Track                    [Page 3]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-4" ></span>
<span class="grey"><a href="/doc/html/rfc7909">RFC 7909</a>                      Securing RPSL                    June 2016</span>


   The capitalized key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;,
   &quot;SHALL NOT&quot;, &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;MAY&quot;, and
   &quot;OPTIONAL&quot; in this document are to be interpreted as described in
   [<a href="/doc/html/rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].

<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  Signature Syntax and Semantics</span>

   When signing an RPSL object [<a href="/doc/html/rfc2622" title="&quot;Routing Policy Specification Language (RPSL)&quot;">RFC2622</a>] [<a href="/doc/html/rfc4012" title="&quot;Routing Policy Specification Language next generation (RPSLng)&quot;">RFC4012</a>], the input for the
   signature process is transformed into a sequence of strings of ASCII
   data.  The approach is similar to the one used in Domain Key
   Identified Mail (DKIM) [<a href="/doc/html/rfc6376" title="&quot;DomainKeys Identified Mail (DKIM) Signatures&quot;">RFC6376</a>].  In the case of RPSL, the object to
   be signed closely resembles an SMTP header, so it seems reasonable to
   adapt DKIM&#x27;s relevant features.

<span class="h3"><a class="selflink" id="section-2.1" href="#section-2.1">2.1</a>.  General Attributes and Meta Information</span>

   The digital signature associated with an RPSL object is itself a new
   attribute named &quot;signature&quot;.  It consists of mandatory and optional
   fields.  These fields are structured in a sequence of name and value
   pairs, separated by a semicolon &quot;;&quot; and a whitespace.  Collectively,
   these fields make up the value for the new &quot;signature&quot; attribute.
   The &quot;name&quot; part of such a component is always a single ASCII
   character that serves as an identifier; the value is an ASCII string
   the contents of which depend on the field type.  Mandatory fields
   MUST appear exactly once, whereas optional fields MUST appear at most
   once.

   Mandatory fields of the &quot;signature&quot; attribute:

   o  Version of the signature (field &quot;v&quot;): This field MUST be set to
      &quot;rpkiv1&quot; and MAY be the first field of the signature attribute to
      simplify the parsing of the attributes&#x27; fields.  The signature
      format described in this document applies when the version field
      is set to &quot;rpkiv1&quot;.  All the rest of the signature attributes are
      defined by the value of the version field.

   o  Reference to the certificate corresponding to the private key used
      to sign this object (field &quot;c&quot;): The value of this field MUST be a
      URL of type &quot;rsync&quot; [<a href="/doc/html/rfc5781" title="&quot;The rsync URI Scheme&quot;">RFC5781</a>] or &quot;http(s)&quot; [<a href="/doc/html/rfc7230" title="&quot;Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing&quot;">RFC7230</a>] that points
      to a specific resource certificate in an RPKI repository
      [<a href="/doc/html/rfc6481" title="&quot;A Profile for Resource Certificate Repository Structure&quot;">RFC6481</a>].  Any non URL-safe characters (including semicolon &quot;;&quot;
      and plus &quot;+&quot;) must be URL encoded [<a href="/doc/html/rfc3986" title="&quot;Uniform Resource Identifier (URI): Generic Syntax&quot;">RFC3986</a>].

   o  Signature method (field &quot;m&quot;): What hash and signature algorithms
      were used to create the signature.  This specification follows the
      algorithms defined in <a href="/doc/html/rfc6485">RFC 6485</a> [<a href="/doc/html/rfc6485" title="&quot;The Profile for Algorithms and Key Sizes for Use in the Resource Public Key Infrastructure (RPKI)&quot;">RFC6485</a>].  The algorithms are
      referenced within the signature attribute by the ASCII names of
      the algorithms.



<span class="grey">Kisteleki &amp; Haberman         Standards Track                    [Page 4]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-5" ></span>
<span class="grey"><a href="/doc/html/rfc7909">RFC 7909</a>                      Securing RPSL                    June 2016</span>


   o  Time of signing (field &quot;t&quot;): The format of the value of this field
      MUST be in the Internet Date/Time ABNF format [<a href="/doc/html/rfc3339" title="&quot;Date and Time on the Internet: Timestamps&quot;">RFC3339</a>].  All
      times MUST be converted to Universal Coordinated Time (UTC), i.e.,
      the ABNF time-offset is always &quot;Z&quot;.

   o  The signed attributes (field &quot;a&quot;): This is a list of attribute
      names, separated by an ASCII &quot;+&quot; character (if more than one
      attribute is enumerated).  The list must include any attribute at
      most once.

   o  The signature itself (field &quot;b&quot;): This MUST be the last field in
      the list.  The signature is the output of the signature algorithm
      using the appropriate private key and the calculated hash value of
      the object as inputs.  The value of this field is the digital
      signature in base64 encoding (<a href="/doc/html/rfc4648#section-4">Section&nbsp;4 of [RFC4648]</a>).

   Optional fields of the &quot;signature&quot; attribute:

   o  Signature expiration time (field &quot;x&quot;): The format of the value of
      this field MUST be in the Internet Date/Time format [<a href="/doc/html/rfc3339" title="&quot;Date and Time on the Internet: Timestamps&quot;">RFC3339</a>].
      All times MUST be represented in UTC.

<span class="h3"><a class="selflink" id="section-2.2" href="#section-2.2">2.2</a>.  Signed Attributes</span>

   One can look at an RPSL object as an (ordered) set of attributes,
   each having a &quot;key: value&quot; syntax.  Understanding this structure can
   help in developing more flexible methods for applying digital
   signatures.

   Some of these attributes are automatically added by the database,
   some are database-dependent, yet others do not carry operationally
   important information.  This specification allows the maintainer of
   such an object to decide which attributes are important (signed) and
   which are not (not signed), from among all the attributes of the
   object; in other words, we define a way of including important
   attributes while excluding irrelevant ones.  Allowing the maintainer
   of an object to select the attributes that are covered by the digital
   signature achieves the goals established in <a href="#section-1">Section 1</a>.

   The type of the object determines the minimum set of attributes that
   MUST be signed.  The signer MAY choose to sign additional attributes,
   in order to provide integrity protection for those attributes too.

   When verifying the signature of an object, the verifier has to check
   whether the signature itself is valid, and whether all the specified
   attributes are referenced in the signature.  If not, the verifier
   MUST reject the signature and treat the object as a regular, unsigned
   RPSL object.



<span class="grey">Kisteleki &amp; Haberman         Standards Track                    [Page 5]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-6" ></span>
<span class="grey"><a href="/doc/html/rfc7909">RFC 7909</a>                      Securing RPSL                    June 2016</span>


<span class="h3"><a class="selflink" id="section-2.3" href="#section-2.3">2.3</a>.  Storage of the Signature Data</span>

   The result of applying the signature mechanism once is exactly one
   new attribute for the object.  As an illustration, the structure of a
   signed RPSL object is as follows:

     attribute1:  value1
     attribute2:  value2
     attribute3:  value3
     ...
     signature:   v=rpkiv1; c=rsync://.....; m=sha256WithRSAEncryption;
                  t=2014-12-31T23:59:60Z;
                  a=attribute1+attribute2+attribute3+...;
                  b=&lt;base64 data&gt;

<span class="h3"><a class="selflink" id="section-2.4" href="#section-2.4">2.4</a>.  Number Resource Coverage</span>

   Even if the signature over the object is valid according to the
   signature validation rules, it may not be relevant to the object; it
   also needs to cover the relevant Internet number resources mentioned
   in the object.

   Therefore, the Internet number resources present in [<a href="/doc/html/rfc3779" title="&quot;X.509 Extensions for IP Addresses and AS Identifiers&quot;">RFC3779</a>]
   extensions of the certificate referred to in the &quot;c&quot; field of the
   signature MUST cover the resources in the primary key of the object
   (e.g., value of the &quot;aut-num:&quot; attribute of an aut-num object, value
   of the &quot;inetnum:&quot; attribute of an inetnum object, values of &quot;route:&quot;,
   and &quot;origin:&quot; attributes of a route object, etc.).

<span class="h3"><a class="selflink" id="section-2.5" href="#section-2.5">2.5</a>.  Validity Time of the Signature</span>

   The validity time interval of a signature is the intersection of the
   validity time of the certificate used to verify the signature, the
   &quot;not before&quot; time specified by the &quot;t&quot; field of the signature, and
   the optional &quot;not after&quot; time specified by the &quot;x&quot; field of the
   signature.

   When checking multiple signatures, these checks are individually
   applied to each signature.

<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>.  Signature Creation and Validation Steps</span>

<span class="h3"><a class="selflink" id="section-3.1" href="#section-3.1">3.1</a>.  Canonicalization</span>

   The notion of canonicalization is essential to digital signature
   generation and validation whenever data representations may change
   between a signer and one or more signature verifiers.
   Canonicalization defines how one transforms a representation of data



<span class="grey">Kisteleki &amp; Haberman         Standards Track                    [Page 6]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-7" ></span>
<span class="grey"><a href="/doc/html/rfc7909">RFC 7909</a>                      Securing RPSL                    June 2016</span>


   into a series of bits for signature generation and verification.  The
   task of canonicalization is to make irrelevant differences in
   representations of the same object, which would otherwise cause
   signature verification to fail.  Examples of this could be:

   o  data transformations applied by the databases that host these
      objects (such as notational changes for IPv4/IPv6 prefixes,
      automatic addition/modification of &quot;changed&quot; attributes, etc.)

   o  the difference of line terminators across different systems

   This means that the destination database might change parts of the
   submitted data after it was signed, which would cause signature
   verification to fail.  This document specifies strict
   canonicalization rules to overcome this problem.

   The following steps MUST be applied in order to achieve canonicalized
   representation of an object, before the actual signature
   (verification) process can begin:

   1.  Comments (anything beginning with a &quot;#&quot;) MUST be omitted.

   2.  Any trailing whitespace MUST be omitted.

   3.  A multi-line attribute MUST be converted into its single-line
       equivalent.  This is accomplished by:

       *  Converting all line endings to a single blank space (ASCII
          code 32).

       *  Concatenating all lines into a single line.

       *  Replacing the trailing blank space with a single new line
          (&quot;\n&quot;, ASCII code 10).

   4.  Numerical fields MUST be converted to canonical representations.
       These include:

       *  Date and time fields MUST be converted to UTC and MUST be
          represented in the Internet Date/Time format [<a href="/doc/html/rfc3339" title="&quot;Date and Time on the Internet: Timestamps&quot;">RFC3339</a>].

       *  AS numbers MUST be converted to ASPLAIN syntax [<a href="/doc/html/rfc5396" title="&quot;Textual Representation of Autonomous System (AS) Numbers&quot;">RFC5396</a>].

       *  IPv6 addresses MUST be canonicalized as defined in [<a href="/doc/html/rfc5952" title="&quot;A Recommendation for IPv6 Address Text Representation&quot;">RFC5952</a>].

       *  IPv4 addresses MUST be represented as the ipv4-address type
          defined by RPSL [<a href="/doc/html/rfc2622" title="&quot;Routing Policy Specification Language (RPSL)&quot;">RFC2622</a>].




<span class="grey">Kisteleki &amp; Haberman         Standards Track                    [Page 7]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-8" ></span>
<span class="grey"><a href="/doc/html/rfc7909">RFC 7909</a>                      Securing RPSL                    June 2016</span>


       *  All IP prefixes (IPv4 and IPv6) MUST be represented in
          Classless Inter-Domain Routing (CIDR) notation [<a href="/doc/html/rfc4632" title="&quot;Classless Inter-domain Routing (CIDR): The Internet Address Assignment and Aggregation Plan&quot;">RFC4632</a>].

   5.  All ranges, lists, or sets of numerical fields are represented
       using the appropriate RPSL attribute and each numerical element
       contained within those attributes MUST conform to the
       canonicalization rules in this document.  The ordering of values
       within such fields MUST be maintained during database transfers.

   6.  The name of each attribute MUST be converted into lower case, and
       MUST be kept as part of the attribute line.

   7.  Tab characters (&quot;\t&quot;, ASCII code 09) MUST be converted into
       spaces.

   8.  Multiple whitespaces MUST be collapsed into a single space (&quot; &quot;,
       ASCII code 32) character.

   9.  All line endings MUST be converted into a single new line (&quot;\n&quot;,
       ASCII code 10) character, (thus avoiding CR vs. CRLF
       differences).

<span class="h3"><a class="selflink" id="section-3.2" href="#section-3.2">3.2</a>.  Signature Creation</span>

   Given an RPSL object and corresponding certificate, in order to
   create the digital signature, the following steps MUST be performed:

   1.  Create a list of attribute names referring to the attributes that
       will be signed (contents of the &quot;a&quot; field).  The minimum set of
       these attributes is determined by the object type; the signer MAY
       select additional attributes.

   2.  Arrange the selected attributes according to the selection
       sequence specified in the &quot;a&quot; field as above, omitting all
       attributes that will not be signed.

   3.  Construct the new &quot;signature&quot; attribute, with all its fields,
       leaving the value of the &quot;b&quot; field empty.

   4.  Apply canonicalization rules to the result (including the
       &quot;signature&quot; attribute).

   5.  Create the signature over the results of the canonicalization
       process (according to the signature and hash algorithms specified
       in the &quot;m&quot; field of the signature attribute).

   6.  Insert the base64-encoded value of the signature as the value of
       the &quot;b&quot; field.



<span class="grey">Kisteleki &amp; Haberman         Standards Track                    [Page 8]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-9" ></span>
<span class="grey"><a href="/doc/html/rfc7909">RFC 7909</a>                      Securing RPSL                    June 2016</span>


   7.  Append the resulting &quot;signature&quot; attribute to the original
       object.

<span class="h3"><a class="selflink" id="section-3.3" href="#section-3.3">3.3</a>.  Signature Validation</span>

   In order to validate a signature over such an object, the following
   steps MUST be performed:

   1.  Verify the syntax of the &quot;signature&quot; attribute (i.e., whether it
       contains the mandatory and optional components and the syntax of
       these fields matches the specification as described in
       <a href="#section-2.1">Section 2.1</a>).

   2.  Fetch the certificate referred to in the &quot;c&quot; field of the
       &quot;signature&quot; attribute, and check its validity using the steps
       described in [<a href="/doc/html/rfc6487" title="&quot;A Profile for X.509 PKIX Resource Certificates&quot;">RFC6487</a>].

   3.  Extract the list of attributes that were signed using the signer
       from the &quot;a&quot; field of the &quot;signature&quot; attribute.

   4.  Verify that the list of signed attributes includes the minimum
       set of attributes for that object type.

   5.  Arrange the selected attributes according to the selection
       sequence provided in the value of the &quot;a&quot; field, omitting all
       unsigned attributes.

   6.  Replace the value of the signature field &quot;b&quot; of the &quot;signature&quot;
       attribute with an empty string.

   7.  Apply the canonicalization procedure to the selected attributes
       (including the &quot;signature&quot; attribute).

   8.  Check the validity of the signature using the signature algorithm
       specified in the &quot;m&quot; field of the signature attribute, the public
       key contained in the certificate mentioned in the &quot;c&quot; field of
       the signature, the signature value specified in the &quot;b&quot; field of
       the signature attribute, and the output of the canonicalization
       process.

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>.  Signed Object Types and Set of Signed Attributes</span>

   This section describes a list of object types that MAY be signed
   using this approach.  For each object type, the set of attributes
   that MUST be signed for these object types (the minimum set noted in
   <a href="#section-3.3">Section 3.3</a> is enumerated.





<span class="grey">Kisteleki &amp; Haberman         Standards Track                    [Page 9]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-10" ></span>
<span class="grey"><a href="/doc/html/rfc7909">RFC 7909</a>                      Securing RPSL                    June 2016</span>


   This list generally excludes attributes that are used to maintain
   referential integrity in the databases that carry these objects,
   since these usually make sense only within the context of such a
   database, whereas the scope of the signatures is only one specific
   object.  Since the attributes in the referred object (such as mnt-by,
   admin-c, tech-c, etc.) can change without any modifications to the
   signed object, signing such attributes could lead to a false sense of
   security in terms of the contents of the signed data; therefore,
   including such attributes should only be done in order to provide
   full integrity protection of the object itself.

   The newly constructed &quot;signature&quot; attribute is always included in the
   list.  The signature under construction MUST NOT include signature
   attributes that are already present in the object.

      as-block:

      *  as-block

      *  signature

      aut-num:

      *  aut-num
      *  as-name
      *  member-of
      *  import
      *  mp-import
      *  export
      *  mp-export
      *  default
      *  mp-default
      *  signature

      inet[6]num:

      *  inet[6]num
      *  netname
      *  country
      *  status
      *  signature










<span class="grey">Kisteleki &amp; Haberman         Standards Track                   [Page 10]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-11" ></span>
<span class="grey"><a href="/doc/html/rfc7909">RFC 7909</a>                      Securing RPSL                    June 2016</span>


      route[6]:

      *  route[6]
      *  origin
      *  holes
      *  member-of
      *  signature

   It should be noted that the approach defined in this document has a
   limitation in signing route[6] objects.  This document only supports
   a single signature per object.  This means that it is not possible to
   properly sign route[6] objects where one resource holder possesses
   the Autonomous System Number (ASN) and another resource holder
   possesses the referenced prefix.  A future version of this
   specification may resolve this limitation.

   For each signature, the extension described in <a href="/doc/html/rfc3779">RFC 3779</a> that appears
   in the certificate used to verify the signature MUST include a
   resource entry that is equivalent to, or covers (i.e., is &quot;less
   specific&quot; than) the following resources mentioned in the object the
   signature is attached to:

   o  For the as-block object type: the resource in the &quot;as-block&quot;
      attribute.

   o  For the aut-num object type: the resource in the &quot;aut-num&quot;
      attribute.

   o  For the inet[6]num object type: the resource in the &quot;inet[6]num&quot;
      attribute.

   o  For the route[6] object type: the resource in the &quot;route[6]&quot; or
      &quot;origin&quot; (or both) attributes.

<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>.  Keys and Certificates Used for Signature and Verification</span>

   The certificate that is referred to in the signature (in the &quot;c&quot;
   field):

   o  MUST be an end-entity (i.e., non-CA) certificate

   o  MUST conform to the X.509 PKIX Resource Certificate profile
      [<a href="/doc/html/rfc6487" title="&quot;A Profile for X.509 PKIX Resource Certificates&quot;">RFC6487</a>]

   o  MUST have the extension described in <a href="/doc/html/rfc3779">RFC 3779</a> that covers the
      Internet number resource included in a signed attribute [<a href="/doc/html/rfc3779" title="&quot;X.509 Extensions for IP Addresses and AS Identifiers&quot;">RFC3779</a>]





<span class="grey">Kisteleki &amp; Haberman         Standards Track                   [Page 11]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-12" ></span>
<span class="grey"><a href="/doc/html/rfc7909">RFC 7909</a>                      Securing RPSL                    June 2016</span>


   The certificate generated will omit the Subject Information Access
   (SIA) extension mandated by <a href="/doc/html/rfc6487">RFC 6487</a> as that extension requires an
   rsync URI for the accessLocation form and RPSL currently does not
   support database access via rsync.

<span class="h2"><a class="selflink" id="section-6" href="#section-6">6</a>.  Security Considerations</span>

   RPSL objects stored in the Internet Routing Registry (IRR) databases
   are public, and as such there is no need for confidentiality.  Each
   signed RPSL object can have its integrity and authenticity verified
   using the supplied digital signature and the referenced certificate.

   Since the RPSL signature approach leverages X.509 extensions, the
   security considerations in [<a href="/doc/html/rfc3779" title="&quot;X.509 Extensions for IP Addresses and AS Identifiers&quot;">RFC3779</a>] apply here as well.
   Additionally, implementers MUST follow the certificate validation
   steps described in <a href="/doc/html/rfc6487">RFC 6487</a>.

   The maintainer of an object has the ability to include attributes in
   the signature that are not included in the resource certificate used
   to create the signature.  Potentially, a maintainer may include
   attributes that reference resources the maintainer is not authorized
   to use.

   It should be noted that this digital signature does not preclude
   monkey-in-the-middle attacks where the adversary either intercepts
   RPSL object transfers, deletes the signature attribute, modifies the
   contents, or intercepts the transfer and drops the objects destined
   for the requester.

<span class="h2"><a class="selflink" id="section-7" href="#section-7">7</a>.  References</span>

<span class="h3"><a class="selflink" id="section-7.1" href="#section-7.1">7.1</a>.  Normative References</span>

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., &quot;Key words for use in RFCs to Indicate
              Requirement Levels&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc2119">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC2622">RFC2622</a>]  Alaettinoglu, C., Villamizar, C., Gerich, E., Kessens, D.,
              Meyer, D., Bates, T., Karrenberg, D., and M. Terpstra,
              &quot;Routing Policy Specification Language (RPSL)&quot;, <a href="/doc/html/rfc2622">RFC 2622</a>,
              DOI 10.17487/RFC2622, June 1999,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2622">http://www.rfc-editor.org/info/rfc2622</a>&gt;.

   [<a id="ref-RFC3339">RFC3339</a>]  Klyne, G. and C. Newman, &quot;Date and Time on the Internet:
              Timestamps&quot;, <a href="/doc/html/rfc3339">RFC 3339</a>, DOI 10.17487/RFC3339, July 2002,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3339">http://www.rfc-editor.org/info/rfc3339</a>&gt;.




<span class="grey">Kisteleki &amp; Haberman         Standards Track                   [Page 12]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-13" ></span>
<span class="grey"><a href="/doc/html/rfc7909">RFC 7909</a>                      Securing RPSL                    June 2016</span>


   [<a id="ref-RFC3779">RFC3779</a>]  Lynn, C., Kent, S., and K. Seo, &quot;X.509 Extensions for IP
              Addresses and AS Identifiers&quot;, <a href="/doc/html/rfc3779">RFC 3779</a>,
              DOI 10.17487/RFC3779, June 2004,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3779">http://www.rfc-editor.org/info/rfc3779</a>&gt;.

   [<a id="ref-RFC3986">RFC3986</a>]  Berners-Lee, T., Fielding, R., and L. Masinter, &quot;Uniform
              Resource Identifier (URI): Generic Syntax&quot;, STD 66,
              <a href="/doc/html/rfc3986">RFC 3986</a>, DOI 10.17487/RFC3986, January 2005,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3986">http://www.rfc-editor.org/info/rfc3986</a>&gt;.

   [<a id="ref-RFC4012">RFC4012</a>]  Blunk, L., Damas, J., Parent, F., and A. Robachevsky,
              &quot;Routing Policy Specification Language next generation
              (RPSLng)&quot;, <a href="/doc/html/rfc4012">RFC 4012</a>, DOI 10.17487/RFC4012, March 2005,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4012">http://www.rfc-editor.org/info/rfc4012</a>&gt;.

   [<a id="ref-RFC4632">RFC4632</a>]  Fuller, V. and T. Li, &quot;Classless Inter-domain Routing
              (CIDR): The Internet Address Assignment and Aggregation
              Plan&quot;, <a href="/doc/html/bcp122">BCP 122</a>, <a href="/doc/html/rfc4632">RFC 4632</a>, DOI 10.17487/RFC4632, August
              2006, &lt;<a href="http://www.rfc-editor.org/info/rfc4632">http://www.rfc-editor.org/info/rfc4632</a>&gt;.

   [<a id="ref-RFC4648">RFC4648</a>]  Josefsson, S., &quot;The Base16, Base32, and Base64 Data
              Encodings&quot;, <a href="/doc/html/rfc4648">RFC 4648</a>, DOI 10.17487/RFC4648, October 2006,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4648">http://www.rfc-editor.org/info/rfc4648</a>&gt;.

   [<a id="ref-RFC5396">RFC5396</a>]  Huston, G. and G. Michaelson, &quot;Textual Representation of
              Autonomous System (AS) Numbers&quot;, <a href="/doc/html/rfc5396">RFC 5396</a>,
              DOI 10.17487/RFC5396, December 2008,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5396">http://www.rfc-editor.org/info/rfc5396</a>&gt;.

   [<a id="ref-RFC5781">RFC5781</a>]  Weiler, S., Ward, D., and R. Housley, &quot;The rsync URI
              Scheme&quot;, <a href="/doc/html/rfc5781">RFC 5781</a>, DOI 10.17487/RFC5781, February 2010,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5781">http://www.rfc-editor.org/info/rfc5781</a>&gt;.

   [<a id="ref-RFC5952">RFC5952</a>]  Kawamura, S. and M. Kawashima, &quot;A Recommendation for IPv6
              Address Text Representation&quot;, <a href="/doc/html/rfc5952">RFC 5952</a>,
              DOI 10.17487/RFC5952, August 2010,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5952">http://www.rfc-editor.org/info/rfc5952</a>&gt;.

   [<a id="ref-RFC6481">RFC6481</a>]  Huston, G., Loomans, R., and G. Michaelson, &quot;A Profile for
              Resource Certificate Repository Structure&quot;, <a href="/doc/html/rfc6481">RFC 6481</a>,
              DOI 10.17487/RFC6481, February 2012,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6481">http://www.rfc-editor.org/info/rfc6481</a>&gt;.

   [<a id="ref-RFC6485">RFC6485</a>]  Huston, G., &quot;The Profile for Algorithms and Key Sizes for
              Use in the Resource Public Key Infrastructure (RPKI)&quot;,
              <a href="/doc/html/rfc6485">RFC 6485</a>, DOI 10.17487/RFC6485, February 2012,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6485">http://www.rfc-editor.org/info/rfc6485</a>&gt;.




<span class="grey">Kisteleki &amp; Haberman         Standards Track                   [Page 13]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-14" ></span>
<span class="grey"><a href="/doc/html/rfc7909">RFC 7909</a>                      Securing RPSL                    June 2016</span>


   [<a id="ref-RFC6487">RFC6487</a>]  Huston, G., Michaelson, G., and R. Loomans, &quot;A Profile for
              X.509 PKIX Resource Certificates&quot;, <a href="/doc/html/rfc6487">RFC 6487</a>,
              DOI 10.17487/RFC6487, February 2012,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6487">http://www.rfc-editor.org/info/rfc6487</a>&gt;.

   [<a id="ref-RFC7230">RFC7230</a>]  Fielding, R., Ed. and J. Reschke, Ed., &quot;Hypertext Transfer
              Protocol (HTTP/1.1): Message Syntax and Routing&quot;,
              <a href="/doc/html/rfc7230">RFC 7230</a>, DOI 10.17487/RFC7230, June 2014,
              &lt;<a href="http://www.rfc-editor.org/info/rfc7230">http://www.rfc-editor.org/info/rfc7230</a>&gt;.

<span class="h3"><a class="selflink" id="section-7.2" href="#section-7.2">7.2</a>.  Informative References</span>

   [<a id="ref-RFC2725">RFC2725</a>]  Villamizar, C., Alaettinoglu, C., Meyer, D., and S.
              Murphy, &quot;Routing Policy System Security&quot;, <a href="/doc/html/rfc2725">RFC 2725</a>,
              DOI 10.17487/RFC2725, December 1999,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2725">http://www.rfc-editor.org/info/rfc2725</a>&gt;.

   [<a id="ref-RFC6376">RFC6376</a>]  Crocker, D., Ed., Hansen, T., Ed., and M. Kucherawy, Ed.,
              &quot;DomainKeys Identified Mail (DKIM) Signatures&quot;, STD 76,
              <a href="/doc/html/rfc6376">RFC 6376</a>, DOI 10.17487/RFC6376, September 2011,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6376">http://www.rfc-editor.org/info/rfc6376</a>&gt;.

Acknowledgements

   The authors would like to acknowledge the valued contributions from
   Jos Boumans, Tom Harrison, Steve Kent, Sandra Murphy, Magnus Nystrom,
   Alvaro Retana, Sean Turner, Geoff Huston, and Stephen Farrell in
   preparation of this document.

Authors&#x27; Addresses

   Robert Kisteleki
   RIPE NCC

   Email: robert@ripe.net
   URI:   <a href="http://www.ripe.net">http://www.ripe.net</a>


   Brian Haberman
   Johns Hopkins University Applied Physics Lab

   Email: brian@innovationslab.net









Kisteleki &amp; Haberman         Standards Track                   [Page 14]
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

