<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    rfc1852
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.33.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.33.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/rfc1852/">
  <meta name="description" content="IP Authentication using Keyed SHA (RFC )">
  <script src="https://www.ietf.org/lib/dt/7.33.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.33.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.33.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.33.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bgbrown"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc1852.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc1852.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/pdfrfc/rfc1852.txt.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/rfc1852/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/rfc1852/" title="Datatracker information for this document">Tracker</a>] [<a href="mailto:rfc1852@ietf.org?subject=rfc1852" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=rfc1852-.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=rfc1852-.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/rfc1852-.txt" title="Run an idnits check of this document">Nits</a>]

Obsoleted by: <a href="/doc/html/rfc2841">2841</a>                                          Experimental</pre>
      </div>
    

    <div class="draftcontent">
    <pre>Network Working Group                                         P. Metzger
Request for Comments: 1852                                      Piermont
Category: Experimental                                        W. Simpson
                                                              Daydreamer
                                                          September 1995


                   <span class="h1">IP Authentication using Keyed SHA</span>



Status of this Memo

   This document defines an Experimental Protocol for the Internet
   community.  This does not specify an Internet standard of any kind.
   Discussion and suggestions for improvement are requested.
   Distribution of this memo is unlimited.


Abstract

   This document describes the use of keyed SHA with the IP
   Authentication Header.


Table of Contents

     <a href="#section-1">1</a>.     Introduction ..........................................    <a href="#page-2">2</a>
        <a href="#section-1.1">1.1</a>       Keys ............................................    <a href="#page-2">2</a>
        <a href="#section-1.2">1.2</a>       Data Size .......................................    <a href="#page-2">2</a>
        <a href="#section-1.3">1.3</a>       Performance .....................................    <a href="#page-2">2</a>

     <a href="#section-2">2</a>.     Calculation ...........................................    <a href="#page-3">3</a>

     SECURITY CONSIDERATIONS ......................................    <a href="#page-4">4</a>
     ACKNOWLEDGEMENTS .............................................    <a href="#page-4">4</a>
     REFERENCES ...................................................    <a href="#page-5">5</a>
     AUTHOR&#x27;S ADDRESS .............................................    <a href="#page-6">6</a>













<span class="grey">Metzger &amp; Simpson             Experimental                      [Page 1]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-2" ></span>
<span class="grey"><a href="/doc/html/rfc1852">RFC 1852</a>                         AH SHA                   September 1995</span>


<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>.  Introduction</span>

   The Authentication Header (AH) [<a href="/doc/html/rfc1826">RFC-1826</a>] provides integrity and
   authentication for IP datagrams.  This specification describes the AH
   use of keys with the Secure Hash Algorithm (SHA) [<a href="#ref-FIPS-180-1">FIPS-180-1</a>].

      It should be noted that this document specifies a newer version of
      the SHA than that described in [<a href="#ref-FIPS-180">FIPS-180</a>], which was flawed.  The
      older version is not interoperable with the newer version.

   This document assumes that the reader is familiar with the related
   document &quot;Security Architecture for the Internet Protocol&quot; [RFC-
   1825], which defines the overall security plan for IP, and provides
   important background for this specification.



<span class="h3"><a class="selflink" id="section-1.1" href="#section-1.1">1.1</a>.  Keys</span>

   The secret authentication key shared between the communicating
   parties SHOULD be a cryptographically strong random number, not a
   guessable string of any sort.

   The shared key is not constrained by this transform to any particular
   size.  Lengths of up to 160 bits MUST be supported by the
   implementation, although any particular key may be shorter.  Longer
   keys are encouraged.



<span class="h3"><a class="selflink" id="section-1.2" href="#section-1.2">1.2</a>.  Data Size</span>

   SHA&#x27;s 160-bit output is naturally 32-bit aligned.  However, many
   implementations require 64-bit alignment of the following headers, in
   which case an additional 32 bits of padding is added, either before
   or after the SHA output.

   The size and position of this padding are negotiated as part of the
   key management.  Padding bits are filled with unspecified
   implementation dependent (random) values, which are ignored on
   receipt.



<span class="h3"><a class="selflink" id="section-1.3" href="#section-1.3">1.3</a>.  Performance</span>

   Preliminary results indicate that SHA is 62% as fast as MD5, and 80%
   as fast as DES hashing.  That is,



<span class="grey">Metzger &amp; Simpson             Experimental                      [Page 2]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-3" ></span>
<span class="grey"><a href="/doc/html/rfc1852">RFC 1852</a>                         AH SHA                   September 1995</span>


                           SHA &lt; DES &lt; MD5

   Nota Bene:
      Suggestions are sought on alternative authentication algorithms
      that have significantly faster throughput, are not patent-
      encumbered, and still retain adequate cryptographic strength.



<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  Calculation</span>

   The 160-bit digest is calculated as described in [<a href="#ref-FIPS-180-1">FIPS-180-1</a>].  At
   the time of writing, a portable C language implementation of SHA is
   available via FTP from <a href="ftp://rand.org/pub/jim/sha.tar.gz">ftp://rand.org/pub/jim/sha.tar.gz</a>.

   The form of the authenticated message is

            key, keyfill, datagram, key, SHAfill

   First, the variable length secret authentication key is filled to the
   next 512-bit boundary, using the same pad with length technique
   defined for SHA.

   Then, the filled key is concatenated with (immediately followed by)
   the invariant fields of the entire IP datagram (variant fields are
   zeroed), concatenated with (immediately followed by) the original
   variable length key again.

   A trailing pad with length to the next 512-bit boundary for the
   entire message is added by SHA itself.  The 160-bit SHA digest is
   calculated, and the result is inserted into the Authentication Data
   field.

   Discussion:
      The leading copy of the key is padded in order to facilitate
      copying of the key at machine boundaries without requiring re-
      alignment of the following datagram.  The padding technique
      includes a length which protects arbitrary length keys.  Filling
      to the SHA block size also allows the key to be prehashed to avoid
      the physical copy in some implementations.

      The trailing copy of the key is not necessary to protect against
      appending attacks, as the IP datagram already includes a total
      length field.  It reintroduces mixing of the entire key, providing
      minimal protection for very long and very short datagrams, and
      marginal robustness against possible attacks on the IP length
      field itself.




<span class="grey">Metzger &amp; Simpson             Experimental                      [Page 3]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-4" ></span>
<span class="grey"><a href="/doc/html/rfc1852">RFC 1852</a>                         AH SHA                   September 1995</span>


      When the implementation adds the keys and padding in place before
      and after the IP datagram, care must be taken that the keys and/or
      padding are not sent over the link by the link driver.



Security Considerations

   Users need to understand that the quality of the security provided by
   this specification depends completely on the strength of the SHA hash
   function, the correctness of that algorithm&#x27;s implementation, the
   security of the key management mechanism and its implementation, the
   strength of the key [<a href="#ref-CN94">CN94</a>], and upon the correctness of the
   implementations in all of the participating nodes.

   The SHA algorithm was originally derived from the MD4 algorithm
   [<a href="/doc/html/rfc1320">RFC-1320</a>].  A flaw was apparently found in the original
   specification of SHA [<a href="#ref-FIPS-180">FIPS-180</a>], and this document specifies the use
   of a corrected version [<a href="#ref-FIPS-180-1">FIPS-180-1</a>].

   At the time of writing of this document, there are no known flaws in
   the SHA algorithm.  That is, there are no known attacks on SHA or any
   of its components that are better than brute force, and the 160-bit
   hash output by SHA is substantially more resistant to brute force
   attacks than the 128-bit hash size of MD4 and MD5.

   However, as the flaw in the original SHA algorithm shows,
   cryptographers are fallible, and there may be substantial
   deficiencies yet to be discovered in the algorithm.



Acknowledgements

   Some of the text of this specification was derived from work by
   Randall Atkinson for the SIP, SIPP, and IPv6 Working Groups.

   Preliminary performance analysis was provided by Joe Touch.

   Comments should be submitted to the ipsec@ans.net mailing list.











<span class="grey">Metzger &amp; Simpson             Experimental                      [Page 4]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-5" ></span>
<span class="grey"><a href="/doc/html/rfc1852">RFC 1852</a>                         AH SHA                   September 1995</span>


References

   [<a id="ref-CN94">CN94</a>]   John M. Carroll &amp; Sri Nudiati, &quot;On Weak Keys and Weak Data:
            Foiling the Two Nemeses&quot;, Cryptologia, Vol. 18 No. 23 pp.
            253-280, July 1994.

   [<a id="ref-FIPS-180">FIPS-180</a>]
            &quot;Secure Hash Standard&quot;, Computer Systems Laboratory,
            National Institute of Standards and Technology, U.S.
            Department Of Commerce, May 1993.

            Also known as: 58 Fed Reg 27712 (1993).

   [<a id="ref-FIPS-180-1">FIPS-180-1</a>]
            &quot;Secure Hash Standard&quot;, National Institute of Standards and
            Technology, U.S. Department Of Commerce, April 1995.

            Also known as: 59 Fed Reg 35317 (1994).

   [<a id="ref-RFC-1320">RFC-1320</a>]
            Ronald Rivest, &quot;The MD4 Message-Digest Algorithm&quot;, <a href="/doc/html/rfc1320">RFC-1320</a>,
            April 1992.

   [<a id="ref-RFC-1700">RFC-1700</a>]
            Reynolds, J., and J. Postel, &quot;Assigned Numbers&quot;, STD 2, <a href="/doc/html/rfc1700">RFC</a>
            <a href="/doc/html/rfc1700">1700</a>, USC/Information Sciences Institute, October 1994.

   [<a id="ref-RFC-1825">RFC-1825</a>]
            Atkinson, R., &quot;Security Architecture for the Internet
            Protocol&quot;, <a href="/doc/html/rfc1825">RFC-1825</a>, Naval Research Laboratory, July 1995.

   [<a id="ref-RFC-1826">RFC-1826</a>]
            Atkinson, R., &quot;IP Authentication Header&quot;, <a href="/doc/html/rfc1826">RFC-1826</a>, Naval
            Research Laboratory, July 1995.

















<span class="grey">Metzger &amp; Simpson             Experimental                      [Page 5]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-6" ></span>
<span class="grey"><a href="/doc/html/rfc1852">RFC 1852</a>                         AH SHA                   September 1995</span>


Author&#x27;s Address

   Questions about this memo can also be directed to:

      Perry Metzger
      Piermont Information Systems Inc.
      160 Cabrini Blvd., Suite #2
      New York, NY  10033

      perry@piermont.com


      William Allen Simpson
      Daydreamer
      Computer Systems Consulting Services
      1384 Fontaine
      Madison Heights, Michigan  48071

      Bill.Simpson@um.cc.umich.edu
          bsimpson@MorningStar.com































Metzger &amp; Simpson             Experimental                      [Page 6]
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

