<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    rfc6358
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.34.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.34.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/draft-hoffman-tls-master-secret-input/">
  <meta name="description" content="Additional Master Secret Inputs for TLS (RFC )">
  <script src="https://www.ietf.org/lib/dt/7.34.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.34.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bgyellow"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc6358.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc6358.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/pdfrfc/rfc6358.txt.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/rfc6358/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/rfc6358/" title="Datatracker information for this document">Tracker</a>] [<a href="/group/sec/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-hoffman-tls-master-secret-input@ietf.org?subject=draft-hoffman-tls-master-secret-input" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=draft-hoffman-tls-master-secret-input-03.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-hoffman-tls-master-secret-input-03.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-hoffman-tls-master-secret-input-03.txt" title="Run an idnits check of this document">Nits</a>]

From: <a href="/doc/html/draft-hoffman-tls-master-secret-input-03">draft-hoffman-tls-master-secret-input-03</a>              Experimental</pre>
      </div>
    

    <div class="draftcontent">
    <pre>Internet Engineering Task Force (IETF)                        P. Hoffman
Request for Comments: 6358                                VPN Consortium
Category: Experimental                                      January 2012
ISSN: 2070-1721


                <span class="h1">Additional Master Secret Inputs for TLS</span>

Abstract

   This document describes a mechanism for using additional master
   secret inputs with Transport Layer Security (TLS) and Datagram TLS
   (DTLS).

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for examination, experimental implementation, and
   evaluation.

   This document defines an Experimental Protocol for the Internet
   community.  This document is a product of the Internet Engineering
   Task Force (IETF).  It represents the consensus of the IETF
   community.  It has received public review and has been approved for
   publication by the Internet Engineering Steering Group (IESG).  Not
   all documents approved by the IESG are a candidate for any level of
   Internet Standard; see <a href="/doc/html/rfc5741#section-2">Section&nbsp;2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6358">http://www.rfc-editor.org/info/rfc6358</a>.

Copyright Notice

   Copyright (c) 2012 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="/doc/html/bcp78">BCP 78</a> and the IETF Trust&#x27;s Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.





<span class="grey">Hoffman                      Experimental                       [Page 1]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-2" ></span>
<span class="grey"><a href="/doc/html/rfc6358">RFC 6358</a>                  Additional TLS Inputs             January 2012</span>


   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>.  Introduction</span>

   Some TLS 1.2 [<a href="/doc/html/rfc5246" title="&quot;The Transport Layer Security (TLS) Protocol Version 1.2&quot;">RFC5246</a>] and DTLS 1.2 [<a href="/doc/html/rfc6347" title="&quot;Datagram Transport Layer Security version 1.2&quot;">RFC6347</a>] extensions want to mix
   particular data into the calculation of the master secret.  This
   mixing creates a cryptographic binding of the added material directly
   into the secret that is used to protect the TLS session.  For
   example, some systems want to be sure that there is sufficient
   randomness in the TLS master secret, and this can be accomplished by
   adding it directly to the master secret calculations.

   This document describes a framework for TLS and DTLS extensions to
   meet these requirements.  In an extension that uses this framework, a
   client and server provide data in the handshake using normal TLS
   extensions, and then this data is combined with the ClientHello and
   ServerHello random values during the derivation of the master_secret.

   Extensions that specify data to be added to the master secret are
   called &quot;extensions with master secret input&quot;.  An extension with
   master secret input must specify the additional input that comes from
   the client and/or the server.  Note that the term &quot;and/or&quot; is used
   here because the definition of the extension might cause input to the
   master secret to come from only one of the participants.

   Note that extensions that do not specify that they are extensions
   with master secret input cannot be extensions with master secret
   input.  That is, every extension that does not call itself an
   extension with master secret input is treated just like a normal
   extension.  Also note that this document only describes a framework;
   if an extension uses this framework, and a client and server both
   implement the extension, no signaling about the use of master secret
   input is needed: that comes as part of the extension definition
   itself.

   Use of one or more of these extensions changes the way that the
   master secret is calculated in TLS and DTLS.  That is, if the
   handshake has no extensions, or only extensions that are not



<span class="grey">Hoffman                      Experimental                       [Page 2]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-3" ></span>
<span class="grey"><a href="/doc/html/rfc6358">RFC 6358</a>                  Additional TLS Inputs             January 2012</span>


   extensions with master secret input, the master secret calculation is
   unchanged.

<span class="h3"><a class="selflink" id="section-1.1" href="#section-1.1">1.1</a>.  Conventions Used in This Document</span>

   The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;,
   &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;MAY&quot;, and &quot;OPTIONAL&quot; in this
   document are to be interpreted as described in [<a href="/doc/html/rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].

<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  Master Secret Calculation Modifications for TLS and DTLS</span>

   When an extension with master secret input is present in the
   handshake, the additional master secret input values MUST be mixed
   into the pseudorandom function (PRF) calculation along with the
   client and server random values during the computation of the master
   secret.  For the calculation of the master secret, the extensions
   MUST be sorted by extension type order.  Note that TLS 1.2 specifies
   that there can only be one extension per type, and the extensions can
   appear in mixed order.

   Each extension with master secret input adds its own specified input,
   called &quot;additional_ms_input_1&quot; for the extension with master secret
   input that has the lowest type number, &quot;additional_ms_input_2&quot; for
   the extension with master secret input with the second lowest type
   number, and so on.

   The calculation of the master secret becomes:

      master_secret = PRF(pre_master_secret, &quot;master secret&quot;,
                          ClientHello.random +
                          ClientHello.additional_ms_input_1 +
                          ClientHello.additional_ms_input_2 +
                          . . .
                          ClientHello.additional_ms_input_N +
                          ServerHello.random +
                          ServerHello.additional_ms_input_1 +
                          ServerHello.additional_ms_input_2 +
                          . . .
                          ServerHello.additional_ms_input_N +
                          )[0..47];

   Using the specified order of the additional_ms_input_n fields in the
   master_secret is required for interoperability.  Otherwise, a server
   and a client would not know how to unambiguously calculate the same
   master_secret.






<span class="grey">Hoffman                      Experimental                       [Page 3]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-4" ></span>
<span class="grey"><a href="/doc/html/rfc6358">RFC 6358</a>                  Additional TLS Inputs             January 2012</span>


<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>.  Security Considerations</span>

   This modification to TLS and DTLS increases the amount of data that
   an attacker can inject into the master secret calculation.  This
   potentially would allow an attacker who had partially compromised the
   inputs to the master secret calculation greater scope for influencing
   the output.  Hash-based PRFs like the one used in TLS master secret
   calculations are designed to be fairly indifferent to the input size.

   The additional master secret input may have no entropy; in fact, it
   might be completely predictable to an attacker.  TLS is designed to
   function correctly even when the PRF used in the master secret
   calculation has a great deal of predictable material because the PRF
   is used to generate distinct keying material for each connection.
   Thus, even in the face of completely predictable additional master
   secret input values, no harm is done to the resulting PRF output.
   When there is entropy in these values, that entropy is reflected in
   the PRF output.

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>.  Acknowledgments</span>

   Much of the text in this document is derived from text written by
   Eric Rescorla, Margaret Salter, and Jerry Solinas.

<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>.  Normative References</span>

   [<a id="ref-RFC2119">RFC2119</a>]   Bradner, S., &quot;Key words for use in RFCs to Indicate
               Requirement Levels&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc2119">RFC 2119</a>, March 1997.

   [<a id="ref-RFC5246">RFC5246</a>]   Dierks, T. and E. Rescorla, &quot;The Transport Layer Security
               (TLS) Protocol Version 1.2&quot;, <a href="/doc/html/rfc5246">RFC 5246</a>, August 2008.

   [<a id="ref-RFC6347">RFC6347</a>]   Rescorla, E. and N. Modadugu, &quot;Datagram Transport Layer
               Security version 1.2&quot;, <a href="/doc/html/rfc6347">RFC 6347</a>, January 2012.

Author&#x27;s Address

   Paul Hoffman
   VPN Consortium

   EMail: paul.hoffman@vpnc.org










Hoffman                      Experimental                       [Page 4]
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

