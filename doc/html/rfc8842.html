<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    rfc8842
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.34.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.34.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/draft-ietf-mmusic-dtls-sdp/">
  <meta name="description" content="Session Description Protocol (SDP) Offer/Answer Considerations for Datagram Transport Layer Security (DTLS) and Transport Layer Security (TLS) (RFC )">
  <script src="https://www.ietf.org/lib/dt/7.34.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.34.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bgblue"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc8842.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc8842.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/rfc8842.xml" title="XML source for this document">xml</a>|<a href="https://www.rfc-editor.org/rfc/rfc8842.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/rfc8842/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/rfc8842/" title="Datatracker information for this document">Tracker</a>] [<a href="/group/mmusic/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-mmusic-dtls-sdp@ietf.org?subject=draft-ietf-mmusic-dtls-sdp" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=draft-ietf-mmusic-dtls-sdp-32.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-ietf-mmusic-dtls-sdp-32.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-ietf-mmusic-dtls-sdp-32.txt" title="Run an idnits check of this document">Nits</a>]

From: <a href="/doc/html/draft-ietf-mmusic-dtls-sdp-32">draft-ietf-mmusic-dtls-sdp-32</a>                    Proposed Standard</pre>
      </div>
    

    <div class="draftcontent">
    <pre>Internet Engineering Task Force (IETF)                       C. Holmberg
Request for Comments: 8842                                      Ericsson
Updates: <a href="/doc/html/rfc5763">5763</a>, <a href="/doc/html/rfc7345">7345</a>                                           R. Shpount
Category: Standards Track                                    TurboBridge
ISSN: 2070-1721                                             January 2021


   <span class="h1">Session Description Protocol (SDP) Offer/Answer Considerations for</span>
 <span class="h1">Datagram Transport Layer Security (DTLS) and Transport Layer Security</span>
                                 <span class="h1">(TLS)</span>

Abstract

   This document defines the Session Description Protocol (SDP) offer/
   answer procedures for negotiating and establishing a Datagram
   Transport Layer Security (DTLS) association.  The document also
   defines the criteria for when a new DTLS association must be
   established.  The document updates RFCs 5763 and 7345 by replacing
   common SDP offer/answer procedures with a reference to this
   specification.

   This document defines a new SDP media-level attribute, &quot;tls-id&quot;.

   This document also defines how the &quot;tls-id&quot; attribute can be used for
   negotiating and establishing a Transport Layer Security (TLS)
   connection, in conjunction with the procedures in RFCs 4145 and 8122.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="/doc/html/rfc7841#section-2">Section&nbsp;2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="https://www.rfc-editor.org/info/rfc8842">https://www.rfc-editor.org/info/rfc8842</a>.

Copyright Notice

   Copyright (c) 2021 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="/doc/html/bcp78">BCP 78</a> and the IETF Trust&#x27;s Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction
   2.  Conventions
   3.  Establishing a New DTLS Association
     3.1.  General
     3.2.  Change of Local Transport Parameters
     3.3.  Change of ICE ufrag Value
   4.  SDP &quot;tls-id&quot; Attribute
   5.  SDP Offer/Answer Procedures
     5.1.  General
     5.2.  Generating the Initial SDP Offer
     5.3.  Generating the Answer
     5.4.  Offerer Processing of the SDP Answer
     5.5.  Modifying the Session
   6.  ICE Considerations
   7.  TLS Considerations
   8.  SIP Considerations
   9.  RFC Updates
     9.1.  General
     9.2.  Update to <a href="/doc/html/rfc5763">RFC 5763</a>
       9.2.1.  Update to <a href="#section-1">Section 1</a>
       9.2.2.  Update to <a href="#section-5">Section 5</a>
       9.2.3.  Update to <a href="#section-6.6">Section 6.6</a>
       9.2.4.  Update to <a href="#section-6.7.1">Section 6.7.1</a>
     9.3.  Update to <a href="/doc/html/rfc7345">RFC 7345</a>
       9.3.1.  Update to <a href="#section-4">Section 4</a>
       9.3.2.  Update to <a href="#section-5.2.1">Section 5.2.1</a>
       9.3.3.  Update to <a href="#section-9.1">Section 9.1</a>
   10. Security Considerations
   11. IANA Considerations
   12. References
     12.1.  Normative References
     12.2.  Informative References
   Acknowledgements
   Authors&#x27; Addresses

<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>.  Introduction</span>

   [<a id="ref-RFC5763">RFC5763</a>] defines Session Description Protocol (SDP) offer/answer
   procedures for Secure Real-time Transport Protocol using Datagram
   Transport Layer Security (DTLS-SRTP).  [<a href="/doc/html/rfc7345" title="&quot;UDP Transport Layer (UDPTL) over Datagram Transport Layer Security (DTLS)&quot;">RFC7345</a>] defines SDP offer/
   answer procedures for UDP Transport Layer over Datagram Transport
   Layer Security (UDPTL-DTLS).  This specification defines general
   offer/answer procedures for DTLS, based on the procedures in
   [<a href="/doc/html/rfc5763" title="&quot;Framework for Establishing a Secure Real-time Transport Protocol (SRTP) Security Context Using Datagram Transport Layer Security (DTLS)&quot;">RFC5763</a>].  Other specifications, defining specific DTLS usages, can
   then reference this specification, in order to ensure that the DTLS
   aspects are common among all usages.  Having common procedures is
   essential when multiple usages share the same DTLS association
   [<a href="/doc/html/rfc8843" title="&quot;Negotiating Media Multiplexing Using the Session Description Protocol (SDP)&quot;">RFC8843</a>].  This document updates [<a href="/doc/html/rfc5763" title="&quot;Framework for Establishing a Secure Real-time Transport Protocol (SRTP) Security Context Using Datagram Transport Layer Security (DTLS)&quot;">RFC5763</a>] and [<a href="/doc/html/rfc7345" title="&quot;UDP Transport Layer (UDPTL) over Datagram Transport Layer Security (DTLS)&quot;">RFC7345</a>] by
   replacing common SDP offer/answer procedures with a reference to this
   specification.

      |  NOTE: Since the publication of [<a href="/doc/html/rfc5763" title="&quot;Framework for Establishing a Secure Real-time Transport Protocol (SRTP) Security Context Using Datagram Transport Layer Security (DTLS)&quot;">RFC5763</a>], [<a href="/doc/html/rfc4474" title="&quot;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP)&quot;">RFC4474</a>] has been
      |  obsoleted by [<a href="/doc/html/rfc8224" title="&quot;Authenticated Identity Management in the Session Initiation Protocol (SIP)&quot;">RFC8224</a>].  The updating of the references (and
      |  the associated procedures) within [<a href="/doc/html/rfc5763" title="&quot;Framework for Establishing a Secure Real-time Transport Protocol (SRTP) Security Context Using Datagram Transport Layer Security (DTLS)&quot;">RFC5763</a>] is outside the
      |  scope of this document.  However, implementers of [<a href="/doc/html/rfc5763" title="&quot;Framework for Establishing a Secure Real-time Transport Protocol (SRTP) Security Context Using Datagram Transport Layer Security (DTLS)&quot;">RFC5763</a>]
      |  applications are encouraged to implement [<a href="/doc/html/rfc8224" title="&quot;Authenticated Identity Management in the Session Initiation Protocol (SIP)&quot;">RFC8224</a>] instead of
      |  [<a href="/doc/html/rfc4474" title="&quot;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP)&quot;">RFC4474</a>].

   As defined in [<a href="/doc/html/rfc5763" title="&quot;Framework for Establishing a Secure Real-time Transport Protocol (SRTP) Security Context Using Datagram Transport Layer Security (DTLS)&quot;">RFC5763</a>], a new DTLS association MUST be established
   when transport parameters are changed.  Transport parameter change is
   not well defined when Interactive Connectivity Establishment (ICE)
   [<a href="/doc/html/rfc8445" title="&quot;Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal&quot;">RFC8445</a>] is used.  One possible way to determine a transport change
   is based on ufrag [<a href="/doc/html/rfc8445" title="&quot;Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal&quot;">RFC8445</a>] change, but the ufrag value is changed
   both when ICE is negotiated and when ICE restart [<a href="/doc/html/rfc8445" title="&quot;Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal&quot;">RFC8445</a>] occurs.
   These events do not always require a new DTLS association to be
   established, but previously there was no way to explicitly indicate
   in an SDP offer or answer whether a new DTLS association was
   required.  To solve that problem, this document defines a new SDP
   attribute, &quot;tls-id&quot;.  The pair of SDP &quot;tls-id&quot; attribute values (the
   attribute values of the offerer and the answerer) uniquely identifies
   the DTLS association.  Providing a new value of the &quot;tls-id&quot;
   attribute in an SDP offer or answer can be used to indicate whether a
   new DTLS association is to be established.

   The SDP &quot;tls-id&quot; attribute can be specified when negotiating a
   Transport Layer Security (TLS) connection, using the procedures in
   this document in conjunction with the procedures in [<a href="/doc/html/rfc5763" title="&quot;Framework for Establishing a Secure Real-time Transport Protocol (SRTP) Security Context Using Datagram Transport Layer Security (DTLS)&quot;">RFC5763</a>] and
   [<a href="/doc/html/rfc8122" title="&quot;Connection-Oriented Media Transport over the Transport Layer Security (TLS) Protocol in the Session Description Protocol (SDP)&quot;">RFC8122</a>].  The unique combination of SDP &quot;tls-id&quot; attribute values
   can be used to identify the negotiated TLS connection.  The unique
   value can be used, for example, within TLS protocol extensions to
   differentiate between multiple TLS connections and correlate those
   connections with specific offer/answer exchanges.  The TLS-specific
   considerations are described in <a href="#section-7">Section 7</a>.

<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  Conventions</span>

   The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;,
   &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;NOT RECOMMENDED&quot;, &quot;MAY&quot;, and
   &quot;OPTIONAL&quot; in this document are to be interpreted as described in
   <a href="/doc/html/bcp14">BCP 14</a> [<a href="/doc/html/rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>] [<a href="/doc/html/rfc8174" title="&quot;Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words&quot;">RFC8174</a>] when, and only when, they appear in all
   capitals, as shown here.

<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>.  Establishing a New DTLS Association</span>

<span class="h3"><a class="selflink" id="section-3.1" href="#section-3.1">3.1</a>.  General</span>

   A new DTLS association must be established between two endpoints
   after a successful SDP offer/answer exchange in the following cases:

   *  The negotiated DTLS setup roles change; or

   *  One or more fingerprint values are modified, added, or removed in
      either an SDP offer or answer; or

   *  The intent to establish a new DTLS association is explicitly
      signaled using SDP, by changing the value of the SDP &quot;tls-id&quot;
      attribute defined in this document;

      |  NOTE: The first two items above are based on the procedures in
      |  [<a href="/doc/html/rfc5763" title="&quot;Framework for Establishing a Secure Real-time Transport Protocol (SRTP) Security Context Using Datagram Transport Layer Security (DTLS)&quot;">RFC5763</a>].  This specification adds the support for explicit
      |  signaling using the SDP &quot;tls-id&quot; attribute.

   A new DTLS association can only be established as a result of the
   successful SDP offer/answer exchange.  Whenever an entity determines
   that a new DTLS association is required, the entity MUST initiate an
   SDP offer/answer exchange, following the procedures in <a href="#section-5">Section 5</a>.

   The sections below describe typical cases where a new DTLS
   association needs to be established.

   In this document, a &quot;new DTLS association&quot; between two endpoints
   refers to either an initial DTLS association (when no DTLS
   association is currently established between the endpoints) or a DTLS
   association replacing a previously established one.

<span class="h3"><a class="selflink" id="section-3.2" href="#section-3.2">3.2</a>.  Change of Local Transport Parameters</span>

   If an endpoint modifies its local transport parameters (address and/
   or port), and if the modification requires a new DTLS association,
   the endpoint MUST change its local SDP &quot;tls-id&quot; attribute value (see
   <a href="#section-4">Section 4</a>).

   If the underlying transport protocol prohibits a DTLS association
   from spanning multiple 5-tuples (transport/source address/source
   port/destination address/destination port), and if the 5-tuple is
   changed, the endpoint MUST change its local SDP &quot;tls-id&quot; attribute
   value (see <a href="#section-4">Section 4</a>).  An example of such a case is when DTLS is
   carried over the Stream Control Transmission Protocol (SCTP), as
   described in [<a href="/doc/html/rfc6083" title="&quot;Datagram Transport Layer Security (DTLS) for Stream Control Transmission Protocol (SCTP)&quot;">RFC6083</a>].

<span class="h3"><a class="selflink" id="section-3.3" href="#section-3.3">3.3</a>.  Change of ICE ufrag Value</span>

   If an endpoint uses ICE and modifies a local ufrag value, and if the
   modification requires a new DTLS association, the endpoint MUST
   change its local SDP &quot;tls-id&quot; attribute value (see <a href="#section-4">Section 4</a>).

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>.  SDP &quot;tls-id&quot; Attribute</span>

   The pair of SDP &quot;tls-id&quot; attribute values (the attribute values of
   the offerer and the answerer) uniquely identifies the DTLS
   association or TLS connection.

   Name:  tls-id

   Value:  tls-id-value

   Usage Level:  media

   Charset Dependent:  no

   Default Value:  N/A

   Syntax:
      tls-id-value = 20*255(tls-id-char)
      tls-id-char = ALPHA / DIGIT / &quot;+&quot; / &quot;/&quot; / &quot;-&quot; / &quot;_&quot;

      &lt;ALPHA and DIGIT defined in <a href="/doc/html/rfc4566">RFC 4566</a>&gt;

   Example:
      a=tls-id:abc3de65cddef001be82

   Every time an endpoint requests to establish a new DTLS association,
   the endpoint MUST generate a new local &quot;tls-id&quot; attribute value.  An
   unchanged local &quot;tls-id&quot; attribute value, in combination with non-
   changed fingerprints, indicates that the endpoint intends to reuse
   the existing DTLS association.

   The &quot;tls-id&quot; attribute value MUST be generated using a strong random
   function and include at least 120 bits of randomness.

   No default value is defined for the SDP &quot;tls-id&quot; attribute.
   Implementations that wish to use the attribute MUST explicitly
   include it in SDP offers and answers.  If an offer or answer does not
   contain a &quot;tls-id&quot; attribute (this could happen if the offerer or
   answerer represents an existing implementation that has not been
   updated to support the &quot;tls-id&quot; attribute), a modification of one or
   more of the following characteristics MUST be treated as an
   indication that an endpoint wants to establish a new DTLS
   association, unless there is another mechanism to explicitly indicate
   that a new DTLS association is to be established:

   *  DTLS setup role; or

   *  fingerprint set; or

   *  local transport parameters

      |  NOTE: A modification of the ufrag value is not treated as an
      |  indication that an endpoint wants to establish a new DTLS
      |  association.  In order to indicate that a new DTLS association
      |  is to be established, one or more of the characteristics listed
      |  above have to be modified.

   The mux category [<a href="/doc/html/rfc8859" title="&quot;A Framework for Session Description Protocol (SDP) Attributes When Multiplexing&quot;">RFC8859</a>] for the &quot;tls-id&quot; attribute is &quot;IDENTICAL&quot;,
   which means that the attribute value applies to all media
   descriptions being multiplexed [<a href="/doc/html/rfc8843" title="&quot;Negotiating Media Multiplexing Using the Session Description Protocol (SDP)&quot;">RFC8843</a>].  However, as described in
   [<a href="/doc/html/rfc8843" title="&quot;Negotiating Media Multiplexing Using the Session Description Protocol (SDP)&quot;">RFC8843</a>], in order to avoid duplication, the attribute is only
   associated with the &quot;m=&quot; line representing the offerer/answerer
   BUNDLE tag.

   For RTP-based media, the &quot;tls-id&quot; attribute applies to the whole
   associated media description.  The attribute MUST NOT be defined per
   source (using the SDP &quot;ssrc&quot; attribute [<a href="/doc/html/rfc5576" title="&quot;Source-Specific Media Attributes in the Session Description Protocol (SDP)&quot;">RFC5576</a>]).

   The SDP offer/answer procedures [<a href="/doc/html/rfc3264" title="&quot;An Offer/Answer Model with Session Description Protocol (SDP)&quot;">RFC3264</a>] associated with the
   attribute are defined in <a href="#section-5">Section 5</a>.

<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>.  SDP Offer/Answer Procedures</span>

<span class="h3"><a class="selflink" id="section-5.1" href="#section-5.1">5.1</a>.  General</span>

   This section defines the generic SDP offer/answer procedures for
   negotiating a DTLS association.  Additional procedures (e.g.,
   regarding usage of specific SDP attributes) for individual DTLS
   usages (e.g., DTLS-SRTP) are outside the scope of this specification
   and need to be specified in a usage-specific document.

      |  NOTE: The procedures in this section are generalizations of
      |  procedures first specified in the DTLS-SRTP document [<a href="/doc/html/rfc5763" title="&quot;Framework for Establishing a Secure Real-time Transport Protocol (SRTP) Security Context Using Datagram Transport Layer Security (DTLS)&quot;">RFC5763</a>],
      |  with the addition of usage of the SDP &quot;tls-id&quot; attribute.  That
      |  document is herein updated to make use of these new procedures.

   The procedures in this section apply to an SDP media description
   (&quot;m=&quot; line) associated with DTLS-protected media/data.

   When an offerer or answerer indicates that it wants to establish a
   new DTLS association, it needs to make sure that media packets
   associated with any previously established DTLS association and the
   new DTLS association can be demultiplexed.  In the case of an ordered
   transport (e.g., SCTP), this can be done simply by sending packets
   for the new DTLS association after all packets associated with a
   previously established DTLS association have been sent.  In the case
   of an unordered transport, such as UDP, packets associated with a
   previously established DTLS association can arrive after the answer
   SDP and the first packets associated with the new DTLS association
   have been received.  The only way to demultiplex packets associated
   with a previously established DTLS association and the new DTLS
   association is on the basis of the 5-tuple.  Because of this, if an
   unordered transport is used for the DTLS association, a new 3-tuple
   (transport/source address/source port) MUST be allocated by at least
   one of the endpoints so that DTLS packets can be demultiplexed.

   When an offerer needs to establish a new DTLS association, and if an
   unordered transport (e.g., UDP) is used, the offerer MUST allocate a
   new 3-tuple for the offer in such a way that the offerer can
   disambiguate any packets associated with the new DTLS association
   from any packets associated with any other DTLS association.  This
   typically means using a local address and/or port, or a set of ICE
   candidates (see <a href="#section-6">Section 6</a>), which were not recently used for any
   other DTLS association.

   When an answerer needs to establish a new DTLS association, if an
   unordered transport is used, and the offerer did not allocate a new
   3-tuple, the answerer MUST allocate a new 3-tuple for the answer in
   such a way that it can disambiguate any packets associated with the
   new DTLS association from any packets associated with any other DTLS
   association.  This typically means using a local address and/or port,
   or a set of ICE candidates (see <a href="#section-6">Section 6</a>), which were not recently
   used for any other DTLS association.

   In order to negotiate a DTLS association, the following SDP
   attributes are used:

   *  The SDP &quot;setup&quot; attribute, defined in [<a href="/doc/html/rfc4145" title="&quot;TCP-Based Media Transport in the Session Description Protocol (SDP)&quot;">RFC4145</a>], is used to
      negotiate the DTLS roles;

   *  The SDP &quot;fingerprint&quot; attribute, defined in [<a href="/doc/html/rfc8122" title="&quot;Connection-Oriented Media Transport over the Transport Layer Security (TLS) Protocol in the Session Description Protocol (SDP)&quot;">RFC8122</a>], is used to
      provide one or more fingerprint values; and

   *  The SDP &quot;tls-id&quot; attribute, defined in this specification, is used
      to identity the DTLS association.

   This specification does not define the usage of the SDP &quot;connection&quot;
   attribute [<a href="/doc/html/rfc4145" title="&quot;TCP-Based Media Transport in the Session Description Protocol (SDP)&quot;">RFC4145</a>] for negotiating a DTLS association.  However, the
   attribute MAY be used if the DTLS association is used together with
   another protocol (e.g., SCTP or TCP) for which the usage of the
   attribute has been defined.

   Unlike for TCP and TLS connections, endpoints MUST NOT use the SDP
   &quot;setup&quot; attribute &quot;holdconn&quot; value when negotiating a DTLS
   association.

   Endpoints MUST support the hash functions as defined in [<a href="/doc/html/rfc8122" title="&quot;Connection-Oriented Media Transport over the Transport Layer Security (TLS) Protocol in the Session Description Protocol (SDP)&quot;">RFC8122</a>].

   The certificate received during the DTLS handshake [<a href="/doc/html/rfc6347" title="&quot;Datagram Transport Layer Security Version 1.2&quot;">RFC6347</a>] MUST
   match a certificate fingerprint received in SDP &quot;fingerprint&quot;
   attributes according to the procedures defined in [<a href="/doc/html/rfc8122" title="&quot;Connection-Oriented Media Transport over the Transport Layer Security (TLS) Protocol in the Session Description Protocol (SDP)&quot;">RFC8122</a>].  If
   fingerprints do not match the hashed certificate, then an endpoint
   MUST tear down the media session immediately (see [<a href="/doc/html/rfc8122" title="&quot;Connection-Oriented Media Transport over the Transport Layer Security (TLS) Protocol in the Session Description Protocol (SDP)&quot;">RFC8122</a>]).

   SDP offerers and answerers might reuse certificates across multiple
   DTLS associations, and provide identical fingerprint values for each
   DTLS association.  The combination of the SDP &quot;tls-id&quot; attribute
   values of the SDP offerer and answerer identifies each individual
   DTLS association.

      |  NOTE: There are cases where the SDP &quot;tls-id&quot; attribute value
      |  generated by the offerer will end up being used for multiple
      |  DTLS associations.  For that reason, the combination of the
      |  attribute values of the offerer and answerer is needed in order
      |  to identity a DTLS association.  An example of such a case is
      |  where the offerer sends an updated offer (<a href="#section-5.5">Section 5.5</a>) without
      |  modifying its attribute value, but the answerer determines that
      |  a new DTLS association is to be created.  The answerer will
      |  generate a new local attribute value for the new DTLS
      |  association (<a href="#section-5.3">Section 5.3</a>), while the offerer will use the same
      |  attribute value that it used for the current association.
      |  Another example is when the Session Initiation Protocol (SIP)
      |  [<a href="/doc/html/rfc3261" title="&quot;SIP: Session Initiation Protocol&quot;">RFC3261</a>] is used for signaling, and an offer is forked to
      |  multiple answerers.  The attribute value generated by the
      |  offerer will be used for DTLS associations established by each
      |  answerer.

<span class="h3"><a class="selflink" id="section-5.2" href="#section-5.2">5.2</a>.  Generating the Initial SDP Offer</span>

   When an offerer sends the initial offer, the offerer MUST insert an
   SDP &quot;setup&quot; attribute [<a href="/doc/html/rfc4145" title="&quot;TCP-Based Media Transport in the Session Description Protocol (SDP)&quot;">RFC4145</a>] with an &quot;actpass&quot; attribute value, as
   well as one or more SDP &quot;fingerprint&quot; attributes according to the
   procedures in [<a href="/doc/html/rfc8122" title="&quot;Connection-Oriented Media Transport over the Transport Layer Security (TLS) Protocol in the Session Description Protocol (SDP)&quot;">RFC8122</a>].  In addition, the offerer MUST insert in the
   offer an SDP &quot;tls-id&quot; attribute with a unique attribute value.

   As the offerer inserts the SDP &quot;setup&quot; attribute with an &quot;actpass&quot;
   attribute value, the offerer MUST be prepared to receive a DTLS
   ClientHello message [<a href="/doc/html/rfc6347" title="&quot;Datagram Transport Layer Security Version 1.2&quot;">RFC6347</a>] from the answerer (if a new DTLS
   association is established by the answerer) before the offerer
   receives the SDP answer.

   If the offerer receives a DTLS ClientHello message, and a DTLS
   association is established before the offerer receives the SDP answer
   carrying the fingerprint associated with the DTLS association, any
   data received on the DTLS association before the fingerprint MUST be
   considered to be coming from an unverified source.  The processing of
   such data and sending of data by the offerer to the unverified source
   is outside the scope of this document.

<span class="h3"><a class="selflink" id="section-5.3" href="#section-5.3">5.3</a>.  Generating the Answer</span>

   When an answerer sends an answer, the answerer MUST insert in the
   answer an SDP &quot;setup&quot; attribute according to the procedures in
   [<a href="/doc/html/rfc4145" title="&quot;TCP-Based Media Transport in the Session Description Protocol (SDP)&quot;">RFC4145</a>] and one or more SDP &quot;fingerprint&quot; attributes according to
   the procedures in [<a href="/doc/html/rfc8122" title="&quot;Connection-Oriented Media Transport over the Transport Layer Security (TLS) Protocol in the Session Description Protocol (SDP)&quot;">RFC8122</a>].  If the answerer determines, based on
   the criteria specified in <a href="#section-3.1">Section 3.1</a>, that a new DTLS association is
   to be established, the answerer MUST insert in the associated answer
   an SDP &quot;tls-id&quot; attribute with a new unique attribute value.  Note
   that the offerer and answerer generate their own local &quot;tls-id&quot;
   attribute values, and the combination of both values identifies the
   DTLS association.

   If the answerer receives an offer that requires establishment of a
   new DTLS association, and if the answerer does not accept the
   establishment of a new DTLS association, the answerer MUST reject the
   &quot;m=&quot; lines associated with the suggested DTLS association [<a href="/doc/html/rfc3264" title="&quot;An Offer/Answer Model with Session Description Protocol (SDP)&quot;">RFC3264</a>].

   If an answerer receives an offer that does not require the
   establishment of a new DTLS association, and if the answerer
   determines that a new DTLS association is not to be established, the
   answerer MUST insert in the associated answer an SDP &quot;tls-id&quot;
   attribute with the previously assigned attribute value.  In addition,
   the answerer MUST insert an SDP &quot;setup&quot; attribute with an attribute
   value that does not change the previously negotiated DTLS roles, as
   well as one or more SDP &quot;fingerprint&quot; attributes values that do not
   change the previously sent fingerprint set, in the associated answer.

   If the answerer receives an offer that does not contain an SDP &quot;tls-
   id&quot; attribute, the answerer MUST NOT insert a &quot;tls-id&quot; attribute in
   the answer.

   If a new DTLS association is to be established, and if the answerer
   inserts an SDP &quot;setup&quot; attribute with an &quot;active&quot; attribute value in
   the answer, the answerer MUST initiate a DTLS handshake [<a href="/doc/html/rfc6347" title="&quot;Datagram Transport Layer Security Version 1.2&quot;">RFC6347</a>] by
   sending a DTLS ClientHello message towards the offerer.

   Even though an offerer is required to insert an &quot;SDP&quot; setup attribute
   with an &quot;actpass&quot; attribute value in initial offers (<a href="#section-5.2">Section 5.2</a>) and
   subsequent offers (<a href="#section-5.5">Section 5.5</a>), the answerer MUST be able to receive
   initial and subsequent offers with other attribute values, in order
   to be backward compatible with older implementations that might
   insert other attribute values in initial and subsequent offers.

<span class="h3"><a class="selflink" id="section-5.4" href="#section-5.4">5.4</a>.  Offerer Processing of the SDP Answer</span>

   When an offerer receives an answer that establishes a new DTLS
   association based on criteria defined in <a href="#section-3.1">Section 3.1</a>, if the offerer
   becomes DTLS client (based on the value of the SDP &quot;setup&quot; attribute
   value [<a href="/doc/html/rfc4145" title="&quot;TCP-Based Media Transport in the Session Description Protocol (SDP)&quot;">RFC4145</a>]), the offerer MUST establish a DTLS association.  If
   the offerer becomes DTLS server, it MUST wait for the answerer to
   establish the DTLS association.

   If the offerer indicated a desire to reuse an existing DTLS
   association, and the answerer does not request the establishment of a
   new DTLS association, the offerer will continue to use the previously
   established DTLS association.

   A new DTLS association can be established based on changes in either
   an SDP offer or answer.  When communicating with legacy endpoints, an
   offerer can receive an answer that includes the same fingerprint set
   and setup role.  A new DTLS association will still be established if
   such an answer is received as a response to an offer that requested
   the establishment of a new DTLS association, as the transport
   parameters would have been changed in the offer.

<span class="h3"><a class="selflink" id="section-5.5" href="#section-5.5">5.5</a>.  Modifying the Session</span>

   When an offerer sends a subsequent offer, if the offerer wants to
   establish a new DTLS association, the offerer MUST insert an SDP
   &quot;setup&quot; attribute [<a href="/doc/html/rfc4145" title="&quot;TCP-Based Media Transport in the Session Description Protocol (SDP)&quot;">RFC4145</a>] with an &quot;actpass&quot; attribute value, as
   well as or more SDP &quot;fingerprint&quot; attributes according to the
   procedures in [<a href="/doc/html/rfc8122" title="&quot;Connection-Oriented Media Transport over the Transport Layer Security (TLS) Protocol in the Session Description Protocol (SDP)&quot;">RFC8122</a>].  In addition, the offerer MUST insert in the
   offer an SDP &quot;tls-id&quot; attribute with a new unique attribute value.

   When an offerer sends a subsequent offer and does not want to
   establish a new DTLS association, if a previously established DTLS
   association exists, the offerer MUST insert in the offer an SDP
   &quot;setup&quot; attribute with an &quot;actpass&quot; attribute value, and one or more
   SDP &quot;fingerprint&quot; attributes with attribute values that do not change
   the previously sent fingerprint set.  In addition, the offerer MUST
   insert an SDP &quot;tls-id&quot; attribute with the previously assigned
   attribute value in the offer.

      |  NOTE: When a new DTLS association is being established, each
      |  endpoint needs to be prepared to receive data on both the new
      |  and old DTLS associations as long as both are alive.

<span class="h2"><a class="selflink" id="section-6" href="#section-6">6</a>.  ICE Considerations</span>

   When the Interactive Connectivity Establishment (ICE) mechanism
   [<a href="/doc/html/rfc8445" title="&quot;Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal&quot;">RFC8445</a>] is used, the ICE connectivity checks are performed before
   the DTLS handshake begins.  Note that if aggressive nomination mode
   is used, multiple candidate pairs may be marked valid before ICE
   finally converges on a single candidate pair.

      |  NOTE: Aggressive nomination has been deprecated from ICE but
      |  must still be supported for backwards compatibility reasons
      |  [<a href="/doc/html/rfc8445" title="&quot;Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal&quot;">RFC8445</a>].

   When a new DTLS association is established over an unordered
   transport, in order to disambiguate any packets associated with the
   newly established DTLS association, at least one of the endpoints
   MUST allocate a completely new set of ICE candidates that were not
   recently used for any other DTLS association.  This means the
   answerer cannot initiate a new DTLS association unless the offerer
   initiated ICE restart [<a href="/doc/html/rfc8445" title="&quot;Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal&quot;">RFC8445</a>].  If the answerer wants to initiate a
   new DTLS association, it needs to initiate an ICE restart and a new
   offer/answer exchange on its own.  However, an ICE restart does not
   by default require a new DTLS association to be established.

      |  NOTE: Simple Traversal of the UDP Protocol through NAT (STUN)
      |  packets are sent directly over UDP, not over DTLS.  [<a href="/doc/html/rfc7983" title="&quot;Multiplexing Scheme Updates for Secure Real-time Transport Protocol (SRTP) Extension for Datagram Transport Layer Security (DTLS)&quot;">RFC7983</a>]
      |  describes how to demultiplex STUN packets from DTLS packets and
      |  SRTP packets.

   Each ICE candidate associated with a component is treated as being
   part of the same DTLS association.  Therefore, from a DTLS
   perspective, it is not considered a change of local transport
   parameters when an endpoint switches between those ICE candidates.

<span class="h2"><a class="selflink" id="section-7" href="#section-7">7</a>.  TLS Considerations</span>

   The procedures in this document can also be used for negotiating and
   establishing a TLS connection, with the restriction described below.

   As specified in [<a href="/doc/html/rfc4145" title="&quot;TCP-Based Media Transport in the Session Description Protocol (SDP)&quot;">RFC4145</a>], the SDP &quot;connection&quot; attribute is used to
   indicate whether to establish a new TLS connection.  An offerer and
   answerer MUST ensure that the &quot;connection&quot; attribute value and the
   &quot;tls-id&quot; attribute value do not cause a conflict regarding whether a
   new TLS connection is to be established or not.

      |  NOTE: Even though the SDP &quot;connection&quot; attribute can be used to
      |  indicate whether a new TLS connection is to be established, the
      |  unique combination of SDP &quot;tls-id&quot; attribute values can be used
      |  to identity a TLS connection.  The unique value can be used
      |  e.g., within TLS protocol extensions to differentiate between
      |  multiple TLS connections and correlate those connections with
      |  specific offer/answer exchanges.  One such extension is defined
      |  in [<a href="/doc/html/rfc8844" title="&quot;Unknown Key-Share Attacks on Uses of TLS with the Session Description Protocol (SDP)&quot;">RFC8844</a>].

   If an offerer or answerer inserts an SDP &quot;connection&quot; attribute with
   a &quot;new&quot; value in the offer/answer and also inserts an SDP &quot;tls-id&quot;
   attribute, the value of the &quot;tls-id&quot; attribute MUST be new and
   unique.

   If an offerer or answerer inserts an SDP &quot;connection&quot; attribute with
   an &quot;existing&quot; value in the offer/answer, if a previously established
   TLS connection exists, and if the offerer/answerer previously
   inserted an SDP &quot;tls-id&quot; attribute associated with the same TLS
   connection in an offer/answer, the offerer/answerer MUST also insert
   an SDP &quot;tls-id&quot; attribute with the previously assigned value in the
   offer/answer.

   If an offerer or answerer receives an offer/answer with conflicting
   attribute values, the offerer/answerer MUST process the offer/answer
   as misformed.

   An endpoint MUST NOT make assumptions regarding the support of the
   SDP &quot;tls-id&quot; attribute by the peer.  Therefore, to avoid ambiguity,
   both offerers and answerers MUST always use the &quot;connection&quot;
   attribute in conjunction with the &quot;tls-id&quot; attribute.

      |  NOTE: As defined in [<a href="/doc/html/rfc4145" title="&quot;TCP-Based Media Transport in the Session Description Protocol (SDP)&quot;">RFC4145</a>], if the SDP &quot;connection&quot;
      |  attribute is not explicitly present, the implicit default value
      |  is &quot;new&quot;.

   The SDP example below is based on the example in <a href="/doc/html/rfc8122#section-3.4">Section&nbsp;3.4 of
   [RFC8122]</a>, with the addition of the SDP &quot;tls-id&quot; attribute.

   m=image 54111 TCP/TLS t38
   c=IN IP4 192.0.2.2
   a=tls-id:abc3de65cddef001be82
   a=setup:passive
   a=connection:new
   a=fingerprint:SHA-256 \
    12:DF:3E:5D:49:6B:19:E5:7C:AB:4A:AD:B9:B1:3F:82:18:3B:54:02:12:DF: \
    3E:5D:49:6B:19:E5:7C:AB:4A:AD
   a=fingerprint:SHA-1 \
    4A:AD:B9:B1:3F:82:18:3B:54:02:12:DF:3E:5D:49:6B:19:E5:7C:AB

<span class="h2"><a class="selflink" id="section-8" href="#section-8">8</a>.  SIP Considerations</span>

   When the Session Initiation Protocol (SIP) [<a href="/doc/html/rfc3261" title="&quot;SIP: Session Initiation Protocol&quot;">RFC3261</a>] is used as the
   signal protocol for establishing a multimedia session, dialogs
   [<a href="/doc/html/rfc3261" title="&quot;SIP: Session Initiation Protocol&quot;">RFC3261</a>] might be established between the caller and multiple
   callees.  This is referred to as forking.  If forking occurs,
   separate DTLS associations will be established between the caller and
   each callee.

   When forking occurs, an SDP offerer can receive DTLS ClientHello
   messages and SDP answers from multiple remote locations.  Because of
   this, the offerer might have to wait for multiple SDP answers (from
   different remote locations) until it receives a certificate
   fingerprint that matches the certificate associated with a specific
   DTLS handshake.  The offerer MUST NOT declare a fingerprint mismatch
   until it determines that it will not receive SDP answers from any
   additional remote locations.

   It is possible to send an INVITE request that does not contain an SDP
   offer.  Such an INVITE request is often referred to as an &quot;empty
   INVITE&quot; or an &quot;offerless INVITE&quot;.  The receiving endpoint will
   include the SDP offer in a response to the request.  When the
   endpoint generates such an SDP offer, if a previously established
   DTLS association exists, the offerer MUST insert an SDP &quot;tls-id&quot;
   attribute and one or more SDP &quot;fingerprint&quot; attributes, with
   previously assigned attribute values.  If a previously established
   DTLS association does not exist, the offer MUST be generated based on
   the same rules as a new offer (see <a href="#section-5.2">Section 5.2</a>).  Regardless of the
   previous existence of a DTLS association, the SDP &quot;setup&quot; attribute
   MUST be included according to the rules defined in [<a href="/doc/html/rfc4145" title="&quot;TCP-Based Media Transport in the Session Description Protocol (SDP)&quot;">RFC4145</a>].
   Furthermore, if ICE is used, ICE restart MUST be initiated, according
   to the third-party call-control considerations described in
   [<a href="/doc/html/rfc8839" title="&quot;Session Description Protocol (SDP) Offer/Answer Procedures for Interactive Connectivity Establishment (ICE)&quot;">RFC8839</a>].

<span class="h2"><a class="selflink" id="section-9" href="#section-9">9</a>.  RFC Updates</span>

<span class="h3"><a class="selflink" id="section-9.1" href="#section-9.1">9.1</a>.  General</span>

   This section updates specifications that use DTLS-protected media, in
   order to reflect the procedures defined in this specification.

<span class="h3"><a class="selflink" id="section-9.2" href="#section-9.2">9.2</a>.  Update to <a href="/doc/html/rfc5763">RFC 5763</a></span>

<span class="h4"><a class="selflink" id="section-9.2.1" href="#section-9.2.1">9.2.1</a>.  Update to <a href="#section-1">Section 1</a></span>

   The reference to [<a href="/doc/html/rfc4572" title="&quot;Connection-Oriented Media Transport over the Transport Layer Security (TLS) Protocol in the Session Description Protocol (SDP)&quot;">RFC4572</a>] is replaced with a reference to [<a href="/doc/html/rfc8122" title="&quot;Connection-Oriented Media Transport over the Transport Layer Security (TLS) Protocol in the Session Description Protocol (SDP)&quot;">RFC8122</a>].

<span class="h4"><a class="selflink" id="section-9.2.2" href="#section-9.2.2">9.2.2</a>.  Update to <a href="#section-5">Section 5</a></span>

   The text in <a href="/doc/html/rfc5763#section-5">[RFC5763], Section&nbsp;5</a> (&quot;Establishing a Secure Channel&quot;) is
   modified by replacing generic SDP offer/answer procedures for DTLS
   with a reference to this specification:

   NEW TEXT:

   |  The two endpoints in the exchange present their identities as part
   |  of the DTLS handshake procedure using certificates.  This document
   |  uses certificates in the same style as described in &quot;Connection-
   |  Oriented Media Transport over the Transport Layer Security (TLS)
   |  Protocol in the Session Description Protocol (SDP)&quot; [<a href="/doc/html/rfc8122" title="&quot;Connection-Oriented Media Transport over the Transport Layer Security (TLS) Protocol in the Session Description Protocol (SDP)&quot;">RFC8122</a>].
   |
   |  If self-signed certificates are used, the content of the
   |  &quot;subjectAltName&quot; attribute inside the certificate MAY use the
   |  uniform resource identifier (URI) of the user.  This is useful for
   |  debugging purposes only and is not required to bind the
   |  certificate to one of the communication endpoints.  The integrity
   |  of the certificate is ensured through the &quot;fingerprint&quot; attribute
   |  in the SDP.
   |
   |  The generation of public/private key pairs is relatively
   |  expensive.  Endpoints are not required to generate certificates
   |  for each session.
   |
   |  The offer/answer model, defined in [<a href="/doc/html/rfc3264" title="&quot;An Offer/Answer Model with Session Description Protocol (SDP)&quot;">RFC3264</a>], is used by protocols
   |  like the Session Initiation Protocol (SIP) [<a href="/doc/html/rfc3261" title="&quot;SIP: Session Initiation Protocol&quot;">RFC3261</a>] to set up
   |  multimedia sessions.
   |
   |  When an endpoint wishes to set up a secure media session with
   |  another endpoint, it sends an offer in a SIP message to the other
   |  endpoint.  This offer includes, as part of the SDP payload, a
   |  fingerprint of a certificate that the endpoint wants to use.  The
   |  endpoint SHOULD send the SIP message containing the offer to the
   |  offerer&#x27;s SIP proxy over an integrity-protected channel.  The
   |  proxy SHOULD add an Identity header field according to the
   |  procedures outlined in [<a href="/doc/html/rfc4474" title="&quot;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP)&quot;">RFC4474</a>].  When the far endpoint receives
   |  the SIP message, it can verify the identity of the sender using
   |  the Identity header field.  Since the Identity header field is a
   |  digital signature across several SIP header fields, in addition to
   |  the body of the SIP message, the receiver can also be certain that
   |  the message has not been tampered with after the digital signature
   |  was applied and added to the SIP message.
   |
   |  The far endpoint (answerer) may now establish a DTLS association
   |  with the offerer.  Alternately, it can indicate in its answer that
   |  the offerer is to initiate the DTLS association.  In either case,
   |  mutual DTLS certificate-based authentication will be used.  After
   |  completing the DTLS handshake, information about the authenticated
   |  identities, including the certificates, is made available to the
   |  endpoint application.  The answerer is then able to verify that
   |  the offerer&#x27;s certificate used for authentication in the DTLS
   |  handshake can be associated with a certificate fingerprint
   |  contained in the offer in the SDP.  At this point, the answerer
   |  may indicate to the end user that the media is secured.  The
   |  offerer may only tentatively accept the answerer&#x27;s certificate,
   |  since it may not yet have the answerer&#x27;s certificate fingerprint
   |
   |  When the answerer accepts the offer, it provides an answer back to
   |  the offerer containing the answerer&#x27;s certificate fingerprint.  At
   |  this point, the offerer can accept or reject the peer&#x27;s
   |  certificate, and the offerer can indicate to the end user that the
   |  media is secured.
   |
   |  Note that the entire authentication and key exchange for securing
   |  the media traffic is handled in the media path through DTLS.  The
   |  signaling path is only used to verify the peers&#x27; certificate
   |  fingerprints.
   |
   |  The offerer and answerer MUST follow the SDP offer/answer
   |  procedures defined in <a href="/doc/html/rfc8842">RFC 8842</a>.

<span class="h4"><a class="selflink" id="section-9.2.3" href="#section-9.2.3">9.2.3</a>.  Update to <a href="#section-6.6">Section 6.6</a></span>

   The text in <a href="/doc/html/rfc5763#section-6.6">[RFC5763], Section&nbsp;6.6</a> (&quot;Session Modification&quot;) is
   modified by replacing generic SDP offer/answer procedures for DTLS
   with a reference to this specification:

   NEW TEXT:

   |  Once an answer is provided to the offerer, either endpoint MAY
   |  request a session modification that MAY include an updated offer.
   |  This session modification can be carried in either an INVITE or
   |  UPDATE request.  The peers can reuse an existing DTLS association
   |  or establish a new one, following the procedures in <a href="/doc/html/rfc8842">RFC 8842</a>.

<span class="h4"><a class="selflink" id="section-9.2.4" href="#section-9.2.4">9.2.4</a>.  Update to <a href="#section-6.7.1">Section 6.7.1</a></span>

   The text in <a href="/doc/html/rfc5763#section-6.7.1">[RFC5763], Section&nbsp;6.7.1</a> (&quot;ICE Interaction&quot;) is modified
   by replacing the ICE procedures with a reference to this
   specification:

   NEW TEXT:

   |  The Interactive Connectivity Establishment (ICE) [<a href="/doc/html/rfc8445" title="&quot;Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal&quot;">RFC8445</a>]
   |  considerations for DTLS-protected media are described in <a href="/doc/html/rfc8842">RFC 8842</a>.

<span class="h3"><a class="selflink" id="section-9.3" href="#section-9.3">9.3</a>.  Update to <a href="/doc/html/rfc7345">RFC 7345</a></span>

<span class="h4"><a class="selflink" id="section-9.3.1" href="#section-9.3.1">9.3.1</a>.  Update to <a href="#section-4">Section 4</a></span>

   The subsections (4.1 - 4.5) in <a href="/doc/html/rfc7345#section-4">[RFC7345], Section&nbsp;4</a> (&quot;SDP Offerer/
   Answerer Procedures&quot;) are removed and replaced with the new text
   below:

   NEW TEXT:

   |  An endpoint (i.e., both the offerer and the answerer) MUST create
   |  an SDP media description (&quot;m=&quot; line) for each UDPTL-over-DTLS
   |  media stream and MUST assign a UDP/TLS/UDPTL value (see Table 1)
   |  to the &quot;proto&quot; field of the &quot;m=&quot; line.
   |
   |  The offerer and answerer MUST follow the SDP offer/answer
   |  procedures defined in <a href="/doc/html/rfc8842">RFC 8842</a> in order to negotiate the DTLS
   |  association associated with the UDPTL-over-DTLS media stream.  In
   |  addition, the offerer and answerer MUST use the SDP attributes
   |  defined for UDPTL over UDP, as defined in [<a href="#ref-ITU.T38" title="&quot;Procedures for real-time Group 3 facsimile communication over IP networks&quot;">ITU.T38</a>].

<span class="h4"><a class="selflink" id="section-9.3.2" href="#section-9.3.2">9.3.2</a>.  Update to <a href="#section-5.2.1">Section 5.2.1</a></span>

   The text in <a href="/doc/html/rfc7345#section-5.2.1">[RFC7345], Section&nbsp;5.2.1</a> (&quot;ICE Usage&quot;) is modified by
   replacing the ICE procedures with a reference to this specification:

   NEW TEXT:

   |  The Interactive Connectivity Establishment (ICE) [<a href="/doc/html/rfc8445" title="&quot;Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal&quot;">RFC8445</a>]
   |  considerations for DTLS-protected media are described in <a href="/doc/html/rfc8842">RFC 8842</a>.

<span class="h4"><a class="selflink" id="section-9.3.3" href="#section-9.3.3">9.3.3</a>.  Update to <a href="#section-9.1">Section 9.1</a></span>

   A reference to [<a href="/doc/html/rfc8122" title="&quot;Connection-Oriented Media Transport over the Transport Layer Security (TLS) Protocol in the Session Description Protocol (SDP)&quot;">RFC8122</a>] is added to <a href="/doc/html/rfc7345#section-9.1">[RFC7345], Section&nbsp;9.1</a>
   (&quot;Normative References&quot;):

   NEW TEXT:

   |  [<a href="/doc/html/rfc8122" title="&quot;Connection-Oriented Media Transport over the Transport Layer Security (TLS) Protocol in the Session Description Protocol (SDP)&quot;">RFC8122</a>]   Lennox, J. and C.  Holmberg, &quot;Connection-Oriented
   |              Media Transport over the Transport Layer Security
   |              (TLS) Protocol in the Session Description Protocol
   |              (SDP)&quot;, <a href="/doc/html/rfc8122">RFC 8122</a>, DOI 10.17487/RFC8122, March 2017,
   |              &lt;<a href="https://www.rfc-editor.org/info/rfc8122">https://www.rfc-editor.org/info/rfc8122</a>&gt;.

<span class="h2"><a class="selflink" id="section-10" href="#section-10">10</a>.  Security Considerations</span>

   This specification does not modify the security considerations
   associated with DTLS or the SDP offer/answer mechanism.  In addition
   to the introduction of the SDP &quot;tls-id&quot; attribute, this document
   simply clarifies the procedures for negotiating and establishing a
   DTLS association.

   This specification does not modify the actual TLS connection setup
   procedures.  The SDP &quot;tls-is&quot; attribute as such cannot be used to
   correlate an SDP offer/answer exchange with a TLS connection setup.
   Thus, this document does not introduce new security considerations
   related to correlating an SDP offer/answer exchange with a TLS
   connection setup.

<span class="h2"><a class="selflink" id="section-11" href="#section-11">11</a>.  IANA Considerations</span>

   This document updates the &quot;Session Description Protocol Parameters&quot;
   registry as specified in <a href="/doc/html/rfc4566#section-8.2.2">Section&nbsp;8.2.2 of [RFC4566]</a>.  Specifically,
   it adds the SDP &quot;tls-id&quot; attribute to the table for SDP media-level
   attributes as follows.

   Attribute name:  tls-id

   Type of attribute:  Media-level

   Subject to charset:  No

   Purpose:  Indicates whether a new DTLS association or TLS connection
      is to be established/re-established.

   Appropriate Values:  See <a href="#section-4">Section 4</a>

   Contact name:  Christer Holmberg

   Mux Category:  IDENTICAL

<span class="h2"><a class="selflink" id="section-12" href="#section-12">12</a>.  References</span>

<span class="h3"><a class="selflink" id="section-12.1" href="#section-12.1">12.1</a>.  Normative References</span>

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., &quot;Key words for use in RFCs to Indicate
              Requirement Levels&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc2119">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC3261">RFC3261</a>]  Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston,
              A., Peterson, J., Sparks, R., Handley, M., and E.
              Schooler, &quot;SIP: Session Initiation Protocol&quot;, <a href="/doc/html/rfc3261">RFC 3261</a>,
              DOI 10.17487/RFC3261, June 2002,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3261">https://www.rfc-editor.org/info/rfc3261</a>&gt;.

   [<a id="ref-RFC3264">RFC3264</a>]  Rosenberg, J. and H. Schulzrinne, &quot;An Offer/Answer Model
              with Session Description Protocol (SDP)&quot;, <a href="/doc/html/rfc3264">RFC 3264</a>,
              DOI 10.17487/RFC3264, June 2002,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3264">https://www.rfc-editor.org/info/rfc3264</a>&gt;.

   [<a id="ref-RFC4145">RFC4145</a>]  Yon, D. and G. Camarillo, &quot;TCP-Based Media Transport in
              the Session Description Protocol (SDP)&quot;, <a href="/doc/html/rfc4145">RFC 4145</a>,
              DOI 10.17487/RFC4145, September 2005,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4145">https://www.rfc-editor.org/info/rfc4145</a>&gt;.

   [<a id="ref-RFC4566">RFC4566</a>]  Handley, M., Jacobson, V., and C. Perkins, &quot;SDP: Session
              Description Protocol&quot;, <a href="/doc/html/rfc4566">RFC 4566</a>, DOI 10.17487/RFC4566,
              July 2006, &lt;<a href="https://www.rfc-editor.org/info/rfc4566">https://www.rfc-editor.org/info/rfc4566</a>&gt;.

   [<a id="ref-RFC5763">RFC5763</a>]  Fischl, J., Tschofenig, H., and E. Rescorla, &quot;Framework
              for Establishing a Secure Real-time Transport Protocol
              (SRTP) Security Context Using Datagram Transport Layer
              Security (DTLS)&quot;, <a href="/doc/html/rfc5763">RFC 5763</a>, DOI 10.17487/RFC5763, May
              2010, &lt;<a href="https://www.rfc-editor.org/info/rfc5763">https://www.rfc-editor.org/info/rfc5763</a>&gt;.

   [<a id="ref-RFC6347">RFC6347</a>]  Rescorla, E. and N. Modadugu, &quot;Datagram Transport Layer
              Security Version 1.2&quot;, <a href="/doc/html/rfc6347">RFC 6347</a>, DOI 10.17487/RFC6347,
              January 2012, &lt;<a href="https://www.rfc-editor.org/info/rfc6347">https://www.rfc-editor.org/info/rfc6347</a>&gt;.

   [<a id="ref-RFC7345">RFC7345</a>]  Holmberg, C., Sedlacek, I., and G. Salgueiro, &quot;UDP
              Transport Layer (UDPTL) over Datagram Transport Layer
              Security (DTLS)&quot;, <a href="/doc/html/rfc7345">RFC 7345</a>, DOI 10.17487/RFC7345, August
              2014, &lt;<a href="https://www.rfc-editor.org/info/rfc7345">https://www.rfc-editor.org/info/rfc7345</a>&gt;.

   [<a id="ref-RFC8122">RFC8122</a>]  Lennox, J. and C. Holmberg, &quot;Connection-Oriented Media
              Transport over the Transport Layer Security (TLS) Protocol
              in the Session Description Protocol (SDP)&quot;, <a href="/doc/html/rfc8122">RFC 8122</a>,
              DOI 10.17487/RFC8122, March 2017,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8122">https://www.rfc-editor.org/info/rfc8122</a>&gt;.

   [<a id="ref-RFC8174">RFC8174</a>]  Leiba, B., &quot;Ambiguity of Uppercase vs Lowercase in <a href="/doc/html/rfc2119">RFC</a>
              <a href="/doc/html/rfc2119">2119</a> Key Words&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc8174">RFC 8174</a>, DOI 10.17487/RFC8174,
              May 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.

   [<a id="ref-RFC8445">RFC8445</a>]  Keranen, A., Holmberg, C., and J. Rosenberg, &quot;Interactive
              Connectivity Establishment (ICE): A Protocol for Network
              Address Translator (NAT) Traversal&quot;, <a href="/doc/html/rfc8445">RFC 8445</a>,
              DOI 10.17487/RFC8445, July 2018,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8445">https://www.rfc-editor.org/info/rfc8445</a>&gt;.

   [<a id="ref-RFC8843">RFC8843</a>]  Holmberg, C., Alvestrand, H., and C. Jennings,
              &quot;Negotiating Media Multiplexing Using the Session
              Description Protocol (SDP)&quot;, <a href="/doc/html/rfc8843">RFC 8843</a>,
              DOI 10.17487/RFC8843, January 2021,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8843">https://www.rfc-editor.org/info/rfc8843</a>&gt;.

   [<a id="ref-RFC8859">RFC8859</a>]  Nandakumar, S., &quot;A Framework for Session Description
              Protocol (SDP) Attributes When Multiplexing&quot;, <a href="/doc/html/rfc8859">RFC 8859</a>,
              DOI 10.17487/RFC8859, January 2021,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8859">https://www.rfc-editor.org/info/rfc8859</a>&gt;.

<span class="h3"><a class="selflink" id="section-12.2" href="#section-12.2">12.2</a>.  Informative References</span>

   [<a id="ref-ITU.T38">ITU.T38</a>]  ITU-T, &quot;Procedures for real-time Group 3 facsimile
              communication over IP networks&quot;, Recommendation T.38,
              September 2010, &lt;<a href="https://www.itu.int/rec/T-REC-T.38/en">https://www.itu.int/rec/T-REC-T.38/en</a>&gt;.

   [<a id="ref-RFC4474">RFC4474</a>]  Peterson, J. and C. Jennings, &quot;Enhancements for
              Authenticated Identity Management in the Session
              Initiation Protocol (SIP)&quot;, <a href="/doc/html/rfc4474">RFC 4474</a>,
              DOI 10.17487/RFC4474, August 2006,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4474">https://www.rfc-editor.org/info/rfc4474</a>&gt;.

   [<a id="ref-RFC4572">RFC4572</a>]  Lennox, J., &quot;Connection-Oriented Media Transport over the
              Transport Layer Security (TLS) Protocol in the Session
              Description Protocol (SDP)&quot;, <a href="/doc/html/rfc4572">RFC 4572</a>,
              DOI 10.17487/RFC4572, July 2006,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4572">https://www.rfc-editor.org/info/rfc4572</a>&gt;.

   [<a id="ref-RFC5576">RFC5576</a>]  Lennox, J., Ott, J., and T. Schierl, &quot;Source-Specific
              Media Attributes in the Session Description Protocol
              (SDP)&quot;, <a href="/doc/html/rfc5576">RFC 5576</a>, DOI 10.17487/RFC5576, June 2009,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5576">https://www.rfc-editor.org/info/rfc5576</a>&gt;.

   [<a id="ref-RFC6083">RFC6083</a>]  Tuexen, M., Seggelmann, R., and E. Rescorla, &quot;Datagram
              Transport Layer Security (DTLS) for Stream Control
              Transmission Protocol (SCTP)&quot;, <a href="/doc/html/rfc6083">RFC 6083</a>,
              DOI 10.17487/RFC6083, January 2011,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6083">https://www.rfc-editor.org/info/rfc6083</a>&gt;.

   [<a id="ref-RFC7983">RFC7983</a>]  Petit-Huguenin, M. and G. Salgueiro, &quot;Multiplexing Scheme
              Updates for Secure Real-time Transport Protocol (SRTP)
              Extension for Datagram Transport Layer Security (DTLS)&quot;,
              <a href="/doc/html/rfc7983">RFC 7983</a>, DOI 10.17487/RFC7983, September 2016,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7983">https://www.rfc-editor.org/info/rfc7983</a>&gt;.

   [<a id="ref-RFC8224">RFC8224</a>]  Peterson, J., Jennings, C., Rescorla, E., and C. Wendt,
              &quot;Authenticated Identity Management in the Session
              Initiation Protocol (SIP)&quot;, <a href="/doc/html/rfc8224">RFC 8224</a>,
              DOI 10.17487/RFC8224, February 2018,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8224">https://www.rfc-editor.org/info/rfc8224</a>&gt;.

   [<a id="ref-RFC8839">RFC8839</a>]  Petit-Huguenin, M., Nandakumar, S., Holmberg, C., Keränen,
              A., and R. Shpount, &quot;Session Description Protocol (SDP)
              Offer/Answer Procedures for Interactive Connectivity
              Establishment (ICE)&quot;, <a href="/doc/html/rfc8839">RFC 8839</a>, DOI 10.17487/RFC8839,
              January 2021, &lt;<a href="https://www.rfc-editor.org/info/rfc8839">https://www.rfc-editor.org/info/rfc8839</a>&gt;.

   [<a id="ref-RFC8844">RFC8844</a>]  Thomson, M. and E. Rescorla, &quot;Unknown Key-Share Attacks on
              Uses of TLS with the Session Description Protocol (SDP)&quot;,
              <a href="/doc/html/rfc8844">RFC 8844</a>, DOI 10.17487/RFC8844, January 2021,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8844">https://www.rfc-editor.org/info/rfc8844</a>&gt;.

Acknowledgements

   Thanks to Justin Uberti, Martin Thomson, Paul Kyzivat, Jens Guballa,
   Charles Eckel, Gonzalo Salgueiro, and Paul Jones for providing
   comments and suggestions on the document.  Ben Campbell performed an
   Area Director review.  Paul Kyzivat performed a Gen-ART review.

Authors&#x27; Addresses

   Christer Holmberg
   Ericsson
   Hirsalantie 11
   FI-02420 Jorvas
   Finland

   Email: christer.holmberg@ericsson.com


   Roman Shpount
   TurboBridge
   4905 Del Ray Avenue, Suite 300
   Bethesda, MD 20814
   United States of America

   Email: rshpount@turbobridge.com
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

