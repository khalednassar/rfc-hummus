<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    rfc2575
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.34.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.34.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/draft-ietf-snmpv3-vacm/">
  <meta name="description" content="View-based Access Control Model (VACM) for the Simple Network Management Protocol (SNMP) (RFC )">
  <script src="https://www.ietf.org/lib/dt/7.34.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.34.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bgbrown"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc2575.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc2575.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/pdfrfc/rfc2575.txt.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/rfc2575/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/rfc2575/" title="Datatracker information for this document">Tracker</a>] [<a href="/group/snmpv3/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-snmpv3-vacm@ietf.org?subject=draft-ietf-snmpv3-vacm" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=draft-ietf-snmpv3-vacm-04.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-ietf-snmpv3-vacm-04.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-ietf-snmpv3-vacm-04.txt" title="Run an idnits check of this document">Nits</a>]

From: <a href="/doc/html/draft-ietf-snmpv3-vacm-04">draft-ietf-snmpv3-vacm-04</a>                           Draft Standard
Obsoleted by: <a href="/doc/html/rfc3415">3415</a>                                                      </pre>
      </div>
    

    <div class="draftcontent">
    <pre>Network Working Group                                          B. Wijnen
Request for Comments: 2575                     IBM T. J. Watson Research
Obsoletes: <a href="/doc/html/rfc2275">2275</a>                                               R. Presuhn
Category: Standards Track                             BMC Software, Inc.
                                                           K. McCloghrie
                                                     Cisco Systems, Inc.
                                                              April 1999


             <span class="h1">View-based Access Control Model (VACM) for the</span>
               <span class="h1">Simple Network Management Protocol (SNMP)</span>

Status of this Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the &quot;Internet
   Official Protocol Standards&quot; (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (1999).  All Rights Reserved.

Abstract

   This document describes the View-based Access Control Model for use
   in the SNMP architecture [<a href="/doc/html/rfc2571" title="&quot;An Architecture for describing SNMP Management Frameworks&quot;">RFC2571</a>].  It defines the Elements of
   Procedure for controlling access to management information.  This
   document also includes a MIB for remotely managing the configuration
   parameters for the View-based Access Control Model.

Table of Contents

   1.  Introduction                                             2
   1.2.  Access Control                                         3
   1.3.  Local Configuration Datastore                          3
   2.  Elements of the Model                                    3
   2.1.  Groups                                                 3
   2.2.  securityLevel                                          4
   2.3.  Contexts                                               4
   2.4.  MIB Views and View Families                            4
   2.4.1.  View Subtree                                         5
   2.4.2.  ViewTreeFamily                                       5
   2.5.  Access Policy                                          6
   3.  Elements of Procedure                                    6
   3.1.  Overview  of isAccessAllowed Process                   8
   3.2.  Processing the isAccessAllowed Service Request         9



<span class="grey">Wijnen, et al.              Standards Track                     [Page 1]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-2" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


   4.  Definitions                                             10
   5.  Intellectual Property                                   27
   6.  Acknowledgements                                        28
   7.  Security Considerations                                 29
   7.1.  Recommended Practices                                 29
   7.2.  Defining Groups                                       30
   7.3.  Conformance                                           30
   7.4.  Access to the SNMP-VIEW-BASED-ACM-MIB                 30
   8.  References                                              31
   9.  Editors&#x27; Addresses                                      32
   A.1.  Installation Parameters                               33
   B.  Change Log                                              37
   C.  Full Copyright Statement                                38


<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>.  Introduction</span>

   The Architecture for describing Internet Management Frameworks
   [<a href="/doc/html/rfc2571" title="&quot;An Architecture for describing SNMP Management Frameworks&quot;">RFC2571</a>] describes that an SNMP engine is composed of:

     1) a Dispatcher
     2) a Message Processing Subsystem,
     3) a Security Subsystem, and
     4) an Access Control Subsystem.

   Applications make use of the services of these subsystems.

   It is important to understand the SNMP architecture and its
   terminology to understand where the View-based Access Control Model
   described in this document fits into the architecture and interacts
   with other subsystems within the architecture.  The reader is
   expected to have read and understood the description and terminology
   of the SNMP architecture, as defined in [<a href="/doc/html/rfc2571" title="&quot;An Architecture for describing SNMP Management Frameworks&quot;">RFC2571</a>].

   The Access Control Subsystem of an SNMP engine has the responsibility
   for checking whether a specific type of access (read, write, notify)
   to a particular object (instance) is allowed.

   It is the purpose of this document to define a specific model of the
   Access Control Subsystem, designated the View-based Access Control
   Model. Note that this is not necessarily the only Access Control
   Model.

   The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;,
   &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;,  &quot;MAY&quot;, and &quot;OPTIONAL&quot; in this
   document are to be interpreted as described in [<a href="/doc/html/rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].





<span class="grey">Wijnen, et al.              Standards Track                     [Page 2]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-3" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


<span class="h3"><a class="selflink" id="section-1.2" href="#section-1.2">1.2</a>.  Access Control</span>

   Access Control occurs (either implicitly or explicitly) in an SNMP
   entity when processing SNMP retrieval or modification request
   messages from an SNMP entity.  For example a Command Responder
   application applies Access Control when processing requests that it
   received from a Command Generator application.  These requests
   contain Read Class and Write Class PDUs as defined in [<a href="/doc/html/rfc2571" title="&quot;An Architecture for describing SNMP Management Frameworks&quot;">RFC2571</a>].

   Access Control also occurs in an SNMP entity when an SNMP
   notification message is generated (by a Notification Originator
   application).  These notification messages contain Notification Class
   PDUs as defined in [<a href="/doc/html/rfc2571" title="&quot;An Architecture for describing SNMP Management Frameworks&quot;">RFC2571</a>].

   The View-based Access Control Model defines a set of services that an
   application (such as a Command Responder or a Notification Originator
   application) can use for checking access rights.  It is the
   responsibility of the application to make the proper service calls
   for access checking.

<span class="h3"><a class="selflink" id="section-1.3" href="#section-1.3">1.3</a>.  Local Configuration Datastore</span>

   To implement the model described in this document, an SNMP entity
   needs to retain information about access rights and policies.  This
   information is part of the SNMP engine&#x27;s Local Configuration
   Datastore (LCD). See [<a href="/doc/html/rfc2571" title="&quot;An Architecture for describing SNMP Management Frameworks&quot;">RFC2571</a>] for the definition of LCD.

   In order to allow an SNMP entity&#x27;s LCD to be remotely configured,
   portions of the LCD need to be accessible as managed objects.  A MIB
   module, the View-based Access Control Model Configuration MIB, which
   defines these managed object types is included in this document.

<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  Elements of the Model</span>

   This section contains definitions to realize the access control
   service provided by the View-based Access Control Model.

<span class="h3"><a class="selflink" id="section-2.1" href="#section-2.1">2.1</a>.  Groups</span>

   A group is a set of zero or more &lt;securityModel, securityName&gt; tuples
   on whose behalf SNMP management objects can be accessed.  A group
   defines the access rights afforded to all securityNames which belong
   to that group. The combination of a securityModel and a securityName
   maps to at most one group.  A group is identified by a groupName.

   The Access Control module assumes that the securityName has already
   been authenticated as needed and provides no further authentication
   of its own.



<span class="grey">Wijnen, et al.              Standards Track                     [Page 3]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-4" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


   The View-based Access Control Model uses the securityModel and the
   securityName as inputs to the Access Control module when called to
   check for access rights.  It determines the groupName as a function
   of securityModel and securityName.

<span class="h3"><a class="selflink" id="section-2.2" href="#section-2.2">2.2</a>.  securityLevel</span>

   Different access rights for members of a group can be defined for
   different levels of security, i.e., noAuthNoPriv, authNoPriv, and
   authPriv. The securityLevel identifies the level of security that
   will be assumed when checking for access rights.  See the SNMP
   Architecture document [<a href="/doc/html/rfc2571" title="&quot;An Architecture for describing SNMP Management Frameworks&quot;">RFC2571</a>] for a definition of securityLevel.

   The View-based Access Control Model requires that the securityLevel
   is passed as input to the Access Control module when called to check
   for access rights.

<span class="h3"><a class="selflink" id="section-2.3" href="#section-2.3">2.3</a>.  Contexts</span>

   An SNMP context is a collection of management information accessible
   by an SNMP entity.  An item of management information may exist in
   more than one context.  An SNMP entity potentially has access to many
   contexts.  Details about the naming of management information can be
   found in the SNMP Architecture document [<a href="/doc/html/rfc2571" title="&quot;An Architecture for describing SNMP Management Frameworks&quot;">RFC2571</a>].

   The View-based Access Control Model defines a vacmContextTable that
   lists the locally available contexts by contextName.

<span class="h3"><a class="selflink" id="section-2.4" href="#section-2.4">2.4</a>.  MIB Views and View Families</span>

   For security reasons, it is often valuable to be able to restrict the
   access rights of some groups to only a subset of the management
   information in the management domain.  To provide this capability,
   access to a context is via a &quot;MIB view&quot; which details a specific set
   of managed object types (and optionally, the specific instances of
   object types) within that context.  For example, for a given context,
   there will typically always be one MIB view which provides access to
   all management information in that context, and often there will be
   other MIB views each of which contains some subset of the
   information.  So, the access allowed for a group can be restricted in
   the desired manner by specifying its rights in terms of the
   particular (subset) MIB view it can access within each appropriate
   context.

   Since managed object types (and their instances) are identified via
   the tree-like naming structure of ISO&#x27;s OBJECT IDENTIFIERs [ISO-
   ASN.1, <a href="/doc/html/rfc2578">RFC2578</a>],  it is convenient to define a MIB view as the
   combination of a set of &quot;view subtrees&quot;, where each view subtree is a



<span class="grey">Wijnen, et al.              Standards Track                     [Page 4]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-5" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


   subtree within the managed object naming tree.  Thus, a simple MIB
   view (e.g., all managed objects within the Internet Network
   Management Framework) can be defined as a single view subtree, while
   more complicated MIB views (e.g., all information relevant to a
   particular network interface) can be represented by the union of
   multiple view subtrees.

   While any set of managed objects can be described by the union of
   some number of view subtrees, situations can arise that would require
   a very large number of view subtrees.  This could happen, for
   example, when specifying all columns in one conceptual row of a MIB
   table because they would appear in separate subtrees, one per column,
   each with a very similar format.  Because the formats are similar,
   the required set of subtrees can easily be aggregated into one
   structure.  This structure is named a family of view subtrees after
   the set of subtrees that it conceptually represents.  A family of
   view subtrees can either be included or excluded from a MIB view.

<span class="h4"><a class="selflink" id="section-2.4.1" href="#section-2.4.1">2.4.1</a>.  View Subtree</span>

   A view subtree is the set of all MIB object instances which have a
   common ASN.1 OBJECT IDENTIFIER prefix to their names.  A view subtree
   is identified by the OBJECT IDENTIFIER value which is the longest
   OBJECT IDENTIFIER prefix common to all (potential) MIB object
   instances in that subtree.

<span class="h4"><a class="selflink" id="section-2.4.2" href="#section-2.4.2">2.4.2</a>.  ViewTreeFamily</span>

   A family of view subtrees is a pairing of an OBJECT IDENTIFIER value
   (called the family name) together with a bit string value (called the
   family mask).  The family mask indicates which sub-identifiers of the
   associated family name are significant to the family&#x27;s definition.

   For each possible managed object instance, that instance belongs to a
   particular ViewTreeFamily if both of the following conditions are
   true:

   - the OBJECT IDENTIFIER name of the managed object instance
     contains at least as many sub-identifiers as does the family name,
     and

   - each sub-identifier in the OBJECT IDENTIFIER name of the managed
     object instance matches the corresponding sub-identifier of the
     family name whenever the corresponding bit of the associated family
     mask is non-zero.






<span class="grey">Wijnen, et al.              Standards Track                     [Page 5]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-6" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


   When the configured value of the family mask is all ones, the view
   subtree family is identical to the single view subtree identified by
   the family name.

   When the configured value of the family mask is shorter than required
   to perform the above test, its value is implicitly extended with
   ones.  Consequently, a view subtree family having a family mask of
   zero length always corresponds to a single view subtree.

<span class="h3"><a class="selflink" id="section-2.5" href="#section-2.5">2.5</a>.  Access Policy</span>

   The View-based Access Control Model determines the access rights of a
   group, representing zero or more securityNames which have the same
   access rights.  For a particular context, identified by contextName,
   to which a group, identified by groupName, has access using a
   particular securityModel and securityLevel, that group&#x27;s access
   rights are given by a read-view, a write-view and a notify-view.

   The read-view represents the set of object instances authorized for
   the group when reading objects.  Reading objects occurs when
   processing a retrieval operation (when handling Read Class PDUs).

   The write-view represents the set of object instances authorized for
   the group when writing objects.  Writing objects occurs when
   processing a write operation (when handling Write Class PDUs).

   The notify-view represents the set of object instances authorized for
   the group when sending objects in a notification, such as when
   sending a notification (when sending Notification Class PDUs).

<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>.  Elements of Procedure</span>

   This section describes the procedures followed by an Access Control
   module that implements the View-based Access Control Model when
   checking access rights as requested by an application (for example a
   Command Responder or a Notification Originator application).  The
   abstract service primitive is:

     statusInformation =          -- success or errorIndication
         isAccessAllowed(
             securityModel        -- Security Model in use
             securityName         -- principal who wants access
             securityLevel        -- Level of Security
             viewType             -- read, write, or notify view
             contextName          -- context containing variableName
             variableName         -- OID for the managed object
             )




<span class="grey">Wijnen, et al.              Standards Track                     [Page 6]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-7" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


   The abstract data elements are:

     statusInformation - one of the following:
        accessAllowed  - a MIB view was found and access is granted.
        notInView      - a MIB view was found but access is denied.
                         The variableName is not in the configured
                         MIB view for the specified viewType (e.g., in
                         the relevant entry in the vacmAccessTable).
        noSuchView     - no MIB view found because no view has been
                         configured for specified viewType (e.g., in
                         the relevant entry in the vacmAccessTable).
        noSuchContext  - no MIB view found because of no entry in the
                         vacmContextTable for specified contextName.
        noGroupName    - no MIB view found because no entry has been
                         configured in the vacmSecurityToGroupTable
                         for the specified combination of
                         securityModel and securityName.
        noAccessEntry  - no MIB view found because no entry has been
                         configured in the vacmAccessTable for the
                         specified combination of contextName,
                         groupName (from vacmSecurityToGroupTable),
                         securityModel and securityLevel.
        otherError     - failure, an undefined error occurred.
     securityModel - Security Model under which access is requested.
     securityName  - the principal on whose behalf access is requested.
     securityLevel - Level of Security under which access is requested.
     viewType      - view to be checked (read, write or notify).
     contextName   - context in which access is requested.
     variableName  - object instance to which access is requested.






















<span class="grey">Wijnen, et al.              Standards Track                     [Page 7]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-8" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


<span class="h3"><a class="selflink" id="section-3.1" href="#section-3.1">3.1</a>.  Overview  </span>of isAccessAllowed Process

 The following picture shows how the decision for access control is made
 by the View-based Access Control Model.

 +--------------------------------------------------------------------+
 |                                                                    |
 |      +-&gt; securityModel -+                                          |
 |      |   (a)            |                                          |
 | who -+                  +-&gt; groupName ----+                        |
 | (1)  |                  |   (x)           |                        |
 |      +-&gt; securityName --+                 |                        |
 |          (b)                              |                        |
 |                                           |                        |
 | where -&gt; contextName ---------------------+                        |
 | (2)      (e)                              |                        |
 |                                           |                        |
 |                                           |                        |
 |      +-&gt; securityModel -------------------+                        |
 |      |   (a)                              |                        |
 | how -+                                    +-&gt; viewName -+          |
 | (3)  |                                    |   (y)       |          |
 |      +-&gt; securityLevel -------------------+             |          |
 |          (c)                              |             +-&gt; yes/no |
 |                                           |             | decision |
 | why ---&gt; viewType (read/write/notify) ----+             | (z)      |
 | (4)      (d)                                            |          |
 |                                                         |          |
 | what --&gt; object-type ------+                            |          |
 | (5)      (m)               |                            |          |
 |                            +-&gt; variableName (OID) ------+          |
 |                            |   (f)                                 |
 | which -&gt; object-instance --+                                       |
 | (6)      (n)                                                       |
 |                                                                    |
 +--------------------------------------------------------------------+

 How the decision for isAccessAllowed is made.

 1) Inputs to the isAccessAllowed service are:

    (a)       securityModel    -- Security Model in use
    (b)       securityName     -- principal who wants to access
    (c)       securityLevel    -- Level of Security
    (d)       viewType         -- read, write, or notify view
    (e)       contextName      -- context containing variableName





<span class="grey">Wijnen, et al.              Standards Track                     [Page 8]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-9" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


    (f)       variableName     -- OID for the managed object
                               -- this is made up of:
                                  - object-type (m)
                                  - object-instance (n)

 2) The partial &quot;who&quot; (1), represented by the securityModel (a) and
    the securityName (b), are used as the indices (a,b) into the
    vacmSecurityToGroupTable to find a single entry that produces a
    group, represented by groupName (x).

 3) The &quot;where&quot; (2), represented by the contextName (e), the &quot;who&quot;,
    represented by the groupName (x) from the previous step, and the
    &quot;how&quot; (3), represented by securityModel (a) and securityLevel (c),
    are used as indices (e,x,a,c) into the vacmAccessTable to find a
    single entry that contains three MIB views.

 4) The &quot;why&quot; (4), represented by the viewType (d), is used to select
    the proper MIB view, represented by a viewName (y), from the
    vacmAccessEntry selected in the previous step. This viewName (y) is
    an index into the vacmViewTreeFamilyTable and selects the set of
    entries that define the variableNames which are included in or
    excluded from the MIB view identified by the viewName (y).

 5) The &quot;what&quot; (5) type of management data and &quot;which&quot; (6) particular
    instance, represented by the variableName (f), is then checked to be
    in the MIB view or not, e.g., the yes/no decision (z).

<span class="h3"><a class="selflink" id="section-3.2" href="#section-3.2">3.2</a>.  Processing the isAccessAllowed Service Request</span>

   This section describes the procedure followed by an Access Control
   module that implements the View-based Access Control Model whenever
   it receives an isAccessAllowed request.

   1) The vacmContextTable is consulted for information about
      the SNMP context identified by the contextName.  If information
      about this SNMP context is absent from the table, then an
      errorIndication (noSuchContext) is returned to the calling module.

   2) The vacmSecurityToGroupTable is consulted for mapping the
      securityModel and securityName to a groupName.  If the information
      about this combination is absent from the table, then an
      errorIndication (noGroupName) is returned to the calling module.

   3) The vacmAccessTable is consulted for information about the
      groupName, contextName, securityModel and securityLevel.  If
      information about this combination is absent from the table, then
      an errorIndication (noAccessEntry) is returned to the calling
      module.



<span class="grey">Wijnen, et al.              Standards Track                     [Page 9]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-10" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


   4) a) If the viewType is &quot;read&quot;, then the read view is used for
         checking access rights.

      b) If the viewType is &quot;write&quot;, then the write view is used for
         checking access rights.

      c) If the viewType is &quot;notify&quot;, then the notify view is used
         for checking access rights.

      If the view to be used is the empty view (zero length viewName)
      then an errorIndication (noSuchView) is returned to the calling
      module.

   5) a) If there is no view configured for the specified viewType,
         then an errorIndication (noSuchView) is returned to the calling
         module.

      b) If the specified variableName (object instance) is not in the
         MIB view (see DESCRIPTION clause for vacmViewTreeFamilyTable in
         <a href="#section-4">section 4</a>), then an errorIndication (notInView) is returned to
         the calling module.

         Otherwise,

      c) The specified variableName is in the MIB view.
         A statusInformation of success (accessAllowed) is returned to
         the calling module.

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>.  Definitions</span>

SNMP-VIEW-BASED-ACM-MIB DEFINITIONS ::= BEGIN

IMPORTS
    MODULE-COMPLIANCE, OBJECT-GROUP       FROM SNMPv2-CONF
    MODULE-IDENTITY, OBJECT-TYPE,
    snmpModules                           FROM SNMPv2-SMI
    TestAndIncr,
    RowStatus, StorageType                FROM SNMPv2-TC
    SnmpAdminString,
    SnmpSecurityLevel,
    SnmpSecurityModel                     FROM SNMP-FRAMEWORK-MIB;

snmpVacmMIB       MODULE-IDENTITY
    LAST-UPDATED &quot;9901200000Z&quot;            -- 20 Jan 1999, midnight
    ORGANIZATION &quot;SNMPv3 Working Group&quot;
    CONTACT-INFO &quot;WG-email:   snmpv3@lists.tislabs.com
                  Subscribe:  majordomo@lists.tislabs.com
                              In message body:  subscribe snmpv3



<span class="grey">Wijnen, et al.              Standards Track                    [Page 10]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-11" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


                  Chair:      Russ Mundy
                              Trusted Information Systems
                  postal:     3060 Washington Rd
                              Glenwood MD 21738
                              USA
                  email:      mundy@tislabs.com
                  phone:      +1-301-854-6889

                  Co-editor:  Bert Wijnen
                              IBM T.J. Watson Research
                  postal:     Schagen 33
                              3461 GL Linschoten
                              Netherlands
                  email:      wijnen@vnet.ibm.com
                  phone:      +31-348-432-794

                  Co-editor:  Randy Presuhn
                              BMC Software, Inc
                  postal:     965 Stewart Drive
                              Sunnyvale, CA 94086
                              USA
                  email:      randy_presuhn@bmc.com
                  phone:      +1-408-616-3100

                  Co-editor:  Keith McCloghrie
                              Cisco Systems, Inc.
                  postal:     170 West Tasman Drive
                              San Jose, CA  95134-1706
                              USA
                  email:      kzm@cisco.com
                  phone:      +1-408-526-5260
                 &quot;
    DESCRIPTION  &quot;The management information definitions for the
                  View-based Access Control Model for SNMP.
                 &quot;
--  Revision history
    REVISION     &quot;9901200000Z&quot;            -- 20 Jan 1999, midnight
    DESCRIPTION  &quot;Clarifications, published as <a href="/doc/html/rfc2575">RFC2575</a>&quot;

    REVISION     &quot;9711200000Z&quot;            -- 20 Nov 1997, midnight
    DESCRIPTION  &quot;Initial version, published as <a href="/doc/html/rfc2275">RFC2275</a>&quot;

    ::= { snmpModules 16 }

-- Administrative assignments ****************************************

vacmMIBObjects      OBJECT IDENTIFIER ::= { snmpVacmMIB 1 }
vacmMIBConformance  OBJECT IDENTIFIER ::= { snmpVacmMIB 2 }



<span class="grey">Wijnen, et al.              Standards Track                    [Page 11]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-12" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


-- Information about Local Contexts **********************************

vacmContextTable OBJECT-TYPE
    SYNTAX       SEQUENCE OF VacmContextEntry
    MAX-ACCESS   not-accessible
    STATUS       current
    DESCRIPTION &quot;The table of locally available contexts.

                 This table provides information to SNMP Command
                 Generator applications so that they can properly
                 configure the vacmAccessTable to control access to
                 all contexts at the SNMP entity.

                 This table may change dynamically if the SNMP entity
                 allows that contexts are added/deleted dynamically
                 (for instance when its configuration changes). Such
                 changes would happen only if the management
                 instrumentation at that SNMP entity recognizes more
                 (or fewer) contexts.

                 The presence of entries in this table and of entries
                 in the vacmAccessTable are independent.  That is, a
                 context identified by an entry in this table is not
                 necessarily referenced by any entries in the
                 vacmAccessTable; and the context(s) referenced by an
                 entry in the vacmAccessTable does not necessarily
                 currently exist and thus need not be identified by an
                 entry in this table.

                 This table must be made accessible via the default
                 context so that Command Responder applications have
                 a standard way of retrieving the information.

                 This table is read-only. It cannot be configured via
                 SNMP.
                &quot;
    ::= { vacmMIBObjects 1 }

vacmContextEntry OBJECT-TYPE
    SYNTAX       VacmContextEntry
    MAX-ACCESS   not-accessible
    STATUS       current
    DESCRIPTION &quot;Information about a particular context.&quot;
    INDEX       {
                  vacmContextName
                }
    ::= { vacmContextTable 1 }




<span class="grey">Wijnen, et al.              Standards Track                    [Page 12]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-13" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


VacmContextEntry ::= SEQUENCE
    {
        vacmContextName SnmpAdminString
    }

vacmContextName  OBJECT-TYPE
    SYNTAX       SnmpAdminString (SIZE(0..32))
    MAX-ACCESS   read-only
    STATUS       current
    DESCRIPTION &quot;A human readable name identifying a particular
                 context at a particular SNMP entity.

                 The empty contextName (zero length) represents the
                 default context.
                &quot;
    ::= { vacmContextEntry 1 }

-- Information about Groups ******************************************

vacmSecurityToGroupTable OBJECT-TYPE
    SYNTAX       SEQUENCE OF VacmSecurityToGroupEntry
    MAX-ACCESS   not-accessible
    STATUS       current
    DESCRIPTION &quot;This table maps a combination of securityModel and
                 securityName into a groupName which is used to define
                 an access control policy for a group of principals.
                &quot;
    ::= { vacmMIBObjects 2 }

vacmSecurityToGroupEntry OBJECT-TYPE
    SYNTAX       VacmSecurityToGroupEntry
    MAX-ACCESS   not-accessible
    STATUS       current
    DESCRIPTION &quot;An entry in this table maps the combination of a
                 securityModel and securityName into a groupName.
                &quot;
    INDEX       {
                  vacmSecurityModel,
                  vacmSecurityName
                }
    ::= { vacmSecurityToGroupTable 1 }

VacmSecurityToGroupEntry ::= SEQUENCE
    {
        vacmSecurityModel               SnmpSecurityModel,
        vacmSecurityName                SnmpAdminString,
        vacmGroupName                   SnmpAdminString,
        vacmSecurityToGroupStorageType  StorageType,



<span class="grey">Wijnen, et al.              Standards Track                    [Page 13]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-14" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


        vacmSecurityToGroupStatus       RowStatus
    }

vacmSecurityModel OBJECT-TYPE
    SYNTAX       SnmpSecurityModel(1..2147483647)
    MAX-ACCESS   not-accessible
    STATUS       current
    DESCRIPTION &quot;The Security Model, by which the vacmSecurityName
                 referenced by this entry is provided.

                 Note, this object may not take the &#x27;any&#x27; (0) value.
                &quot;
    ::= { vacmSecurityToGroupEntry 1 }

vacmSecurityName OBJECT-TYPE
    SYNTAX       SnmpAdminString (SIZE(1..32))
    MAX-ACCESS   not-accessible
    STATUS       current
    DESCRIPTION &quot;The securityName for the principal, represented in a
                 Security Model independent format, which is mapped by
                 this entry to a groupName.
                &quot;
    ::= { vacmSecurityToGroupEntry 2 }

vacmGroupName    OBJECT-TYPE
    SYNTAX       SnmpAdminString (SIZE(1..32))
    MAX-ACCESS   read-create
    STATUS       current
    DESCRIPTION &quot;The name of the group to which this entry (e.g., the
                 combination of securityModel and securityName)
                 belongs.

                 This groupName is used as index into the
                 vacmAccessTable to select an access control policy.
                 However, a value in this table does not imply that an
                 instance with the value exists in table vacmAccesTable.
                &quot;
    ::= { vacmSecurityToGroupEntry 3 }

vacmSecurityToGroupStorageType OBJECT-TYPE
    SYNTAX       StorageType
    MAX-ACCESS   read-create
    STATUS       current
    DESCRIPTION &quot;The storage type for this conceptual row.
                 Conceptual rows having the value &#x27;permanent&#x27; need not
                 allow write-access to any columnar objects in the row.
                &quot;
    DEFVAL      { nonVolatile }



<span class="grey">Wijnen, et al.              Standards Track                    [Page 14]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-15" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


    ::= { vacmSecurityToGroupEntry 4 }

vacmSecurityToGroupStatus OBJECT-TYPE
    SYNTAX       RowStatus
    MAX-ACCESS   read-create
    STATUS       current
    DESCRIPTION &quot;The status of this conceptual row.

                 Until instances of all corresponding columns are
                 appropriately configured, the value of the
                 corresponding instance of the vacmSecurityToGroupStatus
                 column is &#x27;notReady&#x27;.

                 In particular, a newly created row cannot be made
                 active until a value has been set for vacmGroupName.

                 The  RowStatus TC [<a href="/doc/html/rfc2579" title="&quot;Textual Conventions for SMIv2&quot;">RFC2579</a>] requires that this
                 DESCRIPTION clause states under which circumstances
                 other objects in this row can be modified:

                 The value of this object has no effect on whether
                 other objects in this conceptual row can be modified.
                &quot;
    ::= { vacmSecurityToGroupEntry 5 }

-- Information about Access Rights ***********************************

vacmAccessTable  OBJECT-TYPE
    SYNTAX       SEQUENCE OF VacmAccessEntry
    MAX-ACCESS   not-accessible
    STATUS       current
    DESCRIPTION &quot;The table of access rights for groups.

                 Each entry is indexed by a groupName, a contextPrefix,
                 a securityModel and a securityLevel.  To determine
                 whether access is allowed, one entry from this table
                 needs to be selected and the proper viewName from that
                 entry must be used for access control checking.

                 To select the proper entry, follow these steps:

                 1) the set of possible matches is formed by the
                    intersection of the following sets of entries:
                      the set of entries with identical vacmGroupName
                      the union of these two sets:
                       - the set with identical vacmAccessContextPrefix
                       - the set of entries with vacmAccessContextMatch
                         value of &#x27;prefix&#x27; and matching



<span class="grey">Wijnen, et al.              Standards Track                    [Page 15]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-16" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


                         vacmAccessContextPrefix
                      intersected with the union of these two sets:
                       - the set of entries with identical
                         vacmSecurityModel
                       - the set of entries with vacmSecurityModel
                         value of &#x27;any&#x27;
                      intersected with the set of entries with
                      vacmAccessSecurityLevel value less than or equal
                      to the requested securityLevel

                 2) if this set has only one member, we&#x27;re done
                    otherwise, it comes down to deciding how to weight
                    the preferences between ContextPrefixes,
                    SecurityModels, and SecurityLevels as follows:
                    a) if the subset of entries with securityModel
                       matching the securityModel in the message is
                       not empty, then discard the rest.
                    b) if the subset of entries with
                       vacmAccessContextPrefix matching the contextName
                       in the message is not empty,
                       then discard the rest
                    c) discard all entries with ContextPrefixes shorter
                       than the longest one remaining in the set
                    d) select the entry with the highest securityLevel

                 Please note that for securityLevel noAuthNoPriv, all
                 groups are really equivalent since the assumption that
                 the securityName has been authenticated does not hold.
                &quot;
    ::= { vacmMIBObjects 4 }

vacmAccessEntry  OBJECT-TYPE
    SYNTAX       VacmAccessEntry
    MAX-ACCESS   not-accessible
    STATUS       current
    DESCRIPTION &quot;An access right configured in the Local Configuration
                 Datastore (LCD) authorizing access to an SNMP context.

                 Entries in this table can use an instance value for
                 object vacmGroupName even if no entry in table
                 vacmAccessSecurityToGroupTable has a corresponding
                 value for object vacmGroupName.
                &quot;
    INDEX       { vacmGroupName,
                  vacmAccessContextPrefix,
                  vacmAccessSecurityModel,
                  vacmAccessSecurityLevel
                }



<span class="grey">Wijnen, et al.              Standards Track                    [Page 16]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-17" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


    ::= { vacmAccessTable 1 }

VacmAccessEntry ::= SEQUENCE
    {
        vacmAccessContextPrefix    SnmpAdminString,
        vacmAccessSecurityModel    SnmpSecurityModel,
        vacmAccessSecurityLevel    SnmpSecurityLevel,
        vacmAccessContextMatch     INTEGER,
        vacmAccessReadViewName     SnmpAdminString,
        vacmAccessWriteViewName    SnmpAdminString,
        vacmAccessNotifyViewName   SnmpAdminString,
        vacmAccessStorageType      StorageType,
        vacmAccessStatus           RowStatus
    }

vacmAccessContextPrefix OBJECT-TYPE
    SYNTAX       SnmpAdminString (SIZE(0..32))
    MAX-ACCESS   not-accessible
    STATUS       current
    DESCRIPTION &quot;In order to gain the access rights allowed by this
                 conceptual row, a contextName must match exactly
                 (if the value of vacmAccessContextMatch is &#x27;exact&#x27;)
                 or partially (if the value of vacmAccessContextMatch
                 is &#x27;prefix&#x27;) to the value of the instance of this
                 object.
                &quot;
    ::= { vacmAccessEntry 1 }

vacmAccessSecurityModel OBJECT-TYPE
    SYNTAX       SnmpSecurityModel
    MAX-ACCESS   not-accessible
    STATUS       current
    DESCRIPTION &quot;In order to gain the access rights allowed by this
                 conceptual row, this securityModel must be in use.
                &quot;
    ::= { vacmAccessEntry 2 }

vacmAccessSecurityLevel OBJECT-TYPE
    SYNTAX       SnmpSecurityLevel
    MAX-ACCESS   not-accessible
    STATUS       current
    DESCRIPTION &quot;The minimum level of security required in order to
                 gain the access rights allowed by this conceptual
                 row.  A securityLevel of noAuthNoPriv is less than
                 authNoPriv which in turn is less than authPriv.

                 If multiple entries are equally indexed except for
                 this vacmAccessSecurityLevel index, then the entry



<span class="grey">Wijnen, et al.              Standards Track                    [Page 17]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-18" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


                 which has the highest value for
                 vacmAccessSecurityLevel is selected.
                &quot;
    ::= { vacmAccessEntry 3 }

vacmAccessContextMatch OBJECT-TYPE
    SYNTAX       INTEGER
                { exact (1), -- exact match of prefix and contextName
                  prefix (2) -- Only match to the prefix
                }
    MAX-ACCESS   read-create
    STATUS       current
    DESCRIPTION &quot;If the value of this object is exact(1), then all
                 rows where the contextName exactly matches
                 vacmAccessContextPrefix are selected.

                 If the value of this object is prefix(2), then all
                 rows where the contextName whose starting octets
                 exactly match vacmAccessContextPrefix are selected.
                 This allows for a simple form of wildcarding.
                &quot;
    DEFVAL      { exact }
    ::= { vacmAccessEntry 4 }

vacmAccessReadViewName OBJECT-TYPE
    SYNTAX       SnmpAdminString (SIZE(0..32))
    MAX-ACCESS   read-create
    STATUS       current
    DESCRIPTION &quot;The value of an instance of this object identifies
                 the MIB view of the SNMP context to which this
                 conceptual row authorizes read access.

                 The identified MIB view is that one for which the
                 vacmViewTreeFamilyViewName has the same value as the
                 instance of this object; if the value is the empty
                 string or if there is no active MIB view having this
                 value of vacmViewTreeFamilyViewName, then no access
                 is granted.
                &quot;
    DEFVAL      { &#x27;&#x27;H }   -- the empty string
    ::= { vacmAccessEntry 5 }

vacmAccessWriteViewName OBJECT-TYPE
    SYNTAX       SnmpAdminString (SIZE(0..32))
    MAX-ACCESS   read-create
    STATUS       current
    DESCRIPTION &quot;The value of an instance of this object identifies
                 the MIB view of the SNMP context to which this



<span class="grey">Wijnen, et al.              Standards Track                    [Page 18]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-19" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


                 conceptual row authorizes write access.

                 The identified MIB view is that one for which the
                 vacmViewTreeFamilyViewName has the same value as the
                 instance of this object; if the value is the empty
                 string or if there is no active MIB view having this
                 value of vacmViewTreeFamilyViewName, then no access
                 is granted.
                &quot;
    DEFVAL      { &#x27;&#x27;H }   -- the empty string
    ::= { vacmAccessEntry 6 }

vacmAccessNotifyViewName OBJECT-TYPE
    SYNTAX       SnmpAdminString (SIZE(0..32))
    MAX-ACCESS   read-create
    STATUS       current
    DESCRIPTION &quot;The value of an instance of this object identifies
                 the MIB view of the SNMP context to which this
                 conceptual row authorizes access for notifications.

                 The identified MIB view is that one for which the
                 vacmViewTreeFamilyViewName has the same value as the
                 instance of this object; if the value is the empty
                 string or if there is no active MIB view having this
                 value of vacmViewTreeFamilyViewName, then no access
                 is granted.
                &quot;
    DEFVAL      { &#x27;&#x27;H }   -- the empty string
    ::= { vacmAccessEntry 7 }

vacmAccessStorageType OBJECT-TYPE
    SYNTAX       StorageType
    MAX-ACCESS   read-create
    STATUS       current
    DESCRIPTION &quot;The storage type for this conceptual row.

                 Conceptual rows having the value &#x27;permanent&#x27; need not
                 allow write-access to any columnar objects in the row.
                &quot;
    DEFVAL      { nonVolatile }
    ::= { vacmAccessEntry 8 }

vacmAccessStatus OBJECT-TYPE
    SYNTAX       RowStatus
    MAX-ACCESS   read-create
    STATUS       current
    DESCRIPTION &quot;The status of this conceptual row.




<span class="grey">Wijnen, et al.              Standards Track                    [Page 19]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-20" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


                 The  RowStatus TC [<a href="/doc/html/rfc2579" title="&quot;Textual Conventions for SMIv2&quot;">RFC2579</a>] requires that this
                 DESCRIPTION clause states under which circumstances
                 other objects in this row can be modified:

                 The value of this object has no effect on whether
                 other objects in this conceptual row can be modified.
                &quot;
    ::= { vacmAccessEntry 9 }

-- Information about MIB views ***************************************

-- Support for instance-level granularity is optional.
--
-- In some implementations, instance-level access control
-- granularity may come at a high performance cost.  Managers
-- should avoid requesting such configurations unnecessarily.

vacmMIBViews     OBJECT IDENTIFIER ::= { vacmMIBObjects 5 }

vacmViewSpinLock OBJECT-TYPE
    SYNTAX       TestAndIncr
    MAX-ACCESS   read-write
    STATUS       current
    DESCRIPTION &quot;An advisory lock used to allow cooperating SNMP
                 Command Generator applications to coordinate their
                 use of the Set operation in creating or modifying
                 views.

                 When creating a new view or altering an existing
                 view, it is important to understand the potential
                 interactions with other uses of the view.  The
                 vacmViewSpinLock should be retrieved.  The name of
                 the view to be created should be determined to be
                 unique by the SNMP Command Generator application by
                 consulting the vacmViewTreeFamilyTable.  Finally,
                 the named view may be created (Set), including the
                 advisory lock.
                 If another SNMP Command Generator application has
                 altered the views in the meantime, then the spin
                 lock&#x27;s value will have changed, and so this creation
                 will fail because it will specify the wrong value for
                 the spin lock.

                 Since this is an advisory lock, the use of this lock
                 is not enforced.
                &quot;
    ::= { vacmMIBViews 1 }




<span class="grey">Wijnen, et al.              Standards Track                    [Page 20]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-21" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


vacmViewTreeFamilyTable OBJECT-TYPE
    SYNTAX       SEQUENCE OF VacmViewTreeFamilyEntry
    MAX-ACCESS   not-accessible
    STATUS       current
    DESCRIPTION &quot;Locally held information about families of subtrees
                 within MIB views.

                 Each MIB view is defined by two sets of view subtrees:
                   - the included view subtrees, and
                   - the excluded view subtrees.
                 Every such view subtree, both the included and the
                 excluded ones, is defined in this table.

                 To determine if a particular object instance is in
                 a particular MIB view, compare the object instance&#x27;s
                 OBJECT IDENTIFIER with each of the MIB view&#x27;s active
                 entries in this table.  If none match, then the
                 object instance is not in the MIB view.  If one or
                 more match, then the object instance is included in,
                 or excluded from, the MIB view according to the
                 value of vacmViewTreeFamilyType in the entry whose
                 value of vacmViewTreeFamilySubtree has the most
                 sub-identifiers.  If multiple entries match and have
                 the same number of sub-identifiers (when wildcarding
                 is specified with the value of vacmViewTreeFamilyMask),
                 then the lexicographically greatest instance of
                 vacmViewTreeFamilyType determines the inclusion or
                 exclusion.

                 An object instance&#x27;s OBJECT IDENTIFIER X matches an
                 active entry in this table when the number of
                 sub-identifiers in X is at least as many as in the
                 value of vacmViewTreeFamilySubtree for the entry,
                 and each sub-identifier in the value of
                 vacmViewTreeFamilySubtree matches its corresponding
                 sub-identifier in X.  Two sub-identifiers match
                 either if the corresponding bit of the value of
                 vacmViewTreeFamilyMask for the entry is zero (the
                 &#x27;wild card&#x27; value), or if they are equal.

                 A &#x27;family&#x27; of subtrees is the set of subtrees defined
                 by a particular combination of values of
                 vacmViewTreeFamilySubtree and vacmViewTreeFamilyMask.
                 In the case where no &#x27;wild card&#x27; is defined in the
                 vacmViewTreeFamilyMask, the family of subtrees reduces
                 to a single subtree.

                 When creating or changing MIB views, an SNMP Command



<span class="grey">Wijnen, et al.              Standards Track                    [Page 21]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-22" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


                 Generator application should utilize the
                 vacmViewSpinLock to try to avoid collisions. See
                 DESCRIPTION clause of vacmViewSpinLock.

                 When creating MIB views, it is strongly advised that
                 first the &#x27;excluded&#x27; vacmViewTreeFamilyEntries are
                 created and then the &#x27;included&#x27; entries.

                 When deleting MIB views, it is strongly advised that
                 first the &#x27;included&#x27; vacmViewTreeFamilyEntries are
                 deleted and then the &#x27;excluded&#x27; entries.

                 If a create for an entry for instance-level access
                 control is received and the implementation does not
                 support instance-level granularity, then an
                 inconsistentName error must be returned.
                &quot;
    ::= { vacmMIBViews 2 }

vacmViewTreeFamilyEntry OBJECT-TYPE
    SYNTAX       VacmViewTreeFamilyEntry
    MAX-ACCESS   not-accessible
    STATUS       current
    DESCRIPTION &quot;Information on a particular family of view subtrees
                 included in or excluded from a particular SNMP
                 context&#x27;s MIB view.

                 Implementations must not restrict the number of
                 families of view subtrees for a given MIB view,
                 except as dictated by resource constraints on the
                 overall number of entries in the
                 vacmViewTreeFamilyTable.

                 If no conceptual rows exist in this table for a given
                 MIB view (viewName), that view may be thought of as
                 consisting of the empty set of view subtrees.
                &quot;
    INDEX       { vacmViewTreeFamilyViewName,
                  vacmViewTreeFamilySubtree
                }
    ::= { vacmViewTreeFamilyTable 1 }

VacmViewTreeFamilyEntry ::= SEQUENCE
    {
        vacmViewTreeFamilyViewName     SnmpAdminString,
        vacmViewTreeFamilySubtree      OBJECT IDENTIFIER,
        vacmViewTreeFamilyMask         OCTET STRING,
        vacmViewTreeFamilyType         INTEGER,



<span class="grey">Wijnen, et al.              Standards Track                    [Page 22]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-23" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


        vacmViewTreeFamilyStorageType  StorageType,
        vacmViewTreeFamilyStatus       RowStatus
    }

vacmViewTreeFamilyViewName OBJECT-TYPE
    SYNTAX       SnmpAdminString (SIZE(1..32))
    MAX-ACCESS   not-accessible
    STATUS       current
    DESCRIPTION &quot;The human readable name for a family of view subtrees.
                &quot;
    ::= { vacmViewTreeFamilyEntry 1 }

vacmViewTreeFamilySubtree OBJECT-TYPE
    SYNTAX       OBJECT IDENTIFIER
    MAX-ACCESS   not-accessible
    STATUS       current
    DESCRIPTION &quot;The MIB subtree which when combined with the
                 corresponding instance of vacmViewTreeFamilyMask
                 defines a family of view subtrees.
                &quot;
    ::= { vacmViewTreeFamilyEntry 2 }

vacmViewTreeFamilyMask OBJECT-TYPE
    SYNTAX       OCTET STRING (SIZE (0..16))
    MAX-ACCESS   read-create
    STATUS       current
    DESCRIPTION &quot;The bit mask which, in combination with the
                 corresponding instance of vacmViewTreeFamilySubtree,
                 defines a family of view subtrees.

                 Each bit of this bit mask corresponds to a
                 sub-identifier of vacmViewTreeFamilySubtree, with the
                 most significant bit of the i-th octet of this octet
                 string value (extended if necessary, see below)
                 corresponding to the (8*i - 7)-th sub-identifier, and
                 the least significant bit of the i-th octet of this
                 octet string corresponding to the (8*i)-th
                 sub-identifier, where i is in the range 1 through 16.

                 Each bit of this bit mask specifies whether or not
                 the corresponding sub-identifiers must match when
                 determining if an OBJECT IDENTIFIER is in this
                 family of view subtrees; a &#x27;1&#x27; indicates that an
                 exact match must occur; a &#x27;0&#x27; indicates &#x27;wild card&#x27;,
                 i.e., any sub-identifier value matches.

                 Thus, the OBJECT IDENTIFIER X of an object instance
                 is contained in a family of view subtrees if, for



<span class="grey">Wijnen, et al.              Standards Track                    [Page 23]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-24" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


                 each sub-identifier of the value of
                 vacmViewTreeFamilySubtree, either:

                   the i-th bit of vacmViewTreeFamilyMask is 0, or

                   the i-th sub-identifier of X is equal to the i-th
                   sub-identifier of the value of
                   vacmViewTreeFamilySubtree.

                 If the value of this bit mask is M bits long and
                 there are more than M sub-identifiers in the
                 corresponding instance of vacmViewTreeFamilySubtree,
                 then the bit mask is extended with 1&#x27;s to be the
                 required length.

                 Note that when the value of this object is the
                 zero-length string, this extension rule results in
                 a mask of all-1&#x27;s being used (i.e., no &#x27;wild card&#x27;),
                 and the family of view subtrees is the one view
                 subtree uniquely identified by the corresponding
                 instance of vacmViewTreeFamilySubtree.

                 Note that masks of length greater than zero length
                 do not need to be supported. In this case this
                 object is made read-only.
                &quot;
    DEFVAL      { &#x27;&#x27;H }
    ::= { vacmViewTreeFamilyEntry 3 }

vacmViewTreeFamilyType OBJECT-TYPE
    SYNTAX       INTEGER  { included(1), excluded(2) }
    MAX-ACCESS   read-create
    STATUS       current
    DESCRIPTION &quot;Indicates whether the corresponding instances of
                 vacmViewTreeFamilySubtree and vacmViewTreeFamilyMask
                 define a family of view subtrees which is included in
                 or excluded from the MIB view.
                &quot;
    DEFVAL      { included }
    ::= { vacmViewTreeFamilyEntry 4 }

vacmViewTreeFamilyStorageType OBJECT-TYPE
    SYNTAX       StorageType
    MAX-ACCESS   read-create
    STATUS       current
    DESCRIPTION &quot;The storage type for this conceptual row.

                 Conceptual rows having the value &#x27;permanent&#x27; need not



<span class="grey">Wijnen, et al.              Standards Track                    [Page 24]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-25" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


                 allow write-access to any columnar objects in the row.
                &quot;
    DEFVAL      { nonVolatile }
    ::= { vacmViewTreeFamilyEntry 5 }

vacmViewTreeFamilyStatus OBJECT-TYPE
    SYNTAX       RowStatus
    MAX-ACCESS   read-create
    STATUS       current
    DESCRIPTION &quot;The status of this conceptual row.

                 The  RowStatus TC [<a href="/doc/html/rfc2579" title="&quot;Textual Conventions for SMIv2&quot;">RFC2579</a>] requires that this
                 DESCRIPTION clause states under which circumstances
                 other objects in this row can be modified:

                 The value of this object has no effect on whether
                 other objects in this conceptual row can be modified.
                &quot;
    ::= { vacmViewTreeFamilyEntry 6 }

-- Conformance information *******************************************

vacmMIBCompliances  OBJECT IDENTIFIER ::= { vacmMIBConformance 1 }
vacmMIBGroups       OBJECT IDENTIFIER ::= { vacmMIBConformance 2 }

-- Compliance statements *********************************************

vacmMIBCompliance MODULE-COMPLIANCE
    STATUS       current
    DESCRIPTION &quot;The compliance statement for SNMP engines which
                 implement the SNMP View-based Access Control Model
                 configuration MIB.
                &quot;
    MODULE -- this module
        MANDATORY-GROUPS { vacmBasicGroup }

        OBJECT        vacmAccessContextMatch
        MIN-ACCESS    read-only
        DESCRIPTION  &quot;Write access is not required.&quot;

        OBJECT        vacmAccessReadViewName
        MIN-ACCESS    read-only
        DESCRIPTION  &quot;Write access is not required.&quot;

        OBJECT        vacmAccessWriteViewName
        MIN-ACCESS    read-only
        DESCRIPTION  &quot;Write access is not required.&quot;




<span class="grey">Wijnen, et al.              Standards Track                    [Page 25]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-26" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


        OBJECT        vacmAccessNotifyViewName
        MIN-ACCESS    read-only
        DESCRIPTION  &quot;Write access is not required.&quot;

        OBJECT        vacmAccessStorageType
        MIN-ACCESS    read-only
        DESCRIPTION  &quot;Write access is not required.&quot;

        OBJECT        vacmAccessStatus
        MIN-ACCESS    read-only
        DESCRIPTION  &quot;Create/delete/modify access to the
                      vacmAccessTable is not required.
                     &quot;

        OBJECT        vacmViewTreeFamilyMask
        WRITE-SYNTAX  OCTET STRING (SIZE (0))
        MIN-ACCESS    read-only
        DESCRIPTION  &quot;Support for configuration via SNMP of subtree
                      families using wild-cards is not required.
                     &quot;

        OBJECT        vacmViewTreeFamilyType
        MIN-ACCESS    read-only
        DESCRIPTION  &quot;Write access is not required.&quot;

        OBJECT        vacmViewTreeFamilyStorageType
        MIN-ACCESS    read-only
        DESCRIPTION  &quot;Write access is not required.&quot;

        OBJECT        vacmViewTreeFamilyStatus
        MIN-ACCESS    read-only
        DESCRIPTION  &quot;Create/delete/modify access to the
                      vacmViewTreeFamilyTable is not required.
                     &quot;
    ::= { vacmMIBCompliances 1 }

-- Units of conformance **********************************************

vacmBasicGroup OBJECT-GROUP
    OBJECTS {
              vacmContextName,
              vacmGroupName,
              vacmSecurityToGroupStorageType,
              vacmSecurityToGroupStatus,
              vacmAccessContextMatch,
              vacmAccessReadViewName,
              vacmAccessWriteViewName,
              vacmAccessNotifyViewName,



<span class="grey">Wijnen, et al.              Standards Track                    [Page 26]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-27" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


              vacmAccessStorageType,
              vacmAccessStatus,
              vacmViewSpinLock,
              vacmViewTreeFamilyMask,
              vacmViewTreeFamilyType,
              vacmViewTreeFamilyStorageType,
              vacmViewTreeFamilyStatus
            }
    STATUS       current
    DESCRIPTION &quot;A collection of objects providing for remote
                 configuration of an SNMP engine which implements
                 the SNMP View-based Access Control Model.
                &quot;
    ::= { vacmMIBGroups 1 }

END

<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>.  Intellectual Property</span>

   The IETF takes no position regarding the validity or scope of any
   intellectual property or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; neither does it represent that it
   has made any effort to identify any such rights.  Information on the
   IETF&#x27;s procedures with respect to rights in standards-track and
   standards-related documentation can be found in <a href="/doc/html/bcp11">BCP-11</a>.  Copies of
   claims of rights made available for publication and any assurances of
   licenses to be made available, or the result of an attempt made to
   obtain a general license or permission for the use of such
   proprietary rights by implementors or users of this specification can
   be obtained from the IETF Secretariat.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights which may cover technology that may be required to practice
   this standard.  Please address the information to the IETF Executive
   Director.













<span class="grey">Wijnen, et al.              Standards Track                    [Page 27]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-28" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


<span class="h2"><a class="selflink" id="section-6" href="#section-6">6</a>.  Acknowledgements</span>

   This document is the result of the efforts of the SNMPv3 Working
   Group.  Some special thanks are in order to the following SNMPv3 WG
   members:

   Harald Tveit Alvestrand (Maxware)
   Dave Battle (SNMP Research, Inc.)
   Alan Beard (Disney Worldwide Services)
   Paul Berrevoets (SWI Systemware/Halcyon Inc.)
   Martin Bjorklund (Ericsson)
   Uri Blumenthal (IBM T.J. Watson Research Center)
   Jeff Case (SNMP Research, Inc.)
   John Curran (BBN)
   Mike Daniele (Compaq Computer Corporation)
   T. Max Devlin (Eltrax Systems)
   John Flick (Hewlett Packard)
   Rob Frye (MCI)
   Wes Hardaker (U.C.Davis, Information Technology - D.C.A.S.)
   David Harrington (Cabletron Systems Inc.)
   Lauren Heintz (BMC Software, Inc.)
   N.C. Hien (IBM T.J. Watson Research Center)
   Michael Kirkham (InterWorking Labs, Inc.)
   Dave Levi (SNMP Research, Inc.)
   Louis A Mamakos (UUNET Technologies Inc.)
   Joe Marzot (Nortel Networks)
   Paul Meyer (Secure Computing Corporation)
   Keith McCloghrie (Cisco Systems)
   Bob Moore (IBM)
   Russ Mundy (TIS Labs at Network Associates)
   Bob Natale (ACE*COMM Corporation)
   Mike O&#x27;Dell (UUNET Technologies Inc.)
   Dave Perkins (DeskTalk)
   Peter Polkinghorne (Brunel University)
   Randy Presuhn (BMC Software, Inc.)
   David Reeder (TIS Labs at Network Associates)
   David Reid (SNMP Research, Inc.)
   Aleksey Romanov (Quality Quorum)
   Shawn Routhier (Epilogue)
   Juergen Schoenwaelder (TU Braunschweig)
   Bob Stewart (Cisco Systems)
   Mike Thatcher (Independent Consultant)
   Bert Wijnen (IBM T.J. Watson Research Center)








<span class="grey">Wijnen, et al.              Standards Track                    [Page 28]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-29" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


   The document is based on recommendations of the IETF Security and
   Administrative Framework Evolution for SNMP Advisory Team.  Members
   of that Advisory Team were:

   David Harrington (Cabletron Systems Inc.)
   Jeff Johnson (Cisco Systems)
   David Levi (SNMP Research Inc.)
   John Linn (Openvision)
   Russ Mundy (Trusted Information Systems) chair
   Shawn Routhier (Epilogue)
   Glenn Waters (Nortel)
   Bert Wijnen (IBM T. J. Watson Research Center)

   As recommended by the Advisory Team and the SNMPv3 Working Group
   Charter, the design incorporates as much as practical from previous
   RFCs and drafts. As a result, special thanks are due to the authors
   of previous designs known as SNMPv2u and SNMPv2*:

   Jeff Case (SNMP Research, Inc.)
   David Harrington (Cabletron Systems Inc.)
   David Levi (SNMP Research, Inc.)
   Keith McCloghrie (Cisco Systems)
   Brian O&#x27;Keefe (Hewlett Packard)
   Marshall T. Rose (Dover Beach Consulting)
   Jon Saperia (BGS Systems Inc.)
   Steve Waldbusser (International Network Services)
   Glenn W. Waters (Bell-Northern Research Ltd.)

<span class="h2"><a class="selflink" id="section-7" href="#section-7">7</a>.  Security Considerations</span>

<span class="h3"><a class="selflink" id="section-7.1" href="#section-7.1">7.1</a>.  Recommended Practices</span>

   This document is meant for use in the SNMP architecture.  The View-
   based Access Control Model described in this document checks access
   rights to management information based on:

   - contextName, representing a set of management information at the
     managed system where the Access Control module is running.
   - groupName, representing a set of zero or more securityNames.
     The combination of a securityModel and a securityName is mapped
     into a group in the View-based Access Control Model.
   - securityModel under which access is requested.
   - securityLevel under which access is requested.
   - operation performed on the management information.
   - MIB views for read, write or notify access.






<span class="grey">Wijnen, et al.              Standards Track                    [Page 29]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-30" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


   When the User-based Access Control module is called for checking
   access rights, it is assumed that the calling module has ensured the
   authentication and privacy aspects as specified by the securityLevel
   that is being passed.

   When creating entries in or deleting entries from the
   vacmViewTreeFamilyTable it is important to do such in the sequence as
   recommended in the DESCRIPTION clause of the vacmViewTreeFamilyTable
   definition. Otherwise unwanted access may be granted while changing
   the entries in the table.

<span class="h3"><a class="selflink" id="section-7.2" href="#section-7.2">7.2</a>.  Defining Groups</span>

   The groupNames are used to give access to a group of zero or more
   securityNames.  Within the View-Based Access Control Model, a
   groupName is considered to exist if that groupName is listed in the
   vacmSecurityToGroupTable.

   By mapping the combination of a securityModel and securityName into a
   groupName, an SNMP Command Generator application can add/delete
   securityNames to/from a group, if proper access is allowed.

   Further it is important to realize that the grouping of
   &lt;securityModel, securityName&gt; tuples in the vacmSecurityToGroupTable
   does not take securityLevel into account. It is therefore important
   that the security administrator uses the securityLevel index in the
   vacmAccessTable to separate noAuthNoPriv from authPriv and/or
   authNoPriv access.

<span class="h3"><a class="selflink" id="section-7.3" href="#section-7.3">7.3</a>.  Conformance</span>

   For an implementation of the View-based Access Control Model to be
   conformant, it MUST implement the SNMP-VIEW-BASED-ACM-MIB according
   to the vacmMIBCompliance.  It also SHOULD implement the initial
   configuration, described in <a href="#appendix-A">appendix A</a>.

<span class="h3"><a class="selflink" id="section-7.4" href="#section-7.4">7.4</a>.  Access to the SNMP-VIEW-BASED-ACM-MIB</span>

   The objects in this MIB control the access to all MIB data that is
   accessible via the SNMP engine and they may be considered sensitive
   in many environments.  It is important to closely control (both read
   and write) access to these to these MIB objects by using
   appropriately configured Access Control models (for example the
   View-based Access Control Model as specified in this document).







<span class="grey">Wijnen, et al.              Standards Track                    [Page 30]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-31" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


<span class="h2"><a class="selflink" id="section-8" href="#section-8">8</a>.  References</span>

   [<a id="ref-RFC2578">RFC2578</a>]   McCloghrie, K., Perkins, D. and J. Schoenwaelder,
               &quot;Structure of Management Information Version 2 (SMIv2)&quot;,
               STD 58, <a href="/doc/html/rfc2578">RFC 2578</a>, April 1999.

   [<a id="ref-RFC2579">RFC2579</a>]   McCloghrie, K., Perkins, D. and J. Schoenwaelder,
               &quot;Textual Conventions for SMIv2&quot;, STD 58, <a href="/doc/html/rfc2579">RFC 2579</a>, April
               1999.

   [<a id="ref-RFC2119">RFC2119</a>]   Bradner, S., &quot;Key words for use in RFCs to Indicate
               Requirement Levels&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc2119">RFC 2119</a>, March 1997.

   [<a id="ref-RFC2571">RFC2571</a>]   Harrington, D., Presuhn, R. and B. Wijnen, &quot;An
               Architecture for describing SNMP Management Frameworks&quot;,
               <a href="/doc/html/rfc2571">RFC 2571</a>, April 1999.

   [<a id="ref-RFC2572">RFC2572</a>]   Case, J., Harrington, D., Presuhn, R. and B. Wijnen,
               &quot;Message Processing and Dispatching for the Simple
               Network Management Protocol (SNMP)&quot;, <a href="/doc/html/rfc2572">RFC 2572</a>, April
               1999.

   [<a id="ref-RFC2574">RFC2574</a>]   Blumenthal, U. and B. Wijnen, &quot;User-based Security Model
               (USM) for version 3 of the Simple Network Management
               Protocol (SNMPv3)&quot;, <a href="/doc/html/rfc2574">RFC 2574</a>, April 1999.

   [<a id="ref-ISO-ASN.1">ISO-ASN.1</a>] Information processing systems - Open Systems
               Interconnection - Specification of Abstract Syntax
               Notation One (ASN.1), International Organization for
               Standardization.  International Standard 8824, (December,
               1987).




















<span class="grey">Wijnen, et al.              Standards Track                    [Page 31]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-32" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


<span class="h2"><a class="selflink" id="section-9" href="#section-9">9</a>.  Editors&#x27; Addresses</span>

   Bert Wijnen
   IBM T. J. Watson Research
   Schagen 33
   3461 GL Linschoten
   Netherlands

   Phone:      +31-348-432-794
   EMail:      wijnen@vnet.ibm.com


   Randy Presuhn
   BMC Software, Inc
   965 Stewart Drive
   Sunnyvale, CA 94086
   USA

   Phone:      +1-408-616-3100
   EMail:      randy_presuhn@bmc.com


   Keith McCloghrie
   Cisco Systems, Inc.
   170 West Tasman Drive
   San Jose, CA  95134-1706
   USA

   Phone:      +1-408-526-5260
   EMail:      kzm@cisco.com





















<span class="grey">Wijnen, et al.              Standards Track                    [Page 32]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-33" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


APPENDIX A - Installation

<span class="h3"><a class="selflink" id="appendix-A.1" href="#appendix-A.1">A.1</a>.  Installation Parameters</span>

   During installation, an authoritative SNMP engine which supports this
   View-based Access Control Model SHOULD be configured with several
   initial parameters.  These include for the View-based Access Control
   Model:

1) A security configuration

   The choice of security configuration determines if initial
   configuration is implemented and if so how.  One of three possible
   choices is selected:

        - initial-minimum-security-configuration
        - initial-semi-security-configuration
        - initial-no-access-configuration

   In the case of a initial-no-access-configuration, there is no initial
   configuration, and so the following steps are irrelevant.

2) A default context

   One entry in the vacmContextTable with a contextName of &quot;&quot; (the empty
   string), representing the default context.  Note that this table gets
   created automatically if a default context exists.

     vacmContextName                  &quot;&quot;

3) An initial group

   One entry in the vacmSecurityToGroupTable to allow access to group
   &quot;initial&quot;.

     vacmSecurityModel                3 (USM)
     vacmSecurityName                 &quot;initial&quot;
     vacmGroupName                    &quot;initial&quot;
     vacmSecurityToGroupStorageType   anyValidStorageType
     vacmSecurityToGroupStatus        active











<span class="grey">Wijnen, et al.              Standards Track                    [Page 33]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-34" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


4) Initial access rights

   Three entries in the vacmAccessTable as follows:

   - read-notify access for securityModel USM, securityLevel
     &quot;noAuthNoPriv&quot; on behalf of securityNames that belong to the group
     &quot;initial&quot; to the &lt;restricted&gt; MIB view in the default context with
     contextName &quot;&quot;.

   - read-write-notify access for securityModel USM, securityLevel
     &quot;authNoPriv&quot; on behalf of securityNames that belong to the group
     &quot;initial&quot; to the &lt;internet&gt; MIB view in the default context with
     contextName &quot;&quot;.

   - if privacy is supported,
     read-write-notify access for securityModel USM, securityLevel
     &quot;authPriv&quot; on behalf of securityNames that belong to the group
     &quot;initial&quot; to the &lt;internet&gt; MIB view in the default context with
     contextName &quot;&quot;.

   That translates into the following entries in the vacmAccessTable.

   - One entry to be used for unauthenticated access (noAuthNoPriv):

     vacmGroupName                    &quot;initial&quot;
     vacmAccessContextPrefix          &quot;&quot;
     vacmAccessSecurityModel          3 (USM)
     vacmAccessSecurityLevel          noAuthNoPriv
     vacmAccessContextMatch           exact
     vacmAccessReadViewName           &quot;restricted&quot;
     vacmAccessWriteViewName          &quot;&quot;
     vacmAccessNotifyViewName         &quot;restricted&quot;
     vacmAccessStorageType            anyValidStorageType
     vacmAccessStatus                 active

   - One entry to be used for authenticated access (authNoPriv)
     with optional privacy (authPriv):

     vacmGroupName                    &quot;initial&quot;
     vacmAccessContextPrefix          &quot;&quot;
     vacmAccessSecurityModel          3 (USM)
     vacmAccessSecurityLevel          authNoPriv
     vacmAccessContextMatch           exact
     vacmAccessReadViewName           &quot;internet&quot;
     vacmAccessWriteViewName          &quot;internet&quot;
     vacmAccessNotifyViewName         &quot;internet&quot;
     vacmAccessStorageType            anyValidStorageType
     vacmAccessStatus                 active



<span class="grey">Wijnen, et al.              Standards Track                    [Page 34]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-35" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


5) Two MIB views, of which the second one depends on the security
   configuration.

   -  One view, the &lt;internet&gt; view, for authenticated access:

      -  the &lt;internet&gt; MIB view is the following subtree:
             &quot;internet&quot;  (subtree 1.3.6.1)

   -  A second view, the &lt;restricted&gt; view, for unauthenticated
      access.  This view is configured according to the selected
      security configuration:

      -  For the initial-no-access-configuration there is no default
         initial configuration, so no MIB views are pre-scribed.

      -  For the initial-semi-secure-configuration:

         the &lt;restricted&gt; MIB view is the union of these subtrees:
         (a) &quot;system&quot;       (subtree 1.3.6.1.2.1.1)      [<a href="/doc/html/rfc1907">RFC1907</a>]
         (b) &quot;snmp&quot;         (subtree 1.3.6.1.2.1.11)     [<a href="/doc/html/rfc1907">RFC1907</a>]
         (c) &quot;snmpEngine&quot;   (subtree 1.3.6.1.6.3.10.2.1) [<a href="/doc/html/rfc2571" title="&quot;An Architecture for describing SNMP Management Frameworks&quot;">RFC2571</a>]
         (d) &quot;snmpMPDStats&quot; (subtree 1.3.6.1.6.3.11.2.1) [<a href="/doc/html/rfc2572" title="&quot;Message Processing and Dispatching for the Simple Network Management Protocol (SNMP)&quot;">RFC2572</a>]
         (e) &quot;usmStats&quot;     (subtree 1.3.6.1.6.3.15.1.1) [<a href="/doc/html/rfc2574" title="&quot;User-based Security Model (USM) for version 3 of the Simple Network Management Protocol (SNMPv3)&quot;">RFC2574</a>]

      -  For the initial-minimum-secure-configuration:

         the &lt;restricted&gt; MIB view is the following subtree.
             &quot;internet&quot;  (subtree 1.3.6.1)

   This translates into the following &quot;internet&quot; entry in the
   vacmViewTreeFamilyTable:

                                minimum-secure      semi-secure
                                ----------------    ---------------
  vacmViewTreeFamilyViewName    &quot;internet&quot;          &quot;internet&quot;
  vacmViewTreeFamilySubtree     1.3.6.1             1.3.6.1
  vacmViewTreeFamilyMask        &quot;&quot;                  &quot;&quot;
  vacmViewTreeFamilyType        1 (included)        1 (included)
  vacmViewTreeFamilyStorageType anyValidStorageType anyValidStorageType
  vacmViewTreeFamilyStatus      active              active











<span class="grey">Wijnen, et al.              Standards Track                    [Page 35]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-36" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


   In addition it translates into the following &quot;restricted&quot; entries
   in the vacmViewTreeFamilyTable:

                                minimum-secure      semi-secure
                                ----------------    ---------------
  vacmViewTreeFamilyViewName    &quot;restricted&quot;        &quot;restricted&quot;
  vacmViewTreeFamilySubtree     1.3.6.1             1.3.6.1.2.1.1
  vacmViewTreeFamilyMask        &quot;&quot;                  &quot;&quot;
  vacmViewTreeFamilyType        1 (included)        1 (included)
  vacmViewTreeFamilyStorageType anyValidStorageType anyValidStorageType
  vacmViewTreeFamilyStatus      active              active

  vacmViewTreeFamilyViewName                        &quot;restricted&quot;
  vacmViewTreeFamilySubtree                         1.3.6.1.2.1.11
  vacmViewTreeFamilyMask                            &quot;&quot;
  vacmViewTreeFamilyType                            1 (included)
  vacmViewTreeFamilyStorageType                     anyValidStorageType
  vacmViewTreeFamilyStatus                          active

  vacmViewTreeFamilyViewName                        &quot;restricted&quot;
  vacmViewTreeFamilySubtree                         1.3.6.1.6.3.10.2.1
  vacmViewTreeFamilyMask                            &quot;&quot;
  vacmViewTreeFamilyType                            1 (included)
  vacmViewTreeFamilyStorageType                     anyValidStorageType
  vacmViewTreeFamilyStatus                          active

  vacmViewTreeFamilyViewName                        &quot;restricted&quot;
  vacmViewTreeFamilySubtree                         1.3.6.1.6.3.11.2.1
  vacmViewTreeFamilyMask                            &quot;&quot;
  vacmViewTreeFamilyType                            1 (included)
  vacmViewTreeFamilyStorageType                     anyValidStorageType
  vacmViewTreeFamilyStatus                          active

  vacmViewTreeFamilyViewName                        &quot;restricted&quot;
  vacmViewTreeFamilySubtree                         1.3.6.1.6.3.15.1.1
  vacmViewTreeFamilyMask                            &quot;&quot;
  vacmViewTreeFamilyType                            1 (included)
  vacmViewTreeFamilyStorageType                     anyValidStorageType
  vacmViewTreeFamilyStatus                          active












<span class="grey">Wijnen, et al.              Standards Track                    [Page 36]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-37" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


<span class="h2"><a class="selflink" id="appendix-B" href="#appendix-B">B</a>.  Change Log</span>

   Changes made since <a href="/doc/html/rfc2275">RFC2275</a>:

   - Added text to vacmSecurityToGroupStatus DESCRIPTION clause to
     clarify under which conditions an entry in the
     vacmSecurityToGroupTable can be made active.
   - Added REVISION clauses to MODULE-IDENTITY
   - Clarified text in vacmAccessTable DESCRIPTION clause.
   - Added a DEFVAL clause to vacmAccessContextMatch object.
   - Added missing columns in <a href="#appendix-A">Appendix A</a> and re-arranged for clarity.
   - Fixed oids in <a href="#appendix-A">appendix A</a>.
   - Use the PDU Class terminology instead of <a href="/doc/html/rfc1905">RFC1905</a> PDU types.
   - Added <a href="#section-7.4">section 7.4</a> about access control to the MIB.
   - Fixed references to new/revised documents
   - Fix Editor contact information.
   - fixed spelling errors
   - removed one vacmAccesEntry from sample in <a href="#appendix-A">appendix A</a>.
   - made some more clarifications.
   - updated acknowledgement section.































<span class="grey">Wijnen, et al.              Standards Track                    [Page 37]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-38" ></span>
<span class="grey"><a href="/doc/html/rfc2575">RFC 2575</a>                     VACM for SNMP                    April 1999</span>


<span class="h2"><a class="selflink" id="appendix-C" href="#appendix-C">C</a>.  Full Copyright Statement</span>

   Copyright (C) The Internet Society (1999).  All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assigns.

   This document and the information contained herein is provided on an
   &quot;AS IS&quot; basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Acknowledgement

   Funding for the RFC Editor function is currently provided by
   the Internet Society.


















Wijnen, et al.              Standards Track                    [Page 38]
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

