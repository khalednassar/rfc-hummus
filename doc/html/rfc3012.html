<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    rfc3012
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.33.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.33.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/draft-ietf-mobileip-challenge/">
  <meta name="description" content="Mobile IPv4 Challenge/Response Extensions (RFC )">
  <script src="https://www.ietf.org/lib/dt/7.33.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.33.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.33.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.33.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bgbrown"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc3012.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc3012.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/pdfrfc/rfc3012.txt.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/rfc3012/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/rfc3012/" title="Datatracker information for this document">Tracker</a>] [<a href="/group/mobileip/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-mobileip-challenge@ietf.org?subject=draft-ietf-mobileip-challenge" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=draft-ietf-mobileip-challenge-13.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-ietf-mobileip-challenge-13.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-ietf-mobileip-challenge-13.txt" title="Run an idnits check of this document">Nits</a>]

From: <a href="/doc/html/draft-ietf-mobileip-challenge-13">draft-ietf-mobileip-challenge-13</a>                 Proposed Standard
Obsoleted by: <a href="/doc/html/rfc4721">4721</a>                                                      </pre>
      </div>
    

    <div class="draftcontent">
    <pre>Network Working Group                                         C. Perkins
Request for Comments: 3012                         Nokia Research Center
Category: Standards Track                                     P. Calhoun
                                           Sun Microsystems Laboratories
                                                           November 2000


               <span class="h1">Mobile IPv4 Challenge/Response Extensions</span>

Status of this Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the &quot;Internet
   Official Protocol Standards&quot; (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2000).  All Rights Reserved.

Abstract

   Mobile IP, as originally specified, defines an authentication
   extension (the Mobile-Foreign Authentication extension) by which a
   mobile node can authenticate itself to a foreign agent.
   Unfortunately, this extension does not provide ironclad replay
   protection for the foreign agent, and does not allow for the use of
   existing techniques (such as CHAP) for authenticating portable
   computer devices.  In this specification, we define extensions for
   the Mobile IP Agent Advertisements and the Registration Request that
   allow a foreign agent to use a challenge/response mechanism to
   authenticate the mobile node.


















<span class="grey">Perkins &amp; Calhoun           Standards Track                     [Page 1]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-2" ></span>
<span class="grey"><a href="/doc/html/rfc3012">RFC 3012</a>             Mobile IPv4 Challenge/Response        November 2000</span>


Table of Contents

    <a href="#section-1">1</a>. Introduction . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-2">2</a>
    <a href="#section-2">2</a>. Mobile IP Agent Advertisement Challenge Extension  . . . . .  <a href="#page-3">3</a>
    <a href="#section-3">3</a>. Operation  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
        <a href="#section-3.1">3.1</a>. Mobile Node Processing for Registration Requests . . .  <a href="#page-3">3</a>
        <a href="#section-3.2">3.2</a>. Foreign Agent Processing for Registration Requests . .  <a href="#page-5">5</a>
        <a href="#section-3.3">3.3</a>. Foreign Agent Processing for Registration Replies  . .  <a href="#page-7">7</a>
        <a href="#section-3.4">3.4</a>. Home Agent Processing for the Challenge Extensions . .  <a href="#page-7">7</a>
    <a href="#section-4">4</a>. MN-FA Challenge Extension  . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
    <a href="#section-5">5</a>. Generalized Mobile IP Authentication Extension . . . . . . .  <a href="#page-8">8</a>
    <a href="#section-6">6</a>. MN-AAA Authentication subtype. . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
    <a href="#section-7">7</a>. Reserved SPIs for Mobile IP. . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
    <a href="#section-8">8</a>. SPI For RADIUS AAA Servers . . . . . . . . . . . . . . . . . <a href="#page-10">10</a>
    <a href="#section-9">9</a>. Configurable Parameters. . . . . . . . . . . . . . . . . . . <a href="#page-10">10</a>
   <a href="#section-10">10</a>. Error Values  . . . . . . . . . . . . . . . . .. . . . . . . <a href="#page-10">10</a>
   <a href="#section-11">11</a>. IANA Considerations  . . . . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
   <a href="#section-12">12</a>. Security Considerations  . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
   <a href="#section-13">13</a>. Acknowledgements . . . . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
   References . . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-13">13</a>
    <a href="#appendix-A">A</a>. Verification Infrastructure  . . . . . . . . . . . . . . . . <a href="#page-14">14</a>
   Addresses  . . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-15">15</a>
   Full Copyright Statement . . . . . . . . . . . . . . . . . . . . <a href="#page-17">17</a>

<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>. Introduction</span>

   Mobile IP, as originally specified, defines an authentication
   extension (the Mobile-Foreign Authentication extension) by which a
   mobile node can authenticate itself to a foreign agent.

   Unfortunately, this extension does not provide ironclad replay
   protection, from the point of view of the foreign agent, and does not
   allow for the use of existing techniques (such as CHAP [<a href="#ref-12">12</a>]) for
   authenticating portable computer devices.  In this specification, we
   define extensions for the Mobile IP Agent Advertisements and the
   Registration Request that allow a foreign agent to a use
   challenge/response mechanism to authenticate the mobile node.

   All SPI values defined in this document refer to values for the
   Security Parameter Index, as defined in <a href="/doc/html/rfc2002">RFC 2002</a> [<a href="#ref-8">8</a>].  The key words
   &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;, &quot;SHOULD&quot;,
   &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;MAY&quot;, and &quot;OPTIONAL&quot; in this document
   are to be interpreted as described in [<a href="#ref-1">1</a>].








<span class="grey">Perkins &amp; Calhoun           Standards Track                     [Page 2]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-3" ></span>
<span class="grey"><a href="/doc/html/rfc3012">RFC 3012</a>             Mobile IPv4 Challenge/Response        November 2000</span>


<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>. Mobile IP Agent Advertisement Challenge Extension</span>

   This section defines a new extension to the Router Discovery Protocol
   [<a href="#ref-3">3</a>] for use by foreign agents that need to issue a challenge for
   authenticating mobile nodes.

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Type      |    Length     |          Challenge ...
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                   Figure 1: The Challenge Extension

       Type        24

       Length      The length of the Challenge value in bytes; SHOULD be
                   at least 4

       Challenge   A random value that SHOULD be at least 32 bits.

   The Challenge extension, illustrated in figure 1, is inserted in the
   Agent Advertisements by the Foreign Agent, in order to communicate
   the latest challenge value that can be used by the mobile node to
   compute an authentication for its registration request message.  The
   challenge is selected by the foreign agent to provide local assurance
   that the mobile node is not replaying any earlier registration
   request.  Eastlake, et al. [<a href="#ref-4">4</a>] provides more information on
   generating pseudo-random numbers suitable for use as values for the
   challenge.

<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>. Operation</span>

   This section describes modifications to the Mobile IP registration
   process which may occur after the Foreign Agent issues a Mobile IP
   Agent Advertisement containing the Challenge on its local link.

<span class="h3"><a class="selflink" id="section-3.1" href="#section-3.1">3.1</a>. Mobile Node Processing for Registration Requests</span>

   Whenever the Agent Advertisement contains the Challenge extension, if
   the mobile node does not have a security association with the Foreign
   Agent, then it MUST include the Challenge value in a MN-FA Challenge
   extension to the Registration Request message.  If, on the other
   hand, the mobile node does have a security association with the
   foreign agent, it SHOULD include the Challenge value in its
   Registration Request message.





<span class="grey">Perkins &amp; Calhoun           Standards Track                     [Page 3]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-4" ></span>
<span class="grey"><a href="/doc/html/rfc3012">RFC 3012</a>             Mobile IPv4 Challenge/Response        November 2000</span>


   If the Mobile Node has a security association with the Foreign Agent,
   it MUST include a Mobile-Foreign Authentication extension in its
   Registration Request message, according to the base Mobile IP
   specification [<a href="#ref-8">8</a>].  When the Registration Request contains the MN-FA
   Challenge extension specified in <a href="#section-4">section 4</a>, the Mobile-Foreign
   Authentication MUST follow the Challenge extension in the
   Registration Request.

   If the Mobile Node does not have a security association with the
   Foreign Agent, the Mobile Node MUST include the MN-AAA Authentication
   extension as defined in <a href="#section-6">section 6</a>.  In addition, the Mobile Node
   SHOULD include the NAI extension [<a href="#ref-2">2</a>], to enable the foreign agent to
   make use of any available verification infrastructure.  The SPI field
   of the MN-AAA Authentication extension specifies the particular
   secret and algorithm (shared between the Mobile Node and the
   verification infrastructure) that must be used to perform the
   authentication.  If the SPI value is chosen as CHAP_SPI (see <a href="#section-9">section</a>
   <a href="#section-9">9</a>), then the mobile node specifies CHAP-style authentication [<a href="#ref-12">12</a>]
   using MD5 [<a href="#ref-11">11</a>].

   In either case, the MN-FA Challenge extension and one of the above
   specified authentication extensions MUST follow the Mobile-Home
   Authentication extension, if present.

   A successful Registration Reply from the Foreign Agent MAY include a
   new Challenge value (see <a href="#section-3.3">section 3.3</a>).  The Mobile Node MAY use
   either the value found in the latest Advertisement, or the one found
   in the last Registration Reply from the Foreign Agent.  This approach
   enables the Mobile Node to make use of the challenge without having
   to wait for advertisements.

   A Mobile Node might receive an UNKNOWN_CHALLENGE error (see <a href="#section-9">section</a>
   <a href="#section-9">9</a>) if it moves to a new Foreign Agent that cannot validate the
   challenge provided in the Registration Request.  In such instances,
   the Mobile Node MUST use a new Challenge value in any new
   registration, obtained either from an Agent Advertisement, or from a
   Challenge extension to the Registration Reply containing the error.

   A Mobile Node that does not include a Challenge when the Mobile-
   Foreign Authentication extension is present may receive a
   MISSING_CHALLENGE (see <a href="#section-10">section 10</a>) error.  In this case, the foreign
   agent will not process the request from the mobile node unless the
   request contains a valid Challenge.








<span class="grey">Perkins &amp; Calhoun           Standards Track                     [Page 4]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-5" ></span>
<span class="grey"><a href="/doc/html/rfc3012">RFC 3012</a>             Mobile IPv4 Challenge/Response        November 2000</span>


   A Mobile Node that receives a BAD_AUTHENTICATION error code (see
   <a href="#section-10">section 10</a>) SHOULD include the MN-AAA Authentication Extension in the
   next Registration Request.  This will make it possible for the
   Foreign Agent to use its AAA infrastructure in order to authenticate
   the Mobile Node.

<span class="h3"><a class="selflink" id="section-3.2" href="#section-3.2">3.2</a>. Foreign Agent Processing for Registration Requests</span>

   Upon receipt of the Registration Request, if the Foreign Agent has
   issued a Challenge as part of its Agent Advertisements, and it does
   not have a security association with the mobile node, then the
   Foreign Agent MUST check that the MN-FA Challenge extension exists,
   and that it contains a challenge value previously unused by the
   Mobile Node.  This ensures that the mobile node is not attempting to
   replay a previous advertisement and authentication.  If the challenge
   extension is needed and does not exist, the Foreign Agent MUST send a
   Registration Reply to the mobile node with the error code
   MISSING_CHALLENGE.

   A foreign agent that sends Agent Advertisements containing a
   Challenge value MAY send a Registration Reply message with a
   MISSING_CHALLENGE error if the mobile node sends a Registration
   Request with a Mobile-Foreign Authentication extension without
   including a Challenge.  In other words, such a foreign agent MAY
   refuse to process a Registration Request request from the mobile node
   unless the request contains a valid Challenge.

   If a mobile node retransmits a Registration Request with the same
   Identification field and the same Challenge extension, and the
   Foreign Agent still has a pending Registration Request record in
   effect for the mobile node, then the Foreign Agent forwards the
   Registration Request to the Home Agent again.  In all other
   circumstances, if the Foreign Agent receives a Registration Request
   with a Challenge extension containing a Challenge value previously
   used by that mobile node, the Foreign Agent SHOULD send a
   Registration Reply to the mobile node containing the Code value
   STALE_CHALLENGE.

   The Foreign Agent MUST NOT accept any Challenge in the Registration
   Request unless it was offered in last successful Registration Reply
   issued to the Mobile Node, or else advertised as one of the last
   CHALLENGE_WINDOW (see <a href="#section-9">section 9</a>) Challenge values inserted into the
   immediately preceding Agent advertisements.  If the Challenge is not
   one of the recently advertised values, the foreign Agent SHOULD send
   a Registration Reply with Code UNKNOWN_CHALLENGE (see <a href="#section-10">section 10</a>).






<span class="grey">Perkins &amp; Calhoun           Standards Track                     [Page 5]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-6" ></span>
<span class="grey"><a href="/doc/html/rfc3012">RFC 3012</a>             Mobile IPv4 Challenge/Response        November 2000</span>


   Furthermore, the Foreign Agent MUST check that there is either a
   Mobile-Foreign, or a MN-AAA Authentication extension after the
   Challenge extension.  Any registration message containing the
   Challenge extension without either of these authentication extensions
   MUST be silently discarded.  If the registration message contains a
   Mobile-Foreign Authentication extension with an incorrect
   authenticator that fails verification, the Foreign Agent MAY send a
   Registration Reply to the mobile node with Code value
   BAD_AUTHENTICATION (see <a href="#section-10">Section 10</a>).

   If the MN-AAA Authentication extension (see <a href="#section-6">Section 6</a>) is present in
   the message, or if an NAI extension is included indicating that the
   mobile node belongs to a different administrative domain, the foreign
   agent may take actions outside the scope of this protocol
   specification to carry out the authentication of the mobile node.
   The Foreign Agent MUST NOT remove the MN-AAA Authentication Extension
   from the Registration Request prior to the completion of the
   authentication performed by the AAA infrastructure.  The appendix
   provides an example of an action that could be taken by a foreign
   agent.

   In the event that the Challenge extension is authenticated through
   the Mobile-Foreign Authentication Extension, the Foreign Agent MAY
   remove the Challenge Extension from the Registration Request without
   disturbing the authentication value computed by the Mobile Node for
   use by the AAA or the Home Agent.  If the Challenge extension is not
   removed, it MUST precede the Foreign-Home Authentication extension.

   If the Foreign Agent does not remove the Challenge extension, then
   the Foreign Agent SHOULD store the Challenge value as part of the
   pending registration request list [<a href="#ref-8">8</a>].  Also in this case, the
   Foreign Agent MUST reject any Registration Reply message coming from
   the Home Agent that does not also include the Challenge Extension
   with the same Challenge Value that was included in the Registration
   Request.  The Foreign Agent MUST send the rejected Registration
   message to the mobile node, and change the status in the Registration
   Reply to the value MISSING_CHALLENGE (see <a href="#section-10">section 10</a>).

   If the Foreign Agent does remove the Challenge extension and
   applicable authentication from the Registration Request message, then
   it SHOULD insert the Identification field from the Registration
   Request message along with its record-keeping information about the
   particular Mobile Node in order to protect against replays.








<span class="grey">Perkins &amp; Calhoun           Standards Track                     [Page 6]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-7" ></span>
<span class="grey"><a href="/doc/html/rfc3012">RFC 3012</a>             Mobile IPv4 Challenge/Response        November 2000</span>


<span class="h3"><a class="selflink" id="section-3.3" href="#section-3.3">3.3</a>. Foreign Agent Processing for Registration Replies</span>

   The Foreign Agent MAY include a new Challenge extension in any
   Registration Reply, successful or not.  If the foreign agent includes
   this extension in a successful Registration Reply, the extension
   SHOULD precede a MN-FA authentication extension.

   Suppose the Registration Reply includes a Challenge extension from
   the Home Agent, and the foreign agent wishes to include another
   Challenge extension with the Registration Reply for use by the mobile
   node.  In that case, the foreign agent MUST delete the Challenge
   extension from the Home Agent from the Registration Reply, along with
   any FA-HA authentication extension, before appending the new
   Challenge extension to the Registration Reply.

<span class="h3"><a class="selflink" id="section-3.4" href="#section-3.4">3.4</a>. Home Agent Processing for the Challenge Extensions</span>

   If the Home Agent receives a Registration Request with the MN-FA
   Challenge extension, and recognizes the extension, the Home Agent
   MUST include the Challenge extension in the Registration Reply.  The
   Challenge Extension MUST be placed after the Mobile-Home
   authentication extension, and the extension SHOULD be authenticated
   by a Foreign-Home Authentication extension.

   Since the extension type for the Challenge extension is within the
   range 128-255, the Home Agent MUST process such a Registration
   Request even if it does not recognize the Challenge extension [<a href="#ref-8">8</a>].
   In this case, the Home Agent will send a Registration Reply to the
   Foreign Agent that does not include the Challenge extension.

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>. MN-FA Challenge Extension</span>

   This section specifies a new Mobile IP Registration extension that is
   used to satisfy a Challenge in an Agent Advertisement.  The Challenge
   extension to the Registration Request message is used to indicate the
   challenge that the mobile node is attempting to satisfy.

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Type      |    Length     |         Challenge...
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                Figure 2: The MN-FA Challenge Extension

      Type        132 (skippable) (see [<a href="#ref-8">8</a>])

      Length      Length of the Challenge value



<span class="grey">Perkins &amp; Calhoun           Standards Track                     [Page 7]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-8" ></span>
<span class="grey"><a href="/doc/html/rfc3012">RFC 3012</a>             Mobile IPv4 Challenge/Response        November 2000</span>


      Challenge   The Challenge field is copied from the Challenge field
                  found in the Agent Advertisement Challenge extension
                  (see <a href="#section-2">section 2</a>).

<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>. Generalized Mobile IP Authentication Extension</span>

   Several new authentication extensions have been designed for various
   control messages proposed for extensions to Mobile IP (see, for
   example, [<a href="#ref-9">9</a>]).  A new authentication extension is required for a
   mobile node to present its credentials to any other entity other than
   the ones already defined; the only entities defined in the base
   Mobile IP specification [<a href="#ref-8">8</a>] are the home agent and the foreign agent.
   It is the purpose of the generalized authentication extension defined
   here to collect together data for all such new authentication
   applications into a single extension type with subtypes.

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Type      |    Subtype    |            Length             |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                              SPI                              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                         Authenticator ...
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

       Figure 3: The Generalized Mobile IP Authentication Extension

       Type            36 (not skippable) (see [<a href="#ref-8">8</a>])

       Subtype         a number assigned to identify the kind of
                       endpoints or characteristics of the particular
                       authentication strategy

       Length          4 plus the number of bytes in the Authenticator;
                       MUST be at least 20.

       SPI             Security Parameters Index

       Authenticator   The variable length Authenticator field

   In this document, only one subtype is defined:

       1               MN-AAA Authentication subtype (see <a href="#section-6">section 6</a>)







<span class="grey">Perkins &amp; Calhoun           Standards Track                     [Page 8]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-9" ></span>
<span class="grey"><a href="/doc/html/rfc3012">RFC 3012</a>             Mobile IPv4 Challenge/Response        November 2000</span>


<span class="h2"><a class="selflink" id="section-6" href="#section-6">6</a>. MN-AAA Authentication subtype</span>

   The Generalized Authentication extension with subtype 1 will be
   referred to as a MN-AAA Authentication extension.  If the mobile node
   does not include a Mobile-Foreign Authentication [<a href="#ref-8">8</a>] extension, then
   it MUST include the MN-AAA Authentication extension whenever the
   Challenge extension is present.  If the MN-AAA Authentication
   extension is present, then the Registration Message sent by the
   mobile node MUST contain the Mobile-HA Authentication extension [<a href="#ref-8">8</a>]
   if it shares a security association with the Home Agent.  If present,
   the Mobile-HA Authentication Extension MUST appear prior to the MN-
   AAA Authentication extension.  The mobile node MAY include a MN-AAA
   Authentication extension in any Registration Request.  The
   corresponding response MUST include the MN-HA Authentication
   Extension, and MUST NOT include the MN-AAA Authentication Extension.

   The default algorithm for computation of the authenticator is HMAC-
   MD5 [<a href="#ref-5">5</a>] computed on the following data, in the order shown:

      Preceding Mobile IP data || Type, Subtype, Length, SPI

   where the Type, Length, Subtype, and SPI are as shown in <a href="#section-5">section 5</a>.
   The resulting function call, as described in [<a href="#ref-5">5</a>], would be:

      hmac_md5(data, datalen, Key, KeyLength, authenticator);

   Each mobile node MUST support the ability to produce the
   authenticator by using HMAC-MD5 as shown.  Just as with Mobile IP,
   this default algorithm MUST be able to be configured for selection at
   any arbitrary 32-bit SPI outside of the SPIs in the reserved range
   0-255.

<span class="h2"><a class="selflink" id="section-7" href="#section-7">7</a>. Reserved SPIs for Mobile IP</span>

   Mobile IP defines several authentication extensions for use in
   Registration Requests and Replies.  Each authentication extension
   carries a Security Parameters Index (SPI) which should be used to
   index a table of security associations.  Values in the range 0 - 255
   are reserved for special use.  A list of reserved SPI numbers is to
   be maintained by IANA at the following URL:

      <a href="http://www.iana.org/numbers.html">http://www.iana.org/numbers.html</a>









<span class="grey">Perkins &amp; Calhoun           Standards Track                     [Page 9]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-10" ></span>
<span class="grey"><a href="/doc/html/rfc3012">RFC 3012</a>             Mobile IPv4 Challenge/Response        November 2000</span>


<span class="h2"><a class="selflink" id="section-8" href="#section-8">8</a>. SPI For RADIUS AAA Servers</span>

   Some AAA servers only admit a single security association, and thus
   do not use the SPI numbers for Mobile IP authentication extensions
   for use when determining the security association that would be
   necessary for verifying the authentication information included with
   the Authentication extension.

   SPI number CHAP_SPI (see <a href="#section-9">section 9</a>) is reserved (see <a href="#section-7">section 7</a>) for
   indicating the following procedure for computing authentication data
   (called the &quot;authenticator&quot;), which is used by many RADIUS servers
   [<a href="#ref-10">10</a>] today.

   To compute the authenticator, apply MD5 [<a href="#ref-11">11</a>] computed on the
   following data, in the order shown:

      High-order byte from Challenge || Key ||
      MD5(Preceding Mobile IP data ||
      Type, Subtype (if present), Length, SPI) ||
      Least-order 237 bytes from Challenge

   where the Type, Length, SPI, and possibly Subtype, are the fields of
   the authentication extension in use.  For instance, all four of these
   fields would be in use when SPI == CHAP_SPI is used with the
   Generalized Authentication extension.  Since the RADIUS protocol
   cannot carry attributes greater than 253 in size, the preceding
   Mobile IP data, type, subtype (if present), length and SPI are hashed
   using MD5.  Finally, the least significant 237 bytes of the challenge
   are concatenated.

<span class="h2"><a class="selflink" id="section-9" href="#section-9">9</a>. Configurable Parameters</span>

   Every Mobile IP agent supporting the extensions defined in this
   document SHOULD be able to configure each parameter in the following
   table.  Each table entry contains the name of the parameter, the
   default value, and the section of the document in which the parameter
   first appears.

      Parameter Name     Default Value   Section(s) of Document
      --------------     -------------   ----------------------
      CHALLENGE_WINDOW   2               3.2
      CHAP_SPI           2               8

<span class="h2"><a class="selflink" id="section-10" href="#section-10">10</a>. Error Values</span>

   Each entry in the following table contains the name of Code [<a href="#ref-8">8</a>] to be
   returned in a Registration Reply, the value for the Code, and the
   section in which the error is first mentioned in this specification.



<span class="grey">Perkins &amp; Calhoun           Standards Track                    [Page 10]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-11" ></span>
<span class="grey"><a href="/doc/html/rfc3012">RFC 3012</a>             Mobile IPv4 Challenge/Response        November 2000</span>


      Error Name               Value   Section of Document
      ----------------------   -----   -------------------
      UNKNOWN_CHALLENGE        104     3.2
      BAD_AUTHENTICATION       67      3.2 - also see [<a href="#ref-8">8</a>]
      MISSING_CHALLENGE        105     3.1,3.2
      STALE_CHALLENGE          106     3.2

<span class="h2"><a class="selflink" id="section-11" href="#section-11">11</a>. IANA Considerations</span>

   The Generalized Mobile IP Authentication extension defined in <a href="#section-5">Section</a>
   <a href="#section-5">5</a> is a Mobile IP registration extension as defined in <a href="/doc/html/rfc2002">RFC 2002</a> [<a href="#ref-8">8</a>]
   and extended in <a href="/doc/html/rfc2356">RFC 2356</a> [<a href="#ref-7">7</a>].  IANA should assign a value of 36 for
   this extension.

   A new number space is to be created for enumerating subtypes of the
   Generalized Authentication extension (see <a href="#section-5">section 5</a>).  New subtypes
   of the Generalized Authentication extension, other than the number
   (1) for the MN-AAA authentication extension specified in <a href="#section-6">section 6</a>,
   must be specified and approved by a designated expert.

   The MN-FA Challenge Extension defined in <a href="#section-4">Section 4</a> is a router
   advertisement extension as defined in <a href="/doc/html/rfc1256">RFC 1256</a> [<a href="#ref-3">3</a>] and extended in
   <a href="/doc/html/rfc2002">RFC 2002</a> [<a href="#ref-8">8</a>].  IANA should assign a value of 132 for this purpose.

   The Code values defined in <a href="#section-10">Section 10</a> are error codes as defined in
   <a href="/doc/html/rfc2002">RFC 2002</a> [<a href="#ref-8">8</a>] and extended in <a href="/doc/html/rfc2344">RFC 2344</a> [<a href="#ref-6">6</a>] and <a href="/doc/html/rfc2356">RFC 2356</a> [<a href="#ref-7">7</a>].  They
   correspond to error values conventionally associated with rejection
   by the foreign agent (i.e., values from the range 64-127).  The Code
   value 67 is a pre-existing value which is to be used in some cases
   with the extension defined in this specification.  IANA should record
   the values as defined in <a href="#section-10">Section 10</a>.

   A new section for enumerating algorithms identified by specific SPIs
   within the range 0-255 is to be added to

      <a href="http://www.isi.edu/in-notes/iana/assignments/mobileip-numbers">http://www.isi.edu/in-notes/iana/assignments/mobileip-numbers</a>.

   The CHAP_SPI number (2) discussed in <a href="#section-8">section 8</a> is to be assigned from
   this range of reserved SPI numbers.  New assignments from this
   reserved range must be specified and approved by the Mobile IP
   working group.  SPI number 1 should not be assigned unless in the
   future the Mobile IP working group decides that SKIP is not important
   for enumeration in the list of reserved numbers.  SPI number 0 should
   not be assigned.







<span class="grey">Perkins &amp; Calhoun           Standards Track                    [Page 11]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-12" ></span>
<span class="grey"><a href="/doc/html/rfc3012">RFC 3012</a>             Mobile IPv4 Challenge/Response        November 2000</span>


<span class="h2"><a class="selflink" id="section-12" href="#section-12">12</a>. Security Considerations</span>

   In the event that a malicious mobile node attempts to replay the
   authenticator for an old MN-FA Challenge, the Foreign Agent would
   detect it since the agent always checks whether it has recently
   advertised the Challenge (see <a href="#section-3.2">section 3.2</a>).  Allowing mobile nodes
   with different IP addresses or NAIs to use the same Challenge value
   does not represent a security vulnerability, because the
   authentication data provided by the mobile node will be computed over
   data that is different (at least by the bytes of the mobile nodes&#x27; IP
   addresses).

   Whenever a Foreign Agent updates a field of the Registration Reply
   (as suggested in <a href="#section-3.2">section 3.2</a>), it invalidates the authentication data
   supplied by the Home Agent in the MN-HA Authentication extension to
   the Registration Reply.  Thus, this opens up a security exposure
   whereby a node might try to supply a bogus Registration Reply to a
   mobile node that causes the mobile node to act as if its Registration
   Reply were rejected.  This might happen when, in fact, a Registration
   Reply showing acceptance of the registration might soon be received
   by the mobile node.

   If the foreign agent chooses a Challenge value (see <a href="#section-2">section 2</a>) with
   fewer than 4 bytes, the foreign agent SHOULD maintain records that
   also the Identification field for the mobile node.  The foreign agent
   can then find assurance that the Registration messages using the
   short Challenge value are in fact unique, and thus assuredly not
   replayed from any earlier registration.

   <a href="#section-8">Section 8</a> (SPI For RADIUS AAA Servers) defines a method of computing
   the Generalized Mobile IP Authentication Extension&#x27;s authenticator
   field using MD5 in a manner that is consistent with RADIUS [<a href="#ref-10">10</a>].  The
   use of MD5 in the method described in <a href="#section-8">Section 8</a> is less secure than
   HMAC-MD5 [<a href="#ref-5">5</a>], and should be avoided whenever possible.

<span class="h2"><a class="selflink" id="section-13" href="#section-13">13</a>. Acknowledgements</span>

   The authors would like to thank Tom Hiller, Mark Munson, the TIA
   TR45-6 WG, Gabriel Montenegro, Vipul Gupta, and Pete McCann for their
   useful discussions.  A recent draft by Mohamed Khalil, Raja
   Narayanan, Emad Qaddoura, and Haseeb Akhtar has also suggested the
   definition of a generalized authentication extension similar to the
   specification contained in <a href="#section-5">section 5</a>.








<span class="grey">Perkins &amp; Calhoun           Standards Track                    [Page 12]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-13" ></span>
<span class="grey"><a href="/doc/html/rfc3012">RFC 3012</a>             Mobile IPv4 Challenge/Response        November 2000</span>


References

   [<a id="ref-1">1</a>]  Bradner, S., &quot;Key words for use in RFCs to Indicate Requirement
        Levels&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc2119">RFC 2119</a>, March 1997.

   [<a id="ref-2">2</a>]  Calhoun, P. and C. Perkins. &quot;Mobile IP Network Access Identifier
        Extension for IPv4&quot;, <a href="/doc/html/rfc2794">RFC 2794</a>, January 2000.

   [<a id="ref-3">3</a>]  Deering, S., &quot;ICMP Router Discovery Messages&quot;, <a href="/doc/html/rfc1256">RFC 1256</a>,
        September 1991.

   [<a id="ref-4">4</a>]  Eastlake, D., Crocker, S. and J. Schiller, &quot;Randomness
        Recommendations for Security&quot;, <a href="/doc/html/rfc1750">RFC 1750</a>, December 1994.

   [<a id="ref-5">5</a>]  Krawczyk, H., Bellare, M. and R. Canetti, &quot;HMAC: Keyed-Hashing
        for Message Authentication&quot;, <a href="/doc/html/rfc2104">RFC 2104</a>, February 1997.

   [<a id="ref-6">6</a>]  Montenegro, G., &quot;Reverse Tunneling for Mobile IP&quot;, <a href="/doc/html/rfc2344">RFC 2344</a>, May
        1998.

   [<a id="ref-7">7</a>]  Montenegro, G. and V. Gupta, &quot;Sun&#x27;s SKIP Firewall Traversal for
        Mobile IP&quot;, <a href="/doc/html/rfc2356">RFC 2356</a>, June 1998.

   [<a id="ref-8">8</a>]  Perkins, C., &quot;IP Mobility Support&quot;, <a href="/doc/html/rfc2002">RFC 2002</a>, October 1996.

   [<a id="ref-9">9</a>]  Perkins, C. and D. Johnson, &quot;Route Optimization in Mobile IP&quot;,
        Work in Progress.

   [<a id="ref-10">10</a>] Rigney, C., Rubens, A., Simpson, W. and S. Willens, &quot;Remote
        Authentication Dial In User Service (RADIUS)&quot;, <a href="/doc/html/rfc2138">RFC 2138</a>, April
        1997.

   [<a id="ref-11">11</a>] Rivest, R., &quot;The MD5 Message-Digest Algorithm&quot;, <a href="/doc/html/rfc1321">RFC 1321</a>, April
        1992.

   [<a id="ref-12">12</a>] Simpson, W., &quot;PPP Challenge Handshake Authentication Protocol
        (CHAP)&quot;, <a href="/doc/html/rfc1994">RFC 1994</a>, August 1996.














<span class="grey">Perkins &amp; Calhoun           Standards Track                    [Page 13]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-14" ></span>
<span class="grey"><a href="/doc/html/rfc3012">RFC 3012</a>             Mobile IPv4 Challenge/Response        November 2000</span>


<span class="h2"><a class="selflink" id="appendix-A" href="#appendix-A">A</a>. Verification Infrastructure</span>

   The Challenge extensions in this protocol specification are expected
   to be useful to help the Foreign Agent manage connectivity for
   visiting mobile nodes, even in situations where the foreign agent
   does not have any security association with the mobile node or the
   mobile node&#x27;s home agent.  In order to carry out the necessary
   authentication, it is expected that the foreign agent will need the
   assistance of external administrative systems, which have come to be
   called AAA systems.  For the purposes of this document, we call the
   external administrative support the &quot;verification infrastructure&quot;.
   The verification infrastructure is described to motivate the design
   of the protocol elements defined in this document, and is not
   strictly needed for the protocol to work.  The foreign agent is free
   to use any means at its disposal to verify the credentials of the
   mobile node.  This could, for instance, rely on a separate protocol
   between the foreign agent and the Mobile IP home agent, and still be
   completely invisible to the mobile node.

   In order to verify the credentials of the mobile node, we imagine
   that the foreign agent has access to a verification infrastructure
   that can return a secure notification to the foreign agent that the
   authentication has been performed, along with the results of that
   authentication.  This infrastructure may be visualized as shown in
   figure 4.

             +----------------------------------------------------+
             |                                                    |
             |  Verification and Key Management Infrastructure    |
             |                                                    |
             +----------------------------------------------------+
                    ^ |                                  ^ |
                    | |                                  | |
                    | v                                  | v
             +---------------+                    +---------------+
             |               |                    |               |
             | Foreign Agent |                    |   Home Agent  |
             |               |                    |               |
             +---------------+                    +---------------+

                Figure 4: The Verification Infrastructure

   After the foreign agent gets the Challenge authentication, it MAY
   pass the authentication to the (here unspecified) infrastructure, and
   await a Registration Reply.  If the Reply has a positive status
   (indicating that the registration was accepted), the foreign agent





<span class="grey">Perkins &amp; Calhoun           Standards Track                    [Page 14]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-15" ></span>
<span class="grey"><a href="/doc/html/rfc3012">RFC 3012</a>             Mobile IPv4 Challenge/Response        November 2000</span>


   accepts the registration.  If the Reply contains the Code value
   BAD_AUTHENTICATION (see <a href="#section-10">Section 10</a>), the foreign agent takes actions
   indicated for rejected registrations.

   Implicit in this picture, is the important observation that the
   Foreign Agent and the Home Agent have to be equipped to make use of
   whatever protocol is made available to them by the challenge
   verification and key management infrastructure shown in the figure.

   The protocol messages for handling the authentication within the
   verification infrastructure, and identity of the agent performing the
   verification of the Foreign Agent challenge, are not specified in
   this document, because those operations do not have to be performed
   by any Mobile IP entity.

Addresses

   The working group can be contacted via the current chairs:

   Basavaraj Patil
   Nokia Corporation
   6000 Connection Drive
   M/S M8-540
   Irving, Texas 75039
   USA

   Phone:  +1 972-894-6709
   Fax :  +1 972-894-5349
   EMail:  Basavaraj.Patil@nokia.com


   Phil Roberts
   Motorola
   1501 West Shure Drive
   Arlington Heights, IL 60004
   USA

   Phone:+1 847-632-3148
   EMail:  QA3445@email.mot.com












<span class="grey">Perkins &amp; Calhoun           Standards Track                    [Page 15]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-16" ></span>
<span class="grey"><a href="/doc/html/rfc3012">RFC 3012</a>             Mobile IPv4 Challenge/Response        November 2000</span>


   Questions about this memo can also be directed to the authors:

   Charles E. Perkins
   Communications Systems Lab
   Nokia Research Center
   313 Fairchild Drive
   Mountain View, California 94043
   USA

   Phone:  +1-650 625-2986
   Fax:  +1 650 625-2502
   EMail:  charliep@iprg.nokia.com



   Pat R. Calhoun
   Network &amp; Security Center
   Sun Microsystems Laboratories
   15 Network Circle
   Menlo Park, California 94025
   USA

   Phone:  +1 650-786-7733
   Fax:  +1 650-786-6445
   EMail:  pcalhoun@eng.sun.com


























<span class="grey">Perkins &amp; Calhoun           Standards Track                    [Page 16]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-17" ></span>
<span class="grey"><a href="/doc/html/rfc3012">RFC 3012</a>             Mobile IPv4 Challenge/Response        November 2000</span>


Full Copyright Statement

   Copyright (C) The Internet Society (2000).  All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assigns.

   This document and the information contained herein is provided on an
   &quot;AS IS&quot; basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.



















Perkins &amp; Calhoun           Standards Track                    [Page 17]
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

