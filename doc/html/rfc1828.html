<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    rfc1828
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.34.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.34.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/draft-ietf-ipsec-ah-md5/">
  <meta name="description" content="IP Authentication using Keyed MD5 (RFC )">
  <script src="https://www.ietf.org/lib/dt/7.34.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.34.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bggrey"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc1828.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc1828.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/pdfrfc/rfc1828.txt.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/rfc1828/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/rfc1828/" title="Datatracker information for this document">Tracker</a>] [<a href="/group/ipsec/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-ipsec-ah-md5@ietf.org?subject=draft-ietf-ipsec-ah-md5" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=draft-ietf-ipsec-ah-md5-03.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-ietf-ipsec-ah-md5-03.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-ietf-ipsec-ah-md5-03.txt" title="Run an idnits check of this document">Nits</a>]

From: <a href="/doc/html/draft-ietf-ipsec-ah-md5-03">draft-ietf-ipsec-ah-md5-03</a>                                Historic</pre>
      </div>
    

    <div class="draftcontent">
    <pre>Network Working Group                                         P. Metzger
Request for Comments: 1828                                      Piermont
Category: Standards Track                                     W. Simpson
                                                              Daydreamer
                                                             August 1995


                   <span class="h1">IP Authentication using Keyed MD5</span>



Status of this Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the &quot;Internet
   Official Protocol Standards&quot; (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.


Abstract

   This document describes the use of keyed MD5 with the IP
   Authentication Header.


Table of Contents

     <a href="#section-1">1</a>.     Introduction ..........................................    <a href="#page-1">1</a>
        <a href="#section-1.1">1.1</a>       Keys ............................................    <a href="#page-1">1</a>
        <a href="#section-1.2">1.2</a>       Data Size .......................................    <a href="#page-1">1</a>
        <a href="#section-1.3">1.3</a>       Performance .....................................    <a href="#page-1">1</a>

     <a href="#section-2">2</a>.     Calculation ...........................................    <a href="#page-2">2</a>

     SECURITY CONSIDERATIONS ......................................    <a href="#page-2">2</a>
     ACKNOWLEDGEMENTS .............................................    <a href="#page-3">3</a>
     REFERENCES ...................................................    <a href="#page-3">3</a>
     AUTHOR&#x27;S ADDRESS .............................................    <a href="#page-4">4</a>












<span class="grey">Metzger &amp; Simpson             Standards Track                   [Page i]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-1" ></span>
<span class="grey"><a href="/doc/html/rfc1828">RFC 1828</a>                         AH MD5                      August 1995</span>


<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>.  Introduction</span>

   The Authentication Header (AH) [<a href="/doc/html/rfc1826">RFC-1826</a>] provides integrity and
   authentication for IP datagrams.  This specification describes the AH
   use of keys with Message Digest 5 (MD5) [<a href="/doc/html/rfc1321">RFC-1321</a>].

   All implementations that claim conformance or compliance with the
   Authentication Header specification MUST implement this keyed MD5
   mechanism.

   This document assumes that the reader is familiar with the related
   document &quot;Security Architecture for the Internet Protocol&quot; [RFC-
   1825], which defines the overall security plan for IP, and provides
   important background for this specification.



<span class="h3"><a class="selflink" id="section-1.1" href="#section-1.1">1.1</a>.  Keys</span>

   The secret authentication key shared between the communicating
   parties SHOULD be a cryptographically strong random number, not a
   guessable string of any sort.

   The shared key is not constrained by this transform to any particular
   size.  Lengths of up to 128 bits MUST be supported by the
   implementation, although any particular key may be shorter.  Longer
   keys are encouraged.



<span class="h3"><a class="selflink" id="section-1.2" href="#section-1.2">1.2</a>.  Data Size</span>

   MD5&#x27;s 128-bit output is naturally 64-bit aligned.  Typically, there
   is no further padding of the Authentication Data field.



<span class="h3"><a class="selflink" id="section-1.3" href="#section-1.3">1.3</a>.  Performance</span>

   MD5 software speeds are adequate for commonly deployed LAN and WAN
   links, but reportedly are too slow for newer link technologies [RFC-
   1810].

   Nota Bene:
      Suggestions are sought on alternative authentication algorithms
      that have significantly faster throughput, are not patent-
      encumbered, and still retain adequate cryptographic strength.



<span class="grey">Metzger &amp; Simpson             Standards Track                   [Page 1]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-2" ></span>
<span class="grey"><a href="/doc/html/rfc1828">RFC 1828</a>                         AH MD5                      August 1995</span>


<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  Calculation</span>

   The 128-bit digest is calculated as described in [<a href="/doc/html/rfc1321">RFC-1321</a>].  The
   specification of MD5 includes a portable &#x27;C&#x27; programming language
   description of the MD5 algorithm.

   The form of the authenticated message is

            key, keyfill, datagram, key, MD5fill

   First, the variable length secret authentication key is filled to the
   next 512-bit boundary, using the same pad with length technique
   defined for MD5.

   Then, the filled key is concatenated with (immediately followed by)
   the invariant fields of the entire IP datagram (variant fields are
   zeroed), concatenated with (immediately followed by) the original
   variable length key again.

   A trailing pad with length to the next 512-bit boundary for the
   entire message is added by MD5 itself.  The 128-bit MD5 digest is
   calculated, and the result is inserted into the Authentication Data
   field.

   Discussion:
      When the implementation adds the keys and padding in place before
      and after the IP datagram, care must be taken that the keys and/or
      padding are not sent over the link by the link driver.



Security Considerations

   Users need to understand that the quality of the security provided by
   this specification depends completely on the strength of the MD5 hash
   function, the correctness of that algorithm&#x27;s implementation, the
   security of the key management mechanism and its implementation, the
   strength of the key [<a href="#ref-CN94">CN94</a>], and upon the correctness of the
   implementations in all of the participating nodes.

   At the time of writing of this document, it is known to be possible
   to produce collisions in the compression function of MD5 [<a href="#ref-dBB93">dBB93</a>].
   There is not yet a known method to exploit these collisions to attack
   MD5 in practice, but this fact is disturbing to some authors
   [<a href="#ref-Schneier94">Schneier94</a>].

   It has also recently been determined [<a href="#ref-vOW94">vOW94</a>] that it is possible to
   build a machine for $10 Million that could find two chosen text



<span class="grey">Metzger &amp; Simpson             Standards Track                   [Page 2]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-3" ></span>
<span class="grey"><a href="/doc/html/rfc1828">RFC 1828</a>                         AH MD5                      August 1995</span>


   variants with a common MD5 hash value.  However, it is unclear
   whether this attack is applicable to a keyed MD5 transform.

   This attack requires approximately 24 days.  The same form of attack
   is useful on any iterated n-bit hash function, and the time is
   entirely due to the 128-bit length of the MD5 hash.

   Although there is no substantial weakness for most IP security
   applications, it should be recognized that current technology is
   catching up to the 128-bit hash length used by MD5.  Applications
   requiring extremely high levels of security may wish to move in the
   near future to algorithms with longer hash lengths.



Acknowledgements

   This document was reviewed by the IP Security Working Group of the
   Internet Engineering Task Force (IETF).  Comments should be submitted
   to the ipsec@ans.net mailing list.

   Some of the text of this specification was derived from work by
   Randall Atkinson for the SIP, SIPP, and IPv6 Working Groups.

   The basic concept and use of MD5 is derived in large part from the
   work done for SNMPv2 [<a href="/doc/html/rfc1446">RFC-1446</a>].

   Steve Bellovin, Phil Karn, Charles Lynn, Dave Mihelcic, Hilarie
   Orman, Jeffrey Schiller, Joe Touch, and David Wagner provided useful
   critiques of earlier versions of this draft.



References

   [<a id="ref-CN94">CN94</a>]   Carroll, J.M., and Nudiati, S., &quot;On Weak Keys and Weak Data:
            Foiling the Two Nemeses&quot;, Cryptologia, Vol. 18 No. 23 pp.
            253-280, July 1994.

   [<a id="ref-dBB93">dBB93</a>]  den Boer, B., and Bosselaers, A., &quot;Collisions for the
            Compression function of MD5&quot;, Advances in Cryptology --
            Eurocrypt &#x27;93 Proceedings, Berlin: Springer-Verlag 1994

   [<a id="ref-KR95">KR95</a>]   Kaliski, B., and Robshaw, M., &quot;Message authentication with
            MD5&quot;, CryptoBytes (RSA Labs Technical Newsletter), vol.1
            no.1, Spring 1995.




<span class="grey">Metzger &amp; Simpson             Standards Track                   [Page 3]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-4" ></span>
<span class="grey"><a href="/doc/html/rfc1828">RFC 1828</a>                         AH MD5                      August 1995</span>


   [<a id="ref-RFC-1321">RFC-1321</a>]
            Rivest, R., &quot;The MD5 Message-Digest Algorithm&quot;, <a href="/doc/html/rfc1321">RFC 1321</a>,
            MIT and RSA Data Security, Inc., April 1992.

   [<a id="ref-RFC-1446">RFC-1446</a>]
            Galvin, J., and K. McCloghrie, &quot;Security Protocols for
            Version 2 of the Simple Network Management Protocol
            (SNMPv2)&quot;, <a href="/doc/html/rfc1446">RFC 1446</a>, TIS, Hughes LAN Systems, April
            1993.

   [<a id="ref-RFC-1700">RFC-1700</a>]
            Reynolds, J., and J. Postel, &quot;Assigned Numbers&quot;, STD 2,
            <a href="/doc/html/rfc1700">RFC 1700</a>, USC/Information Sciences Institute, October 1994.

   [<a id="ref-RFC-1800">RFC-1800</a>]
            Postel, J., &quot;Internet Official Protocol Standards&quot;, STD 1,
            <a href="/doc/html/rfc1800">RFC 1800</a>, USC/Information Sciences Institute, July 1995.

   [<a id="ref-RFC-1810">RFC-1810</a>]
            Touch, J., &quot;Report on MD5 Performance&quot;, <a href="/doc/html/rfc1810">RFC 1810</a>,
            USC/Information Sciences Institute, June 1995.

   [<a id="ref-RFC-1825">RFC-1825</a>]
            Atkinson, R., &quot;Security Architecture for the Internet
            Protocol&quot;, <a href="/doc/html/rfc1825">RFC 1825</a>, NRL, August 1995.

   [<a id="ref-RFC-1826">RFC-1826</a>]
            Atkinson, R., &quot;IP Authentication Header&quot;, <a href="/doc/html/rfc1826">RFC 1826</a>, NRL
            August 1995.

   [<a id="ref-Schneier94">Schneier94</a>]
            Schneier, B., &quot;Applied Cryptography&quot;, John Wiley &amp; Sons, New
            York, NY, 1994.  ISBN 0-471-59756-2

   [<a id="ref-vOW94">vOW94</a>]  van Oorschot, P. C., and Wiener, M. J., &quot;Parallel Collision
            Search with Applications to Hash Functions and Discrete
            Logarithms&quot;, Proceedings of the 2nd ACM Conf. Computer and
            Communications Security, Fairfax, VA, November 1994.












<span class="grey">Metzger &amp; Simpson             Standards Track                   [Page 4]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-5" ></span>
<span class="grey"><a href="/doc/html/rfc1828">RFC 1828</a>                         AH MD5                      August 1995</span>


Author&#x27;s Address

   Questions about this memo can also be directed to:

      Perry Metzger
      Piermont Information Systems Inc.
      160 Cabrini Blvd., Suite #2
      New York, NY  10033

      perry@piermont.com


      William Allen Simpson
      Daydreamer
      Computer Systems Consulting Services
      1384 Fontaine
      Madison Heights, Michigan  48071

      Bill.Simpson@um.cc.umich.edu
          bsimpson@MorningStar.com






























Metzger &amp; Simpson             Standards Track                   [Page 5]
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

