<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    rfc5204
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.33.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.33.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/draft-ietf-hip-rvs/">
  <meta name="description" content="Host Identity Protocol (HIP) Rendezvous Extension (RFC )">
  <script src="https://www.ietf.org/lib/dt/7.33.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.33.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.33.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.33.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bgbrown"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc5204.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc5204.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/pdfrfc/rfc5204.txt.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/rfc5204/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/rfc5204/" title="Datatracker information for this document">Tracker</a>] [<a href="/group/hip/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-hip-rvs@ietf.org?subject=draft-ietf-hip-rvs" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=draft-ietf-hip-rvs-05.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-ietf-hip-rvs-05.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-ietf-hip-rvs-05.txt" title="Run an idnits check of this document">Nits</a>]

From: <a href="/doc/html/draft-ietf-hip-rvs-05">draft-ietf-hip-rvs-05</a>                                 Experimental
Obsoleted by: <a href="/doc/html/rfc8004">8004</a>                                                      </pre>
      </div>
    

    <div class="draftcontent">
    <pre>Network Working Group                                        J. Laganier
Request for Comments: 5204                              DoCoMo Euro-Labs
Category: Experimental                                         L. Eggert
                                                                   Nokia
                                                              April 2008


           <span class="h1">Host Identity Protocol (HIP) Rendezvous Extension</span>

Status of This Memo

   This memo defines an Experimental Protocol for the Internet
   community.  It does not specify an Internet standard of any kind.
   Discussion and suggestions for improvement are requested.
   Distribution of this memo is unlimited.

Abstract

   This document defines a rendezvous extension for the Host Identity
   Protocol (HIP).  The rendezvous extension extends HIP and the HIP
   registration extension for initiating communication between HIP nodes
   via HIP rendezvous servers.  Rendezvous servers improve reachability
   and operation when HIP nodes are multi-homed or mobile.




























<span class="grey">Laganier &amp; Eggert             Experimental                      [Page 1]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-2" ></span>
<span class="grey"><a href="/doc/html/rfc5204">RFC 5204</a>                HIP Rendezvous Extension              April 2008</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  Terminology  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
   <a href="#section-3">3</a>.  Overview of Rendezvous Server Operation  . . . . . . . . . . .  <a href="#page-4">4</a>
     <a href="#section-3.1">3.1</a>.  Diagram Notation . . . . . . . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
     <a href="#section-3.2">3.2</a>.  Rendezvous Client Registration . . . . . . . . . . . . . .  <a href="#page-6">6</a>
     <a href="#section-3.3">3.3</a>.  Relaying the Base Exchange . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
   <a href="#section-4">4</a>.  Rendezvous Server Extensions . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
     <a href="#section-4.1">4.1</a>.  RENDEZVOUS Registration Type . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
     <a href="#section-4.2">4.2</a>.  Parameter Formats and Processing . . . . . . . . . . . . .  <a href="#page-8">8</a>
       <a href="#section-4.2.1">4.2.1</a>.  RVS_HMAC Parameter . . . . . . . . . . . . . . . . . .  <a href="#page-8">8</a>
       <a href="#section-4.2.2">4.2.2</a>.  FROM Parameter . . . . . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
       <a href="#section-4.2.3">4.2.3</a>.  VIA_RVS Parameter  . . . . . . . . . . . . . . . . . . <a href="#page-10">10</a>
     <a href="#section-4.3">4.3</a>.  Modified Packets Processing  . . . . . . . . . . . . . . . <a href="#page-10">10</a>
       <a href="#section-4.3.1">4.3.1</a>.  Processing Outgoing I1 Packets . . . . . . . . . . . . <a href="#page-10">10</a>
       <a href="#section-4.3.2">4.3.2</a>.  Processing Incoming I1 Packets . . . . . . . . . . . . <a href="#page-11">11</a>
       <a href="#section-4.3.3">4.3.3</a>.  Processing Outgoing R1 Packets . . . . . . . . . . . . <a href="#page-11">11</a>
       <a href="#section-4.3.4">4.3.4</a>.  Processing Incoming R1 Packets . . . . . . . . . . . . <a href="#page-11">11</a>
   <a href="#section-5">5</a>.  Security Considerations  . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
   <a href="#section-6">6</a>.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
   <a href="#section-7">7</a>.  Acknowledgments  . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-13">13</a>
   <a href="#section-8">8</a>.  References . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-13">13</a>
     <a href="#section-8.1">8.1</a>.  Normative References . . . . . . . . . . . . . . . . . . . <a href="#page-13">13</a>
     <a href="#section-8.2">8.2</a>.  Informative References . . . . . . . . . . . . . . . . . . <a href="#page-14">14</a>


























<span class="grey">Laganier &amp; Eggert             Experimental                      [Page 2]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-3" ></span>
<span class="grey"><a href="/doc/html/rfc5204">RFC 5204</a>                HIP Rendezvous Extension              April 2008</span>


<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>.  Introduction</span>

   The Host Identity Protocol (HIP) Architecture [<a href="/doc/html/rfc4423" title="&quot;Host Identity Protocol (HIP) Architecture&quot;">RFC4423</a>] introduces
   the rendezvous mechanism to help a HIP node to contact a frequently
   moving HIP node.  The rendezvous mechanism involves a third party,
   the rendezvous server (RVS), which serves as an initial contact point
   (&quot;rendezvous point&quot;) for its clients.  The clients of an RVS are HIP
   nodes that use the HIP Registration Extension [<a href="/doc/html/rfc5203" title="&quot;Host Identity Protocol (HIP) Registration Extension&quot;">RFC5203</a>] to register
   their HIT-&gt;IP address mappings with the RVS.  After this
   registration, other HIP nodes can initiate a base exchange using the
   IP address of the RVS instead of the current IP address of the node
   they attempt to contact.  Essentially, the clients of an RVS become
   reachable at the RVS&#x27;s IP address.  Peers can initiate a HIP base
   exchange with the IP address of the RVS, which will relay this
   initial communication such that the base exchange may successfully
   complete.

<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  Terminology</span>

   This section defines terms used throughout the remainder of this
   specification.

   The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;,
   &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;MAY&quot;, and &quot;OPTIONAL&quot; in this
   document are to be interpreted as described in <a href="/doc/html/rfc2119">RFC 2119</a> [<a href="/doc/html/rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].

   In addition to the terminology defined in the HIP specification
   [<a href="/doc/html/rfc5201" title="&quot;Host Identity Protocol&quot;">RFC5201</a>] and the HIP Registration Extension [<a href="/doc/html/rfc5203" title="&quot;Host Identity Protocol (HIP) Registration Extension&quot;">RFC5203</a>], this document
   defines and uses the following terms:

   Rendezvous Service
      A HIP service provided by a rendezvous server to its rendezvous
      clients.  The rendezvous server offers to relay some of the
      arriving base exchange packets between the initiator and
      responder.

   Rendezvous Server (RVS)
      A HIP registrar providing rendezvous service.

   Rendezvous Client
      A HIP requester that has registered for rendezvous service at a
      rendezvous server.

   Rendezvous Registration
      A HIP registration for rendezvous service, established between a
      rendezvous server and a rendezvous client.





<span class="grey">Laganier &amp; Eggert             Experimental                      [Page 3]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-4" ></span>
<span class="grey"><a href="/doc/html/rfc5204">RFC 5204</a>                HIP Rendezvous Extension              April 2008</span>


<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>.  Overview of Rendezvous Server Operation</span>

   Figure 1 shows a simple HIP base exchange without a rendezvous
   server, in which the initiator initiates the exchange directly with
   the responder by sending an I1 packet to the responder&#x27;s IP address,
   as per the HIP specification [<a href="/doc/html/rfc5201" title="&quot;Host Identity Protocol&quot;">RFC5201</a>].

                       +-----+                +-----+
                       |     |-------I1------&gt;|     |
                       |  I  |&lt;------R1-------|  R  |
                       |     |-------I2------&gt;|     |
                       |     |&lt;------R2-------|     |
                       +-----+                +-----+

          Figure 1: HIP base exchange without rendezvous server.

   The End-Host Mobility and Multihoming with the Host Identity Protocol
   specification [<a href="/doc/html/rfc5206" title="&quot;End-Host Mobility and Multihoming with the Host Identity Protocol&quot;">RFC5206</a>] allows a HIP node to notify its peers about
   changes in its set of IP addresses.  This specification presumes
   initial reachability of the two nodes with respect to each other.

   However, such a HIP node MAY also want to be reachable to other
   future correspondent peers that are unaware of its location change.
   The HIP Architecture [<a href="/doc/html/rfc4423" title="&quot;Host Identity Protocol (HIP) Architecture&quot;">RFC4423</a>] introduces rendezvous servers with
   whom a HIP node MAY register its host identity tags (HITs) and
   current IP addresses.  An RVS relays HIP packets arriving for these
   HITs to the node&#x27;s registered IP addresses.  When a HIP node has
   registered with an RVS, it SHOULD record the IP address of its RVS in
   its DNS record, using the HIP DNS resource record type defined in the
   HIP DNS Extension [<a href="/doc/html/rfc5205" title="&quot;Host Identity Protocol (HIP) Domain Name System (DNS) Extensions&quot;">RFC5205</a>].

                                   +-----+
                          +--I1---&gt;| RVS |---I1--+
                          |        +-----+       |
                          |                      v
                       +-----+                +-----+
                       |     |&lt;------R1-------|     |
                       |  I  |-------I2------&gt;|  R  |
                       |     |&lt;------R2-------|     |
                       +-----+                +-----+

           Figure 2: HIP base exchange with a rendezvous server.

   Figure 2 shows a HIP base exchange involving a rendezvous server.  It
   is assumed that HIP node R previously registered its HITs and current
   IP addresses with the RVS, using the HIP Registration Extension
   [<a href="/doc/html/rfc5203" title="&quot;Host Identity Protocol (HIP) Registration Extension&quot;">RFC5203</a>].  When the initiator I tries to establish contact with the




<span class="grey">Laganier &amp; Eggert             Experimental                      [Page 4]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-5" ></span>
<span class="grey"><a href="/doc/html/rfc5204">RFC 5204</a>                HIP Rendezvous Extension              April 2008</span>


   responder R, it must send the I1 of the base exchange either to one
   of R&#x27;s IP addresses (if known via DNS or other means) or to one of
   R&#x27;s rendezvous servers.  Here, I obtains the IP address of R&#x27;s
   rendezvous server from R&#x27;s DNS record and then sends the I1 packet of
   the HIP base exchange to RVS.  RVS, noticing that the HIT contained
   in the arriving I1 packet is not one of its own, MUST check its
   current registrations to determine if it needs to relay the packets.
   Here, it determines that the HIT belongs to R and then relays the I1
   packet to the registered IP address.  R then completes the base
   exchange without further assistance from RVS by sending an R1
   directly to the I&#x27;s IP address, as obtained from the I1 packet.  In
   this specification, the client of the RVS is always the responder.
   However, there might be reasons to allow a client to initiate a base
   exchange through its own RVS, like NAT and firewall traversal.  This
   specification does not address such scenarios, which should be
   specified in other documents.

<span class="h3"><a class="selflink" id="section-3.1" href="#section-3.1">3.1</a>.  Diagram Notation</span>

  Notation       Significance
  --------       ------------

  I, R           I and R are the respective source and destination IP
                 addresses in the IP header.

  HIT-I, HIT-R   HIT-I and HIT-R are the initiator&#x27;s and the
                 responder&#x27;s HITs in the packet, respectively.

  REG_REQ        A REG_REQUEST parameter is present in the HIP header.

  REG_RES        A REG_RESPONSE parameter is present in the HIP header.

  FROM:I         A FROM parameter containing the IP address I is
                 present in the HIP header.

  RVS_HMAC       An RVS_HMAC parameter containing an HMAC keyed with the
                 appropriate registration key is present in the HIP
                 header.

  VIA:RVS        A VIA_RVS parameter containing the IP address RVS of a
                 rendezvous server is present in the HIP header.










<span class="grey">Laganier &amp; Eggert             Experimental                      [Page 5]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-6" ></span>
<span class="grey"><a href="/doc/html/rfc5204">RFC 5204</a>                HIP Rendezvous Extension              April 2008</span>


<span class="h3"><a class="selflink" id="section-3.2" href="#section-3.2">3.2</a>.  Rendezvous Client Registration</span>

   Before a rendezvous server starts to relay HIP packets to a
   rendezvous client, the rendezvous client needs to register with it to
   receive rendezvous service by using the HIP Registration Extension
   [<a href="/doc/html/rfc5203" title="&quot;Host Identity Protocol (HIP) Registration Extension&quot;">RFC5203</a>] as illustrated in the following schema:

                 +-----+                            +-----+
                 |     |            I1              |     |
                 |     |---------------------------&gt;|     |
                 |     |&lt;---------------------------|     |
                 |  I  |         R1(REG_INFO)       | RVS |
                 |     |         I2(REG_REQ)        |     |
                 |     |---------------------------&gt;|     |
                 |     |&lt;---------------------------|     |
                 |     |         R2(REG_RES)        |     |
                 +-----+                            +-----+

          Rendezvous client registering with a rendezvous server.

<span class="h3"><a class="selflink" id="section-3.3" href="#section-3.3">3.3</a>.  Relaying the Base Exchange</span>

   If a HIP node and one of its rendezvous servers have a rendezvous
   registration, the rendezvous servers relay inbound I1 packets (that
   contain one of the client&#x27;s HITs) by rewriting the IP header.  They
   replace the destination IP address of the I1 packet with one of the
   IP addresses of the owner of the HIT, i.e., the rendezvous client.
   They MUST also recompute the IP checksum accordingly.

   Because of egress filtering on the path from the RVS to the client
   [<a href="/doc/html/rfc2827" title="&quot;Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing&quot;">RFC2827</a>][RFC3013], a HIP rendezvous server SHOULD replace the source
   IP address, i.e., the IP address of I, with one of its own IP
   addresses.  The replacement IP address SHOULD be chosen according to
   relevant IPv4 and IPv6 specifications [<a href="/doc/html/rfc1122" title="&quot;Requirements for Internet Hosts - Communication Layers&quot;">RFC1122</a>][RFC3484].  Because
   this replacement conceals the initiator&#x27;s IP address, the RVS MUST
   append a FROM parameter containing the original source IP address of
   the packet.  This FROM parameter MUST be integrity protected by an
   RVS_HMAC keyed with the corresponding rendezvous registration
   integrity key [<a href="/doc/html/rfc5203" title="&quot;Host Identity Protocol (HIP) Registration Extension&quot;">RFC5203</a>].












<span class="grey">Laganier &amp; Eggert             Experimental                      [Page 6]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-7" ></span>
<span class="grey"><a href="/doc/html/rfc5204">RFC 5204</a>                HIP Rendezvous Extension              April 2008</span>


                                               I1(RVS, R, HIT-I, HIT-R
         I1(I, RVS, HIT-I, HIT-R) +---------+     FROM:I, RVS_HMAC)
         +-----------------------&gt;|         |--------------------+
         |                        |   RVS   |                    |
         |                        |         |                    |
         |                        +---------+                    |
         |                                                       V
        +-----+        R1(R, I, HIT-R, HIT-I, VIA:RVS)       +-----+
        |     |&lt;---------------------------------------------|     |
        |     |                                              |     |
        |  I  |            I2(I, R, HIT-I, HIT-R)            |  R  |
        |     |---------------------------------------------&gt;|     |
        |     |&lt;---------------------------------------------|     |
        +-----+             R2(R, I, HIT-R, HIT-I)           +-----+

                 Rendezvous server rewriting IP addresses.

   This modification of HIP packets at a rendezvous server can be
   problematic because the HIP protocol uses integrity checks.  Because
   the I1 does not include HMAC or SIGNATURE parameters, these two end-
   to-end integrity checks are unaffected by the operation of rendezvous
   servers.

   The RVS SHOULD verify the checksum field of an I1 packet before doing
   any modifications.  After modification, it MUST recompute the
   checksum field using the updated HIP header, which possibly included
   new FROM and RVS_HMAC parameters, and a pseudo-header containing the
   updated source and destination IP addresses.  This enables the
   responder to validate the checksum of the I1 packet &quot;as is&quot;, without
   having to parse any FROM parameters.

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>.  Rendezvous Server Extensions</span>

   This section describes extensions to the HIP Registration Extension
   [<a href="/doc/html/rfc5203" title="&quot;Host Identity Protocol (HIP) Registration Extension&quot;">RFC5203</a>], allowing a HIP node to register with a rendezvous server
   for rendezvous service and notify the RVS aware of changes to its
   current location.  It also describes an extension to the HIP
   specification [<a href="/doc/html/rfc5201" title="&quot;Host Identity Protocol&quot;">RFC5201</a>] itself, allowing establishment of HIP
   associations via one or more HIP rendezvous server(s).

<span class="h3"><a class="selflink" id="section-4.1" href="#section-4.1">4.1</a>.  RENDEZVOUS Registration Type</span>

   This specification defines an additional registration for the HIP
   Registration Extension [<a href="/doc/html/rfc5203" title="&quot;Host Identity Protocol (HIP) Registration Extension&quot;">RFC5203</a>] that allows registering with a
   rendezvous server for rendezvous service.






<span class="grey">Laganier &amp; Eggert             Experimental                      [Page 7]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-8" ></span>
<span class="grey"><a href="/doc/html/rfc5204">RFC 5204</a>                HIP Rendezvous Extension              April 2008</span>


   Number   Registration Type
   ------   -----------------
   1        RENDEZVOUS

<span class="h3"><a class="selflink" id="section-4.2" href="#section-4.2">4.2</a>.  Parameter Formats and Processing</span>

<span class="h4"><a class="selflink" id="section-4.2.1" href="#section-4.2.1">4.2.1</a>.  RVS_HMAC Parameter</span>

   The RVS_HMAC is a non-critical parameter whose only difference with
   the HMAC parameter defined in the HIP specification [<a href="/doc/html/rfc5201" title="&quot;Host Identity Protocol&quot;">RFC5201</a>] is its
   &quot;type&quot; code.  This change causes it to be located after the FROM
   parameter (as opposed to the HMAC):

 Type        65500
 Length      Variable.  Length in octets, excluding Type, Length, and
             Padding.
 HMAC        HMAC computed over the HIP packet, excluding the
             RVS_HMAC parameter and any following parameters.  The
             HMAC is keyed with the appropriate HIP integrity key
             (HIP-lg or HIP-gl) established when rendezvous
             registration happened.  The HIP &quot;checksum&quot; field MUST be set
             to zero, and the HIP header length in the HIP common header
             MUST be calculated not to cover any excluded parameter
             when the HMAC is calculated.  The size of the
             HMAC is the natural size of the hash computation
             output depending on the used hash function.

   To allow a rendezvous client and its RVS to verify the integrity of
   packets flowing between them, both SHOULD protect packets with an
   added RVS_HMAC parameter keyed with the HIP-lg or HIP-gl integrity
   key established while registration occurred.  A valid RVS_HMAC SHOULD
   be present on every packet flowing between a client and a server and
   MUST be present when a FROM parameter is processed.


















<span class="grey">Laganier &amp; Eggert             Experimental                      [Page 8]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-9" ></span>
<span class="grey"><a href="/doc/html/rfc5204">RFC 5204</a>                HIP Rendezvous Extension              April 2008</span>


<span class="h4"><a class="selflink" id="section-4.2.2" href="#section-4.2.2">4.2.2</a>.  FROM Parameter</span>

     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |             Type              |             Length            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
    |                             Address                           |
    |                                                               |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

    Type        65498
    Length      16
    Address     An IPv6 address or an IPv4-in-IPv6 format IPv4 address.

   A rendezvous server MUST add a FROM parameter containing the original
   source IP address of a HIP packet whenever the source IP address in
   the IP header is rewritten.  If one or more FROM parameters are
   already present, the new FROM parameter MUST be appended after the
   existing ones.

   Whenever an RVS inserts a FROM parameter, it MUST insert an RVS_HMAC
   protecting the packet integrity, especially the IP address included
   in the FROM parameter.

























<span class="grey">Laganier &amp; Eggert             Experimental                      [Page 9]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-10" ></span>
<span class="grey"><a href="/doc/html/rfc5204">RFC 5204</a>                HIP Rendezvous Extension              April 2008</span>


<span class="h4"><a class="selflink" id="section-4.2.3" href="#section-4.2.3">4.2.3</a>.  VIA_RVS Parameter</span>

     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |             Type              |             Length            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
    |                            Address                            |
    |                                                               |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    .                               .                               .
    .                               .                               .
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
    |                            Address                            |
    |                                                               |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

    Type        65502
    Length      Variable
    Address     An IPv6 address or an IPv4-in-IPv6 format IPv4 address.

   After the responder receives a relayed I1 packet, it can begin to
   send HIP packets addressed to the initiator&#x27;s IP address, without
   further assistance from an RVS.  For debugging purposes, it MAY
   include a subset of the IP addresses of its RVSs in some of these
   packets.  When a responder does so, it MUST append a newly created
   VIA_RVS parameter at the end of the HIP packet.  The main goal of
   using the VIA_RVS parameter is to allow operators to diagnose
   possible issues encountered while establishing a HIP association via
   an RVS.

<span class="h3"><a class="selflink" id="section-4.3" href="#section-4.3">4.3</a>.  Modified Packets Processing</span>

   The following subsections describe the differences of processing of
   I1 and R1 while a rendezvous server is involved in the base exchange.

<span class="h4"><a class="selflink" id="section-4.3.1" href="#section-4.3.1">4.3.1</a>.  Processing Outgoing I1 Packets</span>

   An initiator SHOULD NOT send an opportunistic I1 with a NULL
   destination HIT to an IP address that is known to be a rendezvous
   server address, unless it wants to establish a HIP association with
   the rendezvous server itself and does not know its HIT.





<span class="grey">Laganier &amp; Eggert             Experimental                     [Page 10]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-11" ></span>
<span class="grey"><a href="/doc/html/rfc5204">RFC 5204</a>                HIP Rendezvous Extension              April 2008</span>


   When an RVS rewrites the source IP address of an I1 packet due to
   egress filtering, it MUST add a FROM parameter to the I1 that
   contains the initiator&#x27;s source IP address.  This FROM parameter MUST
   be protected by an RVS_HMAC keyed with the integrity key established
   at rendezvous registration.

<span class="h4"><a class="selflink" id="section-4.3.2" href="#section-4.3.2">4.3.2</a>.  Processing Incoming I1 Packets</span>

   When a rendezvous server receives an I1 whose destination HIT is not
   its own, it consults its registration database to find a registration
   for the rendezvous service established by the HIT owner.  If it finds
   an appropriate registration, it relays the packet to the registered
   IP address.  If it does not find an appropriate registration, it
   drops the packet.

   A rendezvous server SHOULD interpret any incoming opportunistic I1
   (i.e., an I1 with a NULL destination HIT) as an I1 addressed to
   itself and SHOULD NOT attempt to relay it to one of its clients.

   When a rendezvous client receives an I1, it MUST validate any present
   RVS_HMAC parameter.  If the RVS_HMAC cannot be verified, the packet
   SHOULD be dropped.  If the RVS_HMAC cannot be verified and a FROM
   parameter is present, the packet MUST be dropped.

   A rendezvous client acting as responder SHOULD drop opportunistic I1s
   that include a FROM parameter, because this indicates that the I1 has
   been relayed.

<span class="h4"><a class="selflink" id="section-4.3.3" href="#section-4.3.3">4.3.3</a>.  Processing Outgoing R1 Packets</span>

   When a responder replies to an I1 relayed via an RVS, it MUST append
   to the regular R1 header a VIA_RVS parameter containing the IP
   addresses of the traversed RVSs.

<span class="h4"><a class="selflink" id="section-4.3.4" href="#section-4.3.4">4.3.4</a>.  Processing Incoming R1 Packets</span>

   The HIP specification [<a href="/doc/html/rfc5201" title="&quot;Host Identity Protocol&quot;">RFC5201</a>] mandates that a system receiving an
   R1 MUST first check to see if it has sent an I1 to the originator of
   the R1 (i.e., the system is in state I1-SENT).  When the R1 is
   replying to a relayed I1, this check SHOULD be based on HITs only.
   In case the IP addresses are also checked, then the source IP address
   MUST be checked against the IP address included in the VIA_RVS
   parameter.








<span class="grey">Laganier &amp; Eggert             Experimental                     [Page 11]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-12" ></span>
<span class="grey"><a href="/doc/html/rfc5204">RFC 5204</a>                HIP Rendezvous Extension              April 2008</span>


<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>.  Security Considerations</span>

   This section discusses the known threats introduced by these HIP
   extensions and the implications on the overall security of HIP.  In
   particular, it argues that the extensions described in this document
   do not introduce additional threats to the Host Identity Protocol.

   It is difficult to encompass the whole scope of threats introduced by
   rendezvous servers because their presence has implications both at
   the IP and HIP layers.  In particular, these extensions might allow
   for redirection, amplification, and reflection attacks at the IP
   layer, as well as attacks on the HIP layer itself, for example, man-
   in-the-middle attacks against the HIP base exchange.

   If an initiator has a priori knowledge of the responder&#x27;s host
   identity when it first contacts the responder via an RVS, it has a
   means to verify the signatures in the HIP base exchange, which
   protects against man-in-the-middle attacks.

   If an initiator does not have a priori knowledge of the responder&#x27;s
   host identity (so-called &quot;opportunistic initiators&quot;), it is almost
   impossible to defend the HIP exchange against these attacks, because
   the public keys exchanged cannot be authenticated.  The only approach
   would be to mitigate hijacking threats on HIP state by requiring an
   R1 answering an opportunistic I1 to come from the same IP address
   that originally sent the I1.  This procedure retains a level of
   security that is equivalent to what exists in the Internet today.

   However, for reasons of simplicity, this specification does not allow
   the establishment of a HIP association via a rendezvous server in an
   opportunistic manner.

<span class="h2"><a class="selflink" id="section-6" href="#section-6">6</a>.  IANA Considerations</span>

   This section is to be interpreted according to the Guidelines for
   Writing an IANA Considerations Section in RFCs [<a href="/doc/html/rfc2434" title="">RFC2434</a>].

   This document updates the IANA Registry for HIP Parameters Types by
   assigning new HIP Parameter Types values for the new HIP Parameters
   defined in <a href="#section-4.2">Section 4.2</a>:

   o  RVS_HMAC (defined in <a href="#section-4.2.1">Section 4.2.1</a>)

   o  FROM (defined in <a href="#section-4.2.2">Section 4.2.2</a>)

   o  VIA_RVS (defined in <a href="#section-4.2.3">Section 4.2.3</a>)





<span class="grey">Laganier &amp; Eggert             Experimental                     [Page 12]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-13" ></span>
<span class="grey"><a href="/doc/html/rfc5204">RFC 5204</a>                HIP Rendezvous Extension              April 2008</span>


   This document defines an additional registration for the HIP
   Registration Extension [<a href="/doc/html/rfc5203" title="&quot;Host Identity Protocol (HIP) Registration Extension&quot;">RFC5203</a>] that allows registering with a
   rendezvous server for rendezvous service.

   Number   Registration Type
   ------   -----------------
   1        RENDEZVOUS

<span class="h2"><a class="selflink" id="section-7" href="#section-7">7</a>.  Acknowledgments</span>

   The following people have provided thoughtful and helpful discussions
   and/or suggestions that have improved this document: Marcus Brunner,
   Tom Henderson, Miika Komu, Mika Kousa, Pekka Nikander, Justino
   Santos, Simon Schuetz, Tim Shepard, Kristian Slavov, Martin
   Stiemerling, and Juergen Quittek.

<span class="h2"><a class="selflink" id="section-8" href="#section-8">8</a>.  References</span>

<span class="h3"><a class="selflink" id="section-8.1" href="#section-8.1">8.1</a>.  Normative References</span>

   [<a id="ref-RFC1122">RFC1122</a>]  Braden, R., &quot;Requirements for Internet Hosts -
              Communication Layers&quot;, STD 3, <a href="/doc/html/rfc1122">RFC 1122</a>, October 1989.

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., &quot;Key words for use in RFCs to Indicate
              Requirement Levels&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc2119">RFC 2119</a>, March 1997.

   [<a id="ref-RFC2434">RFC2434</a>]  Narten, T. and H. Alvestrand, &quot;Guidelines for Writing an
              IANA Considerations Section in RFCs&quot;, <a href="/doc/html/bcp26">BCP 26</a>, <a href="/doc/html/rfc2434">RFC 2434</a>,
              October 1998.

   [<a id="ref-RFC3484">RFC3484</a>]  Draves, R., &quot;Default Address Selection for Internet
              Protocol version 6 (IPv6)&quot;, <a href="/doc/html/rfc3484">RFC 3484</a>, February 2003.

   [<a id="ref-RFC5201">RFC5201</a>]  Moskowitz, R., Nikander, P., Jokela, P., Ed., and T.
              Henderson, &quot;Host Identity Protocol&quot;, <a href="/doc/html/rfc5201">RFC 5201</a>, April 2008.

   [<a id="ref-RFC5203">RFC5203</a>]  Laganier, J., Koponen, T., and L. Eggert, &quot;Host Identity
              Protocol (HIP) Registration Extension&quot;, <a href="/doc/html/rfc5203">RFC 5203</a>,
              April 2008.

   [<a id="ref-RFC5205">RFC5205</a>]  Nikander, P. and J. Laganier, &quot;Host Identity Protocol
              (HIP) Domain Name System (DNS) Extensions&quot;, <a href="/doc/html/rfc5205">RFC 5205</a>,
              April 2008.








<span class="grey">Laganier &amp; Eggert             Experimental                     [Page 13]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-14" ></span>
<span class="grey"><a href="/doc/html/rfc5204">RFC 5204</a>                HIP Rendezvous Extension              April 2008</span>


<span class="h3"><a class="selflink" id="section-8.2" href="#section-8.2">8.2</a>.  Informative References</span>

   [<a id="ref-RFC2827">RFC2827</a>]  Ferguson, P. and D. Senie, &quot;Network Ingress Filtering:
              Defeating Denial of Service Attacks which employ IP Source
              Address Spoofing&quot;, <a href="/doc/html/bcp38">BCP 38</a>, <a href="/doc/html/rfc2827">RFC 2827</a>, May 2000.

   [<a id="ref-RFC3013">RFC3013</a>]  Killalea, T., &quot;Recommended Internet Service Provider
              Security Services and Procedures&quot;, <a href="/doc/html/bcp46">BCP 46</a>, <a href="/doc/html/rfc3013">RFC 3013</a>,
              November 2000.

   [<a id="ref-RFC4423">RFC4423</a>]  Moskowitz, R. and P. Nikander, &quot;Host Identity Protocol
              (HIP) Architecture&quot;, <a href="/doc/html/rfc4423">RFC 4423</a>, May 2006.

   [<a id="ref-RFC5206">RFC5206</a>]  Henderson, T., Ed., &quot;End-Host Mobility and Multihoming
              with the Host Identity Protocol&quot;, <a href="/doc/html/rfc5206">RFC 5206</a>, April 2008.

Authors&#x27; Addresses

   Julien Laganier
   DoCoMo Communications Laboratories Europe GmbH
   Landsberger Strasse 312
   Munich  80687
   Germany

   Phone: +49 89 56824 231
   EMail: julien.ietf@laposte.net
   URI:   <a href="http://www.docomolab-euro.com/">http://www.docomolab-euro.com/</a>


   Lars Eggert
   Nokia Research Center
   P.O. Box 407
   Nokia Group  00045
   Finland

   Phone: +358 50 48 24461
   EMail: lars.eggert@nokia.com
   URI:   <a href="http://research.nokia.com/people/lars_eggert/">http://research.nokia.com/people/lars_eggert/</a>













<span class="grey">Laganier &amp; Eggert             Experimental                     [Page 14]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-15" ></span>
<span class="grey"><a href="/doc/html/rfc5204">RFC 5204</a>                HIP Rendezvous Extension              April 2008</span>


Full Copyright Statement

   Copyright (C) The IETF Trust (2008).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="/doc/html/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   &quot;AS IS&quot; basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="/doc/html/bcp78">BCP 78</a> and <a href="/doc/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.












Laganier &amp; Eggert             Experimental                     [Page 15]
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

