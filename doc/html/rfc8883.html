<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    rfc8883
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.34.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.34.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/draft-ietf-6man-icmp-limits/">
  <meta name="description" content="ICMPv6 Errors for Discarding Packets Due to Processing Limits (RFC )">
  <script src="https://www.ietf.org/lib/dt/7.34.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.34.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bgblue"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc8883.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc8883.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/rfc8883.xml" title="XML source for this document">xml</a>|<a href="https://www.rfc-editor.org/rfc/rfc8883.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/rfc8883/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/rfc8883/" title="Datatracker information for this document">Tracker</a>] [<a href="/group/6man/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-6man-icmp-limits@ietf.org?subject=draft-ietf-6man-icmp-limits" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=draft-ietf-6man-icmp-limits-08.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-ietf-6man-icmp-limits-08.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-ietf-6man-icmp-limits-08.txt" title="Run an idnits check of this document">Nits</a>]

From: <a href="/doc/html/draft-ietf-6man-icmp-limits-08">draft-ietf-6man-icmp-limits-08</a>                   Proposed Standard</pre>
      </div>
    

    <div class="draftcontent">
    <pre>Internet Engineering Task Force (IETF)                        T. Herbert
Request for Comments: 8883                                         Intel
Category: Standards Track                                 September 2020
ISSN: 2070-1721


     <span class="h1">ICMPv6 Errors for Discarding Packets Due to Processing Limits</span>

Abstract

   Network nodes may discard packets if they are unable to process
   protocol headers of packets due to processing constraints or limits.
   When such packets are dropped, the sender receives no indication, so
   it cannot take action to address the cause of discarded packets.
   This specification defines several new ICMPv6 errors that can be sent
   by a node that discards packets because it is unable to process the
   protocol headers.  A node that receives such an ICMPv6 error may use
   the information to diagnose packet loss and may modify what it sends
   in future packets to avoid subsequent packet discards.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="/doc/html/rfc7841#section-2">Section&nbsp;2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="https://www.rfc-editor.org/info/rfc8883">https://www.rfc-editor.org/info/rfc8883</a>.

Copyright Notice

   Copyright (c) 2020 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="/doc/html/bcp78">BCP 78</a> and the IETF Trust&#x27;s Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction
     1.1.  Extension Header Limits
     1.2.  Aggregate Header Limits
     1.3.  Nonconformant Packet Discard
     1.4.  Terminology
   2.  ICMPv6 Errors for Extension Header Limits
     2.1.  Format
     2.2.  Unrecognized Next Header Type Encountered by Intermediate
           Node (Code 5)
     2.3.  Extension Header Too Big (Code 6)
     2.4.  Extension Header Chain Too Long (Code 7)
     2.5.  Too Many Extension Headers (Code 8)
     2.6.  Too Many Options in Extension Header (Code 9)
     2.7.  Option Too Big (Code 10)
   3.  ICMPv6 Error for Aggregate Header Limits
     3.1.  Format
     3.2.  Usage
   4.  Operation
     4.1.  Priority of Reporting
     4.2.  Host Response
   5.  Applicability and Use Cases
     5.1.  Reliability of ICMP
     5.2.  Processing Limits
       5.2.1.  Long Headers and Header Chains
       5.2.2.  At End Hosts
       5.2.3.  At Intermediate Nodes
   6.  Security Considerations
   7.  IANA Considerations
     7.1.  Parameter Problem Codes
     7.2.  Destination Unreachable Codes
     7.3.  ICMP Extension Object Classes and Class Sub-types
   8.  References
     8.1.  Normative References
     8.2.  Informative References
   Acknowledgments
   Author&#x27;s Address

<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>.  Introduction</span>

   This document specifies several new ICMPv6 errors that can be sent
   when a node discards a packet due to it being unable to process the
   necessary protocol headers because of processing constraints or
   limits.  New ICMPv6 code points are defined to supplement those
   defined in [<a href="/doc/html/rfc4443" title="&quot;Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification&quot;">RFC4443</a>].  Six of the errors are specific to the
   processing of extension headers; another error is used when the
   aggregate protocol headers in a packet exceed the processing limits
   of a node.

<span class="h3"><a class="selflink" id="section-1.1" href="#section-1.1">1.1</a>.  Extension Header Limits</span>

   In IPv6, optional internet-layer information is carried in one or
   more IPv6 extension headers [<a href="/doc/html/rfc8200" title="&quot;Internet Protocol, Version 6 (IPv6) Specification&quot;">RFC8200</a>].  Extension headers are placed
   between the IPv6 header and the upper-layer header in a packet.  The
   term &quot;header chain&quot; refers collectively to the IPv6 header, extension
   headers, and upper-layer headers occurring in a packet.  Individual
   extension headers may have a maximum length of 2048 octets and must
   fit into a single packet.  Destination Options and Hop-by-Hop Options
   contain a list of options in type-length-value (TLV) format.  Each
   option includes a length of the data field in octets: the minimum
   size of an option (non-pad type) is two octets, and the maximum size
   is 257 octets.  The number of options in an extension header is only
   limited by the length of the extension header and the Path MTU from
   the source to the destination.  Options may be skipped over by a
   receiver if they are unknown and the Option Type indicates to skip
   (first two high order bits are 00).

   Per [<a href="/doc/html/rfc8200" title="&quot;Internet Protocol, Version 6 (IPv6) Specification&quot;">RFC8200</a>], except for Hop-by-Hop Options, extension headers are
   not examined or processed by intermediate nodes.  However, in
   deployed networks, many intermediate nodes do examine extension
   headers for various purposes.  For instance, a node may examine all
   extension headers to locate the transport header of a packet in order
   to implement transport-layer filtering or to track connections to
   implement a stateful firewall.

   Destination hosts are expected to process all extension headers and
   options in Hop-by-Hop and Destination Options.

   Due to the variable lengths, high maximum lengths, or potential for a
   denial-of-service attack of extension headers, many devices impose
   operational limits on extension headers in packets they process.
   [<a href="/doc/html/rfc7045" title="&quot;Transmission and Processing of IPv6 Extension Headers&quot;">RFC7045</a>] discusses the requirements of intermediate nodes that
   discard packets because of unrecognized extension headers.  [<a href="/doc/html/rfc8504" title="&quot;IPv6 Node Requirements&quot;">RFC8504</a>]
   discusses limits that may be applied to the number of options in Hop-
   by-Hop Options or Destination Options extension headers.  Both
   intermediate nodes and end hosts may apply limits to extension header
   processing.  When a limit is exceeded, the typical behavior is to
   silently discard the packet.

   This specification defines six Parameter Problem codes that may be
   sent by a node that discards a packet due to the processing limits of
   extension headers being exceeded.  The information in these ICMPv6
   errors may be used for diagnostics to determine why packets are being
   dropped.  Additionally, a source node that receives these ICMPv6
   errors may be able to modify its use of extension headers in
   subsequent packets sent to the destination in order to avoid further
   occurrences of packets being discarded.

<span class="h3"><a class="selflink" id="section-1.2" href="#section-1.2">1.2</a>.  Aggregate Header Limits</span>

   Some hardware devices implement a parsing buffer of a fixed size to
   process packets.  The parsing buffer is expected to contain all the
   headers (often up to a transport-layer header for filtering) that a
   device needs to examine.  If the aggregate length of headers in a
   packet exceeds the size of the parsing buffer, a device will either
   discard the packet or defer processing to a software slow path.  In
   any case, no indication of a problem is sent back to the sender.

   This document defines one code for ICMPv6 Destination Unreachable
   that is sent by a node that is unable to process the headers of a
   packet due to the aggregate size of the packet headers exceeding a
   processing limit.  The information in this ICMPv6 error may be used
   for diagnostics to determine why packets are being dropped.
   Additionally, a source node that receives this ICMPv6 error may be
   able to modify the headers used in subsequent packets to try to avoid
   further occurrences of packets being discarded.

<span class="h3"><a class="selflink" id="section-1.3" href="#section-1.3">1.3</a>.  Nonconformant Packet Discard</span>

   The ICMP errors defined in this specification may be applicable to
   scenarios in which a node is dropping packets outside the auspices of
   any standard specification.  For instance, an intermediate node might
   send a &quot;Headers too long&quot; code in a case where it drops a packet
   because it is unable to parse deeply enough to extract the transport-
   layer information needed for packet filtering.  Such behavior might
   be considered nonconformant (with respect to [<a href="/doc/html/rfc8200" title="&quot;Internet Protocol, Version 6 (IPv6) Specification&quot;">RFC8200</a>], for
   instance).

   This specification does not advocate behaviors that might be
   considered nonconformant.  However, packet discard does occur in real
   deployments, and the intent of this specification is to provide
   visibility as to why packets are being discarded.  In the spirit that
   providing some reason is better than a silent drop, the sending of
   ICMP errors is RECOMMENDED even in cases where a node might be
   discarding packets per a nonconformant behavior.

<span class="h3"><a class="selflink" id="section-1.4" href="#section-1.4">1.4</a>.  Terminology</span>

   The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;,
   &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;NOT RECOMMENDED&quot;, &quot;MAY&quot;, and
   &quot;OPTIONAL&quot; in this document are to be interpreted as described in
   <a href="/doc/html/bcp14">BCP 14</a> [<a href="/doc/html/rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>] [<a href="/doc/html/rfc8174" title="&quot;Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words&quot;">RFC8174</a>] when, and only when, they appear in all
   capitals, as shown here.

<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  ICMPv6 Errors for Extension Header Limits</span>

   Six new codes are defined for the Parameter Problem type.

<span class="h3"><a class="selflink" id="section-2.1" href="#section-2.1">2.1</a>.  Format</span>

   The format of the ICMPv6 Parameter Problem message [<a href="/doc/html/rfc4443" title="&quot;Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification&quot;">RFC4443</a>] for an
   extension header limit exceeded error is:

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |     Code      |          Checksum             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                            Pointer                            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                    As much of the invoking packet             |
   +               as possible without the ICMPv6 packet           +
   |              exceeding the minimum IPv6 MTU [<a href="/doc/html/rfc8200" title="&quot;Internet Protocol, Version 6 (IPv6) Specification&quot;">RFC8200</a>]         |

   IPv6 Header Fields:
      Destination Address:
         Copied from the Source Address field of the invoking packet.

   ICMPv6 Fields:
      Type:
         4  (Parameter Problem type)

      Code:
         (pertinent to this specification)

                  +----+----------------------------------+
                  | 5  | Unrecognized Next Header type    |
                  |    | encountered by intermediate node |
                  +----+----------------------------------+
                  | 6  | Extension header too big         |
                  +----+----------------------------------+
                  | 7  | Extension header chain too long  |
                  +----+----------------------------------+
                  | 8  | Too many extension headers       |
                  +----+----------------------------------+
                  | 9  | Too many options in extension    |
                  |    | header                           |
                  +----+----------------------------------+
                  | 10 | Option too big                   |
                  +----+----------------------------------+

                                   Table 1

      Pointer:
         Identifies the octet offset within the invoking packet where
         the problem occurred.

         The pointer will point beyond the end of the IPv6 packet if the
         field exceeding the limit is beyond what can fit in the maximum
         size of an ICMPv6 error message.  If the pointer is used as an
         offset to read the data in the invoking packet, then a node
         MUST first validate that the pointer value is less than the
         length of the invoking packet data.

<span class="h3"><a class="selflink" id="section-2.2" href="#section-2.2">2.2</a>.  Unrecognized Next Header Type Encountered by Intermediate Node</span>
      (Code 5)

   This code SHOULD be sent by an intermediate node that discards a
   packet because it encounters a Next Header type that is unknown in
   its examination.  The ICMPv6 Pointer field is set to the offset of
   the unrecognized Next Header value within the original packet.

   Note that this code is sent by intermediate nodes and SHOULD NOT be
   sent by a final destination.  If a final destination node observes an
   unrecognized header, then it SHOULD send an ICMP Parameter Problem
   message with an ICMP Code value of 1 (&quot;unrecognized Next Header type
   encountered&quot;) as specified in [<a href="/doc/html/rfc8200" title="&quot;Internet Protocol, Version 6 (IPv6) Specification&quot;">RFC8200</a>].

<span class="h3"><a class="selflink" id="section-2.3" href="#section-2.3">2.3</a>.  Extension Header Too Big (Code 6)</span>

   An ICMPv6 Parameter Problem with code for &quot;Extension header too big&quot;
   SHOULD be sent when a node discards a packet because the size of an
   extension header exceeds its processing limit.  The ICMPv6 Pointer
   field is set to the offset of the first octet in the extension header
   that exceeds the limit.

<span class="h3"><a class="selflink" id="section-2.4" href="#section-2.4">2.4</a>.  Extension Header Chain Too Long (Code 7)</span>

   An ICMPv6 Parameter Problem with code for &quot;Extension header chain too
   long&quot; SHOULD be sent when a node discards a packet with an extension
   header chain that exceeds a limit on the total size in octets of the
   header chain.  The ICMPv6 Pointer is set to the first octet beyond
   the limit.

<span class="h3"><a class="selflink" id="section-2.5" href="#section-2.5">2.5</a>.  Too Many Extension Headers (Code 8)</span>

   An ICMPv6 Parameter Problem with code for &quot;Too many extension
   headers&quot; SHOULD be sent when a node discards a packet with an
   extension header chain that exceeds a limit on the number of
   extension headers in the chain.  The ICMPv6 Pointer is set to the
   offset of the first octet of the first extension header that is
   beyond the limit.

<span class="h3"><a class="selflink" id="section-2.6" href="#section-2.6">2.6</a>.  Too Many Options in Extension Header (Code 9)</span>

   An ICMPv6 Parameter Problem with code for &quot;Too many options in
   extension header&quot; SHOULD be sent when a node discards a packet with
   an extension header that has a number of options that exceeds the
   processing limits of the node.  This code is applicable for
   Destination Options and Hop-by-Hop Options.  The ICMPv6 Pointer field
   is set to the first octet of the first option that exceeds the limit.

<span class="h3"><a class="selflink" id="section-2.7" href="#section-2.7">2.7</a>.  Option Too Big (Code 10)</span>

   An ICMPv6 Parameter Problem with code for &quot;Option too big&quot; is sent in
   two different cases: when the length of an individual Hop-by-Hop or
   Destination Option exceeds a limit, or when the length or number of
   consecutive Hop-by-Hop or Destination padding options exceeds a
   limit.  In a case where the length of an option exceeds a processing
   limit, the ICMPv6 Pointer field is set to the offset of the first
   octet of the option that exceeds the limit.  In cases where the
   length or number of padding options exceeds a limit, the ICMPv6
   Pointer field is set to the offset of the first octet of the padding
   option that exceeds the limit.

   Possible limits related to padding include:

   *  The number of consecutive PAD1 options in Destination Options or
      Hop-by-Hop Options is limited to seven octets [<a href="/doc/html/rfc8504" title="&quot;IPv6 Node Requirements&quot;">RFC8504</a>].

   *  The length of PADN options in Destination Options or Hop-by-Hop
      Options is limited seven octets [<a href="/doc/html/rfc8504" title="&quot;IPv6 Node Requirements&quot;">RFC8504</a>].

   *  The aggregate length of a set of consecutive PAD1 or PADN options
      in Destination Options or Hop-by-Hop Options is limited to seven
      octets.

<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>.  ICMPv6 Error for Aggregate Header Limits</span>

   One code is defined for the Destination Unreachable type for
   aggregate header limits.

   This ICMP error may be applied to other headers in a packet than just
   the IPv6 header or IPv6 extension headers.  Therefore, a Destination
   Unreachable type with a multi-part ICMPv6 message format is used in
   lieu of the Parameter Problem type, which only indicates errors
   concerning IPv6 headers.

<span class="h3"><a class="selflink" id="section-3.1" href="#section-3.1">3.1</a>.  Format</span>

   The error for aggregate header limits employs a multi-part ICMPv6
   message format as defined in [<a href="/doc/html/rfc4884" title="&quot;Extended ICMP to Support Multi-Part Messages&quot;">RFC4884</a>].  The extension object class
   &quot;Extended Information&quot; is defined to contain objects for ancillary
   information pertaining to an ICMP Destination Unreachable error.
   Within this object class, the sub-type &quot;Pointer&quot; is defined, which
   contains a Pointer field with similar semantics to the Pointer field
   in ICMP Parameter Problem errors.

   The format of the ICMPv6 message for an aggregate header limit
   exceeded is:

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\
   |     Type      |     Code      |          Checksum             | |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ I
   |    Length     |                  Unused                       | C
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ M
   |                                                               | P
   ~                As much of the invoking packet                 ~
   |              as possible without the ICMPv6 packet            |
   |             exceeding the minimum IPv6 MTU [<a href="/doc/html/rfc8200" title="&quot;Internet Protocol, Version 6 (IPv6) Specification&quot;">RFC8200</a>]          |/
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+/
   |Version|       Reserved        |           Checksum            |\
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ E
   |             Length            |   Class-Num   |   C-Type      | X
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ T
   |                            Pointer                            | |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+/

   IPv6 Header Fields:
      Destination Address:
         Copied from the Source Address field of the invoking packet.

   ICMPv6 Fields:
      Type:
         1 -  Destination Unreachable

      Code: (pertinent to this specification)
         8 -  Headers too long

      Length:
         Length of the padded invoking packet data measured in 64-bit
         words.  The ICMP extension structure immediately follows the
         padded invoking packet data.

      Invoking Packet:
         Contains as much of the invoking packet as possible without the
         ICMPv6 packet exceeding the minimum IPv6 MTU.  The invoking
         packet data MUST be zero padded to the nearest 64-bit boundary
         [<a href="/doc/html/rfc4884" title="&quot;Extended ICMP to Support Multi-Part Messages&quot;">RFC4884</a>].  If the original invoking packet did not contain 128
         octets, the invoking packet data MUST be zero padded to 128
         octets.

   ICMP Extension Fields:
      Version:
         2 -  per [<a href="/doc/html/rfc4884" title="&quot;Extended ICMP to Support Multi-Part Messages&quot;">RFC4884</a>]

      Reserved:
         0

      Checksum:
         The one&#x27;s complement checksum of the ICMP extension [<a href="/doc/html/rfc4884" title="&quot;Extended ICMP to Support Multi-Part Messages&quot;">RFC4884</a>]

      Length:
         8 -  length of the object header and Pointer field

      Class-Num:
         4 -  Extended Information

      C-Type:
         1 -  Pointer

      Pointer:
         Identifies the octet offset within the invoking packet where a
         limit was exceeded.

         The pointer will point beyond the end of the invoking packet
         data if the field exceeding the limit is beyond what can fit in
         the maximum size of an ICMPv6 error message with the ICMP
         extension.  If the pointer is used as an offset to read the
         data in the invoking packet, then a node MUST first validate
         that the pointer value is less than the length of the invoking
         packet data.

<span class="h3"><a class="selflink" id="section-3.2" href="#section-3.2">3.2</a>.  Usage</span>

   An ICMPv6 Destination Unreachable error with code for &quot;Headers too
   long&quot; SHOULD be sent when a node discards a packet because the
   aggregate length of the headers in the packet exceeds the processing
   limits of the node.  The Pointer in the extended ICMPv6 structure is
   set to the offset of the first octet that exceeds the limit.

   This error is sent in response to a node dropping a packet because
   the aggregate header chain exceeds the processing limits of a node.
   The aggregate header chain may be composed of protocol headers other
   than an IPv6 header and IPv6 extension headers.  For instance, in the
   case of a node parsing a UDP encapsulation protocol, the
   encapsulating UDP header would be considered to be in the aggregate
   header chain.

   As noted in <a href="#section-4.1">Section 4.1</a>, the ICMPv6 Destination Unreachable error
   with code for &quot;Headers too long&quot; has the lowest precedence of the
   ICMP errors discussed in this specification.  If a packet contains an
   error corresponding to a Parameter Problem code, then a node SHOULD
   send the Parameter Problem error instead of sending the ICMPv6
   Destination Unreachable error with code for &quot;Headers too long&quot;.

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>.  Operation</span>

   Nodes that send or receive ICMPv6 errors due to header processing
   limits MUST comply with ICMPv6 processing as specified in [<a href="/doc/html/rfc4443" title="&quot;Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification&quot;">RFC4443</a>].

<span class="h3"><a class="selflink" id="section-4.1" href="#section-4.1">4.1</a>.  Priority of Reporting</span>

   More than one ICMPv6 error may be applicable to report for a packet.
   For instance, the number of extension headers in a packet might
   exceed a limit, and the aggregate length of protocol headers might
   also exceed a limit.  Only one ICMPv6 error SHOULD be sent for a
   packet, so a priority is defined to determine which error to report.

   The RECOMMENDED reporting priority of ICMPv6 errors for processing
   limits is listed from highest to lowest priority:

   1.  Existing ICMP errors defined in [<a href="/doc/html/rfc4443" title="&quot;Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification&quot;">RFC4443</a>].

   2.  &quot;Unrecognized Next Header type encountered by intermediate node&quot;

   3.  &quot;Extension header too big&quot;

   4.  &quot;Option too big&quot; for length or number of consecutive padding
       options exceeding a limit.

   5.  &quot;Option too big&quot; for the length of an option exceeding a limit.

   6.  &quot;Too many options in an extension header&quot;

   7.  &quot;Extension header chain too long&quot; headers exceeding a limit.

   8.  &quot;Too many extension headers&quot;

   9.  &quot;Headers too long&quot;

<span class="h3"><a class="selflink" id="section-4.2" href="#section-4.2">4.2</a>.  Host Response</span>

   When a source host receives an ICMPv6 error for a processing limit
   being exceeded, it SHOULD verify the ICMPv6 error is valid and take
   appropriate action as suggested below.

   The general validations for ICMP as described in [<a href="/doc/html/rfc4443" title="&quot;Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification&quot;">RFC4443</a>] are
   applicable.  The packet in the ICMP data SHOULD be validated to match
   the upper-layer process or connection that generated the original
   packet.  Other validation checks that are specific to the upper
   layers may be performed and are out of the scope of this
   specification.

   The ICMPv6 error SHOULD be logged with sufficient detail for
   debugging packet loss.  The details of the error, including the
   addresses and the offending extension header or data, should be
   retained.  This, for instance, would be useful for debugging when a
   node is misconfigured and unexpectedly discarding packets or when a
   new extension header is being deployed.

   A host MAY modify its usage of protocol headers in subsequent packets
   to avoid repeated occurrences of the same error.

   For ICMPv6 errors caused by extension header limits being exceeded:

   *  An error SHOULD be reported to an application if the application
      enabled extension headers for its traffic.  In response, the
      application may terminate communications if extension headers are
      required, stop using extension headers in packets to the
      destination indicated by the ICMPv6 error, or attempt to modify
      its use of headers or extension headers to avoid further packet
      discards.

   *  A host system SHOULD take appropriate action if it is creating
      packets with extension headers on behalf of the application.  If
      the offending extension header is not required for communication,
      the host may either stop sending it or otherwise modify its use in
      subsequent packets sent to the destination indicated in the ICMPv6
      error.

<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>.  Applicability and Use Cases</span>

<span class="h3"><a class="selflink" id="section-5.1" href="#section-5.1">5.1</a>.  Reliability of ICMP</span>

   ICMP is fundamentally an unreliable protocol and, in real deployment,
   it may consistently fail over some paths.  As with any other use of
   ICMP, it is assumed that the errors defined in this document are only
   the best effort to be delivered.  No protocol should be implemented
   that relies on reliable delivery of ICMP messages.  If necessary,
   alternative or additional mechanisms may be employed to augment the
   processes used to deduce the reason that packets are being discarded.
   For instance, ICMP error messages may be correlated with information
   attained through Packetization Layer Path MTU Discovery (PLPMTUD)
   [<a href="/doc/html/rfc4821" title="&quot;Packetization Layer Path MTU Discovery&quot;">RFC4821</a>] or Happy Eyeballs for IPv6 [<a href="/doc/html/rfc8305" title="&quot;Happy Eyeballs Version 2: Better Connectivity Using Concurrency&quot;">RFC8305</a>].  Details of the
   interaction with alternative mechanisms are out of scope of this
   specification.

<span class="h3"><a class="selflink" id="section-5.2" href="#section-5.2">5.2</a>.  Processing Limits</span>

   This section discusses the trends and motivations of processing
   limits that warrant ICMP errors.

<span class="h4"><a class="selflink" id="section-5.2.1" href="#section-5.2.1">5.2.1</a>.  Long Headers and Header Chains</span>

   The trend towards longer and more complex headers and header chains
   needing to be processed by end nodes, as well as intermediate nodes,
   is driven by:

   *  Increasing prevalence of deep packet inspection in middleboxes.
      In particular, many intermediate nodes now parse network-layer
      encapsulation protocols or transport-layer protocols.

   *  Deployment of routing headers.  For instance, [<a href="/doc/html/rfc8754" title="&quot;IPv6 Segment Routing Header (SRH)&quot;">RFC8754</a>] defines an
      extension header format that includes a list of IPv6 addresses
      which may consume a considerable number of bytes.

   *  Development of in situ OAM headers that allow a rich set of
      measurements to be gathered in the data path at the cost of
      additional header overhead, which may be significant [<a href="#ref-OAM-IPV6" title="&quot;In-situ OAM IPv6 Options&quot;">OAM-IPV6</a>].

   *  Other emerging use cases of Hop-by-Hop and Destination Options.

<span class="h4"><a class="selflink" id="section-5.2.2" href="#section-5.2.2">5.2.2</a>.  At End Hosts</span>

   End hosts may implement limits on processing extension headers as
   described in [<a href="/doc/html/rfc8504" title="&quot;IPv6 Node Requirements&quot;">RFC8504</a>].  Host implementations are usually software
   stacks that typically don&#x27;t have inherent processing limitations.
   Limits imposed by a software stack are more likely to be for denial-
   of-service mitigation or performance.

<span class="h4"><a class="selflink" id="section-5.2.3" href="#section-5.2.3">5.2.3</a>.  At Intermediate Nodes</span>

   Hardware devices that process packet headers may have limits as to
   how many headers or bytes of headers they can process.  For instance,
   a middlebox hardware implementation might have a parsing buffer that
   contains some number of bytes of packet headers to process.  Parsing
   buffers typically have a fixed size such as 64, 128, or 256 bytes.
   In addition, hardware implementations (and some software
   implementations) often don&#x27;t have loop constructs.  Processing of a
   TLV list might be implemented as an unrolled loop so that the number
   of TLVs that can be processed is limited.

<span class="h2"><a class="selflink" id="section-6" href="#section-6">6</a>.  Security Considerations</span>

   The security considerations for ICMPv6 described in [<a href="/doc/html/rfc4443" title="&quot;Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification&quot;">RFC4443</a>] are
   applicable.  The ICMP errors described in this document MAY be
   filtered by firewalls in accordance with [<a href="/doc/html/rfc4890" title="&quot;Recommendations for Filtering ICMPv6 Messages in Firewalls&quot;">RFC4890</a>].

   In some circumstances, the sending of ICMP errors might conceptually
   be exploited as a means to covertly deduce the processing
   capabilities of nodes.  Accordingly, an implementation SHOULD allow a
   configurable policy to withhold sending of the ICMP errors described
   in this specification in environments where the security of ICMP
   errors is a concern.

<span class="h2"><a class="selflink" id="section-7" href="#section-7">7</a>.  IANA Considerations</span>

<span class="h3"><a class="selflink" id="section-7.1" href="#section-7.1">7.1</a>.  Parameter Problem Codes</span>

   IANA has assigned the following codes in the &quot;Type 4 - Parameter
   Problem&quot; registry within the ICMPv6 Parameters registry [<a href="#ref-IANA-ICMP">IANA-ICMP</a>]:

                +======+==================================+
                | Code | Name                             |
                +======+==================================+
                | 5    | Unrecognized Next Header type    |
                |      | encountered by intermediate node |
                +------+----------------------------------+
                | 6    | Extension header too big         |
                +------+----------------------------------+
                | 7    | Extension header chain too long  |
                +------+----------------------------------+
                | 8    | Too many extension headers       |
                +------+----------------------------------+
                | 9    | Too many options in extension    |
                |      | header                           |
                +------+----------------------------------+
                | 10   | Option too big                   |
                +------+----------------------------------+

                                  Table 2

<span class="h3"><a class="selflink" id="section-7.2" href="#section-7.2">7.2</a>.  Destination Unreachable Codes</span>

   IANA has assigned the following code in the &quot;Type 1 - Destination
   Unreachable&quot; registry within the ICMPv6 Parameters registry
   [<a href="#ref-IANA-ICMP">IANA-ICMP</a>]:

                        +======+==================+
                        | Code | Name             |
                        +======+==================+
                        | 8    | Headers too long |
                        +------+------------------+

                                  Table 3

<span class="h3"><a class="selflink" id="section-7.3" href="#section-7.3">7.3</a>.  ICMP Extension Object Classes and Class Sub-types</span>

   IANA has assigned the following Class value in the &quot;ICMP Extension
   Object Classes and Class Sub-types&quot; registry within the ICMP
   Parameters registry [<a href="#ref-IANA-ICMPEXT">IANA-ICMPEXT</a>]:

                  +=============+======================+
                  | Class Value | Class Name           |
                  +=============+======================+
                  | 4           | Extended Information |
                  +-------------+----------------------+

                                 Table 4

   IANA has created a sub-type registry for the &quot;Extended Information&quot;
   ICMP extension object class.  The registration procedure for this
   registry is &quot;Standards Action&quot;.  The sub-type value of 0 is reserved;
   values greater than zero may be assigned.

   IANA has assigned the following sub-type within the &quot;Sub-types -
   Class 4 - Extended Information&quot; registry within the ICMP Parameters
   registry:

                          +=======+=============+
                          | Value | Description |
                          +=======+=============+
                          | 1     | Pointer     |
                          +-------+-------------+

                                  Table 5

<span class="h2"><a class="selflink" id="section-8" href="#section-8">8</a>.  References</span>

<span class="h3"><a class="selflink" id="section-8.1" href="#section-8.1">8.1</a>.  Normative References</span>

   [<a id="ref-IANA-ICMP">IANA-ICMP</a>]
              IANA, &quot;Internet Control Message Protocol version 6
              (ICMPv6) Parameters&quot;,
              &lt;<a href="https://www.iana.org/assignments/icmpv6-parameters/">https://www.iana.org/assignments/icmpv6-parameters/</a>&gt;.

   [<a id="ref-IANA-ICMPEXT">IANA-ICMPEXT</a>]
              IANA, &quot;Internet Control Message Protocol (ICMP)
              Parameters&quot;,
              &lt;<a href="https://www.iana.org/assignments/icmp-parameters/">https://www.iana.org/assignments/icmp-parameters/</a>&gt;.

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., &quot;Key words for use in RFCs to Indicate
              Requirement Levels&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc2119">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC4443">RFC4443</a>]  Conta, A., Deering, S., and M. Gupta, Ed., &quot;Internet
              Control Message Protocol (ICMPv6) for the Internet
              Protocol Version 6 (IPv6) Specification&quot;, STD 89,
              <a href="/doc/html/rfc4443">RFC 4443</a>, DOI 10.17487/RFC4443, March 2006,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4443">https://www.rfc-editor.org/info/rfc4443</a>&gt;.

   [<a id="ref-RFC4884">RFC4884</a>]  Bonica, R., Gan, D., Tappan, D., and C. Pignataro,
              &quot;Extended ICMP to Support Multi-Part Messages&quot;, <a href="/doc/html/rfc4884">RFC 4884</a>,
              DOI 10.17487/RFC4884, April 2007,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4884">https://www.rfc-editor.org/info/rfc4884</a>&gt;.

   [<a id="ref-RFC7045">RFC7045</a>]  Carpenter, B. and S. Jiang, &quot;Transmission and Processing
              of IPv6 Extension Headers&quot;, <a href="/doc/html/rfc7045">RFC 7045</a>,
              DOI 10.17487/RFC7045, December 2013,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7045">https://www.rfc-editor.org/info/rfc7045</a>&gt;.

   [<a id="ref-RFC8174">RFC8174</a>]  Leiba, B., &quot;Ambiguity of Uppercase vs Lowercase in <a href="/doc/html/rfc2119">RFC</a>
              <a href="/doc/html/rfc2119">2119</a> Key Words&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc8174">RFC 8174</a>, DOI 10.17487/RFC8174,
              May 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.

   [<a id="ref-RFC8200">RFC8200</a>]  Deering, S. and R. Hinden, &quot;Internet Protocol, Version 6
              (IPv6) Specification&quot;, STD 86, <a href="/doc/html/rfc8200">RFC 8200</a>,
              DOI 10.17487/RFC8200, July 2017,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8200">https://www.rfc-editor.org/info/rfc8200</a>&gt;.

<span class="h3"><a class="selflink" id="section-8.2" href="#section-8.2">8.2</a>.  Informative References</span>

   [<a id="ref-OAM-IPV6">OAM-IPV6</a>] Bhandari, S., Brockners, F., Pignataro, C., Gredler, H.,
              Leddy, J., Youell, S., Mizrahi, T., Kfir, A., Gafni, B.,
              Lapukhov, P., Spiegel, M., Krishnan, S., Asati, R., and M.
              Smith, &quot;In-situ OAM IPv6 Options&quot;, Work in Progress,
              Internet-Draft, <a href="/doc/html/draft-ietf-ippm-ioam-ipv6-options-03">draft-ietf-ippm-ioam-ipv6-options-03</a>, 18
              September 2020, &lt;<a href="https://tools.ietf.org/html/draft-ietf-ippm-ioam-ipv6-options-03">https://tools.ietf.org/html/draft-ietf-</a>
              <a href="https://tools.ietf.org/html/draft-ietf-ippm-ioam-ipv6-options-03">ippm-ioam-ipv6-options-03</a>&gt;.

   [<a id="ref-RFC4821">RFC4821</a>]  Mathis, M. and J. Heffner, &quot;Packetization Layer Path MTU
              Discovery&quot;, <a href="/doc/html/rfc4821">RFC 4821</a>, DOI 10.17487/RFC4821, March 2007,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4821">https://www.rfc-editor.org/info/rfc4821</a>&gt;.

   [<a id="ref-RFC4890">RFC4890</a>]  Davies, E. and J. Mohacsi, &quot;Recommendations for Filtering
              ICMPv6 Messages in Firewalls&quot;, <a href="/doc/html/rfc4890">RFC 4890</a>,
              DOI 10.17487/RFC4890, May 2007,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4890">https://www.rfc-editor.org/info/rfc4890</a>&gt;.

   [<a id="ref-RFC8305">RFC8305</a>]  Schinazi, D. and T. Pauly, &quot;Happy Eyeballs Version 2:
              Better Connectivity Using Concurrency&quot;, <a href="/doc/html/rfc8305">RFC 8305</a>,
              DOI 10.17487/RFC8305, December 2017,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8305">https://www.rfc-editor.org/info/rfc8305</a>&gt;.

   [<a id="ref-RFC8504">RFC8504</a>]  Chown, T., Loughney, J., and T. Winters, &quot;IPv6 Node
              Requirements&quot;, <a href="/doc/html/bcp220">BCP 220</a>, <a href="/doc/html/rfc8504">RFC 8504</a>, DOI 10.17487/RFC8504,
              January 2019, &lt;<a href="https://www.rfc-editor.org/info/rfc8504">https://www.rfc-editor.org/info/rfc8504</a>&gt;.

   [<a id="ref-RFC8754">RFC8754</a>]  Filsfils, C., Ed., Dukes, D., Ed., Previdi, S., Leddy, J.,
              Matsushima, S., and D. Voyer, &quot;IPv6 Segment Routing Header
              (SRH)&quot;, <a href="/doc/html/rfc8754">RFC 8754</a>, DOI 10.17487/RFC8754, March 2020,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8754">https://www.rfc-editor.org/info/rfc8754</a>&gt;.

Acknowledgments

   The author would like to thank Ron Bonica, Bob Hinden, Nick Hilliard,
   Michael Richardson, Mark Smith, Suresh Krishnan, and Ole Tran for
   their comments and suggestions that improved this document.

Author&#x27;s Address

   Tom Herbert
   Intel
   Santa Clara, CA
   United States of America

   Email: tom@quantonium.net
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

