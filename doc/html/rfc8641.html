<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    rfc8641
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.34.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.34.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/draft-ietf-netconf-yang-push/">
  <meta name="description" content="Subscription to YANG Notifications for Datastore Updates (RFC )">
  <script src="https://www.ietf.org/lib/dt/7.34.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.34.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bgblue"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc8641.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc8641.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/pdfrfc/rfc8641.txt.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/rfc8641/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/rfc8641/" title="Datatracker information for this document">Tracker</a>] [<a href="/group/netconf/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-netconf-yang-push@ietf.org?subject=draft-ietf-netconf-yang-push" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=draft-ietf-netconf-yang-push-25.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-ietf-netconf-yang-push-25.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-ietf-netconf-yang-push-25.txt" title="Run an idnits check of this document">Nits</a>]

From: <a href="/doc/html/draft-ietf-netconf-yang-push-25">draft-ietf-netconf-yang-push-25</a>                  Proposed Standard</pre>
      </div>
    

    <div class="draftcontent">
    <pre>Internet Engineering Task Force (IETF)                          A. Clemm
Request for Comments: 8641                                     Futurewei
Category: Standards Track                                        E. Voit
ISSN: 2070-1721                                            Cisco Systems
                                                          September 2019


        <span class="h1">Subscription to YANG Notifications for Datastore Updates</span>

Abstract

   This document describes a mechanism that allows subscriber
   applications to request a continuous and customized stream of updates
   from a YANG datastore.  Providing such visibility into updates
   enables new capabilities based on the remote mirroring and monitoring
   of configuration and operational state.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="/doc/html/rfc7841#section-2">Section&nbsp;2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="https://www.rfc-editor.org/info/rfc8641">https://www.rfc-editor.org/info/rfc8641</a>.





















<span class="grey">Clemm &amp; Voit                 Standards Track                    [Page 1]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-2" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


Copyright Notice

   Copyright (c) 2019 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="/doc/html/bcp78">BCP 78</a> and the IETF Trust&#x27;s Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

























<span class="grey">Clemm &amp; Voit                 Standards Track                    [Page 2]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-3" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-4">4</a>
   <a href="#section-2">2</a>. Definitions .....................................................<a href="#page-4">4</a>
   <a href="#section-3">3</a>. Solution Overview ...............................................<a href="#page-6">6</a>
      <a href="#section-3.1">3.1</a>. Subscription Model .........................................<a href="#page-6">6</a>
      <a href="#section-3.2">3.2</a>. Negotiation of Subscription Policies .......................<a href="#page-7">7</a>
      <a href="#section-3.3">3.3</a>. On-Change Considerations ...................................<a href="#page-8">8</a>
      <a href="#section-3.4">3.4</a>. Reliability Considerations .................................<a href="#page-9">9</a>
      <a href="#section-3.5">3.5</a>. Data Encodings ............................................<a href="#page-10">10</a>
      <a href="#section-3.6">3.6</a>. Defining the Selection with a Datastore ...................<a href="#page-11">11</a>
      <a href="#section-3.7">3.7</a>. Streaming Updates .........................................<a href="#page-12">12</a>
      <a href="#section-3.8">3.8</a>. Subscription Management ...................................<a href="#page-15">15</a>
      <a href="#section-3.9">3.9</a>. Receiver Authorization ....................................<a href="#page-16">16</a>
      <a href="#section-3.10">3.10</a>. On-Change Notifiable Datastore Nodes .....................<a href="#page-18">18</a>
      <a href="#section-3.11">3.11</a>. Other Considerations .....................................<a href="#page-18">18</a>
   4. A YANG Data Model for Management of Datastore Push
      Subscriptions ..................................................<a href="#page-20">20</a>
      <a href="#section-4.1">4.1</a>. Overview ..................................................<a href="#page-20">20</a>
      <a href="#section-4.2">4.2</a>. Subscription Configuration ................................<a href="#page-27">27</a>
      <a href="#section-4.3">4.3</a>. YANG Notifications ........................................<a href="#page-28">28</a>
      <a href="#section-4.4">4.4</a>. YANG RPCs .................................................<a href="#page-29">29</a>
   <a href="#section-5">5</a>. YANG Module for YANG-Push ......................................<a href="#page-34">34</a>
   <a href="#section-6">6</a>. IANA Considerations ............................................<a href="#page-51">51</a>
   <a href="#section-7">7</a>. Security Considerations ........................................<a href="#page-51">51</a>
   <a href="#section-8">8</a>. References .....................................................<a href="#page-53">53</a>
      <a href="#section-8.1">8.1</a>. Normative References ......................................<a href="#page-53">53</a>
      <a href="#section-8.2">8.2</a>. Informative References ....................................<a href="#page-55">55</a>
   <a href="#appendix-A">Appendix A</a>. Subscription Errors ...................................<a href="#page-56">56</a>
     <a href="#appendix-A.1">A.1</a>. RPC Failures ...............................................<a href="#page-56">56</a>
     <a href="#appendix-A.2">A.2</a>. Failure Notifications ......................................<a href="#page-57">57</a>
   Acknowledgments ...................................................<a href="#page-58">58</a>
   Contributors ......................................................<a href="#page-58">58</a>
   Authors&#x27; Addresses ................................................<a href="#page-58">58</a>

















<span class="grey">Clemm &amp; Voit                 Standards Track                    [Page 3]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-4" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>.  Introduction</span>

   Traditional approaches for providing visibility into managed entities
   from a remote system have been built on polling.  With polling, data
   is periodically requested and retrieved by a client from a server to
   stay up to date.  However, there are issues associated with polling-
   based management:

   o  Polling incurs significant latency.  This latency prohibits many
      types of applications.

   o  Polling cycles may be missed, and requests may be delayed or get
      lost -- often when the network is under stress and the need for
      the data is the greatest.

   o  Polling requests may undergo slight fluctuations, resulting in
      intervals of different lengths.  The resulting data is difficult
      to calibrate and compare.

   o  For applications that monitor for changes, many remote polling
      cycles place unwanted and ultimately wasteful load on the network,
      devices, and applications, particularly when changes occur only
      infrequently.

   A more effective alternative to polling is for an application to
   receive automatic and continuous updates from a targeted subset of a
   datastore.  Accordingly, there is a need for a service that
   (1) allows applications to subscribe to updates from a datastore and
   (2) enables the server (also referred to as the &quot;publisher&quot;) to push
   and, in effect, stream those updates.  The requirements for such a
   service have been documented in [<a href="/doc/html/rfc7923" title="&quot;Requirements for Subscription to YANG Datastores&quot;">RFC7923</a>].

   This document defines a corresponding solution that is built on
   top of [<a href="/doc/html/rfc8639" title="&quot;Subscription to YANG Notifications&quot;">RFC8639</a>].  Supplementing that work are YANG data model
   augmentations, extended RPCs, and new datastore-specific update
   notifications.  Transport options provided in [<a href="/doc/html/rfc8639" title="&quot;Subscription to YANG Notifications&quot;">RFC8639</a>] will work
   seamlessly with this solution.

<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  Definitions</span>

   The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;,
   &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;NOT RECOMMENDED&quot;, &quot;MAY&quot;, and
   &quot;OPTIONAL&quot; in this document are to be interpreted as described in
   <a href="/doc/html/bcp14">BCP 14</a> [<a href="/doc/html/rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>] [<a href="/doc/html/rfc8174" title="&quot;Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words&quot;">RFC8174</a>] when, and only when, they appear in all
   capitals, as shown here.






<span class="grey">Clemm &amp; Voit                 Standards Track                    [Page 4]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-5" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


   This document uses the terminology defined in [<a href="/doc/html/rfc7950" title="&quot;The YANG 1.1 Data Modeling Language&quot;">RFC7950</a>], [<a href="/doc/html/rfc8341" title="&quot;Network Configuration Access Control Model&quot;">RFC8341</a>],
   [<a href="/doc/html/rfc8342" title="&quot;Network Management Datastore Architecture (NMDA)&quot;">RFC8342</a>], and [<a href="/doc/html/rfc8639" title="&quot;Subscription to YANG Notifications&quot;">RFC8639</a>].  In addition, this document defines the
   following terms:

   o  Datastore node: A node in the instantiated YANG data tree
      associated with a datastore.  In this document, datastore nodes
      are often also simply referred to as &quot;objects&quot;.

   o  Datastore node update: A data item containing the current value of
      a datastore node at the time the datastore node update was
      created, as well as the path to the datastore node.

   o  Datastore subscription: A subscription to a stream of datastore
      node updates.

   o  Datastore subtree: A datastore node and all its descendant
      datastore nodes.

   o  On-change subscription: A datastore subscription with updates that
      are triggered when changes in subscribed datastore nodes are
      detected.

   o  Periodic subscription: A datastore subscription with updates that
      are triggered periodically according to some time interval.

   o  Selection filter: Evaluation and/or selection criteria that may be
      applied against a targeted set of objects.

   o  Update record: A representation of one or more datastore node
      updates.  In addition, an update record may contain which type of
      update led to the datastore node update (e.g., whether the
      datastore node was added, changed, or deleted).  Also included in
      the update record may be other metadata, such as a subscription ID
      of the subscription for which the update record was generated.  In
      this document, update records are often also simply referred to as
      &quot;updates&quot;.

   o  Update trigger: A mechanism that determines when an update record
      needs to be generated.

   o  YANG-Push: The subscription and push mechanism for datastore
      updates that is specified in this document.









<span class="grey">Clemm &amp; Voit                 Standards Track                    [Page 5]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-6" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>.  Solution Overview</span>

   This document specifies a solution that provides a subscription
   service for updates from a datastore.  This solution supports dynamic
   as well as configured subscriptions to updates of datastore nodes.
   Subscriptions specify when notification messages (also referred to as
   &quot;push updates&quot;) should be sent and what data to include in update
   records.  Datastore node updates are subsequently pushed from the
   publisher to the receiver per the terms of the subscription.

<span class="h3"><a class="selflink" id="section-3.1" href="#section-3.1">3.1</a>.  Subscription Model</span>

   YANG-Push subscriptions are defined using a YANG data model.  This
   model enhances the subscription model defined in [<a href="/doc/html/rfc8639" title="&quot;Subscription to YANG Notifications&quot;">RFC8639</a>] with
   capabilities that allow subscribers to subscribe to datastore node
   updates -- specifically, to specify the update triggers defining when
   to generate update records as well as what to include in an update
   record.  Key enhancements include:

   o  The specification of selection filters that identify targeted YANG
      datastore nodes and/or datastore subtrees for which updates are to
      be pushed.

   o  The specification of update policies that contain conditions that
      trigger the generation and pushing of new update records.  There
      are two types of subscriptions, distinguished by how updates are
      triggered: periodic and on-change.

      *  For periodic subscriptions, the update trigger is specified by
         two parameters that define when updates are to be pushed.
         These parameters are (1) the period interval with which to
         report updates and (2) an &quot;anchor-time&quot;, i.e., a reference
         point in time that can be used to calculate at which points in
         time periodic updates need to be assembled and sent.

      *  For on-change subscriptions, an update trigger occurs whenever
         a change in the subscribed information is detected.  The
         following additional parameters are included:

         +  &quot;dampening-period&quot;: In an on-change subscription, detected
            object changes should be sent as quickly as possible.
            However, it may be undesirable to send a rapid series of
            object changes.  Such behavior has the potential to exhaust
            resources in the publisher or receiver.  In order to protect
            against this type of scenario, a dampening period MAY be
            used to specify the interval that has to pass before
            successive update records for the same subscription are
            generated for a receiver.  The dampening period collectively



<span class="grey">Clemm &amp; Voit                 Standards Track                    [Page 6]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-7" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


            applies to the set of all datastore nodes selected by a
            single subscription.  This means that when there is a change
            to one or more subscribed objects, an update record
            containing those objects is created immediately (when no
            dampening period is in effect) or at the end of a dampening
            period (when a dampening period is in fact in effect).  If
            multiple changes to a single object occur during a dampening
            period, only the value that is in effect at the time when
            the update record is created is included.  The dampening
            period goes into effect every time the assembly of an update
            record is completed.

         +  &quot;change-type&quot;: This parameter can be used to reduce the
            types of datastore changes for which updates are sent (e.g.,
            you might only send an update when an object is created or
            deleted, but not when an object value changes).

         +  &quot;sync-on-start&quot;: This parameter defines whether or not a
            complete &quot;push-update&quot; (<a href="#section-3.7">Section 3.7</a>) of all subscribed data
            will be sent at the beginning of a subscription.  Such early
            synchronization establishes the frame of reference for
            subsequent updates.

   o  An encoding (using anydata) for the contents of periodic and
      on-change push updates.

<span class="h3"><a class="selflink" id="section-3.2" href="#section-3.2">3.2</a>.  Negotiation of Subscription Policies</span>

   A dynamic subscription request SHOULD be declined if a publisher
   determines that it may be unable to provide update records meeting
   the terms of an &quot;establish-subscription&quot; or &quot;modify-subscription&quot; RPC
   request.  In this case, a subscriber may quickly follow up with a new
   RPC request using different parameters.

   Random guessing of different parameters by a subscriber is to be
   discouraged.  Therefore, in order to minimize the number of
   subscription iterations between subscriber and publisher, a dynamic
   subscription supports a simple negotiation between subscribers and
   publishers for subscription parameters.  This negotiation is in the
   form of supplemental information that should be inserted into error
   responses to a failed RPC request.  This returned error response
   information, when considered, should increase the likelihood of
   success for subsequent RPC requests.  Such hints include suggested
   periodic time intervals, acceptable dampening periods, and size
   estimates for the number of objects that would be returned from a
   proposed selection filter.  However, there are no guarantees that
   subsequent requests that consider these hints will be accepted.




<span class="grey">Clemm &amp; Voit                 Standards Track                    [Page 7]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-8" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


<span class="h3"><a class="selflink" id="section-3.3" href="#section-3.3">3.3</a>.  On-Change Considerations</span>

   On-change subscriptions allow receivers to receive updates whenever
   changes to targeted objects occur.  As such, on-change subscriptions
   are particularly effective for data that changes infrequently but for
   which applications need to be quickly notified, with minimal delay,
   whenever a change does occur.

   On-change subscriptions tend to be more difficult to implement than
   periodic subscriptions.  Accordingly, on-change subscriptions may not
   be supported by all implementations or for every object.

   Whether or not to accept or reject on-change subscription requests
   when the scope of the subscription contains objects for which
   on-change is not supported is up to the publisher implementation.  A
   publisher MAY accept an on-change subscription even when the scope of
   the subscription contains objects for which on-change is not
   supported.  In that case, updates are sent only for those objects
   within the scope of the subscription that do support on-change
   updates, whereas other objects are excluded from update records, even
   if their values change.  In order for a subscriber to determine
   whether objects support on-change subscriptions, objects are marked
   accordingly on a publisher.  Accordingly, when subscribing, it is the
   responsibility of the subscriber to ensure that it is aware of which
   objects support on-change and which do not.  For more on how objects
   are so marked, see <a href="#section-3.10">Section 3.10</a>.

   Alternatively, a publisher MAY decide to simply reject an on-change
   subscription if the scope of the subscription contains objects for
   which on-change is not supported.  In the case of a configured
   subscription, the publisher MAY suspend the subscription.

   To avoid flooding receivers with repeated updates for subscriptions
   containing fast-changing objects or objects with oscillating values,
   an on-change subscription allows for the definition of a dampening
   period.  Once an update record for a given object is generated, no
   other updates for this particular subscription will be created until
   the end of the dampening period.  Values sent at the end of the
   dampening period are the values that are current at the end of the
   dampening period of all changed objects.  Changed objects include
   those objects that were deleted or newly created during that
   dampening period.  If an object has returned to its original value
   (or even has been created and then deleted) during the dampening
   period, that value (and not the interim change) will still be sent.
   This will indicate that churn is occurring on that object.






<span class="grey">Clemm &amp; Voit                 Standards Track                    [Page 8]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-9" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


   On-change subscriptions can be refined to let users subscribe only to
   certain types of changes.  For example, a subscriber might only want
   object creations and deletions, but not modifications of object
   values.

   Putting it all together, the conceptual process for creating an
   update record as part of an on-change subscription is as follows:

   1.  Just before a change, or at the start of a dampening period,
       evaluate any filtering and any access control rules to ensure
       that a receiver is authorized to view all subscribed datastore
       nodes (filtering out any nodes for which this is not the case).
       The result is a set &quot;A&quot; of datastore nodes and subtrees.

   2.  Just after a change, or at the end of a dampening period,
       evaluate any filtering and any (possibly new) access control
       rules.  The result is a set &quot;B&quot; of datastore nodes and subtrees.

   3.  Construct an update record, which takes the form of a YANG Patch
       record [<a href="/doc/html/rfc8072" title="&quot;YANG Patch Media Type&quot;">RFC8072</a>] for going from A to B.

   4.  If there were any changes made between A and B that canceled each
       other out, insert into the YANG Patch record the last change
       made, even if the new value is no different from the original
       value (since changes that were made in the interim were canceled
       out).  If the changes involve creating a new datastore node and
       then deleting it, the YANG Patch record will indicate the
       deletion of the datastore node.  Similarly, if the changes
       involve deleting a new datastore node and then recreating it,
       the YANG Patch record will indicate the creation of the
       datastore node.

   5.  If the resulting YANG Patch record is non-empty, send it to the
       receiver.

   Note: In cases where a subscriber wants to have separate dampening
   periods for different objects, the subscriber has the option to
   create multiple subscriptions with different selection filters.

<span class="h3"><a class="selflink" id="section-3.4" href="#section-3.4">3.4</a>.  Reliability Considerations</span>

   A subscription to updates from a datastore is intended to obviate the
   need for polling.  However, in order to do so, it is critical that
   subscribers can rely on the subscription and have confidence that
   they will indeed receive the subscribed updates without having to
   worry about updates being silently dropped.  In other words, a
   subscription constitutes a promise on the side of the publisher to
   provide the receivers with updates per the terms of the subscription.



<span class="grey">Clemm &amp; Voit                 Standards Track                    [Page 9]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-10" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


   Now, there are many reasons why a publisher may at some point no
   longer be able to fulfill the terms of the subscription, even if the
   subscription had been initiated in good faith.  For example, the
   volume of datastore nodes may be larger than anticipated, the
   interval may prove too short to send full updates in rapid
   succession, or an internal problem may prevent objects from being
   collected.  For this reason, the solution defined in this document
   (1) mandates that a publisher notify receivers immediately and
   reliably whenever it encounters a situation in which it is unable to
   keep the terms of the subscription and (2) provides the publisher
   with the option to suspend the subscription in such a case.  This
   includes indicating the fact that an update is incomplete as part of
   a &quot;push-update&quot; or &quot;push-change-update&quot; notification, as well as
   emitting a &quot;subscription-suspended&quot; notification as applicable.  This
   is described further in <a href="#section-3.11.1">Section 3.11.1</a>.

   A publisher SHOULD reject a request for a subscription if it is
   unlikely that the publisher will be able to fulfill the terms of that
   subscription request.  In such cases, it is preferable to have a
   subscriber request a less resource-intensive subscription than to
   deal with frequently degraded behavior.

   The solution builds on [<a href="/doc/html/rfc8639" title="&quot;Subscription to YANG Notifications&quot;">RFC8639</a>].  As defined therein, any loss of an
   underlying transport connection will be detected and result in
   subscription termination (in the case of dynamic subscriptions) or
   suspension (in the case of configured subscriptions), ensuring that
   situations where the loss of update notifications would go unnoticed
   will not occur.

<span class="h3"><a class="selflink" id="section-3.5" href="#section-3.5">3.5</a>.  Data Encodings</span>

<span class="h4"><a class="selflink" id="section-3.5.1" href="#section-3.5.1">3.5.1</a>.  Periodic Subscriptions</span>

   In a periodic subscription, the data included as part of an update
   record corresponds to data that could have been read using a
   retrieval operation.

<span class="h4"><a class="selflink" id="section-3.5.2" href="#section-3.5.2">3.5.2</a>.  On-Change Subscriptions</span>

   In an on-change subscription, update records need to indicate not
   only values of changed datastore nodes but also the types of changes
   that occurred since the last update.  Therefore, encoding rules for
   data in on-change updates will generally follow YANG Patch operations
   as specified in [<a href="/doc/html/rfc8072" title="&quot;YANG Patch Media Type&quot;">RFC8072</a>].  The YANG Patch operations will describe
   what needs to be applied to the earlier state reported by the
   preceding update in order to result in the now-current state.  Note
   that objects referred to in an update are not limited to




<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 10]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-11" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


   configuration data but can include any objects (including operational
   data), whereas [<a href="/doc/html/rfc8072" title="&quot;YANG Patch Media Type&quot;">RFC8072</a>] patches apply only to configuration data in
   configuration datastores.

   A publisher indicates the type of change to a datastore node using
   the different YANG Patch operations: the &quot;create&quot; operation is used
   for newly created objects (except entries in a user-ordered list),
   the &quot;delete&quot; operation is used for deleted objects (including in
   user-ordered lists), the &quot;replace&quot; operation is used when only the
   object value changes, the &quot;insert&quot; operation is used when a new entry
   is inserted in a list, and the &quot;move&quot; operation is used when an
   existing entry in a user-ordered list is moved.

   However, a patch must be able to do more than just describe the delta
   from the previous state to the current state.  As per <a href="#section-3.3">Section 3.3</a>, it
   must also be able to identify whether transient changes have occurred
   on an object during a dampening period.  To support this, it is valid
   to encode a YANG Patch operation so that its application would result
   in no change between the previous state and the current state.  This
   indicates that some churn has occurred on the object.  An example of
   this would be a patch that indicates a &quot;create&quot; operation for a
   datastore node where the receiver believes one already exists or a
   &quot;replace&quot; operation that replaces a previous value with the same
   value.  Note that this means that the &quot;create&quot; and &quot;delete&quot; errors as
   described in <a href="/doc/html/rfc8072#section-2.5">[RFC8072], Section&nbsp;2.5</a> are not errors in the case of
   YANG-Push (i.e., they are considered valid operations for YANG-Push).

<span class="h3"><a class="selflink" id="section-3.6" href="#section-3.6">3.6</a>.  Defining the Selection with a Datastore</span>

   A subscription must specify both the selection filters and the
   datastore against which these selection filters will be applied.
   This information is used to choose and subsequently push data from
   the publisher&#x27;s datastore to the receivers.

   Only a single selection filter can be applied to a subscription at a
   time.  An RPC request proposing a new selection filter replaces any
   existing filter.  The following selection filter types are included
   in the YANG-Push data model and may be applied against a datastore:

   o  subtree: A subtree selection filter identifies one or more
      datastore subtrees.  When specified, update records will only come
      from the datastore nodes of selected datastore subtree(s).  The
      syntax and semantics correspond to those specified in <a href="/doc/html/rfc6241#section-6">[RFC6241],
      Section&nbsp;6</a>.







<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 11]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-12" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


   o  xpath: An &quot;xpath&quot; selection filter is an XPath expression that
      returns a node set.  (XPath is a query language for selecting
      nodes in an XML document; see [<a href="#ref-XPATH" title="&quot;XML Path Language (XPath) Version 1.0&quot;">XPATH</a>] for details.)  When
      specified, updates will only come from the selected datastore
      nodes.

   These filters are intended to be used as selectors that define which
   objects are within the scope of a subscription.  A publisher MUST
   support at least one type of selection filter.

   XPath itself provides powerful filtering constructs, and care must be
   used in filter definition.  Consider an XPath filter that only passes
   a datastore node when an interface is up.  It is up to the receiver
   to understand the implications of the presence or absence of objects
   in each update.

   When the set of selection-filtering criteria is applied for a
   periodic subscription, these criteria are applied whenever a periodic
   update record is constructed, and only datastore nodes that pass the
   filter and to which a receiver has access are provided to that
   receiver.  If the same filtering criteria are applied to an on-change
   subscription, only the subset of those datastore nodes supporting
   on-change is provided.  A datastore node that doesn&#x27;t support
   on-change is never sent as part of an on-change subscription&#x27;s
   &quot;push-update&quot; or &quot;push-change-update&quot; (<a href="#section-3.7">Section 3.7</a>).

<span class="h3"><a class="selflink" id="section-3.7" href="#section-3.7">3.7</a>.  Streaming Updates</span>

   Contrary to traditional data retrieval requests, datastore
   subscription enables an unbounded series of update records to be
   streamed over time.  Two generic YANG notifications for update
   records have been defined for this scenario: &quot;push-update&quot; and
   &quot;push-change-update&quot;.

   A &quot;push-update&quot; notification defines a complete, filtered update of
   the datastore per the terms of a subscription.  This type of YANG
   notification is used for continuous updates of periodic
   subscriptions.  A &quot;push-update&quot; notification can also be used for the
   on-change subscriptions in two cases.  First, it MUST be used as the
   initial &quot;push-update&quot; if there is a need to synchronize the receiver
   at the start of a new subscription.  Second, it MAY be sent if the
   publisher later chooses to resync an on-change subscription.  The
   &quot;push-update&quot; update record contains an instantiated datastore
   subtree with all of the subscribed contents.  The content of the
   update record is equivalent to the contents that would be obtained
   had the same data been explicitly retrieved using a datastore
   retrieval operation using the same transport with the same filters
   applied.



<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 12]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-13" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


   A &quot;push-change-update&quot; notification is the most common type of update
   for on-change subscriptions.  The update record in this case contains
   the set of changes that datastore nodes have undergone since the last
   notification message.  In other words, this indicates which datastore
   nodes have been created, have been deleted, or have had changes to
   their values.  In cases where multiple changes have occurred over the
   course of a dampening period and the object has not been deleted, the
   object&#x27;s most current value is reported.  (In other words, for each
   object, only one change is reported, not its entire history.  Doing
   so would defeat the purpose of the dampening period.)

   &quot;push-update&quot; and &quot;push-change-update&quot; are encoded and placed in
   notification messages and are ultimately queued for egress over the
   specified transport.

   Figure 1 provides an example of a notification message for a
   subscription tracking the operational status of a single Ethernet
   interface (per [<a href="/doc/html/rfc8343" title="&quot;A YANG Data Model for Interface Management&quot;">RFC8343</a>]).  This notification message is encoded XML
   [<a href="#ref-W3C.REC-xml-20081126">W3C.REC-xml-20081126</a>] over the Network Configuration Protocol
   (NETCONF) as per [<a href="/doc/html/rfc8640" title="&quot;Dynamic Subscription to YANG Events and Datastores over NETCONF&quot;">RFC8640</a>].

  &lt;notification xmlns=&quot;urn:ietf:params:xml:ns:netconf:notification:1.0&quot;&gt;
   &lt;eventTime&gt;2017-10-25T08:00:11.22Z&lt;/eventTime&gt;
   &lt;push-update xmlns=&quot;urn:ietf:params:xml:ns:yang:ietf-yang-push&quot;&gt;
     &lt;id&gt;1011&lt;/id&gt;
     &lt;datastore-contents&gt;
        &lt;interfaces xmlns=&quot;urn:ietf:params:xml:ns:yang:ietf-interfaces&quot;&gt;
         &lt;interface&gt;
           &lt;name&gt;eth0&lt;/name&gt;
           &lt;oper-status&gt;up&lt;/oper-status&gt;
         &lt;/interface&gt;
       &lt;/interfaces&gt;
     &lt;/datastore-contents&gt;
   &lt;/push-update&gt;
  &lt;/notification&gt;

                          Figure 1: Push Example














<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 13]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-14" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


   Figure 2 provides an example of an on-change notification message for
   the same subscription.

  &lt;notification xmlns=&quot;urn:ietf:params:xml:ns:netconf:notification:1.0&quot;&gt;
   &lt;eventTime&gt;2017-10-25T08:22:33.44Z&lt;/eventTime&gt;
   &lt;push-change-update
        xmlns=&quot;urn:ietf:params:xml:ns:yang:ietf-yang-push&quot;&gt;
     &lt;id&gt;89&lt;/id&gt;
     &lt;datastore-changes&gt;
       &lt;yang-patch&gt;
         &lt;patch-id&gt;0&lt;/patch-id&gt;
         &lt;edit&gt;
           &lt;edit-id&gt;edit1&lt;/edit-id&gt;
           &lt;operation&gt;replace&lt;/operation&gt;
           &lt;target&gt;/ietf-interfaces:interfaces&lt;/target&gt;
           &lt;value&gt;
             &lt;interfaces
                  xmlns=&quot;urn:ietf:params:xml:ns:yang:ietf-interfaces&quot;&gt;
               &lt;interface&gt;
                 &lt;name&gt;eth0&lt;/name&gt;
                 &lt;oper-status&gt;down&lt;/oper-status&gt;
               &lt;/interface&gt;
             &lt;/interfaces&gt;
           &lt;/value&gt;
         &lt;/edit&gt;
       &lt;/yang-patch&gt;
     &lt;/datastore-changes&gt;
   &lt;/push-change-update&gt;
  &lt;/notification&gt;

       Figure 2: Push Example for an On-Change Notification Message

   Of note in the above example is the &quot;patch-id&quot; with a value of &quot;0&quot;.
   Per [<a href="/doc/html/rfc8072" title="&quot;YANG Patch Media Type&quot;">RFC8072</a>], the &quot;patch-id&quot; is an arbitrary string.  With
   YANG-Push, the publisher SHOULD put into the &quot;patch-id&quot; a counter
   starting at &quot;0&quot; that increments with every &quot;push-change-update&quot;
   generated for a subscription.  If used as a counter, this counter
   MUST be reset to &quot;0&quot; any time a resynchronization occurs (i.e., with
   the sending of a &quot;push-update&quot;).  Also, if used as a counter, the
   counter MUST be reset to &quot;0&quot; after passing a maximum value of
   &quot;4294967295&quot; (i.e., the maximum value that can be represented using
   the uint32 data type).  Such a mechanism allows easy identification
   of lost or out-of-sequence update records.








<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 14]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-15" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


<span class="h3"><a class="selflink" id="section-3.8" href="#section-3.8">3.8</a>.  Subscription Management</span>

   The RPCs defined in [<a href="/doc/html/rfc8639" title="&quot;Subscription to YANG Notifications&quot;">RFC8639</a>] have been enhanced to support datastore
   subscription negotiation.  Also, new error codes have been added that
   are able to indicate why a datastore subscription attempt has failed,
   along with new yang-data that MAY be used to include details on input
   parameters that might result in a successful subsequent RPC
   invocation.

   The establishment or modification of a datastore subscription can be
   rejected for multiple reasons, including a subtree request that is
   too large or the inability of the publisher to push update records as
   frequently as requested.  In such cases, no subscription is
   established.  Instead, a subscription result that includes the reason
   for the failure is returned as part of the RPC response.  As part of
   this response, a set of alternative subscription parameters MAY be
   returned that would likely have resulted in acceptance of the
   subscription request.  The subscriber may consider including such
   parameters in future subscription attempts.

   In the case of a rejected request for establishment of a datastore
   subscription, if there are hints, the hints SHOULD be transported in
   a yang-data &quot;establish-subscription-datastore-error-info&quot; container
   inserted into the RPC error response, in lieu of the &quot;establish-
   subscription-stream-error-info&quot; that is inserted in the case of a
   stream subscription.

   Figure 3 shows a tree diagram for &quot;establish-subscription-datastore-
   error-info&quot;.  All tree diagrams used in this document follow the
   notation defined in [<a href="/doc/html/rfc8340" title="&quot;YANG Tree Diagrams&quot;">RFC8340</a>].

          yang-data establish-subscription-datastore-error-info
            +--ro establish-subscription-datastore-error-info
               +--ro reason?                identityref
               +--ro period-hint?           centiseconds
               +--ro filter-failure-hint?   string
               +--ro object-count-estimate? uint32
               +--ro object-count-limit?    uint32
               +--ro kilobytes-estimate?    uint32
               +--ro kilobytes-limit?       uint32

   Figure 3: &quot;establish-subscription-datastore-error-info&quot; Tree Diagram









<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 15]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-16" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


   Similarly, in the case of a rejected request for modification of a
   datastore subscription, if there are hints, the hints SHOULD be
   transported in a yang-data &quot;modify-subscription-datastore-error-info&quot;
   container inserted into the RPC error response, in lieu of the
   &quot;modify-subscription-stream-error-info&quot; that is inserted in the case
   of a stream subscription.

   Figure 4 shows a tree diagram for &quot;modify-subscription-datastore-
   error-info&quot;.

          yang-data modify-subscription-datastore-error-info
            +--ro modify-subscription-datastore-error-info
               +--ro reason?                identityref
               +--ro period-hint?           centiseconds
               +--ro filter-failure-hint?   string
               +--ro object-count-estimate? uint32
               +--ro object-count-limit?    uint32
               +--ro kilobytes-estimate?    uint32
               +--ro kilobytes-limit?       uint32

     Figure 4: &quot;modify-subscription-datastore-error-info&quot; Tree Diagram

<span class="h3"><a class="selflink" id="section-3.9" href="#section-3.9">3.9</a>.  Receiver Authorization</span>

   A receiver of subscription data MUST only be sent updates for which
   it has proper authorization.  A publisher MUST ensure that no
   unauthorized data is included in push updates.  To do so, it needs to
   apply all corresponding checks applicable at the time of a specific
   pushed update and, if necessary, silently remove any unauthorized
   data from datastore subtrees.  This enables YANG data that is pushed
   based on subscriptions to be authorized in a way that is equivalent
   to a regular data retrieval (&quot;get&quot;) operation.

   Each &quot;push-update&quot; and &quot;push-change-update&quot; MUST have access control
   applied, as depicted in Figure 5.  This includes validating that read
   access is permitted for any new objects selected since the last
   notification message was sent to a particular receiver.  A publisher
   MUST silently omit data nodes from the results that the client is not
   authorized to see.  To accomplish this, implementations SHOULD apply
   the conceptual authorization model of [<a href="/doc/html/rfc8341" title="&quot;Network Configuration Access Control Model&quot;">RFC8341</a>], specifically
   <a href="#section-3.2.4">Section 3.2.4</a>, extended to apply analogously to data nodes included
   in notifications, not just &lt;rpc-reply&gt; messages sent in response to
   &lt;get&gt; and &lt;get-config&gt; requests.








<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 16]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-17" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


                         +-----------------+      +--------------------+
     push-update or --&gt;  | datastore node  |  yes | add datastore node |
    push-change-update   | access allowed? | ---&gt; | to update record   |
                         +-----------------+      +--------------------+

                 Figure 5: Access Control for Push Updates

   A publisher MUST allow for the possibility that a subscription&#x27;s
   selection filter references nonexistent data or data that a receiver
   is not allowed to access.  Such support permits a receiver the
   ability to monitor the entire lifecycle of some datastore tree
   without needing to explicitly enumerate every individual datastore
   node.  If, after access control has been applied, there are no
   objects remaining in an update record, then the effect varies given
   if the subscription is a periodic or on-change subscription.  For a
   periodic subscription, an empty &quot;push-update&quot; notification MUST be
   sent, so that clients do not get confused into thinking that an
   update was lost.  For an on-change subscription, a &quot;push-update&quot;
   notification MUST NOT be sent, so that clients remain unaware of
   changes made to nodes they don&#x27;t have read-access for.  By the same
   token, changes to objects that are filtered MUST NOT affect any
   dampening intervals.

   A publisher MAY choose to reject an &quot;establish-subscription&quot; request
   that selects nonexistent data or data that a receiver is not allowed
   to access.  The error identity &quot;unchanging-selection&quot; SHOULD be
   returned as the reason for the rejection.  In addition, a publisher
   MAY choose to terminate a dynamic subscription or suspend a
   configured receiver when the authorization privileges of a receiver
   change or the access controls for subscribed objects change.  In that
   case, the publisher SHOULD include the error identity &quot;unchanging-
   selection&quot; as the reason when sending the &quot;subscription-terminated&quot;
   or &quot;subscription-suspended&quot; notification, respectively.  Such a
   capability enables the publisher to avoid having to support
   continuous and total filtering of a subscription&#x27;s content for every
   update record.  It also reduces the possibility of leakage of
   access-controlled objects.

   If read access into previously accessible nodes has been lost due to
   a receiver permissions change, this SHOULD be reported as a patch
   &quot;delete&quot; operation for on-change subscriptions.  If not capable of
   handling such receiver permission changes with such a &quot;delete&quot;,
   publisher implementations MUST force dynamic subscription
   re-establishment or configured subscription reinitialization so that
   appropriate filtering is installed.






<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 17]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-18" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


<span class="h3"><a class="selflink" id="section-3.10" href="#section-3.10">3.10</a>.  On-Change Notifiable Datastore Nodes</span>

   In some cases, a publisher supporting on-change notifications may not
   be able to push on-change updates for some object types.  Reasons for
   this might be that the value of the datastore node changes frequently
   (e.g., the in-octets counter as defined in [<a href="/doc/html/rfc8343" title="&quot;A YANG Data Model for Interface Management&quot;">RFC8343</a>]), small object
   changes are frequent and meaningless (e.g., a temperature gauge
   changing 0.1 degrees), or the implementation is not capable of
   on-change notification for a particular object.

   In those cases, it will be important for client applications to have
   a way to identify for which objects on-change notifications are
   supported and for which ones they are not supported.  Otherwise,
   client applications will have no way of knowing whether they can
   indeed rely on their on-change subscription to provide them with the
   change updates that they are interested in.  In other words, if
   implementations do not provide a solution and do not support
   comprehensive on-change notifiability, clients of those
   implementations will have no way of knowing what their on-change
   subscription actually covers.

   Implementations are therefore strongly advised to provide a solution
   to this problem.  One solution might involve making discoverable to
   clients which objects are on-change notifiable, specified using
   another YANG data model.  Such a solution is specified in
   [<a href="#ref-Yang-Push-Notif-Cap">Yang-Push-Notif-Cap</a>].  Until this solution is standardized,
   implementations SHOULD provide their own solution.

<span class="h3"><a class="selflink" id="section-3.11" href="#section-3.11">3.11</a>.  Other Considerations</span>

<span class="h4"><a class="selflink" id="section-3.11.1" href="#section-3.11.1">3.11.1</a>.  Robustness and Reliability</span>

   It is important that updates as discussed in this document, and
   on-change updates in particular, do not get lost.  If the loss of an
   update is unavoidable, it is critical that the receiver be notified
   accordingly.

   Update records for a single subscription MUST NOT be resequenced
   prior to transport.












<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 18]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-19" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


   It is conceivable that, under certain circumstances, a publisher will
   recognize that it is unable to include in an update record the full
   set of objects desired per the terms of a subscription.  In this
   case, the publisher MUST act as follows.

   o  The publisher MUST set the &quot;incomplete-update&quot; flag on any update
      record that is known to be missing information.

   o  The publisher MAY choose to suspend the subscription as per
      [<a href="/doc/html/rfc8639" title="&quot;Subscription to YANG Notifications&quot;">RFC8639</a>].  If the publisher does not create an update record at
      all, it MUST suspend the subscription.

   o  When resuming an on-change subscription, the publisher SHOULD
      generate a complete patch from the previous update record.  If
      this is not possible and the &quot;sync-on-start&quot; option is set to
      &quot;true&quot; for the subscription, then the full datastore contents MAY
      be sent via a &quot;push-update&quot; instead (effectively replacing the
      previous contents).  If neither scenario above is possible, then
      an &quot;incomplete-update&quot; flag MUST be included on the next
      &quot;push-change-update&quot;.

   Note: It is perfectly acceptable to have a series of &quot;push-change-
   update&quot; notifications (and even &quot;push-update&quot; notifications) serially
   queued at the transport layer awaiting transmission.  It is not
   required for the publisher to merge pending update records sent at
   the same time.

   On the receiver side, what action to take when a record with an
   &quot;incomplete-update&quot; flag is received depends on the application.  It
   could simply choose to wait and do nothing.  It could choose to
   resync, actively retrieving all subscribed information.  It could
   also choose to tear down the subscription and start a new one,
   perhaps with a smaller scope that contains fewer objects.

<span class="h4"><a class="selflink" id="section-3.11.2" href="#section-3.11.2">3.11.2</a>.  Publisher Capacity</span>

   It is far preferable to decline a subscription request than to accept
   such a request when it cannot be met.

   Whether or not a subscription can be supported will be determined by
   a combination of several factors, such as the subscription update
   trigger (on-change or periodic), the period in which to report
   changes (one-second periods will consume more resources than one-hour
   periods), the amount of data in the datastore subtree that is being
   subscribed to, and the number and combination of other subscriptions
   that are concurrently being serviced.





<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 19]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-20" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>.  A YANG Data Model for Management of Datastore Push Subscriptions</span>

<span class="h3"><a class="selflink" id="section-4.1" href="#section-4.1">4.1</a>.  Overview</span>

   The YANG data model for datastore push subscriptions is depicted in
   Figures 6 through 9.  The tree diagram that is used follows the
   notation defined in [<a href="/doc/html/rfc8340" title="&quot;YANG Tree Diagrams&quot;">RFC8340</a>].  New schema objects defined here
   (i.e., beyond those from [<a href="/doc/html/rfc8639" title="&quot;Subscription to YANG Notifications&quot;">RFC8639</a>]) are identified with &quot;yp&quot;.  For
   the reader&#x27;s convenience, in order to compact the tree
   representation, some nodes that are defined in the ietf-subscribed-
   notifications YANG module [<a href="/doc/html/rfc8639" title="&quot;Subscription to YANG Notifications&quot;">RFC8639</a>] and therefore are not essential
   to the understanding of the data model defined here have been
   removed.  This is indicated by &quot;...&quot; in the diagram where applicable.

   Because the tree diagram is quite large, its depiction is broken up
   into four figures.  Figure 6 depicts the augmentations that are
   introduced in YANG module ietf-yang-push to the subscription
   configuration specified in YANG module ietf-subscribed-notifications.

































<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 20]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-21" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


   module: ietf-subscribed-notifications
     ...
     +--rw filters
     |  ...
     |  +--rw yp:selection-filter* [filter-id]
     |     +--rw yp:filter-id                   string
     |     +--rw (yp:filter-spec)?
     |        +--:(yp:datastore-subtree-filter)
     |        |  +--rw yp:datastore-subtree-filter?   &lt;anydata&gt;
     |        |          {sn:subtree}?
     |        +--:(yp:datastore-xpath-filter)
     |           +--rw yp:datastore-xpath-filter?     yang:xpath1.0
     |                   {sn:xpath}?
     +--rw subscriptions
        +--rw subscription* [id]
           |  ...
           +--rw (target)
           |  +--:(stream)
           |  |   ...
           |  +--:(yp:datastore)
           |     +--rw yp:datastore                     identityref
           |     +--rw (yp:selection-filter)?
           |        +--:(yp:by-reference)
           |        |  +--rw yp:selection-filter-ref
           |        |          selection-filter-ref
           |        +--:(yp:within-subscription)
           |           +--rw (yp:filter-spec)?
           |              +--:(yp:datastore-subtree-filter)
           |              |  +--rw yp:datastore-subtree-filter?
           |              |          &lt;anydata&gt; {sn:subtree}?
           |              +--:(yp:datastore-xpath-filter)
           |                 +--rw yp:datastore-xpath-filter?
           |                         yang:xpath1.0 {sn:xpath}?
           | ...
           +--rw (yp:update-trigger)
              +--:(yp:periodic)
              |  +--rw yp:periodic!
              |     +--rw yp:period         centiseconds
              |     +--rw yp:anchor-time?   yang:date-and-time
              +--:(yp:on-change) {on-change}?
                 +--rw yp:on-change!
                    +--rw yp:dampening-period?   centiseconds
                    +--rw yp:sync-on-start?      boolean
                    +--rw yp:excluded-change*    change-type

        Figure 6: Data Model Structure: Subscription Configuration





<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 21]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-22" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


   Figure 7 depicts the augmentations of YANG module ietf-yang-push made
   to RPCs specified in YANG module ietf-subscribed-notifications
   [<a href="/doc/html/rfc8639" title="&quot;Subscription to YANG Notifications&quot;">RFC8639</a>].  Specifically, these augmentations concern the &quot;establish-
   subscription&quot; and &quot;modify-subscription&quot; RPCs, which are augmented
   with parameters that are needed to specify datastore push
   subscriptions.

     rpcs:
       +---x establish-subscription
       |  +---w input
       |  |  ...
       |  |  +---w (target)
       |  |  |  +--:(stream)
       |  |  |  |  ...
       |  |  |  +--:(yp:datastore)
       |  |  |     +---w yp:datastore                   identityref
       |  |  |     +---w (yp:selection-filter)?
       |  |  |        +--:(yp:by-reference)
       |  |  |        |  +---w yp:selection-filter-ref
       |  |  |        |          selection-filter-ref
       |  |  |        +--:(yp:within-subscription)
       |  |  |           +---w (yp:filter-spec)?
       |  |  |              +--:(yp:datastore-subtree-filter)
       |  |  |              |  +---w yp:datastore-subtree-filter?
       |  |  |              |          &lt;anydata&gt; {sn:subtree}?
       |  |  |              +--:(yp:datastore-xpath-filter)
       |  |  |                 +---w yp:datastore-xpath-filter?
       |  |  |                         yang:xpath1.0 {sn:xpath}?
       |  |  | ...
       |  |  +---w (yp:update-trigger)
       |  |     +--:(yp:periodic)
       |  |     |  +---w yp:periodic!
       |  |     |     +---w yp:period         centiseconds
       |  |     |     +---w yp:anchor-time?   yang:date-and-time
       |  |     +--:(yp:on-change) {on-change}?
       |  |        +---w yp:on-change!
       |  |           +---w yp:dampening-period?   centiseconds
       |  |           +---w yp:sync-on-start?      boolean
       |  |           +---w yp:excluded-change*    change-type
       |  +--ro output
       |     +--ro id                            subscription-id
       |     +--ro replay-start-time-revision?   yang:date-and-time
       |             {replay}?








<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 22]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-23" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


       +---x modify-subscription
       |  +---w input
       |     ...
       |     +---w (target)
       |     |  ...
       |     |  +--:(yp:datastore)
       |     |     +---w yp:datastore                   identityref
       |     |     +---w (yp:selection-filter)?
       |     |        +--:(yp:by-reference)
       |     |        |  +---w yp:selection-filter-ref
       |     |        |          selection-filter-ref
       |     |        +--:(yp:within-subscription)
       |     |           +---w (yp:filter-spec)?
       |     |              +--:(yp:datastore-subtree-filter)
       |     |              |  +---w yp:datastore-subtree-filter?
       |     |              |          &lt;anydata&gt; {sn:subtree}?
       |     |              +--:(yp:datastore-xpath-filter)
       |     |                 +---w yp:datastore-xpath-filter?
       |     |                         yang:xpath1.0 {sn:xpath}?
       |     | ...
       |     +---w (yp:update-trigger)
       |        +--:(yp:periodic)
       |        |  +---w yp:periodic!
       |        |     +---w yp:period         centiseconds
       |        |     +---w yp:anchor-time?   yang:date-and-time
       |        +--:(yp:on-change) {on-change}?
       |           +---w yp:on-change!
       |              +---w yp:dampening-period?   centiseconds
       +---x delete-subscription
       |  ...
       +---x kill-subscription
          ...

     yang-data (for placement into RPC error responses)
       ...

                   Figure 7: Data Model Structure: RPCs














<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 23]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-24" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


   Figure 8 depicts augmentations of YANG module ietf-yang-push to the
   notifications that are specified in YANG module ietf-subscribed-
   notifications.  The augmentations allow the inclusion of subscription
   configuration parameters that are specific to datastore push
   subscriptions as part of &quot;subscription-started&quot; and &quot;subscription-
   modified&quot; notifications.

     notifications:
       +---n replay-completed {replay}?
       |  ...
       +---n subscription-completed
       |  ...
       +---n subscription-started {configured}?
       |  |  ...
       |  +--ro (target)
       |  |  ...
       |  |  +--:(yp:datastore)
       |  |     +--ro yp:datastore                   identityref
       |  |     +--ro (yp:selection-filter)?
       |  |        +--:(yp:by-reference)
       |  |        |  +--ro yp:selection-filter-ref
       |  |        |          selection-filter-ref
       |  |        +--:(yp:within-subscription)
       |  |           +--ro (yp:filter-spec)?
       |  |              +--:(yp:datastore-subtree-filter)
       |  |              |  +--ro yp:datastore-subtree-filter?
       |  |              |          &lt;anydata&gt; {sn:subtree}?
       |  |              +--:(yp:datastore-xpath-filter)
       |  |                 +--ro yp:datastore-xpath-filter?
       |  |                         yang:xpath1.0 {sn:xpath}?
       |  ...
       |  +--ro (yp:update-trigger)
       |     +--:(yp:periodic)
       |     |  +--ro yp:periodic!
       |     |     +--ro yp:period         centiseconds
       |     |     +--ro yp:anchor-time?   yang:date-and-time
       |     +--:(yp:on-change) {on-change}?
       |        +--ro yp:on-change!
       |           +--ro yp:dampening-period?   centiseconds
       |           +--ro yp:sync-on-start?      boolean
       |           +--ro yp:excluded-change*    change-type
       +---n subscription-resumed
       |  ...








<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 24]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-25" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


       +---n subscription-modified
       |  ...
       |  +--ro (target)
       |  |  |  ...
       |  |  +--:(yp:datastore)
       |  |     +--ro yp:datastore                   identityref
       |  |     +--ro (yp:selection-filter)?
       |  |        +--:(yp:by-reference)
       |  |        |  +--ro yp:selection-filter-ref
       |  |        |          selection-filter-ref
       |  |        +--:(yp:within-subscription)
       |  |           +--ro (yp:filter-spec)?
       |  |              +--:(yp:datastore-subtree-filter)
       |  |              |  +--ro yp:datastore-subtree-filter?
       |  |              |          &lt;anydata&gt; {sn:subtree}?
       |  |              +--:(yp:datastore-xpath-filter)
       |  |                 +--ro yp:datastore-xpath-filter?
       |  |                         yang:xpath1.0 {sn:xpath}?
       |  ...
       |  +--ro (yp:update-trigger)?
       |     +--:(yp:periodic)
       |     |  +--ro yp:periodic!
       |     |     +--ro yp:period         centiseconds
       |     |     +--ro yp:anchor-time?   yang:date-and-time
       |     +--:(yp:on-change) {on-change}?
       |        +--ro yp:on-change!
       |           +--ro yp:dampening-period?    centiseconds
       |           +--ro yp:sync-on-start?       boolean
       |           +--ro yp:excluded-change*     change-type
       +---n subscription-terminated
       |  ...
       +---n subscription-suspended
          ...

               Figure 8: Data Model Structure: Notifications
















<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 25]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-26" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


   Finally, Figure 9 depicts the parts of YANG module ietf-yang-push
   that are newly introduced in this document (i.e., that are not simply
   augmentations of another YANG module).

   module: ietf-yang-push

     rpcs:
       +---x resync-subscription {on-change}?
          +---w input
             +---w id    sn:subscription-id

     yang-data (for placement into RPC error responses):
       +-- resync-subscription-error
       |  +--ro reason?                   identityref
       |  +--ro period-hint?              centiseconds
       |  +--ro filter-failure-hint?      string
       |  +--ro object-count-estimate?    uint32
       |  +--ro object-count-limit?       uint32
       |  +--ro kilobytes-estimate?       uint32
       |  +--ro kilobytes-limit?          uint32
       +-- establish-subscription-error-datastore
       |  +--ro reason?                   identityref
       |  +--ro period-hint?              centiseconds
       |  +--ro filter-failure-hint?      string
       |  +--ro object-count-estimate?    uint32
       |  +--ro object-count-limit?       uint32
       |  +--ro kilobytes-estimate?       uint32
       |  +--ro kilobytes-limit?          uint32
       +-- modify-subscription-error-datastore
          +--ro reason?                   identityref
          +--ro period-hint?              centiseconds
          +--ro filter-failure-hint?      string
          +--ro object-count-estimate?    uint32
          +--ro object-count-limit?       uint32
          +--ro kilobytes-estimate?       uint32
          +--ro kilobytes-limit?          uint32















<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 26]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-27" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


        notifications:
          +---n push-update
          |  +--ro id?                   sn:subscription-id
          |  +--ro datastore-contents?   &lt;anydata&gt;
          |  +--ro incomplete-update?    empty
          +---n push-change-update {on-change}?
             +--ro id?                   sn:subscription-id
             +--ro datastore-changes
             |  +--ro yang-patch
             |     +--ro patch-id    string
             |     +--ro comment?    string
             |     +--ro edit* [edit-id]
             |        +--ro edit-id      string
             |        +--ro operation    enumeration
             |        +--ro target       target-resource-offset
             |        +--ro point?       target-resource-offset
             |        +--ro where?       enumeration
             |        +--ro value?       &lt;anydata&gt;
             +--ro incomplete-update?    empty

         Figure 9: Data Model Structure: Non-augmentation Portions

   Selected components of the data model are summarized below.

<span class="h3"><a class="selflink" id="section-4.2" href="#section-4.2">4.2</a>.  Subscription Configuration</span>

   Both configured and dynamic subscriptions are represented in the list
   &quot;subscription&quot;.  New parameters extending the basic subscription data
   model in [<a href="/doc/html/rfc8639" title="&quot;Subscription to YANG Notifications&quot;">RFC8639</a>] include:

   o  The targeted datastore from which the selection is being made.
      The potential datastores include those from [<a href="/doc/html/rfc8342" title="&quot;Network Management Datastore Architecture (NMDA)&quot;">RFC8342</a>].  A platform
      may also choose to support a custom datastore.

   o  A selection filter identifying YANG nodes of interest in a
      datastore.  Filter contents are specified via a reference to an
      existing filter or via an in-line definition for only that
      subscription.  Referenced filters allow an implementation to avoid
      evaluating filter acceptability during a dynamic subscription
      request.  The &quot;case&quot; statement differentiates the options.











<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 27]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-28" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


   o  For periodic subscriptions, triggered updates will occur at the
      boundaries of a specified time interval.  These boundaries can be
      calculated from the periodic parameters:

      *  a &quot;period&quot; that defines the duration between push updates.

      *  an &quot;anchor-time&quot;; update intervals fall on the points in time
         that are a multiple of a &quot;period&quot; from an &quot;anchor-time&quot;.  If an
         &quot;anchor-time&quot; is not provided, then the &quot;anchor-time&quot; MUST be
         set with the creation time of the initial update record.

   o  For on-change subscriptions, assuming that any dampening period
      has completed, triggering occurs whenever a change in the
      subscribed information is detected.  On-change subscriptions have
      more-complex semantics that are guided by their own set of
      parameters:

      *  a &quot;dampening-period&quot; that specifies the interval that must pass
         before a successive update for the subscription is sent.  If no
         dampening period is in effect, the update is sent immediately.
         If a subsequent change is detected, another update is only sent
         once the dampening period has passed for this subscription.

      *  an &quot;excluded-change&quot; that allows the restriction of the types
         of changes for which updates should be sent (e.g., only add to
         an update record on object creation).

      *  a &quot;sync-on-start&quot; that specifies whether a complete update with
         all the subscribed data is to be sent at the beginning of a
         subscription.

<span class="h3"><a class="selflink" id="section-4.3" href="#section-4.3">4.3</a>.  YANG Notifications</span>

<span class="h4"><a class="selflink" id="section-4.3.1" href="#section-4.3.1">4.3.1</a>.  State Change Notifications</span>

   Subscription state notifications and mechanisms are reused from
   [<a href="/doc/html/rfc8639" title="&quot;Subscription to YANG Notifications&quot;">RFC8639</a>].  Notifications &quot;subscription-started&quot; and &quot;subscription-
   modified&quot; have been augmented to include the datastore-specific
   objects.












<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 28]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-29" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


<span class="h4"><a class="selflink" id="section-4.3.2" href="#section-4.3.2">4.3.2</a>.  Notifications for Subscribed Content</span>

   Along with the subscribed content, there are other objects that might
   be part of a &quot;push-update&quot; or &quot;push-change-update&quot; notification.

   o  An &quot;id&quot; (that identifies the subscription).  This object MUST be
      transported along with the subscribed contents.  It allows a
      receiver to determine which subscription resulted in a particular
      update record.

   o  An &quot;incomplete-update&quot; leaf.  This leaf indicates that not all
      changes that have occurred since the last update are actually
      included with this update.  In other words, the publisher has
      failed to fulfill its full subscription obligations.  (For
      example, a datastore was unable to provide the full set of
      datastore nodes to a publisher process.)  To facilitate the
      resynchronization of on-change subscriptions, a publisher MAY
      subsequently send a &quot;push-update&quot; containing a full selection
      snapshot of subscribed data.

<span class="h3"><a class="selflink" id="section-4.4" href="#section-4.4">4.4</a>.  YANG RPCs</span>

   YANG-Push subscriptions are established, modified, and deleted using
   RPCs augmented from [<a href="/doc/html/rfc8639" title="&quot;Subscription to YANG Notifications&quot;">RFC8639</a>].

<span class="h4"><a class="selflink" id="section-4.4.1" href="#section-4.4.1">4.4.1</a>.  &quot;establish-subscription&quot; RPC</span>

   The subscriber sends an &quot;establish-subscription&quot; RPC with the
   parameters listed in <a href="#section-3.1">Section 3.1</a>.  An example might look like:






















<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 29]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-30" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


 &lt;netconf:rpc message-id=&quot;101&quot;
     xmlns:netconf=&quot;urn:ietf:params:xml:ns:netconf:base:1.0&quot;&gt;
   &lt;establish-subscription
       xmlns=&quot;urn:ietf:params:xml:ns:yang:ietf-subscribed-notifications&quot;
       xmlns:yp=&quot;urn:ietf:params:xml:ns:yang:ietf-yang-push&quot;&gt;
     &lt;yp:datastore
          xmlns:ds=&quot;urn:ietf:params:xml:ns:yang:ietf-datastores&quot;&gt;
       ds:operational
     &lt;/yp:datastore&gt;
     &lt;yp:datastore-xpath-filter
         xmlns:ex=&quot;https://example.com/sample-data/1.0&quot;&gt;
       /ex:foo
     &lt;/yp:datastore-xpath-filter&gt;
     &lt;yp:periodic&gt;
       &lt;yp:period&gt;500&lt;/yp:period&gt;
     &lt;/yp:periodic&gt;
   &lt;/establish-subscription&gt;
 &lt;/netconf:rpc&gt;

                  Figure 10: &quot;establish-subscription&quot; RPC

   A positive response includes the &quot;id&quot; of the accepted subscription.
   In that case, a publisher may respond as follows:

 &lt;rpc-reply message-id=&quot;101&quot;
    xmlns=&quot;urn:ietf:params:xml:ns:netconf:base:1.0&quot;&gt;
    &lt;id
      xmlns=&quot;urn:ietf:params:xml:ns:yang:ietf-subscribed-notifications&quot;&gt;
       52
    &lt;/id&gt;
 &lt;/rpc-reply&gt;

         Figure 11: &quot;establish-subscription&quot; Positive RPC Response

   A subscription can be rejected for multiple reasons, including the
   lack of authorization to establish a subscription, no capacity to
   serve the subscription at the publisher, or the inability of the
   publisher to select datastore content at the requested cadence.

   If a request is rejected because the publisher is not able to serve
   it, the publisher SHOULD include in the returned error hints that
   help a subscriber understand what subscription parameters might have
   been accepted for the request.  These hints would be included in the
   yang-data structure &quot;establish-subscription-error-datastore&quot;.
   However, even with these hints, there are no guarantees that
   subsequent requests will in fact be accepted.





<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 30]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-31" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


   The specific parameters to be returned as part of the RPC error
   response depend on the specific transport that is used to manage the
   subscription.  For NETCONF, those parameters are defined in
   [<a href="/doc/html/rfc8640" title="&quot;Dynamic Subscription to YANG Events and Datastores over NETCONF&quot;">RFC8640</a>].  For example, for the following NETCONF request:

     &lt;rpc message-id=&quot;101&quot;
          xmlns=&quot;urn:ietf:params:xml:ns:netconf:base:1.0&quot;&gt;
       &lt;establish-subscription
           xmlns=
             &quot;urn:ietf:params:xml:ns:yang:ietf-subscribed-notifications&quot;
           xmlns:yp=&quot;urn:ietf:params:xml:ns:yang:ietf-yang-push&quot;&gt;
         &lt;yp:datastore
             xmlns:ds=&quot;urn:ietf:params:xml:ns:yang:ietf-datastores&quot;&gt;
           ds:operational
         &lt;/yp:datastore&gt;
         &lt;yp:datastore-xpath-filter
             xmlns:ex=&quot;https://example.com/sample-data/1.0&quot;&gt;
           /ex:foo
         &lt;/yp:datastore-xpath-filter&gt;
         &lt;yp:on-change&gt;
           &lt;yp:dampening-period&gt;100&lt;/yp:dampening-period&gt;
         &lt;/yp:on-change&gt;
       &lt;/establish-subscription&gt;
     &lt;/rpc&gt;

          Figure 12: &quot;establish-subscription&quot; Request: Example 2

   A publisher that cannot serve on-change updates but can serve
   periodic updates might return the following NETCONF response:

 &lt;rpc-reply message-id=&quot;101&quot;
   xmlns=&quot;urn:ietf:params:xml:ns:netconf:base:1.0&quot;
   xmlns:yp=&quot;urn:ietf:params:xml:ns:yang:ietf-subscribed-notifications&quot;&gt;
   &lt;rpc-error&gt;
     &lt;error-type&gt;application&lt;/error-type&gt;
     &lt;error-tag&gt;operation-failed&lt;/error-tag&gt;
     &lt;error-severity&gt;error&lt;/error-severity&gt;
     &lt;error-path&gt;/yp:periodic/yp:period&lt;/error-path&gt;
     &lt;error-info&gt;
       &lt;yp:establish-subscription-error-datastore&gt;
         &lt;yp:reason&gt;yp:on-change-unsupported&lt;/yp:reason&gt;
       &lt;/yp:establish-subscription-error-datastore&gt;
     &lt;/error-info&gt;
   &lt;/rpc-error&gt;
 &lt;/rpc-reply&gt;

       Figure 13: &quot;establish-subscription&quot; Error Response: Example 2




<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 31]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-32" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


<span class="h4"><a class="selflink" id="section-4.4.2" href="#section-4.4.2">4.4.2</a>.  &quot;modify-subscription&quot; RPC</span>

   The subscriber MAY invoke the &quot;modify-subscription&quot; RPC for a
   subscription it previously established.  The subscriber will include
   newly desired values in the &quot;modify-subscription&quot; RPC.  Parameters
   not included MUST remain unmodified.  Figure 14 provides an example
   where a subscriber attempts to modify the period and datastore XPath
   filter of a subscription using NETCONF.

     &lt;rpc message-id=&quot;102&quot;
          xmlns=&quot;urn:ietf:params:xml:ns:netconf:base:1.0&quot;&gt;
       &lt;modify-subscription
           xmlns=
             &quot;urn:ietf:params:xml:ns:yang:ietf-subscribed-notifications&quot;
           xmlns:yp=&quot;urn:ietf:params:xml:ns:yang:ietf-yang-push&quot;&gt;
         &lt;id&gt;1011&lt;/id&gt;
         &lt;yp:datastore
             xmlns:ds=&quot;urn:ietf:params:xml:ns:yang:ietf-datastores&quot;&gt;
           ds:operational
         &lt;/yp:datastore&gt;
         &lt;yp:datastore-xpath-filter
             xmlns:ex=&quot;https://example.com/sample-data/1.0&quot;&gt;
           /ex:bar
         &lt;/yp:datastore-xpath-filter&gt;
         &lt;yp:periodic&gt;
           &lt;yp:period&gt;250&lt;/yp:period&gt;
         &lt;/yp:periodic&gt;
        &lt;/modify-subscription&gt;
     &lt;/rpc&gt;

                 Figure 14: &quot;modify-subscription&quot; Request

   The publisher MUST respond to the subscription modification request.
   If the request is rejected, the existing subscription is left
   unchanged, and the publisher MUST send an RPC error response.  This
   response might have hints encapsulated in the yang-data structure
   &quot;modify-subscription-error-datastore&quot;.  A subscription MAY be
   modified multiple times.

   The specific parameters to be returned as part of the RPC error
   response depend on the specific transport that is used to manage the
   subscription.  For NETCONF, those parameters are specified in
   [<a href="/doc/html/rfc8640" title="&quot;Dynamic Subscription to YANG Events and Datastores over NETCONF&quot;">RFC8640</a>].

   A configured subscription cannot be modified using a
   &quot;modify-subscription&quot; RPC.  Instead, the configuration needs to be
   edited as needed.




<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 32]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-33" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


<span class="h4"><a class="selflink" id="section-4.4.3" href="#section-4.4.3">4.4.3</a>.  &quot;delete-subscription&quot; RPC</span>

   To stop receiving updates from a subscription and effectively delete
   a subscription that had previously been established using an
   &quot;establish-subscription&quot; RPC, a subscriber can send a
   &quot;delete-subscription&quot; RPC, which takes as its only input the
   subscription&#x27;s &quot;id&quot;.  This RPC is unmodified from [<a href="/doc/html/rfc8639" title="&quot;Subscription to YANG Notifications&quot;">RFC8639</a>].

<span class="h4"><a class="selflink" id="section-4.4.4" href="#section-4.4.4">4.4.4</a>.  &quot;resync-subscription&quot; RPC</span>

   This RPC is supported only for on-change subscriptions previously
   established using an &quot;establish-subscription&quot; RPC.  For example:

      &lt;rpc message-id=&quot;103&quot;
           xmlns=&quot;urn:ietf:params:xml:ns:netconf:base:1.0&quot;&gt;
        &lt;resync-subscription
            xmlns=&quot;urn:ietf:params:xml:ns:yang:ietf-yang-push&quot;&gt;
          &lt;id&gt;1011&lt;/id&gt;
        &lt;/resync-subscription&gt;
      &lt;/rpc&gt;

                     Figure 15: &quot;resync-subscription&quot;

   On receipt, a publisher must either (1) accept the request and
   quickly follow with a &quot;push-update&quot; or (2) send an appropriate error
   in an RPC error response.  In its error response, the publisher MAY
   include, in the yang-data structure &quot;resync-subscription-error&quot;,
   supplemental information about the reasons for the error.

<span class="h4"><a class="selflink" id="section-4.4.5" href="#section-4.4.5">4.4.5</a>.  YANG Module Synchronization</span>

   To make subscription requests, the subscriber needs to know the YANG
   datastore schemas used by the publisher.  These schemas are available
   in the YANG library module ietf-yang-library.yang as defined in
   [<a href="/doc/html/rfc8525" title="&quot;YANG Library&quot;">RFC8525</a>].  The receiver is expected to know the YANG library
   information before starting a subscription.

   The set of modules, revisions, features, and deviations can change at
   runtime (if supported by the publisher implementation).  For this
   purpose, the YANG library provides a simple &quot;yang-library-change&quot;
   notification that informs the subscriber that the library has
   changed.  In this case, a subscription may need to be updated to take
   the updates into account.  The receiver may also need to be informed
   of module changes in order to process updates regarding datastore
   nodes from changed modules correctly.






<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 33]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-34" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>.  YANG Module for YANG-Push</span>

   This YANG module imports typedefs from [<a href="/doc/html/rfc6991" title="&quot;Common YANG Data Types&quot;">RFC6991</a>], identities from
   [<a href="/doc/html/rfc8342" title="&quot;Network Management Datastore Architecture (NMDA)&quot;">RFC8342</a>], the &quot;yang-data&quot; extension from [<a href="/doc/html/rfc8040" title="&quot;RESTCONF Protocol&quot;">RFC8040</a>], and the
   &quot;yang-patch&quot; grouping from [<a href="/doc/html/rfc8072" title="&quot;YANG Patch Media Type&quot;">RFC8072</a>].  In addition, it imports and
   augments many definitions from [<a href="/doc/html/rfc8639" title="&quot;Subscription to YANG Notifications&quot;">RFC8639</a>].  It also references
   [<a href="/doc/html/rfc6241" title="&quot;Network Configuration Protocol (NETCONF)&quot;">RFC6241</a>], [<a href="#ref-XPATH" title="&quot;XML Path Language (XPath) Version 1.0&quot;">XPATH</a>] (&quot;XML Path Language (XPath) Version 1.0&quot;), and
   [<a href="/doc/html/rfc7950" title="&quot;The YANG 1.1 Data Modeling Language&quot;">RFC7950</a>].

   &lt;CODE BEGINS&gt; file &quot;ietf-yang-push@2019-09-09.yang&quot;
   module ietf-yang-push {
     yang-version 1.1;
     namespace &quot;urn:ietf:params:xml:ns:yang:ietf-yang-push&quot;;
     prefix yp;

     import ietf-yang-types {
       prefix yang;
       reference
         &quot;<a href="/doc/html/rfc6991">RFC 6991</a>: Common YANG Data Types&quot;;
     }
     import ietf-subscribed-notifications {
       prefix sn;
       reference
         &quot;<a href="/doc/html/rfc8639">RFC 8639</a>: Subscription to YANG Notifications&quot;;
     }
     import ietf-datastores {
       prefix ds;
       reference
         &quot;<a href="/doc/html/rfc8342">RFC 8342</a>: Network Management Datastore Architecture (NMDA)&quot;;
     }
     import ietf-restconf {
       prefix rc;
       reference
         &quot;<a href="/doc/html/rfc8040">RFC 8040</a>: RESTCONF Protocol&quot;;
     }
     import ietf-yang-patch {
       prefix ypatch;
       reference
         &quot;<a href="/doc/html/rfc8072">RFC 8072</a>: YANG Patch Media Type&quot;;
     }

     organization
       &quot;IETF NETCONF (Network Configuration) Working Group&quot;;
     contact
       &quot;WG Web:  &lt;https:/datatracker.ietf.org/wg/netconf/&gt;
        WG List: &lt;mailto:netconf@ietf.org&gt;

        Author:  Alexander Clemm



<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 34]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-35" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


                 &lt;mailto:ludwig@clemm.org&gt;

        Author:  Eric Voit
                 &lt;mailto:evoit@cisco.com&gt;&quot;;

     description
       &quot;This module contains YANG specifications for YANG-Push.

        The key words &#x27;MUST&#x27;, &#x27;MUST NOT&#x27;, &#x27;REQUIRED&#x27;, &#x27;SHALL&#x27;, &#x27;SHALL
        NOT&#x27;, &#x27;SHOULD&#x27;, &#x27;SHOULD NOT&#x27;, &#x27;RECOMMENDED&#x27;, &#x27;NOT RECOMMENDED&#x27;,
        &#x27;MAY&#x27;, and &#x27;OPTIONAL&#x27; in this document are to be interpreted as
        described in <a href="/doc/html/bcp14">BCP 14</a> (<a href="/doc/html/rfc2119">RFC 2119</a>) (<a href="/doc/html/rfc8174">RFC 8174</a>) when, and only when,
        they appear in all capitals, as shown here.

        Copyright (c) 2019 IETF Trust and the persons identified as
        authors of the code.  All rights reserved.

        Redistribution and use in source and binary forms, with or
        without modification, is permitted pursuant to, and subject to
        the license terms contained in, the Simplified BSD License set
        forth in <a href="#section-4">Section 4</a>.c of the IETF Trust&#x27;s Legal Provisions
        Relating to IETF Documents
        (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>).

        This version of this YANG module is part of <a href="/doc/html/rfc8641">RFC 8641</a>; see the
        RFC itself for full legal notices.&quot;;

     revision 2019-09-09 {
       description
         &quot;Initial revision.&quot;;
       reference
         &quot;<a href="/doc/html/rfc8641">RFC 8641</a>: Subscriptions to YANG Datastores&quot;;
     }

     /*
      * FEATURES
      */

     feature on-change {
       description
         &quot;This feature indicates that on-change triggered subscriptions
          are supported.&quot;;
     }

     /*
      * IDENTITIES
      */




<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 35]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-36" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


     /* Error type identities for datastore subscription */

     identity resync-subscription-error {
       description
         &quot;Problem found while attempting to fulfill a
          &#x27;resync-subscription&#x27; RPC request.&quot;;
     }

     identity cant-exclude {
       base sn:establish-subscription-error;
       description
         &quot;Unable to remove the set of &#x27;excluded-change&#x27; parameters.
          This means that the publisher is unable to restrict
          &#x27;push-change-update&#x27; notifications to just the change types
          requested for this subscription.&quot;;
     }

     identity datastore-not-subscribable {
       base sn:establish-subscription-error;
       base sn:subscription-terminated-reason;
       description
         &quot;This is not a subscribable datastore.&quot;;
     }

     identity no-such-subscription-resync {
       base resync-subscription-error;
       description
         &quot;The referenced subscription doesn&#x27;t exist.  This may be as a
          result of a nonexistent subscription ID, an ID that belongs to
          another subscriber, or an ID for a configured subscription.&quot;;
     }

     identity on-change-unsupported {
       base sn:establish-subscription-error;
       description
         &quot;On-change is not supported for any objects that are
          selectable by this filter.&quot;;
     }

     identity on-change-sync-unsupported {
       base sn:establish-subscription-error;
       description
         &quot;Neither &#x27;sync-on-start&#x27; nor resynchronization is supported for
          this subscription.  This error will be used for two reasons:
          (1) if an &#x27;establish-subscription&#x27; RPC includes
          &#x27;sync-on-start&#x27; but the publisher can&#x27;t support sending a
          &#x27;push-update&#x27; for this subscription for reasons other than
          &#x27;on-change-unsupported&#x27; or &#x27;sync-too-big&#x27;



<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 36]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-37" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


          (2) if the &#x27;resync-subscription&#x27; RPC is invoked for either an
          existing periodic subscription or an on-change subscription
          that can&#x27;t support resynchronization.&quot;;
     }

     identity period-unsupported {
       base sn:establish-subscription-error;
       base sn:modify-subscription-error;
       base sn:subscription-suspended-reason;
       description
         &quot;The requested time period or &#x27;dampening-period&#x27; is too short.
          This can be for both periodic and on-change subscriptions
          (with or without dampening).  Hints suggesting alternative
          periods may be returned as supplemental information.&quot;;
     }

     identity update-too-big {
       base sn:establish-subscription-error;
       base sn:modify-subscription-error;
       base sn:subscription-suspended-reason;
       description
         &quot;Periodic or on-change push update data trees exceed a maximum
          size limit.  Hints on the estimated size of what was too big
          may be returned as supplemental information.&quot;;
     }

     identity sync-too-big {
       base sn:establish-subscription-error;
       base sn:modify-subscription-error;
       base resync-subscription-error;
       base sn:subscription-suspended-reason;
       description
         &quot;The &#x27;sync-on-start&#x27; or resynchronization data tree exceeds a
          maximum size limit.  Hints on the estimated size of what was
          too big may be returned as supplemental information.&quot;;
     }

     identity unchanging-selection {
       base sn:establish-subscription-error;
       base sn:modify-subscription-error;
       base sn:subscription-terminated-reason;
       description
         &quot;The selection filter is unlikely to ever select data tree
          nodes.  This means that based on the subscriber&#x27;s current
          access rights, the publisher recognizes that the selection
          filter is unlikely to ever select data tree nodes that change.
          Examples for this might be that the node or subtree doesn&#x27;t
          exist, read access is not permitted for a receiver, or static



<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 37]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-38" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


          objects that only change at reboot have been chosen.&quot;;
     }

     /*
      * TYPE DEFINITIONS
      */

     typedef change-type {
       type enumeration {
         enum create {
           description
             &quot;A change that refers to the creation of a new
              datastore node.&quot;;
         }
         enum delete {
           description
             &quot;A change that refers to the deletion of a
              datastore node.&quot;;
         }
         enum insert {
           description
             &quot;A change that refers to the insertion of a new
              user-ordered datastore node.&quot;;
         }
         enum move {
           description
             &quot;A change that refers to a reordering of the target
              datastore node.&quot;;
         }
         enum replace {
           description
             &quot;A change that refers to a replacement of the target
              datastore node&#x27;s value.&quot;;
         }
       }
       description
         &quot;Specifies different types of datastore changes.

          This type is based on the edit operations defined for
          YANG Patch, with the difference that it is valid for a
          receiver to process an update record that performs a
          &#x27;create&#x27; operation on a datastore node the receiver believes
          exists or to process a delete on a datastore node the
          receiver believes is missing.&quot;;
       reference
         &quot;<a href="/doc/html/rfc8072">RFC 8072</a>: YANG Patch Media Type, <a href="#section-2.5">Section 2.5</a>&quot;;
     }




<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 38]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-39" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


     typedef selection-filter-ref {
       type leafref {
         path &quot;/sn:filters/yp:selection-filter/yp:filter-id&quot;;
       }
       description
         &quot;This type is used to reference a selection filter.&quot;;
     }

     typedef centiseconds {
       type uint32;
       description
         &quot;A period of time, measured in units of 0.01 seconds.&quot;;
     }

     /*
      * GROUP DEFINITIONS
      */

     grouping datastore-criteria {
       description
         &quot;A grouping to define criteria for which selected objects from
          a targeted datastore should be included in push updates.&quot;;
       leaf datastore {
         type identityref {
           base ds:datastore;
         }
         mandatory true;
         description
           &quot;Datastore from which to retrieve data.&quot;;
       }
       uses selection-filter-objects;
     }

     grouping selection-filter-types {
       description
         &quot;This grouping defines the types of selectors for objects
          from a datastore.&quot;;
       choice filter-spec {
         description
           &quot;The content filter specification for this request.&quot;;
         anydata datastore-subtree-filter {
           if-feature &quot;sn:subtree&quot;;
           description
             &quot;This parameter identifies the portions of the
              target datastore to retrieve.&quot;;
           reference
             &quot;<a href="/doc/html/rfc6241">RFC 6241</a>: Network Configuration Protocol (NETCONF),
                        <a href="#section-6">Section 6</a>&quot;;



<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 39]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-40" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


         }
         leaf datastore-xpath-filter {
           if-feature &quot;sn:xpath&quot;;
           type yang:xpath1.0;
           description
             &quot;This parameter contains an XPath expression identifying
              the portions of the target datastore to retrieve.

              If the expression returns a node set, all nodes in the
              node set are selected by the filter.  Otherwise, if the
              expression does not return a node set, the filter
              doesn&#x27;t select any nodes.

              The expression is evaluated in the following XPath
              context:

              o  The set of namespace declarations is the set of prefix
                 and namespace pairs for all YANG modules implemented
                 by the server, where the prefix is the YANG module
                 name and the namespace is as defined by the
                 &#x27;namespace&#x27; statement in the YANG module.

                 If the leaf is encoded in XML, all namespace
                 declarations in scope on the &#x27;stream-xpath-filter&#x27;
                 leaf element are added to the set of namespace
                 declarations.  If a prefix found in the XML is
                 already present in the set of namespace declarations,
                 the namespace in the XML is used.

              o  The set of variable bindings is empty.

              o  The function library is comprised of the core
                 function library and the XPath functions defined in
                 <a href="/doc/html/rfc7950#section-10">Section&nbsp;10 in RFC 7950</a>.

              o  The context node is the root node of the target
                 datastore.&quot;;
           reference
             &quot;XML Path Language (XPath) Version 1.0
              (<a href="https://www.w3.org/TR/1999/REC-xpath-19991116">https://www.w3.org/TR/1999/REC-xpath-19991116</a>)
              <a href="/doc/html/rfc7950">RFC 7950</a>: The YANG 1.1 Data Modeling Language,
                        <a href="#section-10">Section 10</a>&quot;;
         }
       }
     }

     grouping selection-filter-objects {
       description



<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 40]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-41" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


         &quot;This grouping defines a selector for objects from a
          datastore.&quot;;
       choice selection-filter {
         description
           &quot;The source of the selection filter applied to the
            subscription.  This will either (1) come referenced from a
            global list or (2) be provided in the subscription itself.&quot;;
         case by-reference {
           description
             &quot;Incorporates a filter that has been configured
              separately.&quot;;
           leaf selection-filter-ref {
             type selection-filter-ref;
             mandatory true;
             description
               &quot;References an existing selection filter that is to be
                applied to the subscription.&quot;;
           }
         }
         case within-subscription {
           description
             &quot;A local definition allows a filter to have the same
              lifecycle as the subscription.&quot;;
           uses selection-filter-types;
         }
       }
     }

     grouping update-policy-modifiable {
       description
         &quot;This grouping describes the datastore-specific subscription
          conditions that can be changed during the lifetime of the
          subscription.&quot;;
       choice update-trigger {
         description
           &quot;Defines necessary conditions for sending an event record to
            the subscriber.&quot;;
         case periodic {
           container periodic {
             presence &quot;indicates a periodic subscription&quot;;
             description
               &quot;The publisher is requested to periodically notify the
                receiver regarding the current values of the datastore
                as defined by the selection filter.&quot;;
             leaf period {
               type centiseconds;
               mandatory true;
               description



<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 41]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-42" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


                 &quot;Duration of time that should occur between periodic
                  push updates, in units of 0.01 seconds.&quot;;
             }
             leaf anchor-time {
               type yang:date-and-time;
               description
                 &quot;Designates a timestamp before or after which a series
                  of periodic push updates are determined.  The next
                  update will take place at a point in time that is a
                  multiple of a period from the &#x27;anchor-time&#x27;.
                  For example, for an &#x27;anchor-time&#x27; that is set for the
                  top of a particular minute and a period interval of a
                  minute, updates will be sent at the top of every
                  minute that this subscription is active.&quot;;
             }
           }
         }
         case on-change {
           if-feature &quot;on-change&quot;;
           container on-change {
             presence &quot;indicates an on-change subscription&quot;;
             description
               &quot;The publisher is requested to notify the receiver
                regarding changes in values in the datastore subset as
                defined by a selection filter.&quot;;
             leaf dampening-period {
               type centiseconds;
               default &quot;0&quot;;
               description
                 &quot;Specifies the minimum interval between the assembly of
                  successive update records for a single receiver of a
                  subscription.  Whenever subscribed objects change and
                  a dampening-period interval (which may be zero) has
                  elapsed since the previous update record creation for
                  a receiver, any subscribed objects and properties
                  that have changed since the previous update record
                  will have their current values marshalled and placed
                  in a new update record.&quot;;
             }
           }
         }
       }
     }

     grouping update-policy {
       description
         &quot;This grouping describes the datastore-specific subscription
          conditions of a subscription.&quot;;



<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 42]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-43" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


       uses update-policy-modifiable {
         augment &quot;update-trigger/on-change/on-change&quot; {
           description
             &quot;Includes objects that are not modifiable once a
              subscription is established.&quot;;
           leaf sync-on-start {
             type boolean;
             default &quot;true&quot;;
             description
               &quot;When this object is set to &#x27;false&#x27;, (1) it restricts an
                on-change subscription from sending &#x27;push-update&#x27;
                notifications and (2) pushing a full selection per the
                terms of the selection filter MUST NOT be done for
                this subscription.  Only updates about changes
                (i.e., only &#x27;push-change-update&#x27; notifications)
                are sent.  When set to &#x27;true&#x27; (the default behavior),
                in order to facilitate a receiver&#x27;s synchronization,
                a full update is sent, via a &#x27;push-update&#x27; notification,
                when the subscription starts.  After that,
                &#x27;push-change-update&#x27; notifications are exclusively sent,
                unless the publisher chooses to resync the subscription
                via a new &#x27;push-update&#x27; notification.&quot;;
           }
           leaf-list excluded-change {
             type change-type;
             description
               &quot;Used to restrict which changes trigger an update.  For
                example, if a &#x27;replace&#x27; operation is excluded, only the
                creation and deletion of objects are reported.&quot;;
           }
         }
       }
     }

     grouping hints {
       description
         &quot;Parameters associated with an error for a subscription
          made upon a datastore.&quot;;
       leaf period-hint {
         type centiseconds;
         description
           &quot;Returned when the requested time period is too short.  This
            hint can assert a viable period for either a periodic push
            cadence or an on-change dampening interval.&quot;;
       }
       leaf filter-failure-hint {
         type string;
         description



<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 43]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-44" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


           &quot;Information describing where and/or why a provided filter
            was unsupportable for a subscription.&quot;;
       }
       leaf object-count-estimate {
         type uint32;
         description
           &quot;If there are too many objects that could potentially be
            returned by the selection filter, this identifies the
            estimate of the number of objects that the filter would
            potentially pass.&quot;;
       }
       leaf object-count-limit {
         type uint32;
         description
           &quot;If there are too many objects that could be returned by
            the selection filter, this identifies the upper limit of
            the publisher&#x27;s ability to service this subscription.&quot;;
       }
       leaf kilobytes-estimate {
         type uint32;
         description
           &quot;If the returned information could be beyond the capacity
            of the publisher, this would identify the estimated
            data size that could result from this selection filter.&quot;;
       }
       leaf kilobytes-limit {
         type uint32;
         description
           &quot;If the returned information would be beyond the capacity
            of the publisher, this identifies the upper limit of the
            publisher&#x27;s ability to service this subscription.&quot;;
       }
     }

     /*
      * RPCs
      */

     rpc resync-subscription {
       if-feature &quot;on-change&quot;;
       description
         &quot;This RPC allows a subscriber of an active on-change
          subscription to request a full push of objects.

          A successful invocation results in a &#x27;push-update&#x27; of all
          datastore nodes that the subscriber is permitted to access.
          This RPC can only be invoked on the same session on which the
          subscription is currently active.  In the case of an error, a



<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 44]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-45" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


          &#x27;resync-subscription-error&#x27; is sent as part of an error
          response.&quot;;
       input {
         leaf id {
           type sn:subscription-id;
           mandatory true;
           description
             &quot;Identifier of the subscription that is to be resynced.&quot;;
         }
       }
     }

     rc:yang-data resync-subscription-error {
       container resync-subscription-error {
         description
           &quot;If a &#x27;resync-subscription&#x27; RPC fails, the subscription is
            not resynced and the RPC error response MUST indicate the
            reason for this failure.  This yang-data MAY be inserted as
            structured data in a subscription&#x27;s RPC error response
            to indicate the reason for the failure.&quot;;
         leaf reason {
           type identityref {
             base resync-subscription-error;
           }
           mandatory true;
           description
             &quot;Indicates the reason why the publisher has declined a
              request for subscription resynchronization.&quot;;
         }
         uses hints;
       }
     }

     augment &quot;/sn:establish-subscription/sn:input&quot; {
       description
         &quot;This augmentation adds additional subscription parameters
          that apply specifically to datastore updates to RPC input.&quot;;
       uses update-policy;
     }

     augment &quot;/sn:establish-subscription/sn:input/sn:target&quot; {
       description
         &quot;This augmentation adds the datastore as a valid target
          for the subscription to RPC input.&quot;;
       case datastore {
         description
           &quot;Information specifying the parameters of a request for a
            datastore subscription.&quot;;



<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 45]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-46" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


         uses datastore-criteria;
       }
     }

     rc:yang-data establish-subscription-datastore-error-info {
       container establish-subscription-datastore-error-info {
         description
           &quot;If any &#x27;establish-subscription&#x27; RPC parameters are
            unsupportable against the datastore, a subscription is not
            created and the RPC error response MUST indicate the reason
            why the subscription failed to be created.  This yang-data
            MAY be inserted as structured data in a subscription&#x27;s
            RPC error response to indicate the reason for the failure.
            This yang-data MUST be inserted if hints are to be provided
            back to the subscriber.&quot;;
         leaf reason {
           type identityref {
             base sn:establish-subscription-error;
           }
           description
             &quot;Indicates the reason why the subscription has failed to
              be created to a targeted datastore.&quot;;
         }
         uses hints;
       }
     }

     augment &quot;/sn:modify-subscription/sn:input&quot; {
       description
         &quot;This augmentation adds additional subscription parameters
          specific to datastore updates.&quot;;
       uses update-policy-modifiable;
     }

     augment &quot;/sn:modify-subscription/sn:input/sn:target&quot; {
       description
         &quot;This augmentation adds the datastore as a valid target
          for the subscription to RPC input.&quot;;
       case datastore {
         description
           &quot;Information specifying the parameters of a request for a
            datastore subscription.&quot;;
         uses datastore-criteria;
       }
     }

     rc:yang-data modify-subscription-datastore-error-info {
       container modify-subscription-datastore-error-info {



<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 46]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-47" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


         description
           &quot;This yang-data MAY be provided as part of a subscription&#x27;s
            RPC error response when there is a failure of a
            &#x27;modify-subscription&#x27; RPC that has been made against a
            datastore.  This yang-data MUST be used if hints are to be
            provided back to the subscriber.&quot;;
         leaf reason {
           type identityref {
             base sn:modify-subscription-error;
           }
           description
             &quot;Indicates the reason why the subscription has failed to
              be modified.&quot;;
         }
         uses hints;
       }
     }

     /*
      * NOTIFICATIONS
      */

     notification push-update {
       description
         &quot;This notification contains a push update that in turn contains
          data subscribed to via a subscription.  In the case of a
          periodic subscription, this notification is sent for periodic
          updates.  It can also be used for synchronization updates of
          an on-change subscription.  This notification shall only be
          sent to receivers of a subscription.  It does not constitute
          a general-purpose notification that would be subscribable as
          part of the NETCONF event stream by any receiver.&quot;;
       leaf id {
         type sn:subscription-id;
         description
           &quot;This references the subscription that drove the
            notification to be sent.&quot;;
       }
       anydata datastore-contents {
         description
           &quot;This contains the updated data.  It constitutes a snapshot
            at the time of update of the set of data that has been
            subscribed to.  The snapshot corresponds to the same
            snapshot that would be returned in a corresponding &#x27;get&#x27;
            operation with the same selection filter parameters
            applied.&quot;;
       }
       leaf incomplete-update {



<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 47]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-48" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


         type empty;
         description
           &quot;This is a flag that indicates that not all datastore
            nodes subscribed to are included with this update.  In
            other words, the publisher has failed to fulfill its full
            subscription obligations and, despite its best efforts, is
            providing an incomplete set of objects.&quot;;
       }
     }

     notification push-change-update {
       if-feature &quot;on-change&quot;;
       description
         &quot;This notification contains an on-change push update.  This
          notification shall only be sent to the receivers of a
          subscription.  It does not constitute a general-purpose
          notification that would be subscribable as part of the
          NETCONF event stream by any receiver.&quot;;
       leaf id {
         type sn:subscription-id;
         description
           &quot;This references the subscription that drove the
            notification to be sent.&quot;;
       }
       container datastore-changes {
         description
           &quot;This contains the set of datastore changes of the target
            datastore, starting at the time of the previous update, per
            the terms of the subscription.&quot;;
         uses ypatch:yang-patch;
       }
       leaf incomplete-update {
         type empty;
         description
           &quot;The presence of this object indicates that not all changes
            that have occurred since the last update are included with
            this update.  In other words, the publisher has failed to
            fulfill its full subscription obligations -- for example,
            in cases where it was not able to keep up with a burst of
            changes.&quot;;
       }
     }

     augment &quot;/sn:subscription-started&quot; {
       description
         &quot;This augmentation adds datastore-specific objects to
          the notification that a subscription has started.&quot;;
       uses update-policy;



<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 48]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-49" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


     }

     augment &quot;/sn:subscription-started/sn:target&quot; {
       description
         &quot;This augmentation allows the datastore to be included as
          part of the notification that a subscription has started.&quot;;
       case datastore {
         uses datastore-criteria {
           refine &quot;selection-filter/within-subscription&quot; {
             description
               &quot;Specifies the selection filter and where it originated
                from.  If the &#x27;selection-filter-ref&#x27; is populated, the
                filter in the subscription came from the &#x27;filters&#x27;
                container.  Otherwise, it is populated in-line as part
                of the subscription itself.&quot;;
           }
         }
       }
     }

     augment &quot;/sn:subscription-modified&quot; {
       description
         &quot;This augmentation adds datastore-specific objects to
          the notification that a subscription has been modified.&quot;;
       uses update-policy;
     }

     augment &quot;/sn:subscription-modified/sn:target&quot; {
       description
         &quot;This augmentation allows the datastore to be included as
          part of the notification that a subscription has been
          modified.&quot;;
       case datastore {
         uses datastore-criteria {
           refine &quot;selection-filter/within-subscription&quot; {
             description
               &quot;Specifies the selection filter and where it originated
                from.  If the &#x27;selection-filter-ref&#x27; is populated, the
                filter in the subscription came from the &#x27;filters&#x27;
                container.  Otherwise, it is populated in-line as part
                of the subscription itself.&quot;;
           }
         }
       }
     }

     /*
      * DATA NODES



<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 49]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-50" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


      */

     augment &quot;/sn:filters&quot; {
       description
         &quot;This augmentation allows the datastore to be included as part
          of the selection-filtering criteria for a subscription.&quot;;
       list selection-filter {
         key &quot;filter-id&quot;;
         description
           &quot;A list of preconfigured filters that can be applied
            to datastore subscriptions.&quot;;
         leaf filter-id {
           type string;
           description
             &quot;An identifier to differentiate between selection
              filters.&quot;;
         }
         uses selection-filter-types;
       }
     }

     augment &quot;/sn:subscriptions/sn:subscription&quot; {
       when &#x27;yp:datastore&#x27;;
       description
         &quot;This augmentation adds objects to a subscription that are
          specific to a datastore subscription, i.e., a subscription to
          a stream of datastore node updates.&quot;;
       uses update-policy;
     }

     augment &quot;/sn:subscriptions/sn:subscription/sn:target&quot; {
       description
         &quot;This augmentation allows the datastore to be included as
          part of the selection-filtering criteria for a subscription.&quot;;
       case datastore {
         uses datastore-criteria;
       }
     }
   }

   &lt;CODE ENDS&gt;










<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 50]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-51" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


<span class="h2"><a class="selflink" id="section-6" href="#section-6">6</a>.  IANA Considerations</span>

   This document registers the following namespace URI in the &quot;IETF XML
   Registry&quot; [<a href="/doc/html/rfc3688" title="&quot;The IETF XML Registry&quot;">RFC3688</a>]:

   URI: urn:ietf:params:xml:ns:yang:ietf-yang-push

   Registrant Contact: The IESG.

   XML: N/A; the requested URI is an XML namespace.

   This document registers the following YANG module in the &quot;YANG Module
   Names&quot; registry [<a href="/doc/html/rfc6020" title="&quot;YANG - A Data Modeling Language for the Network Configuration Protocol (NETCONF)&quot;">RFC6020</a>]:

   Name: ietf-yang-push

   Namespace: urn:ietf:params:xml:ns:yang:ietf-yang-push

   Prefix: yp

   Reference: <a href="/doc/html/rfc8641">RFC 8641</a>

<span class="h2"><a class="selflink" id="section-7" href="#section-7">7</a>.  Security Considerations</span>

   The YANG module specified in this document defines a schema for data
   that is designed to be accessed via network management protocols such
   as NETCONF [<a href="/doc/html/rfc6241" title="&quot;Network Configuration Protocol (NETCONF)&quot;">RFC6241</a>] or RESTCONF [<a href="/doc/html/rfc8040" title="&quot;RESTCONF Protocol&quot;">RFC8040</a>].  The lowest NETCONF layer
   is the secure transport layer, and the mandatory-to-implement secure
   transport is Secure Shell (SSH) [<a href="/doc/html/rfc6242" title="&quot;Using the NETCONF Protocol over Secure Shell (SSH)&quot;">RFC6242</a>].  The lowest RESTCONF layer
   is HTTPS, and the mandatory-to-implement secure transport is TLS
   [<a href="/doc/html/rfc8446" title="&quot;The Transport Layer Security (TLS) Protocol Version 1.3&quot;">RFC8446</a>].

   The Network Configuration Access Control Model (NACM) [<a href="/doc/html/rfc8341" title="&quot;Network Configuration Access Control Model&quot;">RFC8341</a>]
   provides the means to restrict access for particular NETCONF or
   RESTCONF users to a preconfigured subset of all available NETCONF or
   RESTCONF protocol operations and content.

   There are a number of data nodes defined in this YANG module that are
   writable/creatable/deletable (i.e., config true, which is the
   default).  These data nodes may be considered sensitive or vulnerable
   in some network environments.  Write operations (e.g., edit-config)
   to these data nodes without proper protection can have a negative
   effect on network operations.  These are the subtrees and data nodes
   and their sensitivity/vulnerability.  (It should be noted that the
   YANG module defined in this document augments the YANG module defined
   in [<a href="/doc/html/rfc8639" title="&quot;Subscription to YANG Notifications&quot;">RFC8639</a>].  All security considerations that are listed in





<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 51]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-52" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


   [<a id="ref-RFC8639">RFC8639</a>] are also relevant for datastore subscriptions.  In the
   following list, we focus on the new data nodes that are introduced in
   this document.)

   o  Subtree &quot;selection-filter&quot; under container &quot;filters&quot;: This subtree
      allows a subscriber to specify which objects or subtrees to
      include in a datastore subscription.  An attacker could attempt to
      modify the filter.  For example, the filter might be modified to
      result in very few objects being filtered in order to attempt to
      overwhelm the receiver.  Alternatively, the filter might be
      modified to result in certain objects being excluded from updates,
      in which case certain changes would go unnoticed.

   o  Subtree &quot;datastore&quot; in choice &quot;target&quot; in list &quot;subscription&quot;:
      Analogous to &quot;selection filter&quot;, an attacker might attempt to
      modify the objects being filtered in order to overwhelm a receiver
      with a larger volume of object updates than expected or cause
      certain changes to go unnoticed.

   o  Choice &quot;update-trigger&quot; in list &quot;subscription&quot;: By modifying the
      update trigger, an attacker might alter the updates that are being
      sent in order to confuse a receiver, withhold certain updates to
      be sent to the receiver, and/or overwhelm a receiver.  For
      example, an attacker might modify the period with which updates
      are reported for a periodic subscription, or it might modify the
      dampening period for an on-change subscription, resulting in a
      greater delay for successive updates (potentially affecting the
      responsiveness of applications that depend on the updates) or in a
      high volume of updates (to exhaust receiver resources).

   The NACM provides one means to mitigate these threats on the
   publisher side.  In order to address those threats as a subscriber,
   the subscriber could monitor the subscription configuration for any
   unexpected changes and subscribe to updates to the YANG datastore
   nodes that represent its datastore subscriptions.  As this volume of
   data is small, a paranoid subscriber could even revert to occasional
   polling to guard against a compromised subscription against
   subscription configuration updates itself.

   Some of the readable data nodes in this YANG module may be considered
   sensitive or vulnerable in some network environments.  It is thus
   important to control read access (e.g., via get, get-config, or
   notification) to these data nodes.  These are the subtrees and data
   nodes and their sensitivity/vulnerability:

   o  Subtree &quot;selection-filter&quot; under container &quot;filters&quot;: If access
      control is not properly configured, can expose system internals to
      those who should not have access to this information.



<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 52]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-53" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


   o  Subtree &quot;datastore&quot; in choice &quot;target&quot; in list &quot;subscription&quot;: If
      access control is not properly configured, can expose system
      internals to those who should not have access to this information.

   o  Choice &quot;update-trigger&quot; in list &quot;subscription&quot;: If access control
      is not properly configured, can expose system internals to those
      who should not have access to this information.

   Some of the RPC operations in this YANG module may be considered
   sensitive or vulnerable in some network environments.  It is thus
   important to control access to these operations.  These are the
   operations and their sensitivity/vulnerability:

   o  RPC &quot;resync-subscription&quot;: This RPC allows a subscriber of an
      on-change subscription to request a full push of objects in the
      subscription&#x27;s scope.  This can result in a large volume of data.
      An attacker could attempt to use this RPC to exhaust resources on
      the server to generate the data and could then attempt to
      overwhelm a receiver with the resulting large volume of data.

<span class="h2"><a class="selflink" id="section-8" href="#section-8">8</a>.  References</span>

<span class="h3"><a class="selflink" id="section-8.1" href="#section-8.1">8.1</a>.  Normative References</span>

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., &quot;Key words for use in RFCs to Indicate
              Requirement Levels&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc2119">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC3688">RFC3688</a>]  Mealling, M., &quot;The IETF XML Registry&quot;, <a href="/doc/html/bcp81">BCP 81</a>, <a href="/doc/html/rfc3688">RFC 3688</a>,
              DOI 10.17487/RFC3688, January 2004,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3688">https://www.rfc-editor.org/info/rfc3688</a>&gt;.

   [<a id="ref-RFC6020">RFC6020</a>]  Bjorklund, M., Ed., &quot;YANG - A Data Modeling Language for
              the Network Configuration Protocol (NETCONF)&quot;, <a href="/doc/html/rfc6020">RFC 6020</a>,
              DOI 10.17487/RFC6020, October 2010,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6020">https://www.rfc-editor.org/info/rfc6020</a>&gt;.

   [<a id="ref-RFC6991">RFC6991</a>]  Schoenwaelder, J., Ed., &quot;Common YANG Data Types&quot;,
              <a href="/doc/html/rfc6991">RFC 6991</a>, DOI 10.17487/RFC6991, July 2013,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6991">https://www.rfc-editor.org/info/rfc6991</a>&gt;.

   [<a id="ref-RFC7950">RFC7950</a>]  Bjorklund, M., Ed., &quot;The YANG 1.1 Data Modeling Language&quot;,
              <a href="/doc/html/rfc7950">RFC 7950</a>, DOI 10.17487/RFC7950, August 2016,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7950">https://www.rfc-editor.org/info/rfc7950</a>&gt;.






<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 53]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-54" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


   [<a id="ref-RFC8040">RFC8040</a>]  Bierman, A., Bjorklund, M., and K. Watsen, &quot;RESTCONF
              Protocol&quot;, <a href="/doc/html/rfc8040">RFC 8040</a>, DOI 10.17487/RFC8040, January 2017,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8040">https://www.rfc-editor.org/info/rfc8040</a>&gt;.

   [<a id="ref-RFC8072">RFC8072</a>]  Bierman, A., Bjorklund, M., and K. Watsen, &quot;YANG Patch
              Media Type&quot;, <a href="/doc/html/rfc8072">RFC 8072</a>, DOI 10.17487/RFC8072,
              February 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8072">https://www.rfc-editor.org/info/rfc8072</a>&gt;.

   [<a id="ref-RFC8174">RFC8174</a>]  Leiba, B., &quot;Ambiguity of Uppercase vs Lowercase in
              <a href="/doc/html/rfc2119">RFC 2119</a> Key Words&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc8174">RFC 8174</a>,
              DOI 10.17487/RFC8174, May 2017,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.

   [<a id="ref-RFC8341">RFC8341</a>]  Bierman, A. and M. Bjorklund, &quot;Network Configuration
              Access Control Model&quot;, STD 91, <a href="/doc/html/rfc8341">RFC 8341</a>,
              DOI 10.17487/RFC8341, March 2018,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8341">https://www.rfc-editor.org/info/rfc8341</a>&gt;.

   [<a id="ref-RFC8342">RFC8342</a>]  Bjorklund, M., Schoenwaelder, J., Shafer, P., Watsen, K.,
              and R. Wilton, &quot;Network Management Datastore Architecture
              (NMDA)&quot;, <a href="/doc/html/rfc8342">RFC 8342</a>, DOI 10.17487/RFC8342, March 2018,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8342">https://www.rfc-editor.org/info/rfc8342</a>&gt;.

   [<a id="ref-RFC8446">RFC8446</a>]  Rescorla, E., &quot;The Transport Layer Security (TLS) Protocol
              Version 1.3&quot;, <a href="/doc/html/rfc8446">RFC 8446</a>, DOI 10.17487/RFC8446, August 2018,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;.

   [<a id="ref-RFC8525">RFC8525</a>]  Bierman, A., Bjorklund, M., Schoenwaelder, J., Watsen, K.,
              and R. Wilton, &quot;YANG Library&quot;, <a href="/doc/html/rfc8525">RFC 8525</a>,
              DOI 10.17487/RFC8525, March 2019,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8525">https://www.rfc-editor.org/info/rfc8525</a>&gt;.

   [<a id="ref-RFC8639">RFC8639</a>]  Voit, E., Clemm, A., Gonzalez Prieto, A., Nilsen-Nygaard,
              E., and A. Tripathy, &quot;Subscription to YANG Notifications&quot;,
              <a href="/doc/html/rfc8639">RFC 8639</a>, DOI 10.17487/RFC8639, September 2019,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8639">https://www.rfc-editor.org/info/rfc8639</a>&gt;.

   [<a id="ref-W3C.REC-xml-20081126">W3C.REC-xml-20081126</a>]
              Bray, T., Paoli, J., Sperberg-McQueen, M., Maler, E., and
              F. Yergeau, &quot;Extensible Markup Language (XML) 1.0 (Fifth
              Edition)&quot;, World Wide Web Consortium Recommendation
              REC-xml-20081126, November 2008,
              &lt;<a href="https://www.w3.org/TR/2008/REC-xml-20081126">https://www.w3.org/TR/2008/REC-xml-20081126</a>&gt;.

   [<a id="ref-XPATH">XPATH</a>]    Clark, J. and S. DeRose, &quot;XML Path Language (XPath)
              Version 1.0&quot;, November 1999,
              &lt;<a href="https://www.w3.org/TR/1999/REC-xpath-19991116">https://www.w3.org/TR/1999/REC-xpath-19991116</a>&gt;.




<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 54]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-55" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


<span class="h3"><a class="selflink" id="section-8.2" href="#section-8.2">8.2</a>.  Informative References</span>

   [<a id="ref-RFC6241">RFC6241</a>]  Enns, R., Ed., Bjorklund, M., Ed., Schoenwaelder, J., Ed.,
              and A. Bierman, Ed., &quot;Network Configuration Protocol
              (NETCONF)&quot;, <a href="/doc/html/rfc6241">RFC 6241</a>, DOI 10.17487/RFC6241, June 2011,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6241">https://www.rfc-editor.org/info/rfc6241</a>&gt;.

   [<a id="ref-RFC6242">RFC6242</a>]  Wasserman, M., &quot;Using the NETCONF Protocol over Secure
              Shell (SSH)&quot;, <a href="/doc/html/rfc6242">RFC 6242</a>, DOI 10.17487/RFC6242, June 2011,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6242">https://www.rfc-editor.org/info/rfc6242</a>&gt;.

   [<a id="ref-RFC7923">RFC7923</a>]  Voit, E., Clemm, A., and A. Gonzalez Prieto, &quot;Requirements
              for Subscription to YANG Datastores&quot;, <a href="/doc/html/rfc7923">RFC 7923</a>,
              DOI 10.17487/RFC7923, June 2016,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7923">https://www.rfc-editor.org/info/rfc7923</a>&gt;.

   [<a id="ref-RFC8340">RFC8340</a>]  Bjorklund, M. and L. Berger, Ed., &quot;YANG Tree Diagrams&quot;,
              <a href="/doc/html/bcp215">BCP 215</a>, <a href="/doc/html/rfc8340">RFC 8340</a>, DOI 10.17487/RFC8340, March 2018,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8340">https://www.rfc-editor.org/info/rfc8340</a>&gt;.

   [<a id="ref-RFC8343">RFC8343</a>]  Bjorklund, M., &quot;A YANG Data Model for Interface
              Management&quot;, <a href="/doc/html/rfc8343">RFC 8343</a>, DOI 10.17487/RFC8343, March 2018,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8343">https://www.rfc-editor.org/info/rfc8343</a>&gt;.

   [<a id="ref-RFC8640">RFC8640</a>]  Voit, E., Clemm, A., Gonzalez Prieto, A., Nilsen-Nygaard,
              E., and A. Tripathy, &quot;Dynamic Subscription to YANG Events
              and Datastores over NETCONF&quot;, <a href="/doc/html/rfc8640">RFC 8640</a>,
              DOI 10.17487/RFC8640, September 2019,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8640">https://www.rfc-editor.org/info/rfc8640</a>&gt;.

   [<a id="ref-Yang-Push-Notif-Cap">Yang-Push-Notif-Cap</a>]
              Lengyel, B., Clemm, A., and B. Claise, &quot;Yang-Push
              Notification Capabilities&quot;, Work in Progress,
              <a href="/doc/html/draft-ietf-netconf-notification-capabilities-04">draft-ietf-netconf-notification-capabilities-04</a>,
              September 2019.
















<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 55]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-56" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


<span class="h2"><a class="selflink" id="appendix-A" href="#appendix-A">Appendix A</a>.  Subscription Errors</span>

<span class="h3"><a class="selflink" id="appendix-A.1" href="#appendix-A.1">A.1</a>.  RPC Failures</span>

   Rejection of an RPC for any reason is indicated via an RPC error
   response from the publisher.  Valid RPC errors returned include both
   (1) existing transport-layer RPC error codes, such as those seen with
   NETCONF in [<a href="/doc/html/rfc6241" title="&quot;Network Configuration Protocol (NETCONF)&quot;">RFC6241</a>] and (2) subscription-specific errors, such as
   those defined in the YANG data model.  As a result, how subscription
   errors are encoded in an RPC error response is transport dependent.

   References to specific identities in the ietf-subscribed-
   notifications YANG module [<a href="/doc/html/rfc8639" title="&quot;Subscription to YANG Notifications&quot;">RFC8639</a>] or the ietf-yang-push YANG module
   may be returned as part of the error responses resulting from failed
   attempts at datastore subscription.  For errors defined as part of
   the ietf-subscribed-notifications YANG module, please refer to
   [<a href="/doc/html/rfc8639" title="&quot;Subscription to YANG Notifications&quot;">RFC8639</a>].  The errors defined in this document, grouped per RPC, are
   as follows:

      establish-subscription          modify-subscription
      ---------------------------     ---------------------
       cant-exclude                    period-unsupported
       datastore-not-subscribable      update-too-big
       on-change-unsupported           sync-too-big
       on-change-sync-unsupported      unchanging-selection
       period-unsupported
       update-too-big                 resync-subscription
       sync-too-big                   ----------------------------
       unchanging-selection            no-such-subscription-resync
                                       sync-too-big

   There is one final set of transport-independent RPC error elements
   included in the YANG data model.  These are the four yang-data
   structures for failed datastore subscriptions:

   1.  yang-data &quot;establish-subscription-error-datastore&quot;: This MUST be
       returned if information identifying the reason for an RPC error
       has not been placed elsewhere in the transport portion of a
       failed &quot;establish-subscription&quot; RPC response.  This MUST be sent
       if hints are included.

   2.  yang-data &quot;modify-subscription-error-datastore&quot;: This MUST be
       returned if information identifying the reason for an RPC error
       has not been placed elsewhere in the transport portion of a
       failed &quot;modify-subscription&quot; RPC response.  This MUST be sent if
       hints are included.





<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 56]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-57" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


   3.  yang-data &quot;sn:delete-subscription-error&quot;: This MUST be returned
       if information identifying the reason for an RPC error has not
       been placed elsewhere in the transport portion of a failed
       &quot;delete-subscription&quot; or &quot;kill-subscription&quot; RPC response.

   4.  yang-data &quot;resync-subscription-error&quot;: This MUST be returned if
       information identifying the reason for an RPC error has not been
       placed elsewhere in the transport portion of a failed
       &quot;resync-subscription&quot; RPC response.

<span class="h3"><a class="selflink" id="appendix-A.2" href="#appendix-A.2">A.2</a>.  Failure Notifications</span>

   A subscription may be unexpectedly terminated or suspended
   independently of any RPC or configuration operation.  In such cases,
   indications of such a failure MUST be provided.  To accomplish this,
   a number of errors can be returned as part of the corresponding
   subscription state change notification.  For this purpose, the
   following error identities are introduced in this document, in
   addition to those that were already defined in [<a href="/doc/html/rfc8639" title="&quot;Subscription to YANG Notifications&quot;">RFC8639</a>]:

   subscription-terminated        subscription-suspended
   ---------------------------    ----------------------
    datastore-not-subscribable     period-unsupported
    unchanging-selection           update-too-big
                                   synchronization-size


























<span class="grey">Clemm &amp; Voit                 Standards Track                   [Page 57]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-58" ></span>
<span class="grey"><a href="/doc/html/rfc8641">RFC 8641</a>                        YANG-Push                 September 2019</span>


Acknowledgments

   For their valuable comments, discussions, and feedback, we wish to
   acknowledge Tim Jenkins, Martin Bjorklund, Kent Watsen, Susan Hares,
   Yang Geng, Peipei Guo, Michael Scharf, Guangying Zheng, Tom Petch,
   Henk Birkholz, Reshad Rahman, Qin Wu, Rohit Ranade, and Rob Wilton.

Contributors

   The following individuals made substantial contributions to this
   document and should be considered coauthors.  Their contributions
   include information contained in the YANG module provided in
   <a href="#section-5">Section 5</a> of this document.

   Alberto Gonzalez Prieto
   Microsoft
   Email: alberto.gonzalez@microsoft.com

   Ambika Prasad Tripathy
   Cisco Systems
   Email: ambtripa@cisco.com

   Einar Nilsen-Nygaard
   Cisco Systems
   Email: einarnn@cisco.com

   Andy Bierman
   YumaWorks
   Email: andy@yumaworks.com

   Balazs Lengyel
   Ericsson
   Email: balazs.lengyel@ericsson.com

Authors&#x27; Addresses

   Alexander Clemm
   Futurewei

   Email: ludwig@clemm.org


   Eric Voit
   Cisco Systems

   Email: evoit@cisco.com





Clemm &amp; Voit                 Standards Track                   [Page 58]
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

