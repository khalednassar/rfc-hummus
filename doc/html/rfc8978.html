<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    rfc8978
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.33.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.33.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/draft-ietf-v6ops-slaac-renum/">
  <meta name="description" content="Reaction of IPv6 Stateless Address Autoconfiguration (SLAAC) to Flash-Renumbering Events (RFC )">
  <script src="https://www.ietf.org/lib/dt/7.33.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.33.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.33.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.33.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bgorange"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc8978.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc8978.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/rfc8978.xml" title="XML source for this document">xml</a>|<a href="https://www.rfc-editor.org/rfc/rfc8978.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/rfc8978/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/rfc8978/" title="Datatracker information for this document">Tracker</a>] [<a href="/group/v6ops/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-v6ops-slaac-renum@ietf.org?subject=draft-ietf-v6ops-slaac-renum" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=draft-ietf-v6ops-slaac-renum-05.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-ietf-v6ops-slaac-renum-05.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-ietf-v6ops-slaac-renum-05.txt" title="Run an idnits check of this document">Nits</a>]

From: <a href="/doc/html/draft-ietf-v6ops-slaac-renum-05">draft-ietf-v6ops-slaac-renum-05</a>                      Informational</pre>
      </div>
    

    <div class="draftcontent">
    <pre>Internet Engineering Task Force (IETF)                           F. Gont
Request for Comments: 8978                                  SI6 Networks
Category: Informational                                          J. Žorž
ISSN: 2070-1721                                                 6connect
                                                            R. Patterson
                                                                  Sky UK
                                                              March 2021


 <span class="h1">Reaction of IPv6 Stateless Address Autoconfiguration (SLAAC) to Flash-</span>
                           <span class="h1">Renumbering Events</span>

Abstract

   In scenarios where network configuration information related to IPv6
   prefixes becomes invalid without any explicit and reliable signaling
   of that condition (such as when a Customer Edge router crashes and
   reboots without knowledge of the previously employed prefixes), hosts
   on the local network may continue using stale prefixes for an
   unacceptably long time (on the order of several days), thus resulting
   in connectivity problems.  This document describes this issue and
   discusses operational workarounds that may help to improve network
   robustness.  Additionally, it highlights areas where further work may
   be needed.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Not all documents
   approved by the IESG are candidates for any level of Internet
   Standard; see <a href="/doc/html/rfc7841#section-2">Section&nbsp;2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="https://www.rfc-editor.org/info/rfc8978">https://www.rfc-editor.org/info/rfc8978</a>.

Copyright Notice

   Copyright (c) 2021 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="/doc/html/bcp78">BCP 78</a> and the IETF Trust&#x27;s Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction
   2.  Analysis of the Problem
     2.1.  Use of Dynamic Prefixes
     2.2.  Default PIO Lifetime Values in IPv6 Stateless Address
           Autoconfiguration (SLAAC)
     2.3.  Recovering from Stale Network Configuration Information
     2.4.  Lack of Explicit Signaling about Stale Information
     2.5.  Interaction between DHCPv6-PD and SLAAC
   3.  Operational Mitigations
     3.1.  Stable Prefixes
     3.2.  SLAAC Parameter Tweaking
   4.  Future Work
   5.  IANA Considerations
   6.  Security Considerations
   7.  References
     7.1.  Normative References
     7.2.  Informative References
   Acknowledgments
   Authors&#x27; Addresses

<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>.  Introduction</span>

   IPv6 Stateless Address Autoconfiguration (SLAAC) [<a href="/doc/html/rfc4862" title="&quot;IPv6 Stateless Address Autoconfiguration&quot;">RFC4862</a>] conveys
   information about prefixes to be employed for address configuration
   via Prefix Information Options (PIOs) sent in Router Advertisement
   (RA) messages.  IPv6 largely assumes prefix stability, with network
   renumbering only taking place in a planned manner: old prefixes are
   deprecated (and eventually invalidated) via reduced prefix lifetimes
   and new prefixes are introduced (with longer lifetimes) at the same
   time.  However, there are several scenarios that may lead to the so-
   called &quot;flash-renumbering&quot; events, where a prefix employed by a
   network suddenly becomes invalid and replaced by a new prefix.  In
   some of these scenarios, the local router producing the network
   renumbering event may try to deprecate (and eventually invalidate)
   the currently employed prefix (by explicitly signaling the network
   about the renumbering event), whereas in other scenarios, it may be
   unable to do so.

   In scenarios where network configuration information related to IPv6
   prefixes becomes invalid without any explicit and reliable signaling
   of that condition, hosts on the local network may continue using
   stale prefixes for an unacceptably long period of time, thus
   resulting in connectivity problems.

   Scenarios where this problem may arise include, but are not limited
   to, the following:

   *  The most common IPv6 deployment scenario for residential or small
      office networks, where a Customer Edge (CE) router employs DHCPv6
      Prefix Delegation (DHCPv6-PD) [<a href="/doc/html/rfc8415" title="&quot;Dynamic Host Configuration Protocol for IPv6 (DHCPv6)&quot;">RFC8415</a>] to request a prefix from
      an Internet Service Provider (ISP), and a sub-prefix of the leased
      prefix is advertised on the LAN side of the CE router via
      Stateless Address Autoconfiguration (SLAAC) [<a href="/doc/html/rfc4862" title="&quot;IPv6 Stateless Address Autoconfiguration&quot;">RFC4862</a>].  In
      scenarios where the CE router crashes and reboots, the CE router
      may obtain (via DHCPv6-PD) a different prefix from the one
      previously leased and therefore advertise (via SLAAC) a new sub-
      prefix on the LAN side.  Hosts will typically configure addresses
      for the new sub-prefix but will also normally retain and may
      actively employ the addresses configured for the previously
      advertised sub-prefix, since their associated Preferred Lifetime
      and Valid Lifetime allow them to do so.

   *  A router (e.g., Customer Edge router) advertises autoconfiguration
      prefixes (corresponding to prefixes learned via DHCPv6-PD) with
      constant PIO lifetimes that are not synchronized with the
      DHCPv6-PD lease time (even though <a href="/doc/html/rfc8415#section-6.3">Section&nbsp;6.3 of [RFC8415]</a>
      requires such synchronization).  While this behavior violates the
      aforementioned requirement from [<a href="/doc/html/rfc8415" title="&quot;Dynamic Host Configuration Protocol for IPv6 (DHCPv6)&quot;">RFC8415</a>], it is not an unusual
      behavior.  For example, this is particularly true for
      implementations in which DHCPv6-PD is implemented in a different
      software module than SLAAC.

   *  A switch-port that a host is connected to is moved to another
      subnet (VLAN) as a result of manual switch-port reconfiguration or
      802.1x reauthentication.  There has been evidence that some 802.1x
      supplicants do not reset network settings after successful 802.1x
      authentication.  If a host fails 802.1x authentication for some
      reason, it may be placed in a &quot;quarantine&quot; VLAN; if successfully
      authenticated later on, the host may end up having IPv6 addresses
      from both the old (&quot;quarantine&quot;) and new VLANs.

   *  During a planned network renumbering event, a router is configured
      to send an RA including a Prefix Information Option (PIO) for the
      &quot;old&quot; prefix with the Preferred Lifetime set to zero and the Valid
      Lifetime set to a small value, as well as a PIO for the new prefix
      with default lifetimes.  However, due to unsolicited RAs being
      sent to a multicast destination address, and multicast being
      rather unreliable on busy Wi-Fi networks, the RA might not be
      received by local hosts.

   *  An automated device config management system performs periodic
      config pushes to network devices.  In these scenarios, network
      devices may simply immediately forget their previous
      configuration, rather than withdraw it gracefully.  If such a push
      results in changing the prefix configured on a particular subnet,
      hosts attached to that subnet might not get notified about the
      prefix change, and their addresses from the &quot;old&quot; prefix might not
      be deprecated (and eventually invalidated) in a timely manner.  A
      related scenario is an incorrect network renumbering event, where
      a network administrator renumbers a network by simply removing the
      &quot;old&quot; prefix from the configuration and configuring a new prefix
      instead.

   Lacking any explicit and reliable signaling to deprecate (and
   eventually invalidate) the stale prefixes, hosts may continue to
   employ the previously configured addresses, which will typically
   result in packets being filtered or blackholed either on the CE
   router or within the ISP network.

   The default values for the Preferred Lifetime and Valid Lifetime of
   PIOs specified in [<a href="/doc/html/rfc4861" title="&quot;Neighbor Discovery for IP version 6 (IPv6)&quot;">RFC4861</a>] mean that, in the aforementioned
   scenarios, the stale addresses would be retained and could be
   actively employed for new communication instances for an unacceptably
   long period of time (one month and one week, respectively).  This
   could lead to interoperability problems, instead of hosts
   transitioning to the newly advertised prefix(es) in a more timely
   manner.

   Some devices have implemented ad hoc mechanisms to address this
   problem, such as sending RAs to deprecate (and eventually invalidate)
   apparently stale prefixes when the device receives any packets
   employing a source address from a prefix not currently advertised for
   address configuration on the local network [<a href="#ref-FRITZ" title="&quot;Quiz: Weird IPv6 Traffic on the Local Network (updated with solution)&quot;">FRITZ</a>].  However, this
   may introduce other interoperability problems, particularly in
   multihomed/multi-prefix scenarios.  This is a clear indication that
   advice in this area is warranted.

   Unresponsiveness to these flash-renumbering events is caused by the
   inability of the network to deprecate (and eventually invalidate)
   stale information as well as by the inability of hosts to react to
   network configuration changes in a more timely manner.  Clearly, it
   would be desirable that these flash-renumbering events do not occur
   and that, when they do occur, hosts are explicitly and reliably
   notified of their occurrence.  However, for robustness reasons, it is
   paramount for hosts to be able to recover from stale configuration
   information even when these flash-renumbering events occur and the
   network is unable to explicitly and reliably notify hosts about such
   conditions.

   <a href="#section-2">Section 2</a> analyzes this problem in more detail.  <a href="#section-3">Section 3</a> describes
   possible operational mitigations.  <a href="#section-4">Section 4</a> describes possible
   future work to mitigate the aforementioned problem.

<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  Analysis of the Problem</span>

   As noted in <a href="#section-1">Section 1</a>, the problem discussed in this document is
   exacerbated by the default values of some protocol parameters and
   other factors.  The following sections analyze each of them in
   detail.

<span class="h3"><a class="selflink" id="section-2.1" href="#section-2.1">2.1</a>.  Use of Dynamic Prefixes</span>

   In network scenarios where dynamic prefixes are employed, renumbering
   events lead to updated network configuration information being
   propagated through the network, such that the renumbering events are
   gracefully handled.  However, if the renumbering event happens along
   with, e.g., loss of configuration state by some of the devices
   involved in the renumbering procedure (e.g., a router crashes,
   reboots, and gets leased a new prefix), this may result in a flash-
   renumbering event, where new prefixes are introduced without properly
   phasing out the old ones.

   In simple residential or small office scenarios, the problem
   discussed in this document would be avoided if DHCPv6-PD leased
   &quot;stable&quot; prefixes.  However, a recent survey [<a href="#ref-UK-NOF" title="&quot;IPv6 Deployment Survey and BCOP&quot;">UK-NOF</a>] indicates that
   37% of the responding ISPs employ dynamic IPv6 prefixes.  That is,
   dynamic IPv6 prefixes are an operational reality.

   Deployment reality aside, there are a number of possible issues
   associated with stable prefixes:

   *  Provisioning systems may be unable to deliver stable IPv6
      prefixes.

   *  While an ISP might lease stable prefixes to the home or small
      office, the Customer Edge router might in turn lease sub-prefixes
      of these prefixes to other internal network devices.  Unless the
      associated lease databases are stored on non-volatile memory,
      these internal devices might get leased dynamic sub-prefixes of
      the stable prefix leased by the ISP.  In other words, every time a
      prefix is leased, there is the potential for the resulting
      prefixes to become dynamic, even if the device leasing sub-
      prefixes has been leased a stable prefix by its upstream router.

   *  While there is a range of information that may be employed to
      correlate network activity [<a href="/doc/html/rfc7721" title="&quot;Security and Privacy Considerations for IPv6 Address Generation Mechanisms&quot;">RFC7721</a>], the use of stable prefixes
      clearly simplifies network activity correlation and may reduce the
      effectiveness of &quot;temporary addresses&quot; [<a href="/doc/html/rfc8981" title="&quot;Temporary Address Extensions for Stateless Address Autoconfiguration in IPv6&quot;">RFC8981</a>].

   *  There might be existing advice for ISPs to deliver dynamic IPv6
      prefixes *by default* (e.g., see [<a href="#ref-GERMAN-DP">GERMAN-DP</a>]) over privacy
      concerns associated with stable prefixes.

   *  There might be scalability and performance drawbacks of either a
      disaggregated distributed routing topology or a centralized
      topology, which are often required to provide stable prefixes,
      i.e., distributing more-specific routes or summarizing routes at
      centralized locations.

   For a number of reasons (such as the ones stated above), IPv6
   deployments might employ dynamic prefixes (even at the expense of the
   issues discussed in this document), and there might be scenarios in
   which the dynamics of a network are such that the network exhibits
   the behavior of dynamic prefixes.  Rather than trying to regulate how
   operators may run their networks, this document aims at improving
   network robustness in the deployed Internet.

<span class="h3"><a class="selflink" id="section-2.2" href="#section-2.2">2.2</a>.  Default PIO Lifetime Values in IPv6 Stateless Address</span>
<span class="h3">      Autoconfiguration (SLAAC)</span>

   The impact of the issue discussed in this document is a function of
   the lifetime values employed for PIOs, since these values determine
   for how long the corresponding addresses will be preferred and
   considered valid.  Thus, when the problem discussed in this document
   is experienced, the longer the PIO lifetimes, the higher the impact.

   [<a id="ref-RFC4861">RFC4861</a>] specifies the following default PIO lifetime values:

   *  Preferred Lifetime (AdvPreferredLifetime): 604800 seconds (7 days)

   *  Valid Lifetime (AdvValidLifetime): 2592000 seconds (30 days)

   Under problematic circumstances, such as when the corresponding
   network information has become stale without any explicit and
   reliable signal from the network (as described in <a href="#section-1">Section 1</a>), it
   could take hosts up to 7 days (one week) to deprecate the
   corresponding addresses and up to 30 days (one month) to eventually
   invalidate and remove any addresses configured for the stale prefix.
   This means that it will typically take hosts an unacceptably long
   period of time (on the order of several days) to recover from these
   scenarios.

<span class="h3"><a class="selflink" id="section-2.3" href="#section-2.3">2.3</a>.  Recovering from Stale Network Configuration Information</span>

   SLAAC hosts are unable to recover from stale network configuration
   information, since:

   *  In scenarios where SLAAC routers explicitly signal the renumbering
      event, hosts will typically deprecate, but not invalidate, the
      stale addresses, since item &quot;e)&quot; of <a href="/doc/html/rfc4862#section-5.5.3">Section&nbsp;5.5.3 of [RFC4862]</a>
      specifies that an unauthenticated RA may never reduce the valid
      lifetime of an address to less than two hours.  Communication with
      the new &quot;users&quot; of the stale prefix will not be possible, since
      the stale prefix will still be considered &quot;on-link&quot; by the local
      hosts.

   *  In the absence of explicit signaling from SLAAC routers, SLAAC
      hosts will typically fail to recover from stale configuration
      information in a timely manner, since hosts would need to rely on
      the last Preferred Lifetime and Valid Lifetime advertised for the
      stale prefix, for the corresponding addresses to become deprecated
      and subsequently invalidated.  Please see <a href="#section-2.2">Section 2.2</a> of this
      document for a discussion of the default PIO lifetime values.

<span class="h3"><a class="selflink" id="section-2.4" href="#section-2.4">2.4</a>.  Lack of Explicit Signaling about Stale Information</span>

   Whenever prefix information has changed, a SLAAC router should
   advertise not only the new information but also the stale information
   with appropriate lifetime values (both the Preferred Lifetime and the
   Valid Lifetime set to 0).  This would provide explicit signaling to
   SLAAC hosts to remove the stale information (including configured
   addresses and routes).  However, in certain scenarios, such as when a
   CE router crashes and reboots, the CE router may have no knowledge
   about the previously advertised prefixes and thus might be unable to
   advertise them with appropriate lifetimes (in order to deprecate and
   eventually invalidate them).

   In any case, we note that, as discussed in <a href="#section-2.3">Section 2.3</a>, PIOs with
   small Valid Lifetimes in unauthenticated RAs will not lower the Valid
   Lifetime to any value shorter than two hours (as per [<a href="/doc/html/rfc4862" title="&quot;IPv6 Stateless Address Autoconfiguration&quot;">RFC4862</a>]).
   Therefore, even if a SLAAC router tried to explicitly signal the
   network about the stale configuration information via unauthenticated
   RAs, implementations compliant with [<a href="/doc/html/rfc4862" title="&quot;IPv6 Stateless Address Autoconfiguration&quot;">RFC4862</a>] would deprecate the
   corresponding prefixes but would fail to invalidate them.

      |  NOTE:
      |
      |  Some implementations have been updated to honor small PIO
      |  lifetimes values, as proposed in [<a href="#ref-RENUM-RXN">RENUM-RXN</a>].  For example,
      |  please see [<a href="#ref-Linux-update">Linux-update</a>].

<span class="h3"><a class="selflink" id="section-2.5" href="#section-2.5">2.5</a>.  Interaction between DHCPv6-PD and SLAAC</span>

   While DHCPv6-PD is normally employed along with SLAAC, the
   interaction between the two protocols is largely unspecified.  Not
   unusually, the two protocols are implemented in two different
   software components, with the interface between the two implemented
   by means of some sort of script that feeds the SLAAC implementation
   with values learned from DHCPv6-PD.

   At times, the prefix lease time is fed as a constant value to the
   SLAAC router implementation, meaning that, eventually, the prefix
   lifetimes advertised on the LAN side will span *past* the DHCPv6-PD
   lease time.  This is clearly incorrect, since the SLAAC router
   implementation would be allowing the use of such prefixes for a
   period of time that is longer than the one they have been leased for
   via DHCPv6-PD.

<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>.  Operational Mitigations</span>

   The following subsections discuss possible operational workarounds
   for the aforementioned problems.

<span class="h3"><a class="selflink" id="section-3.1" href="#section-3.1">3.1</a>.  Stable Prefixes</span>

   As noted in <a href="#section-2.1">Section 2.1</a>, the use of stable prefixes would eliminate
   the issue in *some* of the scenarios discussed in <a href="#section-1">Section 1</a> of this
   document, such as the typical home network deployment.  However, as
   noted in <a href="#section-2.1">Section 2.1</a>, there might be reasons for which an
   administrator may want or may need to employ dynamic prefixes.

<span class="h3"><a class="selflink" id="section-3.2" href="#section-3.2">3.2</a>.  SLAAC Parameter Tweaking</span>

   An operator may wish to override some SLAAC parameters such that,
   under normal circumstances, the associated timers will be refreshed/
   reset, but in the presence of network faults (such as the one
   discussed in this document), the associated timers go off and trigger
   some fault recovering action (e.g., deprecate and eventually
   invalidate stale addresses).

   The following router configuration variables from [<a href="/doc/html/rfc4861" title="&quot;Neighbor Discovery for IP version 6 (IPv6)&quot;">RFC4861</a>]
   (corresponding to the &quot;lifetime&quot; parameters of PIOs) could be
   overridden as follows:

   *  AdvPreferredLifetime: 2700 seconds (45 minutes)

   *  AdvValidLifetime: 5400 seconds (90 minutes)

      |  NOTES:
      |
      |  The aforementioned values for AdvPreferredLifetime and
      |  AdvValidLifetime are expected to be appropriate for most
      |  networks.  In some networks, particularly those where the
      |  operator has complete control of prefix allocation and where
      |  hosts on the network may spend long periods of time sleeping
      |  (e.g., sensors with limited battery), longer values may be
      |  appropriate.
      |
      |  A CE router advertising a sub-prefix of a prefix leased via
      |  DHCPv6-PD will periodically refresh the Preferred Lifetime and
      |  the Valid Lifetime of an advertised prefix to
      |  AdvPreferredLifetime and AdvValidLifetime, respectively, as
      |  long as the resulting lifetimes of the corresponding prefixes
      |  do not extend past the DHCPv6-PD lease time [<a href="#ref-RENUM-CPE">RENUM-CPE</a>].

   RATIONALE:

   *  In the context of [<a href="/doc/html/rfc8028" title="&quot;First-Hop Router Selection by Hosts in a Multi-Prefix Network&quot;">RFC8028</a>], where it is clear that use of
      addresses configured for a given prefix is tied to using the next-
      hop router that advertised the prefix, it does not make sense for
      the Preferred Lifetime of a PIO to be larger than the Router
      Lifetime (AdvDefaultLifetime) of the corresponding Router
      Advertisement messages.  The Valid Lifetime is set to a larger
      value to cope with transient network problems.

   *  Lacking RAs that refresh information, addresses configured for
      advertised prefixes become deprecated in a more timely manner;
      therefore, Rule 3 of [<a href="/doc/html/rfc6724" title="&quot;Default Address Selection for Internet Protocol Version 6 (IPv6)&quot;">RFC6724</a>] causes other configured addresses
      (if available) to be used instead.

   *  Reducing the Valid Lifetime of PIOs helps reduce the amount of
      time a host may maintain stale information and the amount of time
      an advertising router would need to advertise stale prefixes to
      invalidate them.  Reducing the Preferred Lifetime of PIOs helps
      reduce the amount of time it takes for a host to prefer other
      working prefixes (see <a href="/doc/html/rfc4861#section-12">Section&nbsp;12 of [RFC4861]</a>).  However, we note
      that while the values suggested in this section are an improvement
      over the default values specified in [<a href="/doc/html/rfc4861" title="&quot;Neighbor Discovery for IP version 6 (IPv6)&quot;">RFC4861</a>], they represent a
      trade-off among a number of factors, including responsiveness,
      possible impact on the battery life of connected devices
      [<a href="/doc/html/rfc7772" title="&quot;Reducing Energy Consumption of Router Advertisements&quot;">RFC7772</a>], etc.  Thus, they may or may not provide sufficient
      mitigation to the problem discussed in this document.

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>.  Future Work</span>

   Improvements in Customer Edge routers [<a href="/doc/html/rfc7084" title="&quot;Basic Requirements for IPv6 Customer Edge Routers&quot;">RFC7084</a>], such that they can
   signal hosts about stale prefixes to deprecate (and eventually
   invalidate) them accordingly, can help mitigate the problem discussed
   in this document for the &quot;home network&quot; scenario.  Such work is
   currently being pursued in [<a href="#ref-RENUM-CPE">RENUM-CPE</a>].

   Improvements in the SLAAC protocol [<a href="/doc/html/rfc4862" title="&quot;IPv6 Stateless Address Autoconfiguration&quot;">RFC4862</a>] and some IPv6-related
   algorithms, such as &quot;Default Address Selection for Internet Protocol
   Version 6 (IPv6)&quot; [<a href="/doc/html/rfc6724" title="&quot;Default Address Selection for Internet Protocol Version 6 (IPv6)&quot;">RFC6724</a>], would help improve network robustness.
   Such work is currently being pursued in [<a href="#ref-RENUM-RXN">RENUM-RXN</a>].

   The aforementioned work is considered out of the scope of this
   present document, which only focuses on documenting the problem and
   discussing operational mitigations.

<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>.  IANA Considerations</span>

   This document has no IANA actions.

<span class="h2"><a class="selflink" id="section-6" href="#section-6">6</a>.  Security Considerations</span>

   This document discusses a problem that may arise in scenarios where
   flash-renumbering events occur and proposes workarounds to mitigate
   the aforementioned problem.  This document does not introduce any new
   security issues; therefore, the same security considerations as for
   [<a href="/doc/html/rfc4861" title="&quot;Neighbor Discovery for IP version 6 (IPv6)&quot;">RFC4861</a>] and [<a href="/doc/html/rfc4862" title="&quot;IPv6 Stateless Address Autoconfiguration&quot;">RFC4862</a>] apply.

<span class="h2"><a class="selflink" id="section-7" href="#section-7">7</a>.  References</span>

<span class="h3"><a class="selflink" id="section-7.1" href="#section-7.1">7.1</a>.  Normative References</span>

   [<a id="ref-RFC4861">RFC4861</a>]  Narten, T., Nordmark, E., Simpson, W., and H. Soliman,
              &quot;Neighbor Discovery for IP version 6 (IPv6)&quot;, <a href="/doc/html/rfc4861">RFC 4861</a>,
              DOI 10.17487/RFC4861, September 2007,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4861">https://www.rfc-editor.org/info/rfc4861</a>&gt;.

   [<a id="ref-RFC4862">RFC4862</a>]  Thomson, S., Narten, T., and T. Jinmei, &quot;IPv6 Stateless
              Address Autoconfiguration&quot;, <a href="/doc/html/rfc4862">RFC 4862</a>,
              DOI 10.17487/RFC4862, September 2007,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4862">https://www.rfc-editor.org/info/rfc4862</a>&gt;.

   [<a id="ref-RFC6724">RFC6724</a>]  Thaler, D., Ed., Draves, R., Matsumoto, A., and T. Chown,
              &quot;Default Address Selection for Internet Protocol Version 6
              (IPv6)&quot;, <a href="/doc/html/rfc6724">RFC 6724</a>, DOI 10.17487/RFC6724, September 2012,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6724">https://www.rfc-editor.org/info/rfc6724</a>&gt;.

   [<a id="ref-RFC8028">RFC8028</a>]  Baker, F. and B. Carpenter, &quot;First-Hop Router Selection by
              Hosts in a Multi-Prefix Network&quot;, <a href="/doc/html/rfc8028">RFC 8028</a>,
              DOI 10.17487/RFC8028, November 2016,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8028">https://www.rfc-editor.org/info/rfc8028</a>&gt;.

   [<a id="ref-RFC8415">RFC8415</a>]  Mrugalski, T., Siodelski, M., Volz, B., Yourtchenko, A.,
              Richardson, M., Jiang, S., Lemon, T., and T. Winters,
              &quot;Dynamic Host Configuration Protocol for IPv6 (DHCPv6)&quot;,
              <a href="/doc/html/rfc8415">RFC 8415</a>, DOI 10.17487/RFC8415, November 2018,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8415">https://www.rfc-editor.org/info/rfc8415</a>&gt;.

<span class="h3"><a class="selflink" id="section-7.2" href="#section-7.2">7.2</a>.  Informative References</span>

   [<a id="ref-DEFAULT-ADDR">DEFAULT-ADDR</a>]
              Linkova, J., &quot;Default Address Selection and Subnet
              Renumbering&quot;, Work in Progress, Internet-Draft, <a href="/doc/html/draft-linkova-6man-default-addr-selection-update-00">draft-</a>
              <a href="/doc/html/draft-linkova-6man-default-addr-selection-update-00">linkova-6man-default-addr-selection-update-00</a>, 30 March
              2017, &lt;<a href="https://tools.ietf.org/html/draft-linkova-6man-default-addr-selection-update-00">https://tools.ietf.org/html/draft-linkova-6man-</a>
              <a href="https://tools.ietf.org/html/draft-linkova-6man-default-addr-selection-update-00">default-addr-selection-update-00</a>&gt;.

   [<a id="ref-FRITZ">FRITZ</a>]    Gont, F., &quot;Quiz: Weird IPv6 Traffic on the Local Network
              (updated with solution)&quot;, SI6 Networks, February 2016,
              &lt;<a href="https://www.si6networks.com/2016/02/16/quiz-weird-ipv6-traffic-on-the-local-network-updated-with-solution/">https://www.si6networks.com/2016/02/16/quiz-weird-ipv6-</a>
              <a href="https://www.si6networks.com/2016/02/16/quiz-weird-ipv6-traffic-on-the-local-network-updated-with-solution/">traffic-on-the-local-network-updated-with-solution/</a>&gt;.

   [<a id="ref-GERMAN-DP">GERMAN-DP</a>]
              BFDI, &quot;Einführung von IPv6: Hinweise für Provider im
              Privatkundengeschäft und Hersteller&quot; [Introduction of
              IPv6: Notes for providers in the consumer market and
              manufacturers], Entschliessung der 84. Konferenz der
              Datenschutzbeauftragten des Bundes und der Lander
              [Resolution of the 84th Conference of the Federal and
              State Commissioners for Data Protection], November 2012,
              &lt;<a href="http://www.bfdi.bund.de/SharedDocs/Publikationen/Entschliessungssammlung/DSBundLaender/84DSK_EinfuehrungIPv6.pdf?__blob=publicationFile">http://www.bfdi.bund.de/SharedDocs/Publikationen/</a>
              <a href="http://www.bfdi.bund.de/SharedDocs/Publikationen/Entschliessungssammlung/DSBundLaender/84DSK_EinfuehrungIPv6.pdf?__blob=publicationFile">Entschliessungssammlung/DSBundLaender/84DSK_EinfuehrungIPv</a>
              <a href="http://www.bfdi.bund.de/SharedDocs/Publikationen/Entschliessungssammlung/DSBundLaender/84DSK_EinfuehrungIPv6.pdf?__blob=publicationFile">6.pdf?__blob=publicationFile</a>&gt;.

   [<a id="ref-Linux-update">Linux-update</a>]
              Gont, F., &quot;Subject: [net-next] ipv6: Honor all IPv6 PIO
              Valid Lifetime values&quot;, message to the netdev mailing
              list, 19 April 2020,
              &lt;<a href="https://patchwork.ozlabs.org/project/netdev/patch/20200419122457.GA971@archlinux-current.localdomain/">https://patchwork.ozlabs.org/project/netdev/</a>
              <a href="https://patchwork.ozlabs.org/project/netdev/patch/20200419122457.GA971@archlinux-current.localdomain/">patch/20200419122457.GA971@archlinux-</a>
              <a href="https://patchwork.ozlabs.org/project/netdev/patch/20200419122457.GA971@archlinux-current.localdomain/">current.localdomain/</a>&gt;.

   [<a id="ref-RENUM-CPE">RENUM-CPE</a>]
              Gont, F., Zorz, J., Patterson, R., and B. Volz, &quot;Improving
              the Reaction of Customer Edge Routers to IPv6 Renumbering
              Events&quot;, Work in Progress, Internet-Draft, <a href="/doc/html/draft-ietf-v6ops-cpe-slaac-renum-07">draft-ietf-</a>
              <a href="/doc/html/draft-ietf-v6ops-cpe-slaac-renum-07">v6ops-cpe-slaac-renum-07</a>, 16 February 2021,
              &lt;<a href="https://tools.ietf.org/html/draft-ietf-v6ops-cpe-slaac-renum-07">https://tools.ietf.org/html/draft-ietf-v6ops-cpe-slaac-</a>
              <a href="https://tools.ietf.org/html/draft-ietf-v6ops-cpe-slaac-renum-07">renum-07</a>&gt;.

   [<a id="ref-RENUM-RXN">RENUM-RXN</a>]
              Gont, F., Zorz, J., and R. Patterson, &quot;Improving the
              Robustness of Stateless Address Autoconfiguration (SLAAC)
              to Flash Renumbering Events&quot;, Work in Progress, Internet-
              Draft, <a href="/doc/html/draft-ietf-6man-slaac-renum-02">draft-ietf-6man-slaac-renum-02</a>, 19 January 2021,
              &lt;<a href="https://tools.ietf.org/html/draft-ietf-6man-slaac-renum-02">https://tools.ietf.org/html/draft-ietf-6man-slaac-renum-</a>
              <a href="https://tools.ietf.org/html/draft-ietf-6man-slaac-renum-02">02</a>&gt;.

   [<a id="ref-RFC7084">RFC7084</a>]  Singh, H., Beebee, W., Donley, C., and B. Stark, &quot;Basic
              Requirements for IPv6 Customer Edge Routers&quot;, <a href="/doc/html/rfc7084">RFC 7084</a>,
              DOI 10.17487/RFC7084, November 2013,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7084">https://www.rfc-editor.org/info/rfc7084</a>&gt;.

   [<a id="ref-RFC7721">RFC7721</a>]  Cooper, A., Gont, F., and D. Thaler, &quot;Security and Privacy
              Considerations for IPv6 Address Generation Mechanisms&quot;,
              <a href="/doc/html/rfc7721">RFC 7721</a>, DOI 10.17487/RFC7721, March 2016,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7721">https://www.rfc-editor.org/info/rfc7721</a>&gt;.

   [<a id="ref-RFC7772">RFC7772</a>]  Yourtchenko, A. and L. Colitti, &quot;Reducing Energy
              Consumption of Router Advertisements&quot;, <a href="/doc/html/bcp202">BCP 202</a>, <a href="/doc/html/rfc7772">RFC 7772</a>,
              DOI 10.17487/RFC7772, February 2016,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7772">https://www.rfc-editor.org/info/rfc7772</a>&gt;.

   [<a id="ref-RFC8981">RFC8981</a>]  Gont, F., Krishnan, S., Narten, T., and R. Draves,
              &quot;Temporary Address Extensions for Stateless Address
              Autoconfiguration in IPv6&quot;, <a href="/doc/html/rfc8981">RFC 8981</a>,
              DOI 10.17487/RFC8981, February 2021,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8981">https://www.rfc-editor.org/info/rfc8981</a>&gt;.

   [<a id="ref-RIPE-690">RIPE-690</a>] Žorž, J., Steffann, S., Dražumerič, P., Townsley, M.,
              Alston, A., Doering, G., Palet Martinez, J., Linkova, J.,
              Balbinot, L., Meynell, K., and L. Howard, &quot;Best Current
              Operational Practice for Operators: IPv6 prefix assignment
              for end-users - persistent vs non-persistent, and what
              size to choose&quot;, RIPE 690, October 2017,
              &lt;<a href="https://www.ripe.net/publications/docs/ripe-690">https://www.ripe.net/publications/docs/ripe-690</a>&gt;.

   [<a id="ref-UK-NOF">UK-NOF</a>]   Palet Martinez, J., &quot;IPv6 Deployment Survey and BCOP&quot;, UK
              NOF 39, January 2018,
              &lt;<a href="https://indico.uknof.org.uk/event/41/contributions/542/">https://indico.uknof.org.uk/event/41/contributions/542/</a>&gt;.

Acknowledgments

   The authors would like to thank (in alphabetical order) Brian
   Carpenter, Alissa Cooper, Roman Danyliw, Owen DeLong, Martin Duke,
   Guillermo Gont, Philip Homburg, Sheng Jiang, Benjamin Kaduk, Erik
   Kline, Murray Kucherawy, Warren Kumari, Ted Lemon, Juergen
   Schoenwaelder, Éric Vyncke, Klaas Wierenga, Robert Wilton, and Dale
   Worley for providing valuable comments on earlier draft versions of
   this document.

   The authors would like to thank (in alphabetical order) Mikael
   Abrahamsson, Luis Balbinot, Brian Carpenter, Tassos Chatzithomaoglou,
   Uesley Correa, Owen DeLong, Gert Doering, Martin Duke, Fernando
   Frediani, Steinar Haug, Nick Hilliard, Philip Homburg, Lee Howard,
   Christian Huitema, Ted Lemon, Albert Manfredi, Jordi Palet Martinez,
   Michael Richardson, Mark Smith, Tarko Tikan, and Ole Troan for
   providing valuable comments on a previous document on which this
   document is based.

   Fernando would like to thank Alejandro D&#x27;Egidio and Sander Steffann
   for a discussion of these issues.  Fernando would also like to thank
   Brian Carpenter who, over the years, has answered many questions and
   provided valuable comments that have benefited his protocol-related
   work.

   The problem discussed in this document has been previously documented
   by Jen Linkova in [<a href="#ref-DEFAULT-ADDR">DEFAULT-ADDR</a>] and also in [<a href="#ref-RIPE-690" title="&quot;Best Current Operational Practice for Operators: IPv6 prefix assignment for end-users - persistent vs non-persistent, and what size to choose&quot;">RIPE-690</a>].  <a href="#section-1">Section 1</a>
   borrows text from [<a href="#ref-DEFAULT-ADDR">DEFAULT-ADDR</a>], authored by Jen Linkova.

Authors&#x27; Addresses

   Fernando Gont
   SI6 Networks
   Segurola y Habana 4310, 7mo Piso
   Villa Devoto
   Ciudad Autónoma de Buenos Aires
   Argentina

   Email: fgont@si6networks.com
   URI:   <a href="https://www.si6networks.com">https://www.si6networks.com</a>


   Jan Žorž
   6connect, Inc.

   Email: jan@6connect.com


   Richard Patterson
   Sky UK

   Email: richard.patterson@sky.uk
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

