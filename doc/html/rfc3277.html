<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    rfc3277
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.34.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.34.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/draft-ietf-isis-transient/">
  <meta name="description" content="Intermediate System to Intermediate System (IS-IS) Transient Blackhole Avoidance (RFC )">
  <script src="https://www.ietf.org/lib/dt/7.34.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.34.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bgorange"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc3277.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc3277.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/pdfrfc/rfc3277.txt.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/rfc3277/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/rfc3277/" title="Datatracker information for this document">Tracker</a>] [<a href="/group/isis/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-isis-transient@ietf.org?subject=draft-ietf-isis-transient" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=draft-ietf-isis-transient-01.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-ietf-isis-transient-01.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-ietf-isis-transient-01.txt" title="Run an idnits check of this document">Nits</a>]

From: <a href="/doc/html/draft-ietf-isis-transient-01">draft-ietf-isis-transient-01</a>                         Informational</pre>
      </div>
    

    <div class="draftcontent">
    <pre>Network Working Group                                       D. McPherson
Request for Comments: 3277                                           TCB
Category: Informational                                       April 2002


           <span class="h1">Intermediate System to Intermediate System (IS-IS)</span>
                     <span class="h1">Transient Blackhole Avoidance</span>

Status of this Memo

   This memo provides information for the Internet community.  It does
   not specify an Internet standard of any kind.  Distribution of this
   memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2002).  All Rights Reserved.

Abstract

   This document describes a simple, interoperable mechanism that can be
   employed in Intermediate System to Intermediate System (IS-IS)
   networks in order to decrease the data loss associated with
   deterministic blackholing of packets during transient network
   conditions.  The mechanism proposed here requires no IS-IS protocol
   changes and is completely interoperable with the existing IS-IS
   specification.

<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>. Introduction</span>

   When an IS-IS router that was previously a transit router becomes
   unavailable as a result of some transient condition such as a reboot,
   other routers within the routing domain must select an alternative
   path to reach destinations which have previously transited the failed
   router.  Presumably, the newly selected router(s) comprising the path
   have been available for some time and, as a result, have complete
   forwarding information bases (FIBs) which contain a full set of
   reachability information for both internal and external (e.g., BGP)
   destination networks.

   When the previously failed router becomes available again, it is only
   seconds before the paths that had previously transited the router are
   again selected as the optimal path by the IGP.  As a result,
   forwarding tables are updated and packets are once again forwarded
   along the path.  Unfortunately, external destination reachability
   information (e.g., learned via BGP) is not yet available to the
   router, and as a result, packets bound for destinations not learned
   via the IGP are unnecessarily discarded.



<span class="grey">McPherson                    Informational                      [Page 1]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-2" ></span>
<span class="grey"><a href="/doc/html/rfc3277">RFC 3277</a>          IS-IS Transient Blackhole Avoidance         April 2002</span>


   A simple interoperable mechanism to alleviate the offshoot associated
   with this deterministic behavior is discussed below.

<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>. Discussion</span>

   This document describes a simple, interoperable mechanism that can be
   employed in IS-IS [<a href="#ref-1" title="&quot;Intermediate system to Intermediate system routing information exchange protocol for use in conjunction with the Protocol for providing the Connectionless-mode Network Service (ISO 8473),&quot;">1</a>, <a href="#ref-2" title="&quot;OSI IS-IS for IP and Dual Environment,&quot;">2</a>] networks in order to avoid transition to a
   newly available path until other associated routing protocols such as
   BGP have had sufficient time to converge.

   The benefits of such a mechanism can be realized when considering the
   following scenario depicted in Figure 1.

                                 D.1
                                  |
                              +-------+
                              | RtrD  |
                              +-------+
                              /      \
                             /        \
                        +-------+    +-------+
                        | RtrB  |    | RtrC  |
                        +-------+    +-------+
                             \        /
                              \      /
                              +-------+
                              | RtrA  |
                              +-------+
                                   |
                                  S.1

                 Figure 1: Example Network Topology

   Host S.1 is transmitting data to destination D.1 via a primary path
   of RtrA-&gt;RtrB-&gt;RtrD.  Routers A, B and C learn of reachability to
   destination D.1 via BGP from RtrD.  RtrA&#x27;s primary path to D.1 is
   selected because when calculating the path to BGP NEXT_HOP of RtrD,
   the sum of the IS-IS link metrics on the RtrA-RtrB-RtrD path is less
   than the sum of the metrics of the RtrA-RtrC-RtrD path.

   Assume RtrB becomes unavailable and as a result the RtrC path to RtrD
   is used.  Once RtrA&#x27;s FIB is updated and it begins forwarding packets
   to RtrC, everything should behave properly as RtrC has existing
   forwarding information regarding destination D.1&#x27;s availability via
   BGP NEXT_HOP RtrD.






<span class="grey">McPherson                    Informational                      [Page 2]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-3" ></span>
<span class="grey"><a href="/doc/html/rfc3277">RFC 3277</a>          IS-IS Transient Blackhole Avoidance         April 2002</span>


   Assume now that RtrB comes back online.  In only a few seconds, IS-IS
   neighbor state has been established with RtrA and RtrD and database
   synchronization has occurred.  RtrA now realizes that the best path
   to destination D.1 is via RtrB, and therefore updates it FIB
   appropriately.  RtrA begins to forward packets destined to D.1 to
   RtrB.  Though, because RtrB has yet to establish and synchronize its
   BGP neighbor relationship and routing information with RtrD, RtrB has
   no knowledge regarding reachability of destination D.1, and therefore
   discards the packets received from RtrA destined to D.1.

   If RtrB were to temporarily set its LSP Overload bit while
   synchronizing BGP tables with its neighbors, RtrA would continue to
   use the working RtrA-&gt;RtrC-&gt;RtrD path, and the LSP should only be
   used to obtain reachability to locally connected networks (rather
   than for calculating transit paths through the router, as defined in
   [<a href="#ref-1" title="&quot;Intermediate system to Intermediate system routing information exchange protocol for use in conjunction with the Protocol for providing the Connectionless-mode Network Service (ISO 8473),&quot;">1</a>]).

   However, it should be noted that when RtrB goes away, its LSP is
   still present in the IS-IS databases of all other routers in the
   routing domain.  When RtrB comes back it establishes adjacencies.  As
   soon as its neighbors have an adjacency with RtrB, they will
   advertise their new adjacency in their new LSP.  The result is that
   all the other routers will receive new LSPs from RtrA and RtrD
   containing the RtrB adjacency, even though RtrB is still completing
   its synchronization and therefore has not yet sent its new LSP.

   At this time SPF is computed and everyone will include RtrB in their
   tree since they will use the old version of RtrB LSP (the new one has
   not yet arrived).  Once RtrB has finished establishing all its
   adjacencies, it will then regenerate its LSP and flood it.  Then all
   other routers within the domain will finally compute SPF with the
   correct information.  Only at that time will the Overload bit be
   taken into account.

   As such, it is recommended that each time a router establishes an
   adjacency, it will update its LSP and flood it immediately, even
   before beginning database synchronization.  This will allow for the
   Overload bit setting to propagate immediately, and remove the
   potential for an older version of the reloaded routers LSP to be
   used.

   After synchronization of BGP tables with neighboring routers (or
   expiry of some other timer or trigger), RtrB would generate a new
   LSP, clearing the Overload bit, and RtrA could again begin using the
   optimal path via RtrB.






<span class="grey">McPherson                    Informational                      [Page 3]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-4" ></span>
<span class="grey"><a href="/doc/html/rfc3277">RFC 3277</a>          IS-IS Transient Blackhole Avoidance         April 2002</span>


   Typically, in service provider networks IBGP connections are done via
   peerings with &#x27;loopback&#x27; addresses.  As such, the newly available
   router must advertise its own loopback (or similar) IP address, as
   well as associated adjacencies, in order to make the loopbacks
   accessible to other routers within the routing domain.  It is because
   of this that simply flooding an empty LSP is not sufficient.

<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>. Deployment Considerations</span>

   Such a mechanism increases overall network availability and allows
   network operators to alleviate the deterministic blackholing behavior
   introduced in this scenario.  Similar mechanisms [<a href="#ref-3" title="&quot;OSPF Stub Router Advertisement&quot;">3</a>] have been
   defined for OSPF, though only after realizing the usefulness obtained
   from that of the IS-IS Overload bit technique.

   This mechanism has been deployed in several large IS-IS networks for
   a number of years.

   Triggers for setting the Overload bit as described are left to the
   implementer.  Some potential triggers could perhaps include &quot;N
   seconds after booting&quot;, or &quot;N number of BGP prefixes in the BGP Loc-
   RIB&quot;.

   Unlike similar mechanisms employed in [<a href="#ref-3" title="&quot;OSPF Stub Router Advertisement&quot;">3</a>], if the Overload bit is set
   in a router&#x27;s LSP, NO transit paths are calculated through the
   router.  As such, if no alternative paths are available to the
   destination network, employing such a mechanism may actually have a
   negative impact on convergence (i.e., the router maintains the only
   available path to reach downstream routers, but the Overload bit
   disallows other nodes in the network from calculating paths via the
   router, and as such, no feasible path exists to the routers).

   Finally, if all systems within an IS-IS routing domain haven&#x27;t
   implemented the Overload bit correctly, forwarding loops may occur.

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>. Potential Alternatives</span>

   Alternatively, it may be considered more appealing to employ
   something more akin to [<a href="#ref-3" title="&quot;OSPF Stub Router Advertisement&quot;">3</a>] for this purpose.  With this model, during
   transient conditions a node advertises excessively high link metrics
   to serve as an indication, to other nodes in the network that paths
   transiting the router are &quot;less desirable&quot; than existing paths.

   The advantage of a metric-based mechanism over the Overload bit
   mechanism model proposed here is that transit paths may still be
   calculated through the router.  Another advantage is that a metric-
   based mechanism does not require that all nodes in the IS-IS domain
   correctly implement the Overload bit.



<span class="grey">McPherson                    Informational                      [Page 4]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-5" ></span>
<span class="grey"><a href="/doc/html/rfc3277">RFC 3277</a>          IS-IS Transient Blackhole Avoidance         April 2002</span>


   However, as currently deployed, IS-IS provides for only 6 bits of
   space for link metric allocation, and 10 bits aggregate path metric.
   Though extensions proposed in [<a href="#ref-4" title="&quot;IS-IS extensions for Traffic Engineering&quot;">4</a>] remove this limitation, they have
   not yet been widely deployed.  As such, there&#x27;s currently little
   flexibility when using link metrics for this purpose.  Of course,
   both methods proposed in this document are backwards-compatible.

<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>. Security Considerations</span>

   The mechanisms specified in this memo introduces no new security
   issues to IS-IS.

<span class="h2"><a class="selflink" id="section-6" href="#section-6">6</a>. Acknowledgements</span>

   The author of this document makes no claim to the originality of the
   idea.  Thanks to Stefano Previdi for valuable feedback on the
   mechanism discussed in this document.

<span class="h2"><a class="selflink" id="section-7" href="#section-7">7</a>. References</span>

   [<a id="ref-1">1</a>] ISO, &quot;Intermediate system to Intermediate system routing
       information exchange protocol for use in conjunction with the
       Protocol for providing the Connectionless-mode Network Service
       (ISO 8473),&quot; ISO/IEC 10589:1992.

   [<a id="ref-2">2</a>] Callon, R., &quot;OSI IS-IS for IP and Dual Environment,&quot; <a href="/doc/html/rfc1195">RFC 1195</a>,
       December 1990.

   [<a id="ref-3">3</a>] Retana, A., Nguyen, L., White, R., Zinin, A. and D. McPherson,
       &quot;OSPF Stub Router Advertisement&quot;, <a href="/doc/html/rfc3137">RFC 3137</a>, June 2001.

   [<a id="ref-4">4</a>] Li, T. and H. Smit, &quot;IS-IS extensions for Traffic Engineering&quot;,
       Work in Progress.

<span class="h2"><a class="selflink" id="section-8" href="#section-8">8</a>. Author&#x27;s Address</span>

   Danny McPherson
   TCB
   Phone: 303.470.9257
   EMail: danny@tcb.net











<span class="grey">McPherson                    Informational                      [Page 5]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-6" ></span>
<span class="grey"><a href="/doc/html/rfc3277">RFC 3277</a>          IS-IS Transient Blackhole Avoidance         April 2002</span>


<span class="h2"><a class="selflink" id="section-9" href="#section-9">9</a>.  Full Copyright Statement</span>

   Copyright (C) The Internet Society (2002).  All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assigns.

   This document and the information contained herein is provided on an
   &quot;AS IS&quot; basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.



















McPherson                    Informational                      [Page 6]
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

