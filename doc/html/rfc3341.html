<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    rfc3341
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.34.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.34.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/draft-ietf-apex-access/">
  <meta name="description" content="The Application Exchange (APEX) Access Service (RFC )">
  <script src="https://www.ietf.org/lib/dt/7.34.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.34.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bggrey"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc3341.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc3341.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/pdfrfc/rfc3341.txt.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/rfc3341/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/rfc3341/" title="Datatracker information for this document">Tracker</a>] [<a href="/group/apex/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-apex-access@ietf.org?subject=draft-ietf-apex-access" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=draft-ietf-apex-access-08.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-ietf-apex-access-08.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-ietf-apex-access-08.txt" title="Run an idnits check of this document">Nits</a>]

From: <a href="/doc/html/draft-ietf-apex-access-08">draft-ietf-apex-access-08</a>                                 Historic</pre>
      </div>
    

    <div class="draftcontent">
    <pre>Network Working Group                                            M. Rose
Request for Comments: 3341                  Dover Beach Consulting, Inc.
Category: Standards Track                                       G. Klyne
                                                  Clearswift Corporation
                                                              D. Crocker
                                             Brandenburg InternetWorking
                                                               July 2002


             <span class="h1">The Application Exchange (APEX) Access Service</span>

Status of this Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the &quot;Internet
   Official Protocol Standards&quot; (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2002).  All Rights Reserved.

Abstract

   This memo describes the Application Exchange (APEX) access service,
   addressed as the well-known endpoint &quot;apex=access&quot;.  The access
   service is used to control use of both the APEX &quot;relaying mesh&quot; and
   other APEX services.

Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-2">2</a>
   <a href="#section-2">2</a>.  Use and Management of Access Information . . . . . . . . . . .  <a href="#page-3">3</a>
   <a href="#section-2.1">2.1</a> Querying Access Information  . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
   <a href="#section-2.2">2.2</a> Retrieval of Access Information  . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
   <a href="#section-2.3">2.3</a> Update of Access Information . . . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
   <a href="#section-3">3</a>.  Format of Access Entries . . . . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
   <a href="#section-3.1">3.1</a> Finding the Appropriate Entry: Matching Owners and Actors  . . <a href="#page-11">11</a>
   <a href="#section-3.2">3.2</a> Creating and Updating Access Entries . . . . . . . . . . . . . <a href="#page-14">14</a>
   <a href="#section-4">4</a>.  The Access Service . . . . . . . . . . . . . . . . . . . . . . <a href="#page-14">14</a>
   <a href="#section-4.1">4.1</a> Use of XML and MIME  . . . . . . . . . . . . . . . . . . . . . <a href="#page-15">15</a>
   <a href="#section-4.2">4.2</a> The Query Operation  . . . . . . . . . . . . . . . . . . . . . <a href="#page-16">16</a>
   <a href="#section-4.3">4.3</a> The Get Operation  . . . . . . . . . . . . . . . . . . . . . . <a href="#page-17">17</a>
   <a href="#section-4.4">4.4</a> The Set Operation  . . . . . . . . . . . . . . . . . . . . . . <a href="#page-18">18</a>
   <a href="#section-4.5">4.5</a> The Reply Operation  . . . . . . . . . . . . . . . . . . . . . <a href="#page-20">20</a>
   <a href="#section-5">5</a>.  Registration: The Access Service . . . . . . . . . . . . . . . <a href="#page-20">20</a>
   <a href="#section-6">6</a>.  The Access Service DTD . . . . . . . . . . . . . . . . . . . . <a href="#page-21">21</a>



<span class="grey">Rose, et. al.               Standards Track                     [Page 1]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-2" ></span>
<span class="grey"><a href="/doc/html/rfc3341">RFC 3341</a>     The Application Exchange (APEX) Access Service    July 2002</span>


   <a href="#section-7">7</a>.  Security Considerations  . . . . . . . . . . . . . . . . . . . <a href="#page-23">23</a>
       References . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-23">23</a>
       Authors&#x27; Addresses . . . . . . . . . . . . . . . . . . . . . . <a href="#page-24">24</a>
   <a href="#appendix-A">A</a>.  Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-25">25</a>
       Full Copyright Statement . . . . . . . . . . . . . . . . . . . <a href="#page-26">26</a>

<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>. Introduction</span>

   This memo describes an access service that is built upon the APEX [<a href="#ref-1">1</a>]
   &quot;relaying mesh&quot;.  The APEX access service is used to control use of
   both the relaying mesh and other APEX services.

   APEX, at its core, provides a best-effort datagram service.  Within
   an administrative domain, all relays must be able to handle messages
   for any endpoint within that domain.  APEX services are logically
   defined as endpoints but given their ubiquitous semantics they do not
   necessarily need to be associated with a single physical endpoint.
   As such, they may be provisioned co-resident with each relay within
   an administrative domain, even though they are logically provided on
   top of the relaying mesh, i.e.,

      +----------+     +----------+    +----------+    +---------+
      |   APEX   |     |   APEX   |    |   APEX   |    |         |
      |  access  |     | presence |    |  report  |    |   ...   |
      | service  |     |  service |    | service  |    |         |
      +----------+     +----------+    +----------+    +---------+
           |                |               |               |
           |                |               |               |
   +----------------------------------------------------------------+
   |                                                                |
   |                            APEX core                           |
   |                                                                |
   +----------------------------------------------------------------+

   That is, applications communicate with an APEX service by exchanging
   data with a &quot;well-known endpoint&quot; (WKE).

   APEX applications communicate with the access service by exchanging
   data with the well-known endpoint &quot;apex=access&quot; in the corresponding
   administrative domain, e.g., &quot;apex=access@example.com&quot; is the
   endpoint associated with the access service in the &quot;example.com&quot;
   administrative domain.

   Note that within a single administrative domain, the relaying mesh
   makes use of the APEX access service in order to determine if an
   originator is allowed to transmit data to a recipient (c.f., Step 5.3
   of Section 4.4.4.1 of [<a href="#ref-1">1</a>]).




<span class="grey">Rose, et. al.               Standards Track                     [Page 2]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-3" ></span>
<span class="grey"><a href="/doc/html/rfc3341">RFC 3341</a>     The Application Exchange (APEX) Access Service    July 2002</span>


<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>. Use and Management of Access Information</span>

   Access information is organized around access entries, each of which
   contains:

   o  an owner: an APEX address with which the entry is associated;

   o  an actor: an APEX address that is granted permission to perform
         some action in the context of the owner;

   o  a list of actions; and,

   o  a timestamp indicating when the service last created or modified
         the access entry.

   The access entry for a given owner controls access to a potentially
   large range of different APEX services, such as data delivery, access
   control, and presence information.  In addition, Section 4.5 of [<a href="#ref-1">1</a>]
   discusses APEX access policies that govern such activities as peer
   authentication, message relaying, and so on.

   Management of access information falls into three categories:

   o  applications may query the access service to see if one or more
      actions are allowed;

   o  applications may retrieve access information associated with an
      owner/actor combination; and,

   o  applications may modify (i.e., create, replace, or delete) access
      information associated with an owner/actor combination.

   Each is now described in turn.

<span class="h3"><a class="selflink" id="section-2.1" href="#section-2.1">2.1</a> Querying Access Information</span>

   When an application wants to determine whether one or more actions
   are allowed for an owner/actor combination, it sends a &quot;query&quot;
   element to the service, e.g.,

       +-------+                  +-------+
       |       | -- data -------&gt; |       |
       | appl. |                  | relay |
       |       | &lt;--------- ok -- |       |
       +-------+                  +-------+






<span class="grey">Rose, et. al.               Standards Track                     [Page 3]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-4" ></span>
<span class="grey"><a href="/doc/html/rfc3341">RFC 3341</a>     The Application Exchange (APEX) Access Service    July 2002</span>


     C: &lt;data content=&#x27;#Content&#x27;&gt;
            &lt;originator identity=&#x27;fred@example.com&#x27; /&gt;
            &lt;recipient identity=&#x27;apex=access@example.com&#x27; /&gt;
            &lt;data-content Name=&#x27;Content&#x27;&gt;
                &lt;query owner=&#x27;fred@example.com&#x27; transID=&#x27;1&#x27;
                       actor=&#x27;barney@example.com&#x27;
                       actions=&#x27;core:data presence:subscribe&#x27; /&gt;
            &lt;/data-content&gt;
        &lt;/data&gt;
     S: &lt;ok /&gt;

   The service immediately responds with either an allow or deny
   operation containing the same transaction-identifier, where &quot;allow&quot;
   means that all of the actions listed in the query are permitted,
   e.g.,

                                    +-------+                  +-------+
                                    |       | &lt;------- data -- |       |
                                    | relay |                  |access |
                                    |       | -- ok ---------&gt; |  svc. |
                                    +-------+                  +-------+

       C: &lt;data content=&#x27;#Content&#x27;&gt;
              &lt;originator identity=&#x27;apex=access@example.com&#x27; /&gt;
              &lt;recipient identity=&#x27;fred@example.com&#x27; /&gt;
              &lt;data-content Name=&#x27;Content&#x27;&gt;
                  &lt;allow transID=&#x27;1&#x27; /&gt;
              &lt;/data-content&gt;
          &lt;/data&gt;
       S: &lt;ok /&gt;

   or

       C: &lt;data content=&#x27;#Content&#x27;&gt;
              &lt;originator identity=&#x27;apex=access@example.com&#x27; /&gt;
              &lt;recipient  identity=&#x27;fred@example.com&#x27; /&gt;
              &lt;data-content Name=&#x27;Content&#x27;&gt;
                  &lt;deny transID=&#x27;1&#x27; /&gt;
              &lt;/data-content&gt;
          &lt;/data&gt;
       S: &lt;ok /&gt;

<span class="h3"><a class="selflink" id="section-2.2" href="#section-2.2">2.2</a> Retrieval of Access Information</span>

   When an application wants to retrieve the access entry associated
   with an owner/actor combination (typically in preparation for
   updating that access information), it sends a &quot;get&quot; element to the
   service, e.g.,



<span class="grey">Rose, et. al.               Standards Track                     [Page 4]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-5" ></span>
<span class="grey"><a href="/doc/html/rfc3341">RFC 3341</a>     The Application Exchange (APEX) Access Service    July 2002</span>


       +-------+                  +-------+
       |       | -- data -------&gt; |       |
       | appl. |                  | relay |
       |       | &lt;--------- ok -- |       |
       +-------+                  +-------+

     C: &lt;data content=&#x27;#Content&#x27;&gt;
            &lt;originator identity=&#x27;fred@example.com&#x27; /&gt;
            &lt;recipient identity=&#x27;apex=access@example.com&#x27; /&gt;
            &lt;data-content Name=&#x27;Content&#x27;&gt;
                &lt;get transID=&#x27;2&#x27;
                     owner=&#x27;fred@example.com&#x27;
                     actor=&#x27;*@example.com&#x27; /&gt;
            &lt;/data-content&gt;
        &lt;/data&gt;
     S: &lt;ok /&gt;

   The service immediately responds with a set operation containing the
   access entry and the same transaction-identifier, e.g.,

                                  +-------+                  +-------+
                                  |       | &lt;------- data -- |       |
                                  | relay |                  |access |
                                  |       | -- ok ---------&gt; |  svc. |
                                  +-------+                  +-------+

     C: &lt;data content=&#x27;#Content&#x27;&gt;
            &lt;originator identity=&#x27;apex=access@example.com&#x27; /&gt;
            &lt;recipient identity=&#x27;fred@example.com&#x27; /&gt;
            &lt;data-content Name=&#x27;Content&#x27;&gt;
                &lt;set transID=&#x27;2&#x27;&gt;
                    &lt;access owner=&#x27;fred@example.com&#x27;
                            actor=&#x27;*@example.com&#x27;
                            actions=&#x27;core:data presence:subscribe&#x27;
                            lastUpdate=&#x27;2000-05-14T13:02:00-08:00&#x27; /&gt;
                &lt;/set&gt;
            &lt;/data-content&gt;
        &lt;/data&gt;
     S: &lt;ok /&gt;

<span class="h3"><a class="selflink" id="section-2.3" href="#section-2.3">2.3</a> Update of Access Information</span>

   When an application wants to create or modify an access entry
   associated with an owner/actor combination, it sends a &quot;set&quot; element
   to the service containing the new access entry, e.g.,






<span class="grey">Rose, et. al.               Standards Track                     [Page 5]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-6" ></span>
<span class="grey"><a href="/doc/html/rfc3341">RFC 3341</a>     The Application Exchange (APEX) Access Service    July 2002</span>


       +-------+                  +-------+
       |       | -- data -------&gt; |       |
       | appl. |                  | relay |
       |       | &lt;--------- ok -- |       |
       +-------+                  +-------+

     C: &lt;data content=&#x27;#Content&#x27;&gt;
            &lt;originator identity=&#x27;wilma@example.com&#x27; /&gt;
            &lt;recipient identity=&#x27;apex=access@example.com&#x27; /&gt;
            &lt;data-content Name=&#x27;Content&#x27;&gt;
                &lt;set transID=&#x27;1&#x27;&gt;
                    &lt;access owner=&#x27;fred@example.com&#x27;
                            actor=&#x27;*@example.com&#x27;
                            actions=&#x27;core:data presence:subscribe&#x27;
                            lastUpdate=&#x27;2000-05-14T13:02:00-08:00&#x27; /&gt;
                &lt;/set&gt;
            &lt;/data-content&gt;
        &lt;/data&gt;
     S: &lt;ok /&gt;

   Note that Step 4 of <a href="#section-4.4">Section 4.4</a> requires that the &quot;lastUpdate&quot;
   attribute of an access entry be supplied in order to update that
   entry; accordingly, applications must successfully retrieve an access
   entry prior to trying to modify that entry.  (Naturally,
   administrators should ensure that applications authorized to modify
   an access entry are also authorized to retrieve that entry.)

   The service immediately responds with a reply operation containing
   the same transaction-identifier, e.g.,

                                  +-------+                  +-------+
                                  |       | &lt;------- data -- |       |
                                  | relay |                  |access |
                                  |       | -- ok ---------&gt; |  svc. |
                                  +-------+                  +-------+

     C: &lt;data content=&#x27;#Content&#x27;&gt;
            &lt;originator identity=&#x27;apex=access@example.com&#x27; /&gt;
            &lt;recipient identity=&#x27;wilma@example.com&#x27; /&gt;
            &lt;data-content Name=&#x27;Content&#x27;&gt;
                &lt;reply code=&#x27;250&#x27; transID=&#x27;1&#x27; /&gt;
            &lt;/data-content&gt;
        &lt;/data&gt;
     S: &lt;ok /&gt;

   Note that Steps 6.2 and 9.2 of <a href="#section-4.4">Section 4.4</a> require that the access
   service update the &quot;lastUpdate&quot; attribute of an access entry when it
   is created or modified.



<span class="grey">Rose, et. al.               Standards Track                     [Page 6]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-7" ></span>
<span class="grey"><a href="/doc/html/rfc3341">RFC 3341</a>     The Application Exchange (APEX) Access Service    July 2002</span>


   The service also immediately sends a set operation to the owner
   attribute associated with the access entry, e.g.,

                                  +-------+                  +-------+
                                  |       | &lt;------- data -- |       |
                                  | relay |                  |access |
                                  |       | -- ok ---------&gt; |  svc. |
                                  +-------+                  +-------+

     C: &lt;data content=&#x27;#Content&#x27;&gt;
            &lt;originator identity=&#x27;apex=access@example.com&#x27; /&gt;
            &lt;recipient identity=&#x27;fred@example.com&#x27; /&gt;
            &lt;data-content Name=&#x27;Content&#x27;&gt;
                &lt;set transID=&#x27;1&#x27;&gt;
                    &lt;access owner=&#x27;fred@example.com&#x27;
                            actor=&#x27;*@example.com&#x27;
                            actions=&#x27;core:data presence:subscribe&#x27;
                            lastUpdate=&#x27;2000-05-14T23:02:00-08:00&#x27; /&gt;
                &lt;/set&gt;
            &lt;/data-content&gt;
        &lt;/data&gt;
     S: &lt;ok /&gt;

   When an application wants to delete the access entry associated with
   an owner/actor combination, it sends a &quot;set&quot; element to the service
   omitting the permitted actions, e.g.,

       +-------+                  +-------+
       |       | -- data -------&gt; |       |
       | appl. |                  | relay |
       |       | &lt;--------- ok -- |       |
       +-------+                  +-------+

     C: &lt;data content=&#x27;#Content&#x27;&gt;
            &lt;originator identity=&#x27;wilma@example.com&#x27; /&gt;
            &lt;recipient identity=&#x27;apex=access@example.com&#x27; /&gt;
            &lt;data-content Name=&#x27;Content&#x27;&gt;
                &lt;set transID=&#x27;2&#x27;&gt;
                    &lt;access owner=&#x27;fred@example.com&#x27;
                            actor=&#x27;*@example.com&#x27;
                            lastUpdate=&#x27;2000-05-14T13:02:00-08:00&#x27; /&gt;
                &lt;/set&gt;
            &lt;/data-content&gt;
        &lt;/data&gt;
     S: &lt;ok /&gt;






<span class="grey">Rose, et. al.               Standards Track                     [Page 7]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-8" ></span>
<span class="grey"><a href="/doc/html/rfc3341">RFC 3341</a>     The Application Exchange (APEX) Access Service    July 2002</span>


   The service immediately responds with a reply operation containing
   the same transaction-identifier, e.g.,

                                  +-------+                  +-------+
                                  |       | &lt;------- data -- |       |
                                  | relay |                  |access |
                                  |       | -- ok ---------&gt; |  svc. |
                                  +-------+                  +-------+

     C: &lt;data content=&#x27;#Content&#x27;&gt;
            &lt;originator identity=&#x27;apex=access@example.com&#x27; /&gt;
            &lt;recipient identity=&#x27;wilma@example.com&#x27; /&gt;
            &lt;data-content Name=&#x27;Content&#x27;&gt;
                &lt;reply code=&#x27;250&#x27; transID=&#x27;2&#x27; /&gt;
            &lt;/data-content&gt;
        &lt;/data&gt;
     S: &lt;ok /&gt;

   The service also immediately sends a set operation to the owner
   attribute associated with the access entry, e.g.,

                                  +-------+                  +-------+
                                  |       | &lt;------- data -- |       |
                                  | relay |                  |access |
                                  |       | -- ok ---------&gt; |  svc. |
                                  +-------+                  +-------+

     C: &lt;data content=&#x27;#Content&#x27;&gt;
            &lt;originator identity=&#x27;apex=access@example.com&#x27; /&gt;
            &lt;recipient identity=&#x27;fred@example.com&#x27; /&gt;
            &lt;data-content Name=&#x27;Content&#x27;&gt;
                &lt;set transID=&#x27;2&#x27;&gt;
                    &lt;access owner=&#x27;fred@example.com&#x27;
                            actor=&#x27;*@example.com&#x27;
                            lastUpdate=&#x27;2000-05-14T13:02:00-08:00&#x27; /&gt;
                &lt;/set&gt;
            &lt;/data-content&gt;
        &lt;/data&gt;
     S: &lt;ok /&gt;

   Because there are no actions associated with this access entry, the
   owner knows that the entry has been deleted.

   Note that because access control supported limited wildcarding of
   actors, deleting an access entry for a particular owner/actor
   combination, may modify, rather than remove, permission.  Because of
   this, a special action, &quot;all:none&quot;, is used.




<span class="grey">Rose, et. al.               Standards Track                     [Page 8]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-9" ></span>
<span class="grey"><a href="/doc/html/rfc3341">RFC 3341</a>     The Application Exchange (APEX) Access Service    July 2002</span>


   For example, consider these two access entries:

       &lt;access owner=&#x27;fred@example.com&#x27;
               actor=&#x27;barney@example.com&#x27;
               actions=&#x27;core:data presence:subscribe presence:watch&#x27;
               lastUpdate=&#x27;2000-05-14T13:20:00-08:00&#x27; /&gt;

       &lt;access owner=&#x27;fred@example.com&#x27;
               actor=&#x27;*@example.com&#x27;
               actions=&#x27;core:data&#x27;
               lastUpdate=&#x27;2000-05-14T13:20:00-08:00&#x27; /&gt;

   Deleting the first access entry will not remove all permissions for
   for the actor &quot;barney@example.com&quot;.

   Instead, the first access entry should be modified thusly:

       &lt;access owner=&#x27;fred@example.com&#x27;
               actor=&#x27;barney@example.com&#x27;
               actions=&#x27;all:none&#x27;
               lastUpdate=&#x27;2000-05-14T13:20:00-08:00&#x27; /&gt;

<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>. Format of Access Entries</span>

   Each administrative domain is responsible for maintaining one or more
   &quot;access entries&quot; for each of its endpoints and associated
   subaddresses (regardless of whether those addresses are currently
   attached to the relaying mesh).

   A separate access entry is required for each actor or group of actors
   for whom access permission is specified.  <a href="#section-6">Section 6</a> defines the
   syntax for access entries.  Each access entry has an &quot;owner&quot;
   attribute, an &quot;actor&quot; attribute, an &quot;actions&quot; attribute, a
   &quot;lastUpdate&quot; attribute, and no content:

   o  the &quot;owner&quot; attribute specifies the address (endpoint or
      subaddress) associated with the access entry;

   o  the &quot;actor&quot; attribute specifies an entity or group of entities for
      whom access permissions are specified, as described below;

   o  the &quot;actions&quot; attribute specifies the permissions granted to the
      actor in the context of the owner; and,

   o  the &quot;lastUpdate&quot; attribute specifies the date and time that the
      service last created or modified the access entry.





<span class="grey">Rose, et. al.               Standards Track                     [Page 9]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-10" ></span>
<span class="grey"><a href="/doc/html/rfc3341">RFC 3341</a>     The Application Exchange (APEX) Access Service    July 2002</span>


   An action is specified as a service/operation pair, e.g., the action
   &quot;presence:publish&quot; refers to the &quot;publish&quot; operation of the
   &quot;presence&quot; service.  Two service values are reserved:

   o  &quot;all&quot; is used to refer to all services, e.g., &quot;all:data&quot;; and,

   o  &quot;core&quot; is used to refer to the service implemented by the relaying
      mesh, e.g., the &quot;core:data&quot; permission is consulted by the
      relaying mesh (c.f., Step 5.3 of Section 4.4.4.1 of [<a href="#ref-1">1</a>]).

   Further, two operation values are reserved:

   o  &quot;all&quot; is used to refer to all operations, e.g., &quot;presence:all&quot;;
      and,

   o  &quot;none&quot; is used to refer to no operations whatsoever, e.g.,
      &quot;all:none&quot;.

      An actor is an APEX address and is specified using the &quot;entity&quot;
      syntax specified in Section 2.2 of [<a href="#ref-1">1</a>].  However, both the &quot;local&quot;
      and &quot;domain&quot; parts may contain limited wildcarding:

      o  The &quot;local&quot; part is either:

      *  a literal string (e.g., &quot;fred&quot;);

      *  a subaddress wildcard (e.g., &quot;fred/*&quot; or &quot;apex=pubsub/*&quot;); or,

      *  the value &quot;apex=*&quot;, specifying all APEX services;

      *  the value &quot;*&quot;, specifying any address other than an APEX
         service.

   o  The &quot;domain&quot; part is either:

      *  a FQDN (e.g., &quot;example.com&quot;);

      *  a domain wildcard (e.g., &quot;*.example.com&quot;); or,

      *  the value &quot;*&quot;, specifying all administrative domains.

      Note that in the case of a domain wildcard, the wildcard itself
      matches zero or more subdomains, e.g., &quot;*.example.com&quot; matches
      &quot;example.com&quot;, &quot;foo.example.com&quot;, &quot;bar.foo.example.com&quot;, and so
      on.)






<span class="grey">Rose, et. al.               Standards Track                    [Page 10]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-11" ></span>
<span class="grey"><a href="/doc/html/rfc3341">RFC 3341</a>     The Application Exchange (APEX) Access Service    July 2002</span>


   The following default entries are provided for each owner, but are
   overridden by an explicitly supplied entry with the same actor value:

      actor=&#x27;local@domain&#x27;  actions=&#x27;all:all&#x27;
      actor=&#x27;apex=*@domain&#x27; actions=&#x27;all:all&#x27;
      actor=&#x27;apex=*@*&#x27;      actions=&#x27;core:data&#x27;
      actor=&#x27;*@*&#x27;           actions=&#x27;all:none&#x27;

   where &quot;local@domain&quot; specifies the owner associated with the access
   entry.

   For example, the explicit entry

      actor=&#x27;*@*&#x27;           actions=&#x27;core:data&#x27;

   allows endpoints from any domain to use the relaying mesh to send
   data to the owner, but does not override the default entry for
   &quot;apex=*@domain&quot;, which allows all APEX services in the owner&#x27;s domain
   access to all actions.

   APEX endpoint names can legitimately contain the character &#x27;*&#x27;, but
   access entries use &#x27;*&#x27; to indicate wildcarding.  Accordingly, the
   two-character sequence &#x27;\*&#x27; is used to avoid ambiguity in the &quot;actor&quot;
   attribute.  Similarly, to explicitly specify an endpoint name
   containing &#x27;\&#x27; in the &quot;actor&quot; attribute, the two-character sequence
   &#x27;\\&#x27; is used.

   Note that this convention is used only for the &quot;actor&quot; attribute of
   the &quot;get&quot; operation and of the &quot;access&quot; entry that appears in the
   &quot;set&quot; operation; however, this convention is not used in the &quot;query&quot;
   operation, as this operation does not allow wildcarding.

   For example, to specify the endpoint named as &quot;a\b*c@example.com&quot; in
   the &quot;get&quot; operation or in an &quot;access&quot; entry, the string
   &quot;a\\b\*c@example.com&quot; is used; but in the &quot;query&quot; operation, the
   string &quot;a\b*c@example.com&quot; is used.  (Of course, as name allocation
   is a local matter, these complications can be avoided by the simple
   expedient of not using endpoint names containing &#x27;*&#x27; or &#x27;\&#x27;.)

<span class="h3"><a class="selflink" id="section-3.1" href="#section-3.1">3.1</a> Finding the Appropriate Entry: Matching Owners and Actors</span>

   The use of actor wildcarding makes it possible for several access
   entries to apply for a given owner/actor combination.  When
   determining which access entry to use when responding to the query
   operation, the algorithm is:

   o  Consider only those access entries that are associated with the
      given owner.



<span class="grey">Rose, et. al.               Standards Track                    [Page 11]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-12" ></span>
<span class="grey"><a href="/doc/html/rfc3341">RFC 3341</a>     The Application Exchange (APEX) Access Service    July 2002</span>


   o  Consider only those access entries in which the actor value
      matches the actor address in the query.  If the wildcard character
      (&#x27;*&#x27;) is present, then it a match is possible only if each
      wildcard character can be replaced with a non-empty character
      sequence (one or more characters) to obtain a value identical to
      the address in the query.

   o  Order those remaining access entries:

      *  Use the exactness of the match with the domain part of the
         actor value as the primary key; and,

      *  Use the exactness of the match with the local part of the actor
         value as the secondary key.

   o  When matching with the domain part, an exact match is the best
      match; otherwise, the shorter the wildcard match, the higher the
      priority.

      For example, if the actor&#x27;s domain is &quot;bar.foo.example.com&quot;, a
      match against an entry of &quot;*.foo.example.com&quot; is better than a
      match against an entry of &quot;*.example.com&quot;.

   o  When matching with the local part, an exact match is the best
      match; otherwise, the shorter the wildcard match, the higher the
      priority.  This is true regardless of whether the wildcarding is
      for subaddress or service.  (Note that a local part with a
      wildcard subaddress does not have a non-empty match with the same
      local part without a subaddress.)

   For example, consider these access entries:

      &lt;access owner=&#x27;fred@example.com&#x27;
              actor=&#x27;wilma@example.com&#x27;
              actions=&#x27;all:all&#x27;
              lastUpdate=&#x27;2000-05-14T13:20:00-08:00&#x27; /&gt;
      &lt;access owner=&#x27;fred@example.com&#x27;
              actor=&#x27;mr.slate@example.com&#x27;
              actions=&#x27;core:data&#x27;
              lastUpdate=&#x27;2000-05-14T13:20:00-08:00&#x27; /&gt;
      &lt;access owner=&#x27;fred/appl=wb@example.com&#x27;
              actor=&#x27;barney/appl=wb@example.com&#x27;
              actions=&#x27;core:data&#x27;
              lastUpdate=&#x27;2000-05-14T13:20:00-08:00&#x27; /&gt;
      &lt;access owner=&#x27;fred@example.com&#x27;
              actor=&#x27;*@example.com&#x27;
              actions=&#x27;core:data presence:subscribe presence:watch&#x27;
              lastUpdate=&#x27;2000-05-14T13:20:00-08:00&#x27; /&gt;



<span class="grey">Rose, et. al.               Standards Track                    [Page 12]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-13" ></span>
<span class="grey"><a href="/doc/html/rfc3341">RFC 3341</a>     The Application Exchange (APEX) Access Service    July 2002</span>


      &lt;access owner=&#x27;fred@example.com&#x27;
              actor=&#x27;*@*&#x27;
              actions=&#x27;core:data&#x27;
              lastUpdate=&#x27;2000-05-14T13:20:00-08:00&#x27; /&gt;

   Briefly:

   o  For addresses within the &quot;example.com&quot; administrative domain:

   *  &quot;fred&quot;, &quot;wilma&quot;, and all APEX services within the &quot;example.com&quot;
      administrative domain are allowed access to all operations for
      &quot;fred@example.com&quot;;

   *  &quot;mr.slate&quot; is allowed access only to send data through the
      relaying mesh to &quot;fred@example.com&quot;;

   *  &quot;barney/appl=wb&quot; is allowed access only to send data to &quot;fred/
      appl=wb&quot;, a subaddress of &quot;fred@example.com&quot;; and,

   *  any other address within the &quot;example.com&quot; administrative
      domain is allowed access to send data and invoke the
      &quot;subscribe&quot; and &quot;watch&quot; operations of the APEX presence service
      with respect to &quot;fred@example.com&quot;.

   o  For any address outside the &quot;example.com&quot; administrative domain,
      the address is allowed access to send data, regardless of whether
      it is an APEX service.
























<span class="grey">Rose, et. al.               Standards Track                    [Page 13]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-14" ></span>
<span class="grey"><a href="/doc/html/rfc3341">RFC 3341</a>     The Application Exchange (APEX) Access Service    July 2002</span>


   Note that although the four default entries are always available, the
   explicit entry for actor &quot;*@*&quot; overrides the corresponding default
   entry.

<span class="h3"><a class="selflink" id="section-3.2" href="#section-3.2">3.2</a> Creating and Updating Access Entries</span>

   The get and set operations are provided as a basic mechanism for
   creating and updating access rules, for which no special wildcard
   processing is performed.

   The actor value for an access entry may contain limited wildcard
   characters which have special significance only when performing a
   query operation (cf., <a href="#section-3.1">Section 3.1</a>).  For the purposes of retrieving
   and updating entries, actor values are treated simply as literal
   names.

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>. The Access Service</span>

   <a href="#section-5">Section 5</a> contains the APEX service registration for the access
   service:

   o  Within an administrative domain, the service is addressed using
      the well-known endpoint of &quot;apex=access&quot;.

   o  <a href="#section-6">Section 6</a> defines the syntax of the operations exchanged with the
      service.

   o  A consumer of the service initiates communications by sending data
      containing a query, get, or set operation.

   o  The service replies to these operations.

   o  When an access entry is changed, the service sends a notification
      to the owner associated with the changed entry.

   An implementation of the service must maintain information about
   access entries in persistent storage.

   Consult Section 6.1.1 of [<a href="#ref-1">1</a>] for a discussion on the properties of
   long-lived transaction-identifiers.











<span class="grey">Rose, et. al.               Standards Track                    [Page 14]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-15" ></span>
<span class="grey"><a href="/doc/html/rfc3341">RFC 3341</a>     The Application Exchange (APEX) Access Service    July 2002</span>


<span class="h3"><a class="selflink" id="section-4.1" href="#section-4.1">4.1</a> Use of XML and MIME</span>

   Section 4.1 of [<a href="#ref-1">1</a>] describes how arbitrary MIME content is exchanged
   as a BEEP [<a href="#ref-2">2</a>] payload.  For example, to transmit:

       &lt;data content=&#x27;...&#x27;&gt;
           &lt;originator identity=&#x27;fred@example.com&#x27; /&gt;
           &lt;recipient identity=&#x27;apex=access@example.com&#x27; /&gt;
       &lt;/data&gt;

    where &quot;...&quot; refers to:

       &lt;query owner=&#x27;fred@example.com&#x27; transID=&#x27;1&#x27;
              actor=&#x27;barney@example.com&#x27;
              actions=&#x27;core:data presence:subscribe&#x27; /&gt;

    then the corresponding BEEP message might look like this:

       C: MSG 1 2 . 42 1234
       C: Content-Type: multipart/related; boundary=&quot;boundary&quot;;
       C:               start=&quot;&lt;1@example.com&gt;&quot;;
       C:               type=&quot;application/beep+xml&quot;
       C:
       C: --boundary
       C: Content-Type: application/beep+xml
       C: Content-ID: &lt;1@example.com&gt;
       C:
       C: &lt;data content=&#x27;cid:2@example.com&#x27;&gt;
       C:     &lt;originator identity=&#x27;fred@example.com&#x27; /&gt;
       C:     &lt;recipient identity=&#x27;apex=access@example.com&#x27; /&gt;
       C: &lt;/data&gt;
       C: --boundary
       C: Content-Type: application/beep+xml
       C: Content-ID: &lt;2@example.com&gt;
       C:
       C: &lt;query owner=&#x27;fred@example.com&#x27; transID=&#x27;1&#x27;
       C:        actor=&#x27;barney@example.com&#x27;
       C:        actions=&#x27;core:data presence:subscribe&#x27; /&gt;
       C: --boundary--
       C: END











<span class="grey">Rose, et. al.               Standards Track                    [Page 15]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-16" ></span>
<span class="grey"><a href="/doc/html/rfc3341">RFC 3341</a>     The Application Exchange (APEX) Access Service    July 2002</span>


    or this:

       C: MSG 1 1 . 42 267
       C: Content-Type: application/beep+xml
       C:
       C: &lt;data content=&#x27;#Content&#x27;&gt;
       C:     &lt;originator identity=&#x27;fred@example.com&#x27; /&gt;
       C:     &lt;recipient identity=&#x27;apex=access@example.com&#x27; /&gt;
       C:     &lt;data-content Name=&#x27;Content&#x27;&gt;
       C:         &lt;query owner=&#x27;fred@example.com&#x27; transID=&#x27;1&#x27;
       C:                actor=&#x27;barney@example.com&#x27;
       C:                actions=&#x27;core:data presence:subscribe&#x27; /&gt;
       C:     &lt;/data-content&gt;
       C: &lt;/data&gt;
       C: END

<span class="h3"><a class="selflink" id="section-4.2" href="#section-4.2">4.2</a> The Query Operation</span>

   When an application wants to see if a particular operation is
   allowed, it sends a &quot;query&quot; element to the service.

   The &quot;query&quot; element has an &quot;owner&quot; attribute, an &quot;actor&quot; attribute,
   an &quot;actions&quot; attribute, a &quot;transID&quot; attribute, and no content:

   o  the &quot;owner&quot; attribute specifies the address associated with the
      access entry;

   o  the &quot;actor&quot; attribute specifies the address (without wildcarding)
      for which access permissions are queried;

   o  the &quot;actions&quot; attribute specifies one or more actions for which
      permission is queried; and,

   o  the &quot;transID&quot; attribute specifies the transaction-identifier
      associated with this operation.

   When the service receives a &quot;query&quot; element, we refer to the &quot;owner&quot;
   attribute as the &quot;subject&quot;.  The service performs these steps:

   1. If the subject is outside this administrative domain, a &quot;reply&quot;
      element having code 553 is sent to the originator.

   2. If the subject does not refer to a valid address, a &quot;reply&quot;
      element having code 550 is sent to the originator.

   3. If the subject&#x27;s access entry matching the originator does not
      contain an &quot;access:query&quot; token, a &quot;reply&quot; element having code 537
      is sent to the originator.



<span class="grey">Rose, et. al.               Standards Track                    [Page 16]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-17" ></span>
<span class="grey"><a href="/doc/html/rfc3341">RFC 3341</a>     The Application Exchange (APEX) Access Service    July 2002</span>


   4. The subject&#x27;s access entry matching the actor attribute of the
      query element is selected (cf., <a href="#section-3.1">Section 3.1</a>).

   5. If all of the permissions in the &quot;actions&quot; attribute of the query
      element are contained in the selected access entry, then an
      &quot;allow&quot; element is sent to the originator.

   6. Otherwise, a &quot;deny&quot; element is sent to the originator.

   Regardless of whether an &quot;allow&quot;, &quot;deny&quot;, or &quot;reply&quot; element is sent
   to the originator, the &quot;transID&quot; attribute is identical to the value
   found in the &quot;query&quot; element sent by the originator.

<span class="h3"><a class="selflink" id="section-4.3" href="#section-4.3">4.3</a> The Get Operation</span>

   Prior to creating or updating an access entry for some owner/actor
   combination, an application will usually need to retrieve any
   existing access entry.  It does so by sending a &quot;get&quot; element to the
   service.  In particular, a successful response returns a &quot;lastUpdate&quot;
   value that is necessary when sending a subsequent &quot;set&quot; element.

   The &quot;get&quot; element has an &quot;owner&quot; attribute, an &quot;actor&quot; attribute, a
   &quot;transID&quot; attribute, and no content:

   o  the &quot;owner&quot; attribute specifies the address associated with the
      access entry;

   o  the &quot;actor&quot; attribute specifies the address (with possible
      wildcarding) for which access permissions are retrieved; and,

   o  the &quot;transID&quot; attribute specifies the transaction-identifier
      associated with this operation.

   When the service receives a &quot;get&quot; element, we refer to the &quot;owner&quot;
   attribute as the &quot;subject&quot;.  The service performs these steps:

   1. If the subject is outside this administrative domain, a &quot;reply&quot;
      element having code 553 is sent to the originator.

   2. If the subject does not refer to a valid address, a &quot;reply&quot;
      element having code 550 is sent to the originator.

   3. If the subject&#x27;s access entry matching the originator does not
      contain an &quot;access:get&quot; token, a &quot;reply&quot; element having code 537
      is sent to the originator.

   4. The subject&#x27;s access entry whose &quot;actor&quot; attribute identically
      matches the &quot;actor&quot; attribute of the &quot;get&quot; element is selected.



<span class="grey">Rose, et. al.               Standards Track                    [Page 17]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-18" ></span>
<span class="grey"><a href="/doc/html/rfc3341">RFC 3341</a>     The Application Exchange (APEX) Access Service    July 2002</span>


   5. If no such entry exists, a &quot;reply&quot; element having code 551 is sent
      to the originator.

   6. Otherwise, a &quot;set&quot; element corresponding to the selected access
      entry is sent to the originator.

   Regardless of whether a &quot;set&quot; or &quot;reply&quot; element is sent to the
   originator, the &quot;transID&quot; attribute is identical to the value found
   in the &quot;get&quot; element sent by the originator.

<span class="h3"><a class="selflink" id="section-4.4" href="#section-4.4">4.4</a> The Set Operation</span>

   When an application wants to modify (i.e., create, replace, or
   delete) the access entry associated with an owner/actor combination,
   it sends a &quot;set&quot; element to the service.

   The &quot;set&quot; element has a &quot;transID&quot; attribute, and contains an &quot;access&quot;
   element:

   o  the &quot;transID&quot; attribute specifies the transaction-identifier
      associated with this operation; and,

   o  the &quot;access&quot; element contains the access entry to be created,
      replaced, or deleted.

   The &quot;access&quot; element has an &quot;owner&quot; attribute, an &quot;actor&quot; attribute,
   an optional &quot;actions&quot; attribute, an optional &quot;lastUpdate&quot; attribute,
   and no content:

   o  the &quot;owner&quot; attribute specifies the address associated with the
      access entry;

   o  the &quot;actor&quot; attribute specifies the address (with possible
      wildcarding) for which access permissions are specified;

   o  the &quot;actions&quot; attribute (present only to add or replace an entry)
      specifies one or more actions for which permission is to be
      determined; and,

   o  the &quot;lastUpdate&quot; attribute (present only to replace or delete an
      entry) specifies the current timestamp of the access entry that is
      to be replaced.









<span class="grey">Rose, et. al.               Standards Track                    [Page 18]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-19" ></span>
<span class="grey"><a href="/doc/html/rfc3341">RFC 3341</a>     The Application Exchange (APEX) Access Service    July 2002</span>


   When the service receives a &quot;set&quot; element, we refer to the &quot;owner&quot;
   attribute of the access element as the &quot;subject&quot;.  The service
   performs these steps:

   1. If the subject is outside this administrative domain, a &quot;reply&quot;
      element having code 553 is sent to the originator.

   2. If the subject does not refer to a valid address, a &quot;reply&quot;
      element having code 550 is sent to the originator.

   3. If the subject&#x27;s access entry matching the originator does not
      contain an &quot;access:set&quot; token, a &quot;reply&quot; element having code 537
      is sent to the originator.

   4. The subject&#x27;s access entry whose &quot;actor&quot; attribute identically
      matches the &quot;actor&quot; attribute of the &quot;set&quot; element is selected.

   5. If no such entry exists and the &quot;lastUpdate&quot; attribute is present
      in the supplied &quot;set&quot; element, a &quot;reply&quot; element having code 555
      is sent to the originator.

   6. If no such entry exists and the &quot;lastUpdate&quot; attribute is absent
      in the supplied &quot;set&quot; element, then:

      1. The access entry for the owner/actor combination is created
         from the supplied &quot;access&quot; element.

      2. The &quot;lastUpdate&quot; attribute of that access entry set to the
         service&#x27;s notion of the current date and time.

      3. A &quot;reply&quot; element having code 250 is sent to the originator.

      4. A &quot;set&quot; element corresponding to the newly-created access entry
         is sent to the subject&#x27;s address.

   7. If the selected entry exists, but its &quot;lastUpdate&quot; attribute is
      not semantically identical to the &quot;lastUpdate&quot; attribute of the
      supplied &quot;access&quot; element, a &quot;reply&quot; element having code 555 is
      sent to the originator.

   8. If &quot;actions&quot; attribute of the supplied &quot;access&quot; element is not
      present, then:

      1. The selected entry is deleted.

      2. A &quot;reply&quot; element having code 250 is sent to the originator.





<span class="grey">Rose, et. al.               Standards Track                    [Page 19]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-20" ></span>
<span class="grey"><a href="/doc/html/rfc3341">RFC 3341</a>     The Application Exchange (APEX) Access Service    July 2002</span>


      3. A &quot;set&quot; element corresponding to the owner/actor combination,
         but lacking an &quot;actions&quot; attribute is sent to the subject&#x27;s
         address.

   9. Otherwise:

      1. The access entry for the owner/actor combination is updated
         from the supplied &quot;access&quot; element.

      2. The &quot;lastUpdate&quot; attribute of the updated access entry is set
         to the service&#x27;s notion of the current date and time (which
         should be different from the &quot;lastUpdate&quot; value associated with
         any replaced entry).

      3. A &quot;reply&quot; element having code 250 is sent to the originator.

      4. A &quot;set&quot; element corresponding to the newly-updated access entry
         is sent to the subject&#x27;s address.

   When sending the &quot;reply&quot; element, the &quot;transID&quot; attribute is
   identical to the value found in the &quot;set&quot; element sent by the
   originator.

<span class="h3"><a class="selflink" id="section-4.5" href="#section-4.5">4.5</a> The Reply Operation</span>

   While processing operations, the service may respond with a &quot;reply&quot;
   element.  Consult Sections <a href="#section-10.2">10.2</a> and <a href="#section-6.1.2">6.1.2</a> of [<a href="#ref-1">1</a>], respectively, for
   the definition and an exposition of the syntax of the reply element.

<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>. Registration: The Access Service</span>

   Well-Known Endpoint: apex=access

   Syntax of Messages Exchanged: c.f., <a href="#section-6">Section 6</a>

   Sequence of Messages Exchanged: c.f., <a href="#section-4">Section 4</a>

   Access Control Tokens: access:query, access:get, access:set

   Contact Information: c.f., the &quot;Authors&#x27; Addresses&quot; section of this
      memo










<span class="grey">Rose, et. al.               Standards Track                    [Page 20]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-21" ></span>
<span class="grey"><a href="/doc/html/rfc3341">RFC 3341</a>     The Application Exchange (APEX) Access Service    July 2002</span>


<span class="h2"><a class="selflink" id="section-6" href="#section-6">6</a>. The Access Service DTD</span>

   &lt;!--
     DTD for the APEX access service, as of 2001-06-19

     Refer to this DTD as:

       &lt;!ENTITY % APEXACCESS PUBLIC &quot;-//IETF//DTD APEX ACCESS//EN&quot; &quot;&quot;&gt;
       %APEXACCESS;
     --&gt;

   &lt;!ENTITY % APEXCORE PUBLIC &quot;-//IETF//DTD APEX CORE//EN&quot; &quot;&quot;&gt;
   %APEXCORE;

   &lt;!--
     DTD data types:

          entity        syntax/reference     example
          ======        ================     =======
       access actor
          ACTOR         an ENDPOINT or a     *@example.com
                        wildcard

       permitted actions
          ACTIONS       a list of access     &quot;core:any access:query&quot;
                        tokens
     --&gt;

   &lt;!ENTITY  % ACTOR   &quot;CDATA&quot;&gt;
   &lt;!ENTITY  % ACTIONS &quot;NMTOKENS&quot;&gt;

   &lt;!--
     Synopsis of the APEX access service

       service WKE: apex=access

       message exchanges:

           consumer initiates    service replies
           ==================    ================
           query                 allow, deny, or reply
           get                   set or reply
           set                   reply

           service initiates     consumer replies
           =================     ================
           set                   (nothing)




<span class="grey">Rose, et. al.               Standards Track                    [Page 21]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-22" ></span>
<span class="grey"><a href="/doc/html/rfc3341">RFC 3341</a>     The Application Exchange (APEX) Access Service    July 2002</span>


       access control:

           token                 target
           ==========            ======
           access:query          for &quot;owner&quot; of &quot;access&quot; element
           access:get            for &quot;owner&quot; of &quot;access&quot; element
           access:set            for &quot;owner&quot; of &quot;access&quot; element
     --&gt;

   &lt;!ELEMENT query       EMPTY&gt;
   &lt;!ATTLIST query
             owner       %ENDPOINT;        #REQUIRED
             actor       %ACTOR;           #REQUIRED
             actions     %ACTIONS;         #REQUIRED
             transID     %UNIQID;          #REQUIRED&gt;

   &lt;!ELEMENT get         EMPTY&gt;
   &lt;!ATTLIST get
             owner       %ENDPOINT;        #REQUIRED
             actor       %ACTOR;           #REQUIRED
             transID     %UNIQID;          #REQUIRED&gt;

   &lt;!ELEMENT set         (access)&gt;
   &lt;!ATTLIST set
             transID     %UNIQID;          #REQUIRED&gt;

   &lt;!ELEMENT allow       EMPTY&gt;
   &lt;!ATTLIST allow
             transID     %UNIQID;          #REQUIRED&gt;

   &lt;!ELEMENT deny        EMPTY&gt;
   &lt;!ATTLIST deny
             transID     %UNIQID;          #REQUIRED&gt;

   &lt;!--
     access entries
     --&gt;

   &lt;!ELEMENT access      EMPTY&gt;
   &lt;!ATTLIST access
             owner       %ENDPOINT;        #REQUIRED
             actor       %ACTOR;           #REQUIRED
             actions     %ACTIONS;         #IMPLIED
             lastUpdate  %TIMESTAMP;       #IMPLIED&gt;







<span class="grey">Rose, et. al.               Standards Track                    [Page 22]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-23" ></span>
<span class="grey"><a href="/doc/html/rfc3341">RFC 3341</a>     The Application Exchange (APEX) Access Service    July 2002</span>


<span class="h2"><a class="selflink" id="section-7" href="#section-7">7</a>. Security Considerations</span>

   Consult [<a href="#ref-1">1</a>]&#x27;s <a href="#section-11">Section 11</a> for a discussion of security issues.

   In addition, timestamps issued by the the access service may disclose
   location information.  If this information is considered sensitive,
   the special timezone value &quot;-00:00&quot; may be used (after converting the
   local time accordingly).

References

   [<a id="ref-1">1</a>]   Rose, M., Klyne, G. and D. Crocker, &quot;The Application Exchange
         Core&quot;, <a href="/doc/html/rfc3340">RFC 3340</a>, July 2002.

   [<a id="ref-2">2</a>]   Rose, M., &quot;The Blocks Extensible Exchange Protocol Core&quot;, <a href="/doc/html/rfc3080">RFC</a>
         <a href="/doc/html/rfc3080">3080</a>, March 2001.



































<span class="grey">Rose, et. al.               Standards Track                    [Page 23]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-24" ></span>
<span class="grey"><a href="/doc/html/rfc3341">RFC 3341</a>     The Application Exchange (APEX) Access Service    July 2002</span>


Authors&#x27; Addresses

   Marshall T. Rose
   Dover Beach Consulting, Inc.
   POB 255268
   Sacramento, CA  95865-5268
   US

   Phone: +1 916 483 8878
   EMail: mrose@dbc.mtview.ca.us


   Graham Klyne
   Clearswift Corporation
   1310 Waterside
   Arlington Business Park
   Theale, Reading  RG7 4SA
   UK

   Phone: +44 11 8903 8903
   EMail: Graham.Klyne@MIMEsweeper.com


   David H. Crocker
   Brandenburg Consulting
   675 Spruce Drive
   Sunnyvale, CA  94086
   US

   Phone: +1 408 246 8253
   EMail: dcrocker@brandenburg.com
   URI:   <a href="http://www.brandenburg.com/">http://www.brandenburg.com/</a>



















<span class="grey">Rose, et. al.               Standards Track                    [Page 24]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-25" ></span>
<span class="grey"><a href="/doc/html/rfc3341">RFC 3341</a>     The Application Exchange (APEX) Access Service    July 2002</span>


<span class="h2"><a class="selflink" id="appendix-A" href="#appendix-A">Appendix A</a>. Acknowledgements</span>

   The authors gratefully acknowledge the contributions of: Neil Cook,
   Darren New, Chris Newman, Scott Pead, and Bob Wyman.















































<span class="grey">Rose, et. al.               Standards Track                    [Page 25]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-26" ></span>
<span class="grey"><a href="/doc/html/rfc3341">RFC 3341</a>     The Application Exchange (APEX) Access Service    July 2002</span>


Full Copyright Statement

   Copyright (C) The Internet Society (2002).  All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assigns.

   This document and the information contained herein is provided on an
   &quot;AS IS&quot; basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.



















Rose, et. al.               Standards Track                    [Page 26]
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

