<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    rfc2829
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.34.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.34.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/draft-ietf-ldapext-authmeth/">
  <meta name="description" content="Authentication Methods for LDAP (RFC )">
  <script src="https://www.ietf.org/lib/dt/7.34.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.34.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bgbrown"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc2829.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc2829.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/pdfrfc/rfc2829.txt.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/rfc2829/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/rfc2829/" title="Datatracker information for this document">Tracker</a>] [<a href="/group/ldapext/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-ldapext-authmeth@ietf.org?subject=draft-ietf-ldapext-authmeth" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=draft-ietf-ldapext-authmeth-04.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-ietf-ldapext-authmeth-04.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-ietf-ldapext-authmeth-04.txt" title="Run an idnits check of this document">Nits</a>]

From: <a href="/doc/html/draft-ietf-ldapext-authmeth-04">draft-ietf-ldapext-authmeth-04</a>                   Proposed Standard
Obsoleted by: <a href="/doc/html/rfc4510">4510</a>, <a href="/doc/html/rfc4513">4513</a>                                                
Updated by: <a href="/doc/html/rfc3377">3377</a>                                                        </pre>
      </div>
    

    <div class="draftcontent">
    <pre>Network Working Group                                            M. Wahl
Request for Comments: 2829                        Sun Microsystems, Inc.
Category: Standards Track                                  H. Alvestrand
                                                             EDB Maxware
                                                               J. Hodges
                                                             Oblix, Inc.
                                                               R. Morgan
                                                University of Washington
                                                                May 2000


                    <span class="h1">Authentication Methods for LDAP</span>

Status of this Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the &quot;Internet
   Official Protocol Standards&quot; (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2000).  All Rights Reserved.

Abstract

   This document specifies particular combinations of security
   mechanisms which are required and recommended in LDAP [<a href="#ref-1">1</a>]
   implementations.

<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>. Introduction</span>

   LDAP version 3 is a powerful access protocol for directories.

   It offers means of searching, fetching and manipulating directory
   content, and ways to access a rich set of security functions.

   In order to function for the best of the Internet, it is vital that
   these security functions be interoperable; therefore there has to be
   a minimum subset of security functions that is common to all
   implementations that claim LDAPv3 conformance.

   Basic threats to an LDAP directory service include:

      (1)   Unauthorized access to data via data-fetching operations,





<span class="grey">Wahl, et al.                Standards Track                     [Page 1]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-2" ></span>
<span class="grey"><a href="/doc/html/rfc2829">RFC 2829</a>            Authentication Methods for LDAP             May 2000</span>


      (2)   Unauthorized access to reusable client authentication
            information by monitoring others&#x27; access,

      (3)   Unauthorized access to data by monitoring others&#x27; access,

      (4)   Unauthorized modification of data,

      (5)   Unauthorized modification of configuration,

      (6)   Unauthorized or excessive use of resources (denial of
            service), and

      (7)   Spoofing of directory: Tricking a client into believing that
            information came from the directory when in fact it did not,
            either by modifying data in transit or misdirecting the
            client&#x27;s connection.

   Threats (1), (4), (5) and (6) are due to hostile clients.  Threats
   (2), (3) and (7) are due to hostile agents on the path between client
   and server, or posing as a server.

   The LDAP protocol suite can be protected with the following security
   mechanisms:

      (1)   Client authentication by means of the SASL [<a href="#ref-2">2</a>] mechanism
            set, possibly backed by the TLS credentials exchange
            mechanism,

      (2)   Client authorization by means of access control based on the
            requestor&#x27;s authenticated identity,

      (3)   Data integrity protection by means of the TLS protocol or
            data-integrity SASL mechanisms,

      (4)   Protection against snooping by means of the TLS protocol or
            data-encrypting SASL mechanisms,

      (5)   Resource limitation by means of administrative limits on
            service controls, and

      (6)   Server authentication by means of the TLS protocol or SASL
            mechanism.

   At the moment, imposition of access controls is done by means outside
   the scope of the LDAP protocol.

   In this document, the term &quot;user&quot; represents any application which is
   an LDAP client using the directory to retrieve or store information.



<span class="grey">Wahl, et al.                Standards Track                     [Page 2]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-3" ></span>
<span class="grey"><a href="/doc/html/rfc2829">RFC 2829</a>            Authentication Methods for LDAP             May 2000</span>


   The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;,
   &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;,  &quot;MAY&quot;, and &quot;OPTIONAL&quot; in this
   document are to be interpreted as described in <a href="/doc/html/rfc2119">RFC 2119</a> [<a href="#ref-3">3</a>].

<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  Example deployment scenarios</span>

   The following scenarios are typical for LDAP directories on the
   Internet, and have different security requirements. (In the
   following, &quot;sensitive&quot; means data that will cause real damage to the
   owner if revealed; there may be data that is protected but not
   sensitive).  This is not intended to be a comprehensive list, other
   scenarios are possible, especially on physically protected networks.

      (1)   A read-only directory, containing no sensitive data,
            accessible to &quot;anyone&quot;, and TCP connection hijacking or IP
            spoofing is not a problem.  This directory requires no
            security functions except administrative service limits.

      (2)   A read-only directory containing no sensitive data; read
            access is granted based on identity.  TCP connection
            hijacking is not currently a problem. This scenario requires
            a secure authentication function.

      (3)   A read-only directory containing no sensitive data; and the
            client needs to ensure that the directory data is
            authenticated by the server and not modified while being
            returned from the server.

      (4)   A read-write directory, containing no sensitive data; read
            access is available to &quot;anyone&quot;, update access to properly
            authorized persons.  TCP connection hijacking is not
            currently a problem.  This scenario requires a secure
            authentication function.

      (5)   A directory containing sensitive data.  This scenario
            requires session confidentiality protection AND secure
            authentication.

<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>.  Authentication and Authorization:  </span>Definitions and Concepts

   This section defines basic terms, concepts, and interrelationships
   regarding authentication, authorization, credentials, and identity.
   These concepts are used in describing how various security approaches
   are utilized in client authentication and authorization.







<span class="grey">Wahl, et al.                Standards Track                     [Page 3]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-4" ></span>
<span class="grey"><a href="/doc/html/rfc2829">RFC 2829</a>            Authentication Methods for LDAP             May 2000</span>


<span class="h3"><a class="selflink" id="section-3.1" href="#section-3.1">3.1</a>.  Access Control Policy</span>

   An access control policy is a set of rules defining the protection of
   resources, generally in terms of the capabilities of persons or other
   entities accessing those resources.  A common expression of an access
   control policy is an access control list.  Security objects and
   mechanisms, such as those described here, enable the expression of
   access control policies and their enforcement.  Access control
   policies are typically expressed in terms of access control
   attributes as described below.

<span class="h3"><a class="selflink" id="section-3.2" href="#section-3.2">3.2</a>.  Access Control Factors</span>

   A request, when it is being processed by a server, may be associated
   with a wide variety of security-related factors (section 4.2 of [<a href="#ref-1">1</a>]).
   The server uses these factors to determine whether and how to process
   the request.  These are called access control factors (ACFs).  They
   might include source IP address, encryption strength, the type of
   operation being requested, time of day, etc.  Some factors may be
   specific to the request itself, others may be associated with the
   connection via which the request is transmitted, others (e.g. time of
   day) may be &quot;environmental&quot;.

   Access control policies are expressed in terms of access control
   factors.  E.g., a request having ACFs i,j,k can perform operation Y
   on resource Z. The set of ACFs that a server makes available for such
   expressions is implementation-specific.

<span class="h3"><a class="selflink" id="section-3.3" href="#section-3.3">3.3</a>.  Authentication, Credentials, Identity</span>

   Authentication credentials are the evidence supplied by one party to
   another, asserting the identity of the supplying party (e.g. a user)
   who is attempting to establish an association with the other party
   (typically a server).  Authentication is the process of generating,
   transmitting, and verifying these credentials and thus the identity
   they assert.  An authentication identity is the name presented in a
   credential.

   There are many forms of authentication credentials -- the form used
   depends upon the particular authentication mechanism negotiated by
   the parties.  For example: X.509 certificates, Kerberos tickets,
   simple identity and password pairs.  Note that an authentication
   mechanism may constrain the form of authentication identities used
   with it.







<span class="grey">Wahl, et al.                Standards Track                     [Page 4]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-5" ></span>
<span class="grey"><a href="/doc/html/rfc2829">RFC 2829</a>            Authentication Methods for LDAP             May 2000</span>


<span class="h3"><a class="selflink" id="section-3.4" href="#section-3.4">3.4</a>.  Authorization Identity</span>

   An authorization identity is one kind of access control factor.  It
   is the name of the user or other entity that requests that operations
   be performed.  Access control policies are often expressed in terms
   of authorization identities; e.g., entity X can perform operation Y
   on resource Z.

   The authorization identity bound to an association is often exactly
   the same as the authentication identity presented by the client, but
   it may be different.  SASL allows clients to specify an authorization
   identity distinct from the authentication identity asserted by the
   client&#x27;s credentials.  This permits agents such as proxy servers to
   authenticate using their own credentials, yet request the access
   privileges of the identity for which they are proxying [<a href="#ref-2">2</a>].  Also,
   the form of authentication identity supplied by a service like TLS
   may not correspond to the authorization identities used to express a
   server&#x27;s access control  policy, requiring a server-specific mapping
   to be done.  The method by which a server composes and validates an
   authorization identity from the authentication credentials supplied
   by a client is implementation-specific.

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>. Required security mechanisms</span>

   It is clear that allowing any implementation, faced with the above
   requirements, to pick and choose among the possible alternatives is
   not a strategy that is likely to lead to interoperability. In the
   absence of mandates, clients will be written that do not support any
   security function supported by the server, or worse, support only
   mechanisms like cleartext passwords that provide clearly inadequate
   security.

   Active intermediary attacks are the most difficult for an attacker to
   perform, and for an implementation to protect against.  Methods that
   protect only against hostile client and passive eavesdropping attacks
   are useful in situations where the cost of protection against active
   intermediary attacks is not justified based on the perceived risk of
   active intermediary attacks.

   Given the presence of the Directory, there is a strong desire to see
   mechanisms where identities take the form of a Distinguished Name and
   authentication data can be stored in the directory; this means that
   either this data is useless for faking authentication (like the Unix
   &quot;/etc/passwd&quot; file format used to be), or its content is never passed
   across the wire unprotected - that is, it&#x27;s either updated outside
   the protocol or it is only updated in sessions well protected against
   snooping.  It is also desirable to allow authentication methods to




<span class="grey">Wahl, et al.                Standards Track                     [Page 5]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-6" ></span>
<span class="grey"><a href="/doc/html/rfc2829">RFC 2829</a>            Authentication Methods for LDAP             May 2000</span>


   carry authorization identities based on existing forms of user
   identities for backwards compatibility with non-LDAP-based
   authentication services.

   Therefore, the following implementation conformance requirements are
   in place:

      (1)   For a read-only, public directory, anonymous authentication,
            described in <a href="#section-5">section 5</a>, can be used.

      (2)   Implementations providing password-based authenticated
            access MUST support authentication using the DIGEST-MD5 SASL
            mechanism [<a href="#ref-4">4</a>], as described in <a href="#section-6.1">section 6.1</a>.  This provides
            client authentication with protection against passive
            eavesdropping attacks, but does not provide protection
            against active intermediary attacks.

      (3)   For a directory needing session protection and
            authentication, the Start TLS extended operation [<a href="#ref-5">5</a>], and
            either the simple authentication choice or the SASL EXTERNAL
            mechanism, are to be used together.  Implementations SHOULD
            support authentication with a password as described in
            <a href="#section-6.2">section 6.2</a>, and SHOULD support authentication with a
            certificate as described in <a href="#section-7.1">section 7.1</a>.  Together, these
            can provide integrity and disclosure protection of
            transmitted data, and authentication of client and server,
            including protection against active intermediary attacks.

   If TLS is negotiated, the client MUST discard all information about
   the server fetched prior to the TLS negotiation.  In particular, the
   value of supportedSASLMechanisms MAY be different after TLS has been
   negotiated (specifically, the EXTERNAL mechanism or the proposed
   PLAIN mechanism are likely to only be listed after a TLS negotiation
   has been performed).

   If a SASL security layer is negotiated, the client MUST discard all
   information about the server fetched prior to SASL.  In particular,
   if the client is configured to support multiple SASL mechanisms, it
   SHOULD fetch supportedSASLMechanisms both before and after the SASL
   security layer is negotiated and verify that the value has not
   changed after the SASL security layer was negotiated.  This detects
   active attacks which remove supported SASL mechanisms from the
   supportedSASLMechanisms list, and allows the client to ensure that it
   is using the best mechanism supported by both client and server
   (additionally, this is a SHOULD to allow for environments where the
   supported SASL mechanisms list is provided to the client through a
   different trusted source, e.g. as part of a digitally signed object).




<span class="grey">Wahl, et al.                Standards Track                     [Page 6]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-7" ></span>
<span class="grey"><a href="/doc/html/rfc2829">RFC 2829</a>            Authentication Methods for LDAP             May 2000</span>


<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>. Anonymous authentication</span>

   Directory operations which modify entries or access protected
   attributes or entries generally require client authentication.
   Clients which do not intend to perform any of these operations
   typically use anonymous authentication.

   LDAP implementations MUST support anonymous authentication, as
   defined in <a href="#section-5.1">section 5.1</a>.

   LDAP implementations MAY support anonymous authentication with TLS,
   as defined in <a href="#section-5.2">section 5.2</a>.

   While there MAY be access control restrictions to prevent access to
   directory entries, an LDAP server SHOULD allow an anonymously-bound
   client to retrieve the supportedSASLMechanisms attribute of the root
   DSE.

   An LDAP server MAY use other information about the client provided by
   the lower layers or external means to grant or deny access even to
   anonymously authenticated clients.

<span class="h3"><a class="selflink" id="section-5.1" href="#section-5.1">5.1</a>. Anonymous authentication procedure</span>

   An LDAP client which has not successfully completed a bind operation
   on a connection is anonymously authenticated.

   An LDAP client MAY also specify anonymous authentication in a bind
   request by using a zero-length OCTET STRING with the simple
   authentication choice.

<span class="h3"><a class="selflink" id="section-5.2" href="#section-5.2">5.2</a>. Anonymous authentication and TLS</span>

   An LDAP client MAY use the Start TLS operation [<a href="#ref-5">5</a>] to negotiate the
   use of TLS security [<a href="#ref-6">6</a>].  If the client has not bound beforehand,
   then until the client uses the EXTERNAL SASL mechanism to negotiate
   the recognition of the client&#x27;s certificate, the client is
   anonymously authenticated.

   Recommendations on TLS ciphersuites are given in <a href="#section-10">section 10</a>.

   An LDAP server which requests that clients provide their certificate
   during TLS negotiation MAY use a local security policy to determine
   whether to successfully complete TLS negotiation if the client did
   not present a certificate which could be validated.






<span class="grey">Wahl, et al.                Standards Track                     [Page 7]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-8" ></span>
<span class="grey"><a href="/doc/html/rfc2829">RFC 2829</a>            Authentication Methods for LDAP             May 2000</span>


<span class="h2"><a class="selflink" id="section-6" href="#section-6">6</a>. Password-based authentication</span>

   LDAP implementations MUST support authentication with a password
   using the DIGEST-MD5 SASL mechanism for password protection, as
   defined in <a href="#section-6.1">section 6.1</a>.

   LDAP implementations SHOULD support authentication with the &quot;simple&quot;
   password choice when the connection is protected against
   eavesdropping using TLS, as defined in <a href="#section-6.2">section 6.2</a>.

<span class="h3"><a class="selflink" id="section-6.1" href="#section-6.1">6.1</a>. Digest authentication</span>

   An LDAP client MAY determine whether the server supports this
   mechanism by performing a search request on the root DSE, requesting
   the supportedSASLMechanisms attribute, and checking whether the
   string &quot;DIGEST-MD5&quot; is present as a value of this attribute.

   In the first stage of authentication, when the client is performing
   an &quot;initial authentication&quot; as defined in section 2.1 of [<a href="#ref-4">4</a>], the
   client sends a bind request in which the version number is 3, the
   authentication choice is sasl, the sasl mechanism name is &quot;DIGEST-
   MD5&quot;, and the credentials are absent.  The client then waits for a
   response from the server to this request.

   The server will respond with a bind response in which the resultCode
   is saslBindInProgress, and the serverSaslCreds field is present.  The
   contents of this field is a string defined by &quot;digest-challenge&quot; in
   section 2.1.1 of [<a href="#ref-4">4</a>].  The server SHOULD include a realm indication
   and MUST indicate support for UTF-8.

   The client will send a bind request with a distinct message id, in
   which the version number is 3, the authentication choice is sasl, the
   sasl mechanism name is &quot;DIGEST-MD5&quot;, and the credentials contain the
   string defined by &quot;digest-response&quot; in section 2.1.2 of [<a href="#ref-4">4</a>].  The
   serv-type is &quot;ldap&quot;.

   The server will respond with a bind response in which the resultCode
   is either success, or an error indication.  If the authentication is
   successful and the server does not support subsequent authentication,
   then the credentials field is absent.  If the authentication is
   successful and the server supports subsequent authentication, then
   the credentials field contains the string defined by &quot;response-auth&quot;
   in section 2.1.3 of [<a href="#ref-4">4</a>].   Support for subsequent authentication is
   OPTIONAL in clients and servers.







<span class="grey">Wahl, et al.                Standards Track                     [Page 8]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-9" ></span>
<span class="grey"><a href="/doc/html/rfc2829">RFC 2829</a>            Authentication Methods for LDAP             May 2000</span>


<span class="h3"><a class="selflink" id="section-6.2" href="#section-6.2">6.2</a>. &quot;simple&quot; authentication choice under TLS encryption</span>

   A user who has a directory entry containing a userPassword attribute
   MAY authenticate to the directory by performing a simple password
   bind sequence following the negotiation of a TLS ciphersuite
   providing connection confidentiality [<a href="#ref-6">6</a>].

   The client will use the Start TLS operation [<a href="#ref-5">5</a>] to negotiate the use
   of TLS security [<a href="#ref-6">6</a>] on the connection to the LDAP server.  The client
   need not have bound to the directory beforehand.

   For this authentication procedure to be successful, the client and
   server MUST negotiate a ciphersuite which contains a bulk encryption
   algorithm of appropriate strength.  Recommendations on cipher suites
   are given in <a href="#section-10">section 10</a>.

   Following the successful completion of TLS negotiation, the client
   MUST send an LDAP bind request with the version number of 3, the name
   field containing the name of the user&#x27;s entry, and the &quot;simple&quot;
   authentication choice, containing a password.

   The server will, for each value of the userPassword attribute in the
   named user&#x27;s entry, compare these for case-sensitive equality with
   the client&#x27;s presented password.  If there is a match, then the
   server will respond with resultCode success, otherwise the server
   will respond with resultCode invalidCredentials.

<span class="h3"><a class="selflink" id="section-6.3" href="#section-6.3">6.3</a>. Other authentication choices with TLS</span>

   It is also possible, following the negotiation of TLS, to perform a
   SASL authentication which does not involve the exchange of plaintext
   reusable passwords.  In this case the client and server need not
   negotiate a ciphersuite which provides confidentiality if the only
   service required is data integrity.

<span class="h2"><a class="selflink" id="section-7" href="#section-7">7</a>. Certificate-based authentication</span>

   LDAP implementations SHOULD support authentication via a client
   certificate in TLS, as defined in <a href="#section-7.1">section 7.1</a>.

<span class="h3"><a class="selflink" id="section-7.1" href="#section-7.1">7.1</a>. Certificate-based authentication with TLS</span>

   A user who has a public/private key pair in which the public key has
   been signed by a Certification Authority may use this key pair to
   authenticate to the directory server if the user&#x27;s certificate is
   requested by the server.  The user&#x27;s certificate subject field SHOULD
   be the name of the user&#x27;s directory entry, and the Certification
   Authority must be sufficiently trusted by the directory server to



<span class="grey">Wahl, et al.                Standards Track                     [Page 9]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-10" ></span>
<span class="grey"><a href="/doc/html/rfc2829">RFC 2829</a>            Authentication Methods for LDAP             May 2000</span>


   have issued the certificate in order that the server can process the
   certificate.  The means by which servers validate certificate paths
   is outside the scope of this document.

   A server MAY support mappings for certificates in which the subject
   field name is different from the name of the user&#x27;s directory entry.
   A server which supports mappings of names MUST be capable of being
   configured to support certificates for which no mapping is required.

   The client will use the Start TLS operation [<a href="#ref-5">5</a>] to negotiate the use
   of TLS security [<a href="#ref-6">6</a>] on the connection to the LDAP server.  The client
   need not have bound to the directory beforehand.

   In the TLS negotiation, the server MUST request a certificate.  The
   client will provide its certificate to the server, and MUST perform a
   private key-based encryption, proving it has the private key
   associated with the certificate.

   As deployments will require protection of sensitive data in transit,
   the client and server MUST negotiate a ciphersuite which contains a
   bulk encryption algorithm of appropriate strength.  Recommendations
   of cipher suites are given in <a href="#section-10">section 10</a>.

   The server MUST verify that the client&#x27;s certificate is valid. The
   server will normally check that the certificate is issued by a known
   CA, and that none of the certificates on the client&#x27;s certificate
   chain are invalid or revoked.  There are several procedures by which
   the server can perform these checks.

   Following the successful completion of TLS negotiation, the client
   will send an LDAP bind request with the SASL &quot;EXTERNAL&quot; mechanism.

<span class="h2"><a class="selflink" id="section-8" href="#section-8">8</a>. Other mechanisms</span>

   The LDAP &quot;simple&quot; authentication choice is not suitable for
   authentication on the Internet where there is no network or transport
   layer confidentiality.

   As LDAP includes native anonymous and plaintext authentication
   methods, the &quot;ANONYMOUS&quot; and &quot;PLAIN&quot; SASL mechanisms are not used
   with LDAP.  If an authorization identity of a form different from a
   DN is requested by the client, a mechanism that protects the password
   in transit SHOULD be used.

   The following SASL-based mechanisms are not considered in this
   document: KERBEROS_V4, GSSAPI and SKEY.





<span class="grey">Wahl, et al.                Standards Track                    [Page 10]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-11" ></span>
<span class="grey"><a href="/doc/html/rfc2829">RFC 2829</a>            Authentication Methods for LDAP             May 2000</span>


   The &quot;EXTERNAL&quot; SASL mechanism can be used to request the LDAP server
   make use of security credentials exchanged by a lower layer. If a TLS
   session has not been established between the client and server prior
   to making the SASL EXTERNAL Bind request and there is no other
   external source of authentication credentials (e.g.  IP-level
   security [<a href="#ref-8">8</a>]), or if, during the process of establishing the TLS
   session, the server did not request the client&#x27;s authentication
   credentials, the SASL EXTERNAL bind MUST fail with a result code of
   inappropriateAuthentication.  Any client authentication and
   authorization state of the LDAP association is lost, so the LDAP
   association is in an anonymous state after the failure.

<span class="h2"><a class="selflink" id="section-9" href="#section-9">9</a>. Authorization Identity</span>

   The authorization identity is carried as part of the SASL credentials
   field in the LDAP Bind request and response.

   When the &quot;EXTERNAL&quot; mechanism is being negotiated, if the credentials
   field is present, it contains an authorization identity of the
   authzId form described below.

   Other mechanisms define the location of the authorization identity in
   the credentials field.

   The authorization identity is a string in the UTF-8 character set,
   corresponding to the following ABNF [<a href="#ref-7">7</a>]:

   ; Specific predefined authorization (authz) id schemes are
   ; defined below -- new schemes may be defined in the future.

   authzId    = dnAuthzId / uAuthzId

   ; distinguished-name-based authz id.
   dnAuthzId  = &quot;dn:&quot; dn
   dn         = utf8string    ; with syntax defined in <a href="/doc/html/rfc2253">RFC 2253</a>

   ; unspecified userid, UTF-8 encoded.
   uAuthzId   = &quot;u:&quot; userid
   userid     = utf8string    ; syntax unspecified

   A utf8string is defined to be the UTF-8 encoding of one or more ISO
   10646 characters.

   All servers which support the storage of authentication credentials,
   such as passwords or certificates, in the directory MUST support the
   dnAuthzId choice.





<span class="grey">Wahl, et al.                Standards Track                    [Page 11]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-12" ></span>
<span class="grey"><a href="/doc/html/rfc2829">RFC 2829</a>            Authentication Methods for LDAP             May 2000</span>


   The uAuthzId choice allows for compatibility with client applications
   which wish to authenticate to a local directory but do not know their
   own Distinguished Name or have a directory entry.  The format of the
   string is defined as only a sequence of UTF-8 encoded ISO 10646
   characters, and further interpretation is subject to prior agreement
   between the client and server.

   For example, the userid could identify a user of a specific directory
   service, or be a login name or the local-part of an <a href="/doc/html/rfc822">RFC 822</a> email
   address. In general a uAuthzId MUST NOT be assumed to be globally
   unique.

   Additional authorization identity schemes MAY be defined in future
   versions of this document.

<span class="h2"><a class="selflink" id="section-10" href="#section-10">10</a>. TLS Ciphersuites</span>

   The following ciphersuites defined in [<a href="#ref-6">6</a>] MUST NOT be used for
   confidentiality protection of passwords or data:

         TLS_NULL_WITH_NULL_NULL
         TLS_RSA_WITH_NULL_MD5
         TLS_RSA_WITH_NULL_SHA

   The following ciphersuites defined in [<a href="#ref-6">6</a>] can be cracked easily (less
   than a week of CPU time on a standard CPU in 1997).  The client and
   server SHOULD carefully consider the value of the password or data
   being protected before using these ciphersuites:

         TLS_RSA_EXPORT_WITH_RC4_40_MD5
         TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5
         TLS_RSA_EXPORT_WITH_DES40_CBC_SHA
         TLS_DH_DSS_EXPORT_WITH_DES40_CBC_SHA
         TLS_DH_RSA_EXPORT_WITH_DES40_CBC_SHA
         TLS_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA
         TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA
         TLS_DH_anon_EXPORT_WITH_RC4_40_MD5
         TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA

   The following ciphersuites are vulnerable to man-in-the-middle
   attacks, and SHOULD NOT be used to protect passwords or sensitive
   data, unless the network configuration is such that the danger of a
   man-in-the-middle attack is tolerable:








<span class="grey">Wahl, et al.                Standards Track                    [Page 12]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-13" ></span>
<span class="grey"><a href="/doc/html/rfc2829">RFC 2829</a>            Authentication Methods for LDAP             May 2000</span>


         TLS_DH_anon_EXPORT_WITH_RC4_40_MD5
         TLS_DH_anon_WITH_RC4_128_MD5
         TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA
         TLS_DH_anon_WITH_DES_CBC_SHA
         TLS_DH_anon_WITH_3DES_EDE_CBC_SHA

   A client or server that supports TLS MUST support at least
   TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA.

<span class="h2"><a class="selflink" id="section-11" href="#section-11">11</a>. SASL service name for LDAP</span>

   For use with SASL [<a href="#ref-2">2</a>], a protocol must specify a service name to be
   used with various SASL mechanisms, such as GSSAPI.  For LDAP, the
   service name is &quot;ldap&quot;, which has been registered with the IANA as a
   GSSAPI service name.

<span class="h2"><a class="selflink" id="section-12" href="#section-12">12</a>. Security Considerations</span>

   Security issues are discussed throughout this memo; the
   (unsurprising) conclusion is that mandatory security is important,
   and that session encryption is required when snooping is a problem.

   Servers are encouraged to prevent modifications by anonymous users.
   Servers may also wish to minimize denial of service attacks by timing
   out idle connections, and returning the unwillingToPerform result
   code rather than performing computationally expensive operations
   requested by unauthorized clients.

   A connection on which the client has not performed the Start TLS
   operation or negotiated a suitable SASL mechanism for connection
   integrity and encryption services is subject to man-in-the-middle
   attacks to view and modify information in transit.

   Additional security considerations relating to the EXTERNAL mechanism
   to negotiate TLS can be found in [<a href="#ref-2">2</a>], [<a href="#ref-5">5</a>] and [<a href="#ref-6">6</a>].

<span class="h2"><a class="selflink" id="section-13" href="#section-13">13</a>. Acknowledgements</span>

   This document is a product of the LDAPEXT Working Group of the IETF.
   The contributions of its members is greatly appreciated.











<span class="grey">Wahl, et al.                Standards Track                    [Page 13]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-14" ></span>
<span class="grey"><a href="/doc/html/rfc2829">RFC 2829</a>            Authentication Methods for LDAP             May 2000</span>


<span class="h2"><a class="selflink" id="section-14" href="#section-14">14</a>. Bibliography</span>

   [<a id="ref-1">1</a>] Wahl, M., Howes, T. and S. Kille, &quot;Lightweight Directory Access
       Protocol (v3)&quot;, <a href="/doc/html/rfc2251">RFC 2251</a>, December 1997.

   [<a id="ref-2">2</a>] Myers, J., &quot;Simple Authentication and Security Layer (SASL)&quot;, <a href="/doc/html/rfc2222">RFC</a>
       <a href="/doc/html/rfc2222">2222</a>, October 1997.

   [<a id="ref-3">3</a>] Bradner, S., &quot;Key words for use in RFCs to Indicate Requirement
       Levels&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc2119">RFC 2119</a>, March 1997.

   [<a id="ref-4">4</a>] Leach, P. and C. Newman, &quot;Using Digest Authentication as a SASL
       Mechanism&quot;, <a href="/doc/html/rfc2831">RFC 2831</a>, May 2000.

   [<a id="ref-5">5</a>] Hodges, J., Morgan, R. and M. Wahl, &quot;Lightweight Directory Access
       Protocol (v3): Extension for Transport Layer Security&quot;, <a href="/doc/html/rfc2830">RFC 2830</a>,
       May 2000.

   [<a id="ref-6">6</a>] Dierks, T. and C. Allen, &quot;The TLS Protocol Version 1.0&quot;, <a href="/doc/html/rfc2246">RFC</a>
       <a href="/doc/html/rfc2246">2246</a>, January 1999.

   [<a id="ref-7">7</a>] Crocker, D., Ed. and P. Overell, &quot;Augmented BNF for Syntax
       Specifications: ABNF&quot;, <a href="/doc/html/rfc2234">RFC 2234</a>, November 1997.

   [<a id="ref-8">8</a>] Kent, S. and R. Atkinson, &quot;Security Architecture for the Internet
       Protocol&quot;, <a href="/doc/html/rfc2401">RFC 2401</a>, November 1998.

























<span class="grey">Wahl, et al.                Standards Track                    [Page 14]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-15" ></span>
<span class="grey"><a href="/doc/html/rfc2829">RFC 2829</a>            Authentication Methods for LDAP             May 2000</span>


<span class="h2"><a class="selflink" id="section-15" href="#section-15">15</a>. Authors&#x27; Addresses</span>

   Mark Wahl
   Sun Microsystems, Inc.
   8911 Capital of Texas Hwy #4140
   Austin TX 78759
   USA

   EMail: M.Wahl@innosoft.com


   Harald Tveit Alvestrand
   EDB Maxware
   Pirsenteret
   N-7462 Trondheim, Norway

   Phone: +47 73 54 57 97
   EMail: Harald@Alvestrand.no


   Jeff Hodges
   Oblix, Inc.
   18922 Forge Drive
   Cupertino, CA 95014
   USA

   Phone: +1-408-861-6656
   EMail: JHodges@oblix.com


   RL &quot;Bob&quot; Morgan
   Computing and Communications
   University of Washington
   Seattle, WA 98105
   USA

   Phone: +1-206-221-3307
   EMail: rlmorgan@washington.edu













<span class="grey">Wahl, et al.                Standards Track                    [Page 15]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-16" ></span>
<span class="grey"><a href="/doc/html/rfc2829">RFC 2829</a>            Authentication Methods for LDAP             May 2000</span>


<span class="h2"><a class="selflink" id="section-16" href="#section-16">16</a>.  Full Copyright Statement</span>

   Copyright (C) The Internet Society (2000).  All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assigns.

   This document and the information contained herein is provided on an
   &quot;AS IS&quot; basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.



















Wahl, et al.                Standards Track                    [Page 16]
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

