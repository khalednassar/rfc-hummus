<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    rfc8732
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.34.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.34.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/draft-ietf-curdle-gss-keyex-sha2/">
  <meta name="description" content="Generic Security Service Application Program Interface (GSS-API) Key Exchange with SHA-2 (RFC )">
  <script src="https://www.ietf.org/lib/dt/7.34.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.34.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bgblue"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc8732.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc8732.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/rfc8732.xml" title="XML source for this document">xml</a>|<a href="https://www.rfc-editor.org/rfc/rfc8732.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/rfc8732/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/rfc8732/" title="Datatracker information for this document">Tracker</a>] [<a href="/group/curdle/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-curdle-gss-keyex-sha2@ietf.org?subject=draft-ietf-curdle-gss-keyex-sha2" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=draft-ietf-curdle-gss-keyex-sha2-10.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-ietf-curdle-gss-keyex-sha2-10.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-ietf-curdle-gss-keyex-sha2-10.txt" title="Run an idnits check of this document">Nits</a>]

From: <a href="/doc/html/draft-ietf-curdle-gss-keyex-sha2-10">draft-ietf-curdle-gss-keyex-sha2-10</a>              Proposed Standard</pre>
      </div>
    

    <div class="draftcontent">
    <pre>Internet Engineering Task Force (IETF)                          S. Sorce
Request for Comments: 8732                                      H. Kario
Updates: <a href="/doc/html/rfc4462">4462</a>                                              Red Hat, Inc.
Category: Standards Track                                  February 2020
ISSN: 2070-1721


  <span class="h1">Generic Security Service Application Program Interface (GSS-API) Key</span>
                          <span class="h1">Exchange with SHA-2</span>

Abstract

   This document specifies additions and amendments to <a href="/doc/html/rfc4462">RFC 4462</a>.  It
   defines a new key exchange method that uses SHA-2 for integrity and
   deprecates weak Diffie-Hellman (DH) groups.  The purpose of this
   specification is to modernize the cryptographic primitives used by
   Generic Security Service (GSS) key exchanges.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="/doc/html/rfc7841#section-2">Section&nbsp;2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="https://www.rfc-editor.org/info/rfc8732">https://www.rfc-editor.org/info/rfc8732</a>.

Copyright Notice

   Copyright (c) 2020 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="/doc/html/bcp78">BCP 78</a> and the IETF Trust&#x27;s Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction
   2.  Rationale
   3.  Document Conventions
   4.  New Diffie-Hellman Key Exchange Methods
   5.  New Elliptic Curve Diffie-Hellman Key Exchange Methods
     5.1.  Generic GSS-API Key Exchange with ECDH
     5.2.  ECDH Key Exchange Methods
   6.  Deprecated Algorithms
   7.  IANA Considerations
   8.  Security Considerations
     8.1.  New Finite Field DH Mechanisms
     8.2.  New Elliptic Curve DH Mechanisms
     8.3.  GSS-API Delegation
   9.  References
     9.1.  Normative References
     9.2.  Informative References
   Authors&#x27; Addresses

<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>.  Introduction</span>

   Secure Shell (SSH) Generic Security Service Application Program
   Interface (GSS-API) methods [<a href="/doc/html/rfc4462" title="&quot;Generic Security Service Application Program Interface (GSS-API) Authentication and Key Exchange for the Secure Shell (SSH) Protocol&quot;">RFC4462</a>] allow the use of GSS-API
   [<a href="/doc/html/rfc2743" title="&quot;Generic Security Service Application Program Interface Version 2, Update 1&quot;">RFC2743</a>] for authentication and key exchange in SSH.  [<a href="/doc/html/rfc4462" title="&quot;Generic Security Service Application Program Interface (GSS-API) Authentication and Key Exchange for the Secure Shell (SSH) Protocol&quot;">RFC4462</a>]
   defines three exchange methods all based on DH groups and SHA-1.
   This document updates [<a href="/doc/html/rfc4462" title="&quot;Generic Security Service Application Program Interface (GSS-API) Authentication and Key Exchange for the Secure Shell (SSH) Protocol&quot;">RFC4462</a>] with new methods intended to support
   environments that desire to use the SHA-2 cryptographic hash
   functions.

<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  Rationale</span>

   Due to security concerns with SHA-1 [<a href="/doc/html/rfc6194" title="&quot;Security Considerations for the SHA-0 and SHA-1 Message-Digest Algorithms&quot;">RFC6194</a>] and with modular
   exponentiation (MODP) groups with less than 2048 bits
   [<a href="#ref-NIST-SP-800-131Ar2">NIST-SP-800-131Ar2</a>], we propose the use of hashes based on SHA-2
   [<a href="/doc/html/rfc6234" title="&quot;US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)&quot;">RFC6234</a>] with DH group14, group15, group16, group17, and group18
   [<a href="/doc/html/rfc3526" title="&quot;More Modular Exponential (MODP) Diffie-Hellman groups for Internet Key Exchange (IKE)&quot;">RFC3526</a>].  Additionally, we add support for key exchange based on
   Elliptic Curve Diffie-Hellman with the NIST P-256, P-384, and P-521
   [<a href="#ref-SEC2v2" title="&quot;SEC 2: Recommended Elliptic Curve Domain Parameters&quot;">SEC2v2</a>], as well as the X25519 and X448 [<a href="/doc/html/rfc7748" title="&quot;Elliptic Curves for Security&quot;">RFC7748</a>] curves.  Following
   the practice of [<a href="/doc/html/rfc8268" title="&quot;More Modular Exponentiation (MODP) Diffie- Hellman (DH) Key Exchange (KEX) Groups for Secure Shell (SSH)&quot;">RFC8268</a>], only SHA-256 and SHA-512 hashes are used
   for DH groups.  For NIST curves, the same curve-to-hashing algorithm
   pairing used in [<a href="/doc/html/rfc5656" title="&quot;Elliptic Curve Algorithm Integration in the Secure Shell Transport Layer&quot;">RFC5656</a>] is adopted for consistency.

<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>.  Document Conventions</span>

   The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;,
   &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;NOT RECOMMENDED&quot;, &quot;MAY&quot;, and
   &quot;OPTIONAL&quot; in this document are to be interpreted as described in
   <a href="/doc/html/bcp14">BCP 14</a> [<a href="/doc/html/rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>] [<a href="/doc/html/rfc8174" title="&quot;Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words&quot;">RFC8174</a>] when, and only when, they appear in all
   capitals, as shown here.

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>.  New Diffie-Hellman Key Exchange Methods</span>

   This document adopts the same naming convention defined in [<a href="/doc/html/rfc4462" title="&quot;Generic Security Service Application Program Interface (GSS-API) Authentication and Key Exchange for the Secure Shell (SSH) Protocol&quot;">RFC4462</a>]
   to define families of methods that cover any GSS-API mechanism used
   with a specific Diffie-Hellman group and SHA-2 hash combination.

       +--------------------------+--------------------------------+
       | Key Exchange Method Name | Implementation Recommendations |
       +==========================+================================+
       | gss-group14-sha256-*     | SHOULD/RECOMMENDED             |
       +--------------------------+--------------------------------+
       | gss-group15-sha512-*     | MAY/OPTIONAL                   |
       +--------------------------+--------------------------------+
       | gss-group16-sha512-*     | SHOULD/RECOMMENDED             |
       +--------------------------+--------------------------------+
       | gss-group17-sha512-*     | MAY/OPTIONAL                   |
       +--------------------------+--------------------------------+
       | gss-group18-sha512-*     | MAY/OPTIONAL                   |
       +--------------------------+--------------------------------+

                    Table 1: New Key Exchange Algorithms

   Each key exchange method prefix is registered by this document.  The
   IESG is the change controller of all these key exchange methods; this
   does NOT imply that the IESG is considered to be in control of the
   corresponding GSS-API mechanism.

   Each method in any family of methods (Table 2) specifies GSS-API-
   authenticated Diffie-Hellman key exchanges as described in
   <a href="/doc/html/rfc4462#section-2.1">Section&nbsp;2.1 of [RFC4462]</a>.  The method name for each method (Table 1)
   is the concatenation of the family name prefix with the base64
   encoding of the MD5 hash [<a href="/doc/html/rfc1321" title="&quot;The MD5 Message-Digest Algorithm&quot;">RFC1321</a>] of the ASN.1 DER encoding
   [<a href="#ref-ISO-IEC-8825-1">ISO-IEC-8825-1</a>] of the corresponding GSS-API mechanism&#x27;s OID.
   Base64 encoding is described in <a href="/doc/html/rfc4648#section-4">Section&nbsp;4 of [RFC4648]</a>.

     +---------------------+---------------+----------+--------------+
     | Family Name Prefix  | Hash Function | Group    | Reference    |
     +=====================+===============+==========+==============+
     | gss-group14-sha256- | SHA-256       | 2048-bit | <a href="#section-3">Section 3</a> of |
     |                     |               | MODP     | [<a href="/doc/html/rfc3526" title="&quot;More Modular Exponential (MODP) Diffie-Hellman groups for Internet Key Exchange (IKE)&quot;">RFC3526</a>]    |
     +---------------------+---------------+----------+--------------+
     | gss-group15-sha512- | SHA-512       | 3072-bit | <a href="#section-4">Section 4</a> of |
     |                     |               | MODP     | [<a href="/doc/html/rfc3526" title="&quot;More Modular Exponential (MODP) Diffie-Hellman groups for Internet Key Exchange (IKE)&quot;">RFC3526</a>]    |
     +---------------------+---------------+----------+--------------+
     | gss-group16-sha512- | SHA-512       | 4096-bit | <a href="#section-5">Section 5</a> of |
     |                     |               | MODP     | [<a href="/doc/html/rfc3526" title="&quot;More Modular Exponential (MODP) Diffie-Hellman groups for Internet Key Exchange (IKE)&quot;">RFC3526</a>]    |
     +---------------------+---------------+----------+--------------+
     | gss-group17-sha512- | SHA-512       | 6144-bit | <a href="#section-6">Section 6</a> of |
     |                     |               | MODP     | [<a href="/doc/html/rfc3526" title="&quot;More Modular Exponential (MODP) Diffie-Hellman groups for Internet Key Exchange (IKE)&quot;">RFC3526</a>]    |
     +---------------------+---------------+----------+--------------+
     | gss-group18-sha512- | SHA-512       | 8192-bit | <a href="#section-7">Section 7</a> of |
     |                     |               | MODP     | [<a href="/doc/html/rfc3526" title="&quot;More Modular Exponential (MODP) Diffie-Hellman groups for Internet Key Exchange (IKE)&quot;">RFC3526</a>]    |
     +---------------------+---------------+----------+--------------+

                     Table 2: Family Method References

<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>.  New Elliptic Curve Diffie-Hellman Key Exchange Methods</span>

   In [<a href="/doc/html/rfc5656" title="&quot;Elliptic Curve Algorithm Integration in the Secure Shell Transport Layer&quot;">RFC5656</a>], new SSH key exchange algorithms based on elliptic curve
   cryptography are introduced.  We reuse much of <a href="/doc/html/rfc5656#section-4">Section&nbsp;4 of [RFC5656]</a>
   to define GSS-API-authenticated Elliptic Curve Diffie-Hellman (ECDH)
   key exchanges.

   Additionally, we also utilize the curves defined in [<a href="/doc/html/rfc8731" title="&quot;Secure Shell (SSH) Key Exchange Method Using Curve25519 and Curve448&quot;">RFC8731</a>] to
   complement the three classic NIST-defined curves required by
   [<a href="/doc/html/rfc5656" title="&quot;Elliptic Curve Algorithm Integration in the Secure Shell Transport Layer&quot;">RFC5656</a>].

<span class="h3"><a class="selflink" id="section-5.1" href="#section-5.1">5.1</a>.  Generic GSS-API Key Exchange with ECDH</span>

   This section reuses much of the scheme defined in <a href="/doc/html/rfc4462#section-2.1">Section&nbsp;2.1 of
   [RFC4462]</a> and combines it with the scheme defined in <a href="/doc/html/rfc5656#section-4">Section&nbsp;4 of
   [RFC5656]</a>; in particular, all checks and verification steps
   prescribed in <a href="/doc/html/rfc5656#section-4">Section&nbsp;4 of [RFC5656]</a> apply here as well.

   The key-agreement schemes &quot;ECDHE-Curve25519&quot; and &quot;ECDHE-Curve448&quot;
   perform the Diffie-Hellman protocol using the functions X25519 and
   X448, respectively.  Implementations MUST compute these functions
   using the algorithms described in [<a href="/doc/html/rfc7748" title="&quot;Elliptic Curves for Security&quot;">RFC7748</a>].  When they do so,
   implementations MUST check whether the computed Diffie-Hellman shared
   secret is the all-zero value and abort if so, as described in
   <a href="/doc/html/rfc7748#section-6">Section&nbsp;6 of [RFC7748]</a>.  Alternative implementations of these
   functions SHOULD abort when either the client or the server input
   forces the shared secret to one of a small set of values, as
   described in Sections <a href="#section-6">6</a> and <a href="#section-7">7</a> of [<a href="/doc/html/rfc7748" title="&quot;Elliptic Curves for Security&quot;">RFC7748</a>].

   This section defers to [<a href="/doc/html/rfc7546" title="&quot;Structure of the Generic Security Service (GSS) Negotiation Loop&quot;">RFC7546</a>] as the source of information on GSS-
   API context establishment operations, <a href="#section-3">Section 3</a> being the most
   relevant.  All security considerations described in [<a href="/doc/html/rfc7546" title="&quot;Structure of the Generic Security Service (GSS) Negotiation Loop&quot;">RFC7546</a>] apply
   here, too.

   The parties each generate an ephemeral key pair, according to
   Section 3.2.1 of [<a href="#ref-SEC1v2" title="&quot;SEC 1: Elliptic Curve Cryptography&quot;">SEC1v2</a>].  Keys are verified upon receipt by the
   parties according to Section 3.2.3.1 of [<a href="#ref-SEC1v2" title="&quot;SEC 1: Elliptic Curve Cryptography&quot;">SEC1v2</a>].

   For NIST curves, the keys use the uncompressed point representation
   and MUST be converted using the algorithm in Section 2.3.4 of
   [<a href="#ref-SEC1v2" title="&quot;SEC 1: Elliptic Curve Cryptography&quot;">SEC1v2</a>].  If the conversion fails or the point is transmitted using
   the compressed representation, the key exchange MUST fail.

   A GSS context is established according to <a href="/doc/html/rfc5656#section-4">Section&nbsp;4 of [RFC5656]</a>; the
   client initiates the establishment using GSS_Init_sec_context(), and
   the server responds to it using GSS_Accept_sec_context().  For the
   negotiation, the client MUST set mutual_req_flag and integ_req_flag
   to &quot;true&quot;.  In addition, deleg_req_flag MAY be set to &quot;true&quot; to
   request access delegation, if requested by the user.  Since the key
   exchange process authenticates only the host, the setting of
   anon_req_flag is immaterial to this process.  If the client does not
   support the &quot;gssapi-keyex&quot; user authentication method described in
   <a href="/doc/html/rfc4462#section-4">Section&nbsp;4 of [RFC4462]</a>, or does not intend to use that method in
   conjunction with the GSS-API context established during key exchange,
   then anon_req_flag SHOULD be set to &quot;true&quot;.  Otherwise, this flag MAY
   be set to &quot;true&quot; if the client wishes to hide its identity.  This key
   exchange process will exchange only a single message token once the
   context has been established; therefore, the replay_det_req_flag and
   sequence_req_flag SHOULD be set to &quot;false&quot;.

   The client MUST include its public key with the first message it
   sends to the server during this process; if the server receives more
   than one key or none at all, the key exchange MUST fail.

   During GSS context establishment, multiple tokens may be exchanged by
   the client and the server.  When the GSS context is established
   (major_status is GSS_S_COMPLETE), the parties check that mutual_state
   and integ_avail are both &quot;true&quot;.  If not, the key exchange MUST fail.

   Once a party receives the peer&#x27;s public key, it proceeds to compute a
   shared secret K.  For NIST curves, the computation is done according
   to Section 3.3.1 of [<a href="#ref-SEC1v2" title="&quot;SEC 1: Elliptic Curve Cryptography&quot;">SEC1v2</a>], and the resulting value z is converted
   to the octet string K using the conversion defined in Section 2.3.5
   of [<a href="#ref-SEC1v2" title="&quot;SEC 1: Elliptic Curve Cryptography&quot;">SEC1v2</a>].  For curve25519 and curve448, the algorithms in
   <a href="/doc/html/rfc7748#section-6">Section&nbsp;6 of [RFC7748]</a> are used instead.

   To verify the integrity of the handshake, peers use the hash function
   defined by the selected key exchange method to calculate H:

   H = hash(V_C || V_S || I_C || I_S || K_S || Q_C || Q_S || K).

   The server uses the GSS_GetMIC() call with H as the payload to
   generate a Message Integrity Code (MIC).  The GSS_VerifyMIC() call is
   used by the client to verify the MIC.

   If any GSS_Init_sec_context() or GSS_Accept_sec_context() returns a
   major_status other than GSS_S_COMPLETE or GSS_S_CONTINUE_NEEDED, or
   any other GSS-API call returns a major_status other than
   GSS_S_COMPLETE, the key exchange MUST fail.  The same recommendations
   expressed in <a href="/doc/html/rfc4462#section-2.1">Section&nbsp;2.1 of [RFC4462]</a> are followed with regard to
   error reporting.

   The following is an overview of the key exchange process:

       Client                                                Server
       ------                                                ------
       Generates ephemeral key pair.
       Calls GSS_Init_sec_context().
       SSH_MSG_KEXGSS_INIT  ---------------&gt;

                                              Verifies received key.
   (Optional)                  &lt;------------- SSH_MSG_KEXGSS_HOSTKEY

   (Loop)
   |                                 Calls GSS_Accept_sec_context().
   |                           &lt;------------ SSH_MSG_KEXGSS_CONTINUE
   |   Calls GSS_Init_sec_context().
   |   SSH_MSG_KEXGSS_CONTINUE ------------&gt;

                                     Calls GSS_Accept_sec_context().
                                       Generates ephemeral key pair.
                                             Computes shared secret.
                                                    Computes hash H.
                                        Calls GSS_GetMIC( H ) = MIC.
                               &lt;------------ SSH_MSG_KEXGSS_COMPLETE

       Verifies received key.
       Computes shared secret.
       Computes hash H.
       Calls GSS_VerifyMIC( MIC, H ).

   This is implemented with the following messages:

   The client sends:

       byte      SSH_MSG_KEXGSS_INIT
       string    output_token (from GSS_Init_sec_context())
       string    Q_C, client&#x27;s ephemeral public key octet string

   The server may respond with:

       byte     SSH_MSG_KEXGSS_HOSTKEY
       string   server public host key and certificates (K_S)

   The server sends:

       byte     SSH_MSG_KEXGSS_CONTINUE
       string   output_token (from GSS_Accept_sec_context())

   Each time the client receives the message described above, it makes
   another call to GSS_Init_sec_context().

   The client sends:

       byte      SSH_MSG_KEXGSS_CONTINUE
       string    output_token (from GSS_Init_sec_context())

   As the final message, the server sends the following if an
   output_token is produced:

       byte      SSH_MSG_KEXGSS_COMPLETE
       string    Q_S, server&#x27;s ephemeral public key octet string
       string    mic_token (MIC of H)
       boolean   TRUE
       string    output_token (from GSS_Accept_sec_context())

   If no output_token is produced, the server sends:

       byte      SSH_MSG_KEXGSS_COMPLETE
       string    Q_S, server&#x27;s ephemeral public key octet string
       string    mic_token (MIC of H)
       boolean   FALSE

   The hash H is computed as the HASH hash of the concatenation of the
   following:

       string    V_C, the client&#x27;s version string (CR, NL excluded)
       string    V_S, server&#x27;s version string (CR, NL excluded)
       string    I_C, payload of the client&#x27;s SSH_MSG_KEXINIT
       string    I_S, payload of the server&#x27;s SSH_MSG_KEXINIT
       string    K_S, server&#x27;s public host key
       string    Q_C, client&#x27;s ephemeral public key octet string
       string    Q_S, server&#x27;s ephemeral public key octet string
       mpint     K,   shared secret

   This value is called the &quot;exchange hash&quot;, and it is used to
   authenticate the key exchange.  The exchange hash SHOULD be kept
   secret.  If no SSH_MSG_KEXGSS_HOSTKEY message has been sent by the
   server or received by the client, then the empty string is used in
   place of K_S when computing the exchange hash.

   Since this key exchange method does not require the host key to be
   used for any encryption operations, the SSH_MSG_KEXGSS_HOSTKEY
   message is OPTIONAL.  If the &quot;null&quot; host key algorithm described in
   <a href="/doc/html/rfc4462#section-5">Section&nbsp;5 of [RFC4462]</a> is used, this message MUST NOT be sent.

   If the client receives an SSH_MSG_KEXGSS_CONTINUE message after a
   call to GSS_Init_sec_context() has returned a major_status code of
   GSS_S_COMPLETE, a protocol error has occurred, and the key exchange
   MUST fail.

   If the client receives an SSH_MSG_KEXGSS_COMPLETE message and a call
   to GSS_Init_sec_context() does not result in a major_status code of
   GSS_S_COMPLETE, a protocol error has occurred, and the key exchange
   MUST fail.

<span class="h3"><a class="selflink" id="section-5.2" href="#section-5.2">5.2</a>.  ECDH Key Exchange Methods</span>

       +--------------------------+--------------------------------+
       | Key Exchange Method Name | Implementation Recommendations |
       +==========================+================================+
       | gss-nistp256-sha256-*    | SHOULD/RECOMMENDED             |
       +--------------------------+--------------------------------+
       | gss-nistp384-sha384-*    | MAY/OPTIONAL                   |
       +--------------------------+--------------------------------+
       | gss-nistp521-sha512-*    | MAY/OPTIONAL                   |
       +--------------------------+--------------------------------+
       | gss-curve25519-sha256-*  | SHOULD/RECOMMENDED             |
       +--------------------------+--------------------------------+
       | gss-curve448-sha512-*    | MAY/OPTIONAL                   |
       +--------------------------+--------------------------------+

                     Table 3: New Key Exchange Methods

   Each key exchange method prefix is registered by this document.  The
   IESG is the change controller of all these key exchange methods; this
   does NOT imply that the IESG is considered to be in control of the
   corresponding GSS-API mechanism.

   Each method in any family of methods (Table 4) specifies GSS-API-
   authenticated Elliptic Curve Diffie-Hellman key exchanges as
   described in <a href="#section-5.1">Section 5.1</a>.  The method name for each method (Table 3)
   is the concatenation of the family method name with the base64
   encoding of the MD5 hash [<a href="/doc/html/rfc1321" title="&quot;The MD5 Message-Digest Algorithm&quot;">RFC1321</a>] of the ASN.1 DER encoding
   [<a href="#ref-ISO-IEC-8825-1">ISO-IEC-8825-1</a>] of the corresponding GSS-API mechanism&#x27;s OID.
   Base64 encoding is described in <a href="/doc/html/rfc4648#section-4">Section&nbsp;4 of [RFC4648]</a>.

   +------------------------+----------+---------------+---------------+
   | Family Name Prefix     | Hash     | Parameters /  | Definition    |
   |                        | Function | Function Name |               |
   +========================+==========+===============+===============+
   | gss-nistp256-sha256-   | SHA-256  | secp256r1     | Section       |
   |                        |          |               | 2.4.2 of      |
   |                        |          |               | [<a href="#ref-SEC2v2" title="&quot;SEC 2: Recommended Elliptic Curve Domain Parameters&quot;">SEC2v2</a>]      |
   +------------------------+----------+---------------+---------------+
   | gss-nistp384-sha384-   | SHA-384  | secp384r1     | Section       |
   |                        |          |               | 2.5.1 of      |
   |                        |          |               | [<a href="#ref-SEC2v2" title="&quot;SEC 2: Recommended Elliptic Curve Domain Parameters&quot;">SEC2v2</a>]      |
   +------------------------+----------+---------------+---------------+
   | gss-nistp521-sha512-   | SHA-512  | secp521r1     | Section       |
   |                        |          |               | 2.6.1 of      |
   |                        |          |               | [<a href="#ref-SEC2v2" title="&quot;SEC 2: Recommended Elliptic Curve Domain Parameters&quot;">SEC2v2</a>]      |
   +------------------------+----------+---------------+---------------+
   | gss-curve25519-sha256- | SHA-256  | X22519        | <a href="#section-5">Section 5</a>     |
   |                        |          |               | of            |
   |                        |          |               | [<a href="/doc/html/rfc7748" title="&quot;Elliptic Curves for Security&quot;">RFC7748</a>]     |
   +------------------------+----------+---------------+---------------+
   | gss-curve448-sha512-   | SHA-512  | X448          | <a href="#section-5">Section 5</a>     |
   |                        |          |               | of            |
   |                        |          |               | [<a href="/doc/html/rfc7748" title="&quot;Elliptic Curves for Security&quot;">RFC7748</a>]     |
   +------------------------+----------+---------------+---------------+

                     Table 4: Family Method References

<span class="h2"><a class="selflink" id="section-6" href="#section-6">6</a>.  Deprecated Algorithms</span>

   Because they have small key lengths and are no longer strong in the
   face of brute-force attacks, the algorithms in the following table
   are considered deprecated and SHOULD NOT be used.

       +--------------------------+--------------------------------+
       | Key Exchange Method Name | Implementation Recommendations |
       +==========================+================================+
       | gss-group1-sha1-*        | SHOULD NOT                     |
       +--------------------------+--------------------------------+
       | gss-group14-sha1-*       | SHOULD NOT                     |
       +--------------------------+--------------------------------+
       | gss-gex-sha1-*           | SHOULD NOT                     |
       +--------------------------+--------------------------------+

                       Table 5: Deprecated Algorithms

<span class="h2"><a class="selflink" id="section-7" href="#section-7">7</a>.  IANA Considerations</span>

   This document augments the SSH key exchange message names that were
   defined in [<a href="/doc/html/rfc4462" title="&quot;Generic Security Service Application Program Interface (GSS-API) Authentication and Key Exchange for the Secure Shell (SSH) Protocol&quot;">RFC4462</a>] (see and <a href="#section-6">Section 6</a>); IANA has listed this
   document as reference for those entries in the &quot;SSH Protocol
   Parameters&quot; [<a href="#ref-IANA-KEX-NAMES">IANA-KEX-NAMES</a>] registry.

   In addition, IANA has updated the registry to include the SSH key
   exchange message names described in Sections <a href="#section-4">4</a> and <a href="#section-5">5</a>.

                 +--------------------------+-----------+
                 | Key Exchange Method Name | Reference |
                 +==========================+===========+
                 | gss-group1-sha1-*        | <a href="/doc/html/rfc8732">RFC 8732</a>  |
                 +--------------------------+-----------+
                 | gss-group14-sha1-*       | <a href="/doc/html/rfc8732">RFC 8732</a>  |
                 +--------------------------+-----------+
                 | gss-gex-sha1-*           | <a href="/doc/html/rfc8732">RFC 8732</a>  |
                 +--------------------------+-----------+
                 | gss-group14-sha256-*     | <a href="/doc/html/rfc8732">RFC 8732</a>  |
                 +--------------------------+-----------+
                 | gss-group15-sha512-*     | <a href="/doc/html/rfc8732">RFC 8732</a>  |
                 +--------------------------+-----------+
                 | gss-group16-sha512-*     | <a href="/doc/html/rfc8732">RFC 8732</a>  |
                 +--------------------------+-----------+
                 | gss-group17-sha512-*     | <a href="/doc/html/rfc8732">RFC 8732</a>  |
                 +--------------------------+-----------+
                 | gss-group18-sha512-*     | <a href="/doc/html/rfc8732">RFC 8732</a>  |
                 +--------------------------+-----------+
                 | gss-nistp256-sha256-*    | <a href="/doc/html/rfc8732">RFC 8732</a>  |
                 +--------------------------+-----------+
                 | gss-nistp384-sha384-*    | <a href="/doc/html/rfc8732">RFC 8732</a>  |
                 +--------------------------+-----------+
                 | gss-nistp521-sha512-*    | <a href="/doc/html/rfc8732">RFC 8732</a>  |
                 +--------------------------+-----------+
                 | gss-curve25519-sha256-*  | <a href="/doc/html/rfc8732">RFC 8732</a>  |
                 +--------------------------+-----------+
                 | gss-curve448-sha512-*    | <a href="/doc/html/rfc8732">RFC 8732</a>  |
                 +--------------------------+-----------+

                    Table 6: Additions/Changes to the
                    Key Exchange Method Names Registry

<span class="h2"><a class="selflink" id="section-8" href="#section-8">8</a>.  Security Considerations</span>

<span class="h3"><a class="selflink" id="section-8.1" href="#section-8.1">8.1</a>.  New Finite Field DH Mechanisms</span>

   Except for the use of a different secure hash function and larger DH
   groups, no significant changes have been made to the protocol
   described by [<a href="/doc/html/rfc4462" title="&quot;Generic Security Service Application Program Interface (GSS-API) Authentication and Key Exchange for the Secure Shell (SSH) Protocol&quot;">RFC4462</a>]; therefore, all the original security
   considerations apply.

<span class="h3"><a class="selflink" id="section-8.2" href="#section-8.2">8.2</a>.  New Elliptic Curve DH Mechanisms</span>

   Although a new cryptographic primitive is used with these methods,
   the actual key exchange closely follows the key exchange defined in
   [<a href="/doc/html/rfc5656" title="&quot;Elliptic Curve Algorithm Integration in the Secure Shell Transport Layer&quot;">RFC5656</a>]; therefore, all the original security considerations, as
   well as those expressed in [<a href="/doc/html/rfc5656" title="&quot;Elliptic Curve Algorithm Integration in the Secure Shell Transport Layer&quot;">RFC5656</a>], apply.

<span class="h3"><a class="selflink" id="section-8.3" href="#section-8.3">8.3</a>.  GSS-API Delegation</span>

   Some GSS-API mechanisms can act on a request to delegate credentials
   to the target host when the deleg_req_flag is set.  In this case,
   extra care must be taken to ensure that the acceptor being
   authenticated matches the target the user intended.  Some mechanism
   implementations (such as commonly used krb5 libraries) may use
   insecure DNS resolution to canonicalize the target name; in these
   cases, spoofing a DNS response that points to an attacker-controlled
   machine may result in the user silently delegating credentials to the
   attacker, who can then impersonate the user at will.

<span class="h2"><a class="selflink" id="section-9" href="#section-9">9</a>.  References</span>

<span class="h3"><a class="selflink" id="section-9.1" href="#section-9.1">9.1</a>.  Normative References</span>

   [<a id="ref-RFC1321">RFC1321</a>]  Rivest, R., &quot;The MD5 Message-Digest Algorithm&quot;, <a href="/doc/html/rfc1321">RFC 1321</a>,
              DOI 10.17487/RFC1321, April 1992,
              &lt;<a href="https://www.rfc-editor.org/info/rfc1321">https://www.rfc-editor.org/info/rfc1321</a>&gt;.

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., &quot;Key words for use in RFCs to Indicate
              Requirement Levels&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc2119">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC2743">RFC2743</a>]  Linn, J., &quot;Generic Security Service Application Program
              Interface Version 2, Update 1&quot;, <a href="/doc/html/rfc2743">RFC 2743</a>,
              DOI 10.17487/RFC2743, January 2000,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2743">https://www.rfc-editor.org/info/rfc2743</a>&gt;.

   [<a id="ref-RFC3526">RFC3526</a>]  Kivinen, T. and M. Kojo, &quot;More Modular Exponential (MODP)
              Diffie-Hellman groups for Internet Key Exchange (IKE)&quot;,
              <a href="/doc/html/rfc3526">RFC 3526</a>, DOI 10.17487/RFC3526, May 2003,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3526">https://www.rfc-editor.org/info/rfc3526</a>&gt;.

   [<a id="ref-RFC4462">RFC4462</a>]  Hutzelman, J., Salowey, J., Galbraith, J., and V. Welch,
              &quot;Generic Security Service Application Program Interface
              (GSS-API) Authentication and Key Exchange for the Secure
              Shell (SSH) Protocol&quot;, <a href="/doc/html/rfc4462">RFC 4462</a>, DOI 10.17487/RFC4462, May
              2006, &lt;<a href="https://www.rfc-editor.org/info/rfc4462">https://www.rfc-editor.org/info/rfc4462</a>&gt;.

   [<a id="ref-RFC4648">RFC4648</a>]  Josefsson, S., &quot;The Base16, Base32, and Base64 Data
              Encodings&quot;, <a href="/doc/html/rfc4648">RFC 4648</a>, DOI 10.17487/RFC4648, October 2006,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4648">https://www.rfc-editor.org/info/rfc4648</a>&gt;.

   [<a id="ref-RFC5656">RFC5656</a>]  Stebila, D. and J. Green, &quot;Elliptic Curve Algorithm
              Integration in the Secure Shell Transport Layer&quot;,
              <a href="/doc/html/rfc5656">RFC 5656</a>, DOI 10.17487/RFC5656, December 2009,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5656">https://www.rfc-editor.org/info/rfc5656</a>&gt;.

   [<a id="ref-RFC7546">RFC7546</a>]  Kaduk, B., &quot;Structure of the Generic Security Service
              (GSS) Negotiation Loop&quot;, <a href="/doc/html/rfc7546">RFC 7546</a>, DOI 10.17487/RFC7546,
              May 2015, &lt;<a href="https://www.rfc-editor.org/info/rfc7546">https://www.rfc-editor.org/info/rfc7546</a>&gt;.

   [<a id="ref-RFC7748">RFC7748</a>]  Langley, A., Hamburg, M., and S. Turner, &quot;Elliptic Curves
              for Security&quot;, <a href="/doc/html/rfc7748">RFC 7748</a>, DOI 10.17487/RFC7748, January
              2016, &lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;.

   [<a id="ref-RFC8174">RFC8174</a>]  Leiba, B., &quot;Ambiguity of Uppercase vs Lowercase in <a href="/doc/html/rfc2119">RFC</a>
              <a href="/doc/html/rfc2119">2119</a> Key Words&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc8174">RFC 8174</a>, DOI 10.17487/RFC8174,
              May 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.

   [<a id="ref-RFC8731">RFC8731</a>]  Adamantiadis, A., Josefsson, S., and M. Baushke, &quot;Secure
              Shell (SSH) Key Exchange Method Using Curve25519 and
              Curve448&quot;, <a href="/doc/html/rfc8731">RFC 8731</a>, DOI 10.17487/RFC8731, February 2020,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8731">https://www.rfc-editor.org/info/rfc8731</a>&gt;.

   [<a id="ref-SEC1v2">SEC1v2</a>]   Standards for Efficient Cryptography Group, &quot;SEC 1:
              Elliptic Curve Cryptography&quot;, Version 2.0, May 2009.

   [<a id="ref-SEC2v2">SEC2v2</a>]   Standards for Elliptic Cryptography Group, &quot;SEC 2:
              Recommended Elliptic Curve Domain Parameters&quot;,
              Version 2.0, January 2010.

<span class="h3"><a class="selflink" id="section-9.2" href="#section-9.2">9.2</a>.  Informative References</span>

   [<a id="ref-IANA-KEX-NAMES">IANA-KEX-NAMES</a>]
              IANA, &quot;Secure Shell (SSH) Protocol Parameters: Key
              Exchange Method Names&quot;,
              &lt;<a href="https://www.iana.org/assignments/ssh-parameters/">https://www.iana.org/assignments/ssh-parameters/</a>&gt;.

   [<a id="ref-ISO-IEC-8825-1">ISO-IEC-8825-1</a>]
              ITU-T, &quot;Information technology -- ASN.1 encoding rules:
              Specification of Basic Encoding Rules (BER), Canonical
              Encoding Rules (CER) and Distinguished Encoding Rules
              (DER)&quot;, ISO/IEC 8825-1:2015, ITU-T Recommendation X.690,
              November 2015,
              &lt;<a href="http://standards.iso.org/ittf/PubliclyAvailableStandards/c068345_ISO_IEC_8825-1_2015.zip">http://standards.iso.org/ittf/PubliclyAvailableStandards/</a>
              <a href="http://standards.iso.org/ittf/PubliclyAvailableStandards/c068345_ISO_IEC_8825-1_2015.zip">c068345_ISO_IEC_8825-1_2015.zip</a>&gt;.

   [<a id="ref-NIST-SP-800-131Ar2">NIST-SP-800-131Ar2</a>]
              National Institute of Standards and Technology,
              &quot;Transitioning of the Use of Cryptographic Algorithms and
              Key Lengths&quot;, DOI 10.6028/NIST.SP.800-131Ar2, NIST Special
              Publication 800-131A Revision 2, November 2015,
              &lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar2.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/</a>
              <a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar2.pdf">NIST.SP.800-131Ar2.pdf</a>&gt;.

   [<a id="ref-RFC6194">RFC6194</a>]  Polk, T., Chen, L., Turner, S., and P. Hoffman, &quot;Security
              Considerations for the SHA-0 and SHA-1 Message-Digest
              Algorithms&quot;, <a href="/doc/html/rfc6194">RFC 6194</a>, DOI 10.17487/RFC6194, March 2011,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6194">https://www.rfc-editor.org/info/rfc6194</a>&gt;.

   [<a id="ref-RFC6234">RFC6234</a>]  Eastlake 3rd, D. and T. Hansen, &quot;US Secure Hash Algorithms
              (SHA and SHA-based HMAC and HKDF)&quot;, <a href="/doc/html/rfc6234">RFC 6234</a>,
              DOI 10.17487/RFC6234, May 2011,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6234">https://www.rfc-editor.org/info/rfc6234</a>&gt;.

   [<a id="ref-RFC8268">RFC8268</a>]  Baushke, M., &quot;More Modular Exponentiation (MODP) Diffie-
              Hellman (DH) Key Exchange (KEX) Groups for Secure Shell
              (SSH)&quot;, <a href="/doc/html/rfc8268">RFC 8268</a>, DOI 10.17487/RFC8268, December 2017,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8268">https://www.rfc-editor.org/info/rfc8268</a>&gt;.

Authors&#x27; Addresses

   Simo Sorce
   Red Hat, Inc.
   140 Broadway, 24th Floor
   New York, NY 10025
   United States of America

   Email: simo@redhat.com


   Hubert Kario
   Red Hat, Inc.
   Purkynova 115
   612 00 Brno
   Czech Republic

   Email: hkario@redhat.com
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

