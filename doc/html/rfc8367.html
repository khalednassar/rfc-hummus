<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    rfc8367
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.33.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.33.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/rfc8367/">
  <meta name="description" content="Wrongful Termination of Internet Protocol (IP) Packets (RFC )">
  <script src="https://www.ietf.org/lib/dt/7.33.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.33.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.33.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.33.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bgorange"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc8367.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc8367.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/pdfrfc/rfc8367.txt.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/rfc8367/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/rfc8367/" title="Datatracker information for this document">Tracker</a>] [<a href="mailto:rfc8367@ietf.org?subject=rfc8367" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=rfc8367-.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=rfc8367-.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/rfc8367-.txt" title="Run an idnits check of this document">Nits</a>]

                                                           Informational</pre>
      </div>
    

    <div class="draftcontent">
    <pre>Independent Submission                                        T. Mizrahi
Request for Comments: 8367                                       Marvell
Category: Informational                                       J. Yallouz
ISSN: 2070-1721                                                    Intel
                                                            1 April 2018


         <span class="h1">Wrongful Termination of Internet Protocol (IP) Packets</span>

Abstract

   Routers and middleboxes terminate packets for various reasons.  In
   some cases, these packets are wrongfully terminated.  This memo
   describes some of the most common scenarios of wrongful termination
   of Internet Protocol (IP) packets and presents recommendations for
   mitigating them.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This is a contribution to the RFC Series, independently of any other
   RFC stream.  The RFC Editor has chosen to publish this document at
   its discretion and makes no statement about its value for
   implementation or deployment.  Documents approved for publication by
   the RFC Editor are not candidates for any level of Internet Standard;
   see <a href="/doc/html/rfc7841#section-2">Section&nbsp;2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="https://www.rfc-editor.org/info/rfc8367">https://www.rfc-editor.org/info/rfc8367</a>.

Copyright Notice

   Copyright (c) 2018 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="/doc/html/bcp78">BCP 78</a> and the IETF Trust&#x27;s Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.







<span class="grey">Mizrahi &amp; Yallouz             Informational                     [Page 1]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-2" ></span>
<span class="grey"><a href="/doc/html/rfc8367">RFC 8367</a>           Wrongful Termination of IP Packets       1 April 2018</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ................................................... <a href="#page-2">2</a>
   <a href="#section-2">2</a>. Abbreviations .................................................. <a href="#page-2">2</a>
   <a href="#section-3">3</a>. Wrongful Termination Scenarios ................................. <a href="#page-3">3</a>
      <a href="#section-3.1">3.1</a>. Color-Based Termination ................................... <a href="#page-3">3</a>
      <a href="#section-3.2">3.2</a>. Age-Based Termination ..................................... <a href="#page-3">3</a>
      <a href="#section-3.3">3.3</a>. Origin-Based Termination .................................. <a href="#page-4">4</a>
      <a href="#section-3.4">3.4</a>. Length-Based Termination .................................. <a href="#page-4">4</a>
      <a href="#section-3.5">3.5</a>. IP-Version-Based Termination .............................. <a href="#page-5">5</a>
      <a href="#section-3.6">3.6</a>. Flag-Based Termination .................................... <a href="#page-5">5</a>
   <a href="#section-4">4</a>. Security Considerations ........................................ <a href="#page-5">5</a>
   <a href="#section-5">5</a>. IANA Considerations ............................................ <a href="#page-5">5</a>
   <a href="#section-6">6</a>. Conclusion ..................................................... <a href="#page-6">6</a>
   <a href="#section-7">7</a>. References ..................................................... <a href="#page-6">6</a>
      <a href="#section-7.1">7.1</a>. Normative References ...................................... <a href="#page-6">6</a>
      <a href="#section-7.2">7.2</a>. Informative References .................................... <a href="#page-6">6</a>
   Authors&#x27; Addresses ................................................ <a href="#page-6">6</a>

<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>.  Introduction</span>

   IP packets are often terminated by network devices.  In some cases,
   control-plane packets are terminated and processed by the local
   device, while in other cases packets are terminated (discarded) due
   to a packet filtering mechanism.  Packet filtering is widely employed
   in network devices for sanity checking, policy enforcement, and
   security.  IP routers and middleboxes, such as firewalls, often
   terminate packets that do not comply with a predefined policy.
   Unfortunately, some filtering policies cause false positive or
   unnecessary packet termination.  Moreover, these wrongful
   terminations are sometimes biased and discriminate against packets
   based on their color, age, origin, length, or IP version.

   This memo discusses some of the most common scenarios of wrongful
   termination of IP packets and presents recommendations for preventing
   such discrimination.

<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  Abbreviations</span>

   IP    Internet Protocol

   TTL   Time To Live

   OAM   Operations, Administration, and Maintenance







<span class="grey">Mizrahi &amp; Yallouz             Informational                     [Page 2]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-3" ></span>
<span class="grey"><a href="/doc/html/rfc8367">RFC 8367</a>           Wrongful Termination of IP Packets       1 April 2018</span>


<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>.  Wrongful Termination Scenarios</span>

<span class="h3"><a class="selflink" id="section-3.1" href="#section-3.1">3.1</a>.  Color-Based Termination</span>

   Synopsis

      IP packets are terminated due to their color.

   Description

      Routers often employ metering mechanisms [<a href="/doc/html/rfc4115" title="&quot;A Differentiated Service Two-Rate, Three-Color Marker with Efficient Handling of in-Profile Traffic&quot;">RFC4115</a>].  These
      mechanisms often support a color-aware mode, in which the packet&#x27;s
      color (green, yellow, or red) is used as a criterion in the
      metering algorithm.  This mode has been known to prefer green
      packets over red and yellow packets.

   Recommendation

      Use of color-blind metering is recommended, as it allows equal
      opportunity for packets of different colors.

<span class="h3"><a class="selflink" id="section-3.2" href="#section-3.2">3.2</a>.  Age-Based Termination</span>

   Synopsis

      IP packets are terminated based on their TTL.

   Description

      The IPv4 TTL field [<a href="/doc/html/rfc791" title="&quot;Internet Protocol&quot;">RFC791</a>] and the IPv6 Hop Limit field [<a href="/doc/html/rfc8200" title="&quot;Internet Protocol, Version 6 (IPv6) Specification&quot;">RFC8200</a>]
      are used for loop prevention.  These fields essentially represent
      the packet&#x27;s age.  A router that receives an IP packet with a TTL
      value of 0 or 1 typically terminates the packet.  In this
      document, packets with a TTL or Hop Limit of 0 or 1 are referred
      to as &#x27;senior packets&#x27;.

   Recommendation

      When possible, the practice of reverse discrimination is
      recommended.  Notably, senior packets have been known to be highly
      effective for OAM tasks, such as Hello [<a href="/doc/html/rfc2328" title="&quot;OSPF Version 2&quot;">RFC2328</a>] and Traceroute
      [<a href="/doc/html/rfc2151" title="&quot;A Primer On Internet and TCP/IP Tools and Utilities&quot;">RFC2151</a>].  Therefore, senior packets should not be easily
      dismissed; to the extent possible, senior packets should be used
      in control-plane protocols.







<span class="grey">Mizrahi &amp; Yallouz             Informational                     [Page 3]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-4" ></span>
<span class="grey"><a href="/doc/html/rfc8367">RFC 8367</a>           Wrongful Termination of IP Packets       1 April 2018</span>


<span class="h3"><a class="selflink" id="section-3.3" href="#section-3.3">3.3</a>.  Origin-Based Termination</span>

   Synopsis

      IP packets are terminated based on their origin (source IP address
      prefix).

   Description

      Routers and middleboxes often perform IP address filtering.
      Packets are often discarded based on the prefix of their source IP
      address.  In this memo, prefix-based source address filtering is
      referred to as origin-based filtering.  While source IP address
      filtering is an acceptable technique for preventing security
      attacks performed by known attackers, filtering an entire prefix
      may lead to unnecessary termination of legitimate traffic.

   Recommendation

      Origin-based filtering should be limited, to the extent possible,
      so as not to punish an entire autonomous system for the crime of a
      single host.  Individual address-based filtering should be
      preferred in cases where the address of the potential threat is
      well known.

<span class="h3"><a class="selflink" id="section-3.4" href="#section-3.4">3.4</a>.  Length-Based Termination</span>

   Synopsis

      Short IP packets are wrongfully terminated due to their length.

   Description

      The minimum permissible size of an IPv4 [<a href="/doc/html/rfc791" title="&quot;Internet Protocol&quot;">RFC791</a>] packet is 20
      octets, and the minimum size of an IPv6 [<a href="/doc/html/rfc8200" title="&quot;Internet Protocol, Version 6 (IPv6) Specification&quot;">RFC8200</a>] packet is 40
      octets.  However, due to the size limits of Ethernet, it is often
      the case that IP packets that are shorter than 46 octets are
      discarded.  This is because the minimal Ethernet frame size is 64
      octets, the minimal Ethernet header size is 14 octets, and the
      Ethernet Frame Check Sequence is 4 octets long (i.e., 64 - 14 - 4
      = 46). In the context of this memo, legitimate IP packets that are
      less than 46 octets long are referred to as &#x27;short IP packets&#x27;.

   Recommendation

      Short IP packets should not be discarded.  The Ethernet frame
      length should be enforced at the Ethernet layer, while the IP
      layer should avoid discrimination of short IP packets.



<span class="grey">Mizrahi &amp; Yallouz             Informational                     [Page 4]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-5" ></span>
<span class="grey"><a href="/doc/html/rfc8367">RFC 8367</a>           Wrongful Termination of IP Packets       1 April 2018</span>


<span class="h3"><a class="selflink" id="section-3.5" href="#section-3.5">3.5</a>.  IP-Version-Based Termination</span>

   Synopsis

      IPv6 packets are terminated due to their version.

   Description

      Many routers and middleboxes are configured to process only IPv4
      [<a href="/doc/html/rfc791" title="&quot;Internet Protocol&quot;">RFC791</a>] packets and to reject IPv6 [<a href="/doc/html/rfc8200" title="&quot;Internet Protocol, Version 6 (IPv6) Specification&quot;">RFC8200</a>] packets.

   Recommendation

      It is quite unsettling that there are still networks in which IPv6
      packets are deemed unwanted in the second decade of the 21st
      century.  Indeed, IPv6 packets have a slightly shorter payload
      than IPv4 packets.  However, they are essential to the future
      growth of the Internet.  It is time for operators to finally give
      IPv6 its well-deserved opportunity.

<span class="h3"><a class="selflink" id="section-3.6" href="#section-3.6">3.6</a>.  Flag-Based Termination</span>

   Synopsis

      IPv4 packets are terminated because their More Fragments (MF) flag
      is set.

   Description

      Many routers and middleboxes are configured to discard fragmented
      packets.

   Recommendation

      A packet should not be discarded on the grounds of a flag it
      supports.  All flags should be respected, as well as the features
      they represent.

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>.  Security Considerations</span>

   This memo proposes to practice liberality with respect to IP packet
   filtering in routers and middleboxes.  Arguably, such a liberal
   approach may compromise security in some cases.  Not only must
   security be done; it must also be seen to be done.

<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>.  IANA Considerations</span>

   This document has no IANA actions.



<span class="grey">Mizrahi &amp; Yallouz             Informational                     [Page 5]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-6" ></span>
<span class="grey"><a href="/doc/html/rfc8367">RFC 8367</a>           Wrongful Termination of IP Packets       1 April 2018</span>


<span class="h2"><a class="selflink" id="section-6" href="#section-6">6</a>.  Conclusion</span>

   This memo recommends that every router and middlebox be an Equal
   Opportunity Device, which does not discriminate on the basis of
   actual or perceived rate, color, age, origin, length, IP version,
   fragmentation characteristics, higher-layer protocols, or any other
   IP characteristic.

<span class="h2"><a class="selflink" id="section-7" href="#section-7">7</a>.  References</span>

<span class="h3"><a class="selflink" id="section-7.1" href="#section-7.1">7.1</a>.  Normative References</span>

   [<a id="ref-RFC791">RFC791</a>]   Postel, J., &quot;Internet Protocol&quot;, STD 5, <a href="/doc/html/rfc791">RFC 791</a>,
              DOI 10.17487/RFC0791, September 1981,
              &lt;<a href="https://www.rfc-editor.org/info/rfc791">https://www.rfc-editor.org/info/rfc791</a>&gt;.

   [<a id="ref-RFC8200">RFC8200</a>]  Deering, S. and R. Hinden, &quot;Internet Protocol, Version 6
              (IPv6) Specification&quot;, STD 86, <a href="/doc/html/rfc8200">RFC 8200</a>,
              DOI 10.17487/RFC8200, July 2017,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8200">https://www.rfc-editor.org/info/rfc8200</a>&gt;.

<span class="h3"><a class="selflink" id="section-7.2" href="#section-7.2">7.2</a>.  Informative References</span>

   [<a id="ref-RFC2151">RFC2151</a>]  Kessler, G. and S. Shepard, &quot;A Primer On Internet and
              TCP/IP Tools and Utilities&quot;, FYI 30, <a href="/doc/html/rfc2151">RFC 2151</a>,
              DOI 10.17487/RFC2151, June 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2151">https://www.rfc-editor.org/info/rfc2151</a>&gt;.

   [<a id="ref-RFC2328">RFC2328</a>]  Moy, J., &quot;OSPF Version 2&quot;, STD 54, <a href="/doc/html/rfc2328">RFC 2328</a>,
              DOI 10.17487/RFC2328, April 1998,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2328">https://www.rfc-editor.org/info/rfc2328</a>&gt;.

   [<a id="ref-RFC4115">RFC4115</a>]  Aboul-Magd, O. and S. Rabie, &quot;A Differentiated Service
              Two-Rate, Three-Color Marker with Efficient Handling of
              in-Profile Traffic&quot;, <a href="/doc/html/rfc4115">RFC 4115</a>, DOI 10.17487/RFC4115,
              July 2005, &lt;<a href="https://www.rfc-editor.org/info/rfc4115">https://www.rfc-editor.org/info/rfc4115</a>&gt;.

Authors&#x27; Addresses

   Tal Mizrahi
   Marvell
   Email: talmi@marvell.com


   Jose Yallouz
   Intel
   Email: jose@alumni.technion.ac.il




Mizrahi &amp; Yallouz             Informational                     [Page 6]
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

