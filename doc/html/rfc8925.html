<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    rfc8925
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.34.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.34.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/draft-ietf-dhc-v6only/">
  <meta name="description" content="IPv6-Only Preferred Option for DHCPv4 (RFC )">
  <script src="https://www.ietf.org/lib/dt/7.34.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.34.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bgblue"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc8925.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc8925.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/rfc8925.xml" title="XML source for this document">xml</a>|<a href="https://www.rfc-editor.org/rfc/rfc8925.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/rfc8925/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/rfc8925/" title="Datatracker information for this document">Tracker</a>] [<a href="/group/dhc/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-dhc-v6only@ietf.org?subject=draft-ietf-dhc-v6only" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=draft-ietf-dhc-v6only-08.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-ietf-dhc-v6only-08.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-ietf-dhc-v6only-08.txt" title="Run an idnits check of this document">Nits</a>]

From: <a href="/doc/html/draft-ietf-dhc-v6only-08">draft-ietf-dhc-v6only-08</a>                         Proposed Standard</pre>
      </div>
    

    <div class="draftcontent">
    <pre>Internet Engineering Task Force (IETF)                        L. Colitti
Request for Comments: 8925                                    J. Linkova
Updates: <a href="/doc/html/rfc2563">2563</a>                                                     Google
Category: Standards Track                                  M. Richardson
ISSN: 2070-1721                                                Sandelman
                                                            T. Mrugalski
                                                                     ISC
                                                            October 2020


                 <span class="h1">IPv6-Only Preferred Option for DHCPv4</span>

Abstract

   This document specifies a DHCPv4 option to indicate that a host
   supports an IPv6-only mode and is willing to forgo obtaining an IPv4
   address if the network provides IPv6 connectivity.  It also updates
   <a href="/doc/html/rfc2563">RFC 2563</a> to specify DHCPv4 server behavior when the server receives a
   DHCPDISCOVER not containing the Auto-Configure option but containing
   the new option defined in this document.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="/doc/html/rfc7841#section-2">Section&nbsp;2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="https://www.rfc-editor.org/info/rfc8925">https://www.rfc-editor.org/info/rfc8925</a>.

Copyright Notice

   Copyright (c) 2020 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="/doc/html/bcp78">BCP 78</a> and the IETF Trust&#x27;s Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction
     1.1.  Requirements Language
     1.2.  Terminology
   2.  Reasons to Signal IPv6-Only Support in DHCPv4 Packets
   3.  IPv6-Only Preferred Option
     3.1.  Option Format
     3.2.  DHCPv4 Client Behavior
     3.3.  DHCPv4 Server Behavior
       3.3.1.  Interaction with <a href="/doc/html/rfc2563">RFC 2563</a>
     3.4.  Constants and Configuration Variables
   4.  IPv6-Only Transition Technology Considerations
   5.  IANA Considerations
   6.  Security Considerations
   7.  References
     7.1.  Normative References
     7.2.  Informative References
   Acknowledgements
   Authors&#x27; Addresses

<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>.  Introduction</span>

   One of the biggest challenges of deploying IPv6-only LANs is that
   such networks might contain a rather heterogeneous collection of
   hosts.  While some hosts are capable of operating in IPv6-only mode
   (either because the OS and all applications are IPv6-only capable or
   because the host has some form of 464XLAT [<a href="/doc/html/rfc6877" title="&quot;464XLAT: Combination of Stateful and Stateless Translation&quot;">RFC6877</a>] deployed), others
   might still have IPv4 dependencies and need IPv4 addresses to operate
   properly.  To incrementally roll out IPv6-only, network operators
   might need to provide IPv4 on demand, whereby a host receives an IPv4
   address if it needs it, while IPv6-only-capable hosts (such as modern
   mobile devices) are not allocated IPv4 addresses.  Traditionally,
   that goal is achieved by placing IPv6-only-capable devices in a
   dedicated IPv6-only network segment or Wi-Fi Service Set Identifier
   (SSID), while dual-stack devices reside in another network with IPv4
   and DHCPv4 enabled.  However, such an approach has a number of
   drawbacks, including, but not limited to, the following:

   *  Doubling the number of network segments leads to operational
      complexity and impact on performance -- for instance, due to high
      memory utilization caused by an increased number of Access Control
      List (ACL) entries.

   *  Placing a host in the correct network segment is problematic.  For
      example, in the case of 802.11 Wi-Fi, the user might select the
      wrong SSID.  In the case of wired 802.1x authentication, the
      authentication server might not have all the information required
      to make the correct decision and choose between an IPv6-only VLAN
      and a dual-stack VLAN.

   It would be beneficial for IPv6 deployment if operators could
   implement IPv6-mostly (or IPv4-on-demand) segments where IPv6-only
   hosts coexist with legacy dual-stack devices.  The trivial solution
   of disabling the IPv4 stack on IPv6-only-capable hosts is not
   feasible, as those clients must be able to operate on IPv4-only
   networks as well.  While IPv6-only-capable devices might use a
   heuristic approach to learning if the network provides IPv6-only
   functionality and stop using IPv4 if it does, such an approach might
   be undesirable in practice.  One important reason is that when a host
   connects to a network, it does not know whether the network is
   IPv4-only, dual-stack, or IPv6-only.  To ensure that connectivity
   over whatever protocol is present becomes available as soon as
   possible, the host usually starts configuring both IPv4 and IPv6
   immediately.  If hosts were to delay requesting IPv4 until IPv6
   reachability is confirmed, that would penalize IPv4-only and dual-
   stack networks, which does not seem practical.  Requesting IPv4 and
   then releasing it later, after IPv6 reachability is confirmed, might
   cause errors that are visible to users, as it would be disruptive for
   applications that have already started using the assigned IPv4
   address.  Instead, it would be useful to have a mechanism that would
   allow a host to indicate that its request for an IPv4 address is
   optional and a network to signal that IPv6-only functionality (such
   as NAT64 [<a href="/doc/html/rfc6146" title="&quot;Stateful NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4 Servers&quot;">RFC6146</a>]) is available.  This document provides such a
   solution via a new DHCPv4 option that a client uses to indicate that
   it does not need an IPv4 address if the network provides IPv6-only
   connectivity (as NAT64 and DNS64).  If the particular network segment
   provides IPv4 on demand, such clients would not be supplied with IPv4
   addresses, while IPv4 addresses would be provided on IPv4-only or
   dual-stack segments without NAT64 services.

   [<a id="ref-RFC2563">RFC2563</a>] introduced the Auto-Configure DHCPv4 option and describes
   DHCPv4 server behavior if no address is chosen for a host.  This
   document updates [<a href="/doc/html/rfc2563" title="&quot;DHCP Option to Disable Stateless Auto- Configuration in IPv4 Clients&quot;">RFC2563</a>] to modify server behavior if the DHCPOFFER
   contains the IPv6-Only Preferred option.

<span class="h3"><a class="selflink" id="section-1.1" href="#section-1.1">1.1</a>.  Requirements Language</span>

   The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;,
   &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;NOT RECOMMENDED&quot;, &quot;MAY&quot;, and
   &quot;OPTIONAL&quot; in this document are to be interpreted as described in
   <a href="/doc/html/bcp14">BCP 14</a> [<a href="/doc/html/rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>] [<a href="/doc/html/rfc8174" title="&quot;Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words&quot;">RFC8174</a>] when, and only when, they appear in all
   capitals, as shown here.

<span class="h3"><a class="selflink" id="section-1.2" href="#section-1.2">1.2</a>.  Terminology</span>

   Dual-stack network or device:  A network or device that has both
      versions of the Internet Protocol (IPv4 and IPv6) enabled and
      operational.

   IPv6-only-capable host:  A host that does not require an IPv4 address
      and can operate on IPv6-only networks.  More precisely, IPv6-only
      capability is specific to a given interface of the host: if some
      applications on a host require IPv4 and the 464XLAT CLAT
      (customer-side translator) [<a href="/doc/html/rfc6877" title="&quot;464XLAT: Combination of Stateful and Stateless Translation&quot;">RFC6877</a>] is only enabled on one
      interface, the host is IPv6-only capable if connected to a NAT64
      network via that interface.  This document implies that IPv6-only-
      capable hosts reach IPv4-only destinations via a NAT64 service
      provided by the network.  <a href="#section-4">Section 4</a> discusses hypothetical
      scenarios for other transition technologies being used.

   IPv4-requiring host:  A host that is not IPv6-only capable and cannot
      operate in an IPv6-only network providing NAT64 service.

   IPv4 on demand:  A deployment scenario where end hosts are expected
      to operate in IPv6-only mode by default and IPv4 addresses can be
      assigned to some hosts if those hosts explicitly opt in to receive
      IPv4 addresses.

   IPv6-mostly network:  A network that provides NAT64 (possibly with
      DNS64) service as well as IPv4 connectivity and allows the
      coexistence of IPv6-only, dual-stack, and IPv4-only hosts on the
      same segment.  Such a deployment scenario allows operators to
      incrementally turn off IPv4 on end hosts, while still providing
      IPv4 to devices that require IPv4 to operate.  But IPv6-only-
      capable devices need not be assigned IPv4 addresses.

   IPv6-only mode:  A mode of operation where a host acts as an IPv6-
      only-capable host and does not have IPv4 addresses assigned
      (except that IPv4 link-local addresses [<a href="/doc/html/rfc3927" title="&quot;Dynamic Configuration of IPv4 Link-Local Addresses&quot;">RFC3927</a>] may have been
      configured).

   IPv6-only network:  A network that does not provide routing
      functionality for IPv4 packets.  Such networks may or may not
      allow intra-LAN IPv4 connectivity.  An IPv6-only network usually
      provides access to IPv4-only resources via NAT64 [<a href="/doc/html/rfc6146" title="&quot;Stateful NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4 Servers&quot;">RFC6146</a>].

   NAT64:  Network Address and Protocol Translation from IPv6 Clients to
      IPv4 Servers [<a href="/doc/html/rfc6146" title="&quot;Stateful NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4 Servers&quot;">RFC6146</a>].

   Router Advertisement (RA):  A message used by IPv6 routers to
      advertise their presence, together with various link and Internet
      parameters [<a href="/doc/html/rfc4861" title="&quot;Neighbor Discovery for IP version 6 (IPv6)&quot;">RFC4861</a>].

   DNS64:  A mechanism for synthesizing AAAA records from A records
      [<a href="/doc/html/rfc6147" title="&quot;DNS64: DNS Extensions for Network Address Translation from IPv6 Clients to IPv4 Servers&quot;">RFC6147</a>].

   Network attachment event:  A link up event, as described by
      [<a href="/doc/html/rfc4957" title="&quot;Link-Layer Event Notifications for Detecting Network Attachments&quot;">RFC4957</a>], that results in a host detecting an available network.

   Disabling the IPv4 stack on the host interface:  Host behavior when
      the host

      *  does not send any IPv4 packets from that interface,

      *  drops all IPv4 packets received on that interface, and

      *  does not forward any IPv4 packets to that interface.

<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  Reasons to Signal IPv6-Only Support in DHCPv4 Packets</span>

   For networks that contain a mix of both IPv6-only-capable hosts and
   IPv4-requiring hosts and that utilize DHCPv4 for configuring the IPv4
   network stack on hosts, it seems natural to leverage the same
   protocol to signal that IPv4 is discretional on a given segment.  An
   ability to remotely disable IPv4 on a host can be seen as a new
   denial-of-service attack vector.  The approach provided in this
   document limits the attack surface to DHCPv4-related attacks without
   introducing new vulnerable elements.

   Another benefit of using DHCPv4 for signaling is that IPv4 will be
   disabled only if both the client and the server indicate IPv6-only
   capability.  It allows IPv6-only-capable hosts to turn off IPv4 only
   upon receiving an explicit signal from the network and operate in
   dual-stack or IPv4-only mode otherwise.  In addition, the mechanism
   defined in this document does not introduce any additional delays to
   the process of configuring an IP stack on hosts.  If the network does
   not support IPv6-only/IPv4-on-demand mode, an IPv6-only-capable host
   would configure an IPv4 address as quickly as any other host.

   Being a client/server protocol, DHCPv4 allows IPv4 to be selectively
   disabled on a per-host basis on a given network segment.  The
   coexistence of IPv6-only, dual-stack, and even IPv4-only hosts on the
   same LAN would not only allow network administrators to preserve
   scarce IPv4 addresses but would also drastically simplify incremental
   deployment of IPv6-only networks, positively impacting IPv6 adoption.

<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>.  IPv6-Only Preferred Option</span>

<span class="h3"><a class="selflink" id="section-3.1" href="#section-3.1">3.1</a>.  Option Format</span>

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Code      |   Length      |           Value               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |         Value (cont.)         |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                Figure 1: IPv6-Only Preferred Option Format

   Fields:

   Code:  8-bit identifier of the IPv6-Only Preferred option code as
      assigned by IANA: 108.  The client includes the Code in the
      Parameter Request List in DHCPDISCOVER and DHCPREQUEST messages as
      described in <a href="#section-3.2">Section 3.2</a>.

   Length:  8-bit unsigned integer.  The length of the option, excluding
      the Code and Length Fields.  The server MUST set the length field
      to 4.  The client MUST ignore the IPv6-Only Preferred option if
      the length field value is not 4.

   Value:  32-bit unsigned integer.  The number of seconds for which the
      client should disable DHCPv4 (V6ONLY_WAIT configuration variable).
      If the server pool is explicitly configured with a V6ONLY_WAIT
      timer, the server MUST set the field to that configured value.
      Otherwise, the server MUST set it to zero.  The client MUST
      process that field as described in <a href="#section-3.2">Section 3.2</a>.

      The client never sets this field, as it never sends the full
      option but includes the option code in the Parameter Request List
      as described in <a href="#section-3.2">Section 3.2</a>.

<span class="h3"><a class="selflink" id="section-3.2" href="#section-3.2">3.2</a>.  DHCPv4 Client Behavior</span>

   A DHCPv4 client SHOULD allow a device administrator to configure
   IPv6-only capability either for a specific interface (to indicate
   that the device is IPv6-only capable if connected to a NAT64 network
   via that interface) or for all interfaces.  If only a specific
   interface is configured as IPv6-only capable, the DHCPv4 client MUST
   NOT consider the host an IPv6-only-capable host for the purpose of
   sending/receiving DHCPv4 packets over any other interfaces.

   The DHCPv4 client on an IPv4-requiring host MUST NOT include the
   IPv6-Only Preferred option code in the Parameter Request List of any
   DHCPv4 packets and MUST ignore that option in packets received from
   DHCPv4 servers.

   DHCPv4 clients running on IPv6-only-capable hosts SHOULD include the
   IPv6-Only Preferred option code in the Parameter Request List in
   DHCPDISCOVER and DHCPREQUEST messages for interfaces so enabled and
   follow the processing as described below on a per-enabled-interface
   basis.

   If the client did not include the IPv6-Only Preferred option code in
   the Parameter Request List in the DHCPDISCOVER or DHCPREQUEST
   message, it MUST ignore the IPv6-Only Preferred option in any
   messages received from the server.

   If the client includes the IPv6-Only Preferred option code in the
   Parameter Request List and the DHCPOFFER message from the server
   contains a valid IPv6-Only Preferred option, the client SHOULD NOT
   request the IPv4 address provided in the DHCPOFFER.  If the IPv6-Only
   Preferred option returned by the server contains a value greater than
   or equal to MIN_V6ONLY_WAIT, the client SHOULD set the V6ONLY_WAIT
   timer to that value.  Otherwise, the client SHOULD set the
   V6ONLY_WAIT timer to MIN_V6ONLY_WAIT.  The client SHOULD stop the
   DHCPv4 configuration process for V6ONLY_WAIT seconds or until a
   network attachment event, whichever happens first.  The host MAY
   disable the IPv4 stack completely on the affected interface for
   V6ONLY_WAIT seconds or until the network attachment event, whichever
   happens first.

   The IPv6-Only Preferred option SHOULD be included in the Parameter
   Request List in DHCPREQUEST messages (after receiving a DHCPOFFER
   without this option, for an INIT-REBOOT, or when renewing or
   rebinding a leased address).  If the DHCPv4 server responds with a
   DHCPACK that includes the IPv6-Only Preferred option, the client&#x27;s
   behavior depends on the client&#x27;s state.  If the client is in the
   INIT-REBOOT state, it SHOULD stop the DHCPv4 configuration process or
   disable the IPv4 stack completely for V6ONLY_WAIT seconds or until
   the network attachment event, whichever happens first.  It also MAY
   send a DHCPRELEASE message.  If the client is in any other state, it
   SHOULD continue to use the assigned IPv4 address until further DHCPv4
   reconfiguration events.

   If the client includes the IPv6-Only Preferred option code in the
   Parameter Request List and the server responds with a DHCPOFFER
   message without a valid IPv6-Only Preferred option, the client MUST
   proceed as normal with a DHCPREQUEST.

   If the client waits for multiple DHCPOFFER responses and selects one
   of them, it MUST follow the processing for the IPv6-Only Preferred
   option based on the selected response.  A client MAY use the presence
   of the IPv6-Only Preferred option as a selection criterion.

   When an IPv6-only-capable client receives the IPv6-Only Preferred
   option from the server, the client MAY configure an IPv4 link-local
   address [<a href="/doc/html/rfc3927" title="&quot;Dynamic Configuration of IPv4 Link-Local Addresses&quot;">RFC3927</a>].  In that case, IPv6-only-capable devices might
   still be able to communicate over IPv4 to other devices on the link.
   The Auto-Configure option [<a href="/doc/html/rfc2563" title="&quot;DHCP Option to Disable Stateless Auto- Configuration in IPv4 Clients&quot;">RFC2563</a>] can be used to control the
   autoconfiguration of IPv4 link-local addresses.  <a href="#section-3.3.1">Section 3.3.1</a>
   discusses the interaction between the IPv6-Only Preferred option and
   the Auto-Configure option.

<span class="h3"><a class="selflink" id="section-3.3" href="#section-3.3">3.3</a>.  DHCPv4 Server Behavior</span>

   The DHCPv4 server SHOULD be able to configure all or individual pools
   to include the IPv6-Only Preferred option in DHCPv4 responses if the
   client included the option code in the Parameter Request List.  The
   DHCPv4 server MAY have a configuration option to specify the
   V6ONLY_WAIT timer for all or individual IPv6-mostly pools.

   The server MUST NOT include the IPv6-Only Preferred option in the
   DHCPOFFER or DHCPACK message if the selected pool is not configured
   as IPv6-mostly.  The server MUST NOT include the IPv6-Only Preferred
   option in the DHCPOFFER or DHCPACK message if the option was not
   present in the Parameter Request List sent by the client.

   If the IPv6-Only Preferred option is present in the Parameter Request
   List received from the client and the corresponding DHCPv4 pool is
   explicitly configured as belonging to an IPv6-mostly network segment,
   the server MUST include the IPv6-Only Preferred option when
   responding with the DHCPOFFER or DHCPACK message.  If the server
   responds with the IPv6-Only Preferred option and the V6ONLY_WAIT
   timer is configured for the pool, the server MUST copy the configured
   value to the IPv6-Only Preferred option value field.  Otherwise, it
   MUST set the field to zero.  The server SHOULD NOT assign an address
   from the pool.  Instead, it SHOULD return 0.0.0.0 as the offered
   address.  Alternatively, if offering 0.0.0.0 is not feasible -- for
   example, due to some limitations of the server or the network
   infrastructure -- the server MAY include in the DHCPOFFER an
   available IPv4 address from the pool, as per recommendations in
   [<a href="/doc/html/rfc2131" title="&quot;Dynamic Host Configuration Protocol&quot;">RFC2131</a>].  In this case, the offered address MUST be a valid address
   that is not committed to any other client.  Because the client is not
   ever expected to request this address, the server SHOULD NOT reserve
   the address and SHOULD NOT verify its uniqueness.  If the client then
   issues a DHCPREQUEST for the address, the server MUST process it per
   [<a href="/doc/html/rfc2131" title="&quot;Dynamic Host Configuration Protocol&quot;">RFC2131</a>], including replying with a DHCPACK for the address if it
   has not been committed to another client in the meantime.

   If a client includes both a Rapid Commit option [<a href="/doc/html/rfc4039" title="&quot;Rapid Commit Option for the Dynamic Host Configuration Protocol version 4 (DHCPv4)&quot;">RFC4039</a>] and an
   IPv6-Only Preferred option in the DHCPDISCOVER message, the server
   SHOULD NOT honor the Rapid Commit option if the response to the
   client would contain the IPv6-Only Preferred option.  It SHOULD
   instead respond with a DHCPOFFER as indicated above.

   If the server receives a DHCPREQUEST containing the IPv6-Only
   Preferred option for the address from a pool configured as
   IPv6-mostly, the server MUST process it per [<a href="/doc/html/rfc2131" title="&quot;Dynamic Host Configuration Protocol&quot;">RFC2131</a>].

<span class="h4"><a class="selflink" id="section-3.3.1" href="#section-3.3.1">3.3.1</a>.  Interaction with <a href="/doc/html/rfc2563">RFC 2563</a></span>

   [<a id="ref-RFC2563">RFC2563</a>] defines an Auto-Configure DHCPv4 option to disable IPv4
   link-local address configuration for IPv4 clients.  Clients can
   support both the IPv6-Only Preferred option and the Auto-Configure
   option, just one of the options, or neither option.  If a client
   sends both the IPv6-Only Preferred option and the Auto-Configure
   option, the network administrator can prevent the host from
   configuring an IPv4 link-local address on an IPv6-mostly network.  To
   achieve this, the server needs to send a DHCPOFFER that contains a
   &#x27;yiaddr&#x27; of 0.0.0.0, and the Auto-Configure flag set to
   &quot;DoNotAutoConfigure&quot;.

   However, special care should be taken in a situation where a server
   supports both options and receives just an IPv6-Only Preferred option
   from a client.  <a href="/doc/html/rfc2563#section-2.3">Section&nbsp;2.3 of [RFC2563]</a> states that if no address is
   chosen for the host (which would be the case for IPv6-only-capable
   clients on an IPv6-mostly network), then &quot;If the DHCPDISCOVER does
   not contain the Auto-Configure option, it is not answered.&quot;  Such
   behavior would be undesirable for clients supporting the IPv6-Only
   Preferred option without supporting the Auto-Configure option, as
   they would not receive any response from the server and would keep
   requesting a response instead of disabling DHCPv4 for V6ONLY_WAIT
   seconds.  Therefore, the following update is made to <a href="/doc/html/rfc2563#section-2.3">Section&nbsp;2.3 of
   [RFC2563]</a>.

   OLD TEXT:

   |  However, if no address is chosen for the host, a few additional
   |  steps MUST be taken.
   |
   |  If the DHCPDISCOVER does not contain the Auto-Configure option, it
   |  is not answered.

   NEW TEXT:

   |  However, if no address is chosen for the host, a few additional
   |  steps MUST be taken.
   |
   |  If the DHCPDISCOVER does not contain the Auto-Configure option and
   |  the IPv6-Only Preferred option is not present, it is not answered.
   |  If the DHCPDISCOVER does not contain the Auto-Configure option but
   |  contains the IPv6-Only Preferred option, the processing rules for
   |  the IPv6-Only Preferred option apply.

<span class="h3"><a class="selflink" id="section-3.4" href="#section-3.4">3.4</a>.  Constants and Configuration Variables</span>

   V6ONLY_WAIT:  The time for which the client SHOULD stop the DHCPv4
      configuration process.  The value MUST NOT be less than
      MIN_V6ONLY_WAIT seconds.  Default: 1800 seconds

   MIN_V6ONLY_WAIT:  The lower boundary for V6ONLY_WAIT.  Value: 300
      seconds

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>.  IPv6-Only Transition Technology Considerations</span>

   Until IPv6 adoption in the Internet reaches 100%, communication
   between an IPv6-only host and an IPv4-only destination requires some
   form of a transition mechanism deployed in the network.  At the time
   of writing, the only such mechanism that is widely supported by end
   hosts is NAT64 [<a href="/doc/html/rfc6146" title="&quot;Stateful NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4 Servers&quot;">RFC6146</a>] (either with or without 464XLAT).
   Therefore, the IPv6-Only Preferred option is only sent by hosts
   capable of operating on NAT64 networks.  In a typical deployment
   scenario, a network administrator would not configure the DHCPv4
   server to return the IPv6-Only Preferred option unless the network
   provides NAT64 service.

   Hypothetically, it is possible for multiple transition technologies
   to coexist.  In such a scenario, some form of negotiation would be
   required between a client and a server to ensure that the transition
   technology supported by the client is the one the network provides.
   However, it seems unlikely that any new transition technology would
   arise and be widely adopted in the foreseeable future.  Therefore,
   adding support for non-existing technologies seems to be suboptimal,
   so this document implies that NAT64 is used to facilitate
   connectivity between IPv6 and IPv4.  In the unlikely event that a new
   transition mechanism becomes widely deployed, the applicability of
   the IPv6-Only Preferred option to that mechanism will depend on the
   nature of the new mechanism.  If the new mechanism is designed in
   such a way that it&#x27;s fully transparent for hosts that support NAT64
   and the IPv6-Only Preferred option, then the option can continue to
   be used with the new mechanism.  If the new mechanism is not
   compatible with NAT64 and implementation on the host side is required
   to support it, then a new DHCPv4 option needs to be defined.

   It should also be noted that declaring a host (technically, a host
   interface) IPv6-only capable is a policy decision.  For example,

   *  An OS vendor may make such a decision and configure their DHCPv4
      clients to send the IPv6-Only Preferred option by default if the
      OS has a 464XLAT CLAT [<a href="/doc/html/rfc6877" title="&quot;464XLAT: Combination of Stateful and Stateless Translation&quot;">RFC6877</a>] enabled.

   *  An enterprise network administrator may provision the corporate
      hosts as IPv6-only capable if all applications that users are
      supposed to run have been tested in an IPv6-only environment (or
      if a 464XLAT CLAT is enabled on the devices).

   *  Internet of Things (IoT) devices may be shipped in IPv6-only-
      capable mode if they are designed to connect to an IPv6-enabled
      cloud destination only.

<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>.  IANA Considerations</span>

   The IANA has assigned a new DHCPv4 option code for the IPv6-Only
   Preferred option from the &quot;BOOTP Vendor Extensions and DHCP Options&quot;
   registry, located at &lt;<a href="https://www.iana.org/assignments/bootp-dhcp-parameters/">https://www.iana.org/assignments/bootp-dhcp-</a>
   <a href="https://www.iana.org/assignments/bootp-dhcp-parameters/">parameters/</a>&gt;.

   Tag:  108
   Name:  IPv6-Only Preferred
   Data Length:  4
   Meaning:  Number of seconds that DHCPv4 should be disabled
   Reference:  <a href="/doc/html/rfc8925">RFC 8925</a>

<span class="h2"><a class="selflink" id="section-6" href="#section-6">6</a>.  Security Considerations</span>

   An attacker might send a spoofed DHCPOFFER containing an IPv6-Only
   Preferred option with the value field set to a large number, such as
   0xffffffff, effectively disabling DHCPv4 on clients supporting the
   option.  If the network is IPv4-only, such clients would lose
   connectivity, while on a dual-stack network without NAT64 service,
   only connectivity to IPv4-only destinations would be affected.
   Recovery from such an attack would require triggering a network
   attachment event.  However, it should be noted that if the network
   does not provide protection from a rogue DHCPv4 server, the similar
   attack vector can be executed by offering an invalid address and
   setting the Lease Time option [<a href="/doc/html/rfc2132" title="&quot;DHCP Options and BOOTP Vendor Extensions&quot;">RFC2132</a>] value field to 0xffffffff.
   The latter attack would affect all hosts -- not just hosts that
   support the IPv6-Only Preferred option.  Therefore, the security
   measures against rogue DHCPv4 servers would be sufficient to prevent
   attacks specific to the IPv6-Only Preferred option.  Additionally,
   such attacks can only be executed if the victim prefers the rogue
   DHCPOFFER over legitimate offers.  Therefore, for the attack to be
   successful, the attacker needs to know the selection criteria used by
   the client and be able to make its rogue offer preferable to other
   offers.

   It should be noted that disabling IPv4 on a host upon receiving the
   IPv6-Only Preferred option from the DHCPv4 server protects the host
   from IPv4-related attacks and therefore could be considered a
   security feature, as it reduces the attack surface.

<span class="h2"><a class="selflink" id="section-7" href="#section-7">7</a>.  References</span>

<span class="h3"><a class="selflink" id="section-7.1" href="#section-7.1">7.1</a>.  Normative References</span>

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., &quot;Key words for use in RFCs to Indicate
              Requirement Levels&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc2119">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC2131">RFC2131</a>]  Droms, R., &quot;Dynamic Host Configuration Protocol&quot;,
              <a href="/doc/html/rfc2131">RFC 2131</a>, DOI 10.17487/RFC2131, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2131">https://www.rfc-editor.org/info/rfc2131</a>&gt;.

   [<a id="ref-RFC2563">RFC2563</a>]  Troll, R., &quot;DHCP Option to Disable Stateless Auto-
              Configuration in IPv4 Clients&quot;, <a href="/doc/html/rfc2563">RFC 2563</a>,
              DOI 10.17487/RFC2563, May 1999,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2563">https://www.rfc-editor.org/info/rfc2563</a>&gt;.

   [<a id="ref-RFC3927">RFC3927</a>]  Cheshire, S., Aboba, B., and E. Guttman, &quot;Dynamic
              Configuration of IPv4 Link-Local Addresses&quot;, <a href="/doc/html/rfc3927">RFC 3927</a>,
              DOI 10.17487/RFC3927, May 2005,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3927">https://www.rfc-editor.org/info/rfc3927</a>&gt;.

   [<a id="ref-RFC4039">RFC4039</a>]  Park, S., Kim, P., and B. Volz, &quot;Rapid Commit Option for
              the Dynamic Host Configuration Protocol version 4
              (DHCPv4)&quot;, <a href="/doc/html/rfc4039">RFC 4039</a>, DOI 10.17487/RFC4039, March 2005,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4039">https://www.rfc-editor.org/info/rfc4039</a>&gt;.

   [<a id="ref-RFC8174">RFC8174</a>]  Leiba, B., &quot;Ambiguity of Uppercase vs Lowercase in <a href="/doc/html/rfc2119">RFC</a>
              <a href="/doc/html/rfc2119">2119</a> Key Words&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc8174">RFC 8174</a>, DOI 10.17487/RFC8174,
              May 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.

<span class="h3"><a class="selflink" id="section-7.2" href="#section-7.2">7.2</a>.  Informative References</span>

   [<a id="ref-RFC2132">RFC2132</a>]  Alexander, S. and R. Droms, &quot;DHCP Options and BOOTP Vendor
              Extensions&quot;, <a href="/doc/html/rfc2132">RFC 2132</a>, DOI 10.17487/RFC2132, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2132">https://www.rfc-editor.org/info/rfc2132</a>&gt;.

   [<a id="ref-RFC4861">RFC4861</a>]  Narten, T., Nordmark, E., Simpson, W., and H. Soliman,
              &quot;Neighbor Discovery for IP version 6 (IPv6)&quot;, <a href="/doc/html/rfc4861">RFC 4861</a>,
              DOI 10.17487/RFC4861, September 2007,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4861">https://www.rfc-editor.org/info/rfc4861</a>&gt;.

   [<a id="ref-RFC4957">RFC4957</a>]  Krishnan, S., Ed., Montavont, N., Njedjou, E., Veerepalli,
              S., and A. Yegin, Ed., &quot;Link-Layer Event Notifications for
              Detecting Network Attachments&quot;, <a href="/doc/html/rfc4957">RFC 4957</a>,
              DOI 10.17487/RFC4957, August 2007,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4957">https://www.rfc-editor.org/info/rfc4957</a>&gt;.

   [<a id="ref-RFC6146">RFC6146</a>]  Bagnulo, M., Matthews, P., and I. van Beijnum, &quot;Stateful
              NAT64: Network Address and Protocol Translation from IPv6
              Clients to IPv4 Servers&quot;, <a href="/doc/html/rfc6146">RFC 6146</a>, DOI 10.17487/RFC6146,
              April 2011, &lt;<a href="https://www.rfc-editor.org/info/rfc6146">https://www.rfc-editor.org/info/rfc6146</a>&gt;.

   [<a id="ref-RFC6147">RFC6147</a>]  Bagnulo, M., Sullivan, A., Matthews, P., and I. van
              Beijnum, &quot;DNS64: DNS Extensions for Network Address
              Translation from IPv6 Clients to IPv4 Servers&quot;, <a href="/doc/html/rfc6147">RFC 6147</a>,
              DOI 10.17487/RFC6147, April 2011,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6147">https://www.rfc-editor.org/info/rfc6147</a>&gt;.

   [<a id="ref-RFC6877">RFC6877</a>]  Mawatari, M., Kawashima, M., and C. Byrne, &quot;464XLAT:
              Combination of Stateful and Stateless Translation&quot;,
              <a href="/doc/html/rfc6877">RFC 6877</a>, DOI 10.17487/RFC6877, April 2013,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6877">https://www.rfc-editor.org/info/rfc6877</a>&gt;.

Acknowledgements

   Thanks to the following people (in alphabetical order) for their
   review and feedback: Mohamed Boucadair, Martin Duke, Russ Housley,
   Sheng Jiang, Benjamin Kaduk, Murray Kucherawy, Ted Lemon, Roy
   Marples, Bjorn Mork, Alvaro Retana, Peng Shuping, Pascal Thubert,
   Bernie Volz, Éric Vyncke, and Robert Wilton.  The authors would like
   to thank Bob Hinden and Brian Carpenter for the initial idea of
   signaling IPv6-only capability to hosts.  Special thanks to Erik
   Kline, Mark Townsley, and Maciej Zenczykowski for the discussion that
   led to the idea of signaling IPv6-only capability over DHCPv4.

Authors&#x27; Addresses

   Lorenzo Colitti
   Google
   Shibuya 3-21-3, Shibuya, Tokyo
   150-0002
   Japan

   Email: lorenzo@google.com


   Jen Linkova
   Google
   1 Darling Island Rd
   Pyrmont NSW 2009
   Australia

   Email: furry@google.com


   Michael C. Richardson
   Sandelman Software Works

   Email: mcr+ietf@sandelman.ca
   URI:   <a href="https://www.sandelman.ca/">https://www.sandelman.ca/</a>


   Tomek Mrugalski
   Internet Systems Consortium, Inc.
   PO Box 360
   Newmarket, NH 03857
   United States of America

   Email: tomasz.mrugalski@gmail.com
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

