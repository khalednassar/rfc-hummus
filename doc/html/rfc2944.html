<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    rfc2944
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.34.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.34.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/draft-wu-telnet-auth-srp/">
  <meta name="description" content="Telnet Authentication: SRP (RFC )">
  <script src="https://www.ietf.org/lib/dt/7.34.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.34.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bgblue"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc2944.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc2944.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/pdfrfc/rfc2944.txt.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/rfc2944/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/rfc2944/" title="Datatracker information for this document">Tracker</a>] [<a href="mailto:draft-wu-telnet-auth-srp@ietf.org?subject=draft-wu-telnet-auth-srp" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=draft-wu-telnet-auth-srp-05.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-wu-telnet-auth-srp-05.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-wu-telnet-auth-srp-05.txt" title="Run an idnits check of this document">Nits</a>]

From: <a href="/doc/html/draft-wu-telnet-auth-srp-05">draft-wu-telnet-auth-srp-05</a>                      Proposed Standard</pre>
      </div>
    

    <div class="draftcontent">
    <pre>Network Working Group                                              T. Wu
Request for Comments: 2944                          Standford University
Category: Standards Track                                 September 2000


                       <span class="h1">Telnet Authentication: SRP</span>

Status of this Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the &quot;Internet
   Official Protocol Standards&quot; (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2000).  All Rights Reserved.

Abstract

   This document specifies an authentication scheme for the Telnet
   protocol under the framework described in [<a href="/doc/html/rfc2941" title="&quot;Telnet Authentication Option&quot;">RFC2941</a>], using the Secure
   Remote Password Protocol (SRP) authentication mechanism.  The
   specific mechanism, SRP-SHA1, is described in [<a href="/doc/html/rfc2945" title="&quot;The SRP Authentication and Key Exchange System&quot;">RFC2945</a>].

<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>. Command Names and Codes</span>

   Authentication Types

      SRP          5

   Suboption Commands

      AUTH         0
      REJECT       1
      ACCEPT       2
      CHALLENGE    3
      RESPONSE     4

      EXP          8
      PARAMS       9









<span class="grey">Wu                          Standards Track                     [Page 1]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-2" ></span>
<span class="grey"><a href="/doc/html/rfc2944">RFC 2944</a>               Telnet Authentication: SRP         September 2000</span>


<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>. Command Meanings</span>

   IAC SB AUTHENTICATION IS &lt;authentication-type-pair&gt; AUTH IAC SE

      This command indicates that the client has supplied the
      username and is ready to receive that user&#x27;s field parameters.
      There is no authentication information to be sent to the remote
      side of the connection yet.  This should only be sent after the
      IAC SB AUTHENTICATION NAME command has been issued.  If the
      modifier byte (second byte of the authentication-type-pair)
      has any bits other than AUTH_WHO_MASK or AUTH_HOW_MASK set,
      both bytes are included in the session key hash described later.
      This ensures that the authentication type pair was correctly
      negotiated, while maintaining backward-compatibility with existing
      software.

   IAC SB AUTHENTICATION REPLY &lt;authentication-type-pair&gt; PARAMS &lt;values
   of modulus, generator, and salt&gt; IAC SE

      This command is used to pass the three parameter values used
      in the exponentiation to the client.  These values are often
      called n, g, and s.

   IAC SB AUTHENTICATION IS &lt;authentication-type-pair&gt; EXP &lt;client&#x27;s
   exponential residue&gt; IAC SE

      This command is used to pass the client&#x27;s exponential residue,
      otherwise known as A, computed against the parameters exchanged
      earlier.

   IAC SB AUTHENTICATION REPLY &lt;authentication-type-pair&gt; CHALLENGE
   &lt;server&#x27;s exponential residue&gt; IAC SE

      This command is used to pass the server&#x27;s exponential residue,
      computed against the same parameters.  This quantity is actually
      the sum of two residues, i.e. g^x + g^b.  For details see [<a href="#ref-SRP" title="&quot;The Secure Remote Password Protocol&quot;">SRP</a>]
      and [<a href="/doc/html/rfc2945" title="&quot;The SRP Authentication and Key Exchange System&quot;">RFC2945</a>].

   IAC SB AUTHENTICATION IS &lt;authentication-type-pair&gt; RESPONSE
   &lt;response from client&gt; IAC SE

      This command gives the server proof of the client&#x27;s authenticity
      with a 160-bit (20 byte) response.








<span class="grey">Wu                          Standards Track                     [Page 2]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-3" ></span>
<span class="grey"><a href="/doc/html/rfc2944">RFC 2944</a>               Telnet Authentication: SRP         September 2000</span>


   IAC SB AUTHENTICATION REPLY &lt;authentication-type-pair&gt; ACCEPT
   &lt;server&#x27;s response&gt; IAC SE

      This command indicates that the authentication was successful.
      The server will construct its own proof of authenticity and
      include it as sub-option data.

   IAC SB AUTHENTICATION REPLY &lt;authentication-type-pair&gt; REJECT
   &lt;optional reason for rejection&gt; IAC SE

      This command indicates that the authentication was not successful,
      and if there is any more data in the sub-option, it is an ASCII
      text message of the reason for the rejection.

   For the PARAMS command, since three pieces of data are being
   transmitted, each parameter is preceded by a 16-bit (two byte) length
   specifier in network byte order.  The EXP commands do not have a
   count in front of the data because there is only one piece of data in
   that suboption.  The CHALLENGE, RESPONSE, and ACCEPT data also do not
   have a count because they are all fixed in size.

<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>. Implementation Rules</span>

   Currently, only AUTH_CLIENT_TO_SERVER mode is supported.  Although
   the SRP protocol effectively performs implicit mutual authentication
   as a result of the two-way proofs, only the AUTH_HOW_ONE_WAY
   authentication mode is currently defined.  The AUTH_HOW_MUTUAL
   setting is being reserved for an explicit mutual-authentication
   variant of the SRP protocol to be defined in future specifications.

   All large number data sent in the arguments of the PARAMS and EXP
   commands must be in network byte order, i.e. most significant byte
   first.  No padding is used.

   The SRP-SHA1 mechanism, as described in [<a href="/doc/html/rfc2945" title="&quot;The SRP Authentication and Key Exchange System&quot;">RFC2945</a>] generates a 40-byte
   session key, which allows implementations to use different keys for
   incoming and outgoing traffic, increasing the security of the
   encrypted session.  It is recommended that the Telnet ENCRYPT method,
   if it is used, be able to take advantage of the longer session keys.

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>. Examples</span>

   User &quot;tjw&quot; may wish to log in on machine &quot;foo&quot;.  The client would
   send IAC SB AUTHENTICATION NAME &quot;tjw&quot; IAC SE IAC SB AUTHENTICATION IS
   SRP AUTH IAC SE.  The server would look up the field and salt
   parameters for &quot;tjw&quot; from its password file and send them back to the
   client.  Client and server would then exchange exponential residues
   and calculate their session keys (after the client prompted &quot;tjw&quot; for



<span class="grey">Wu                          Standards Track                     [Page 3]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-4" ></span>
<span class="grey"><a href="/doc/html/rfc2944">RFC 2944</a>               Telnet Authentication: SRP         September 2000</span>


   his password).  Then, the client would send the server its proof that
   it knows the session key.  The server would either send back an
   ACCEPT or a REJECT.  If the server accepts authentication, it also
   sends its own proof that it knows the session key to the client.

        Client                           Server
                                         IAC DO AUTHENTICATION
        IAC WILL AUTHENTICATION

        [ The server is now free to request authentication information.
          ]
                                         IAC SB AUTHENTICATION SEND
                                         SRP CLIENT|ONE_WAY|
                                         ENCRYPT_USING_TELOPT
                                         SRP CLIENT|ONE_WAY
                                         IAC SE

        [ The server has requested SRP authentication.  It has indicated
          a preference for ENCRYPT_USING_TELOPT, which requires the
          Telnet ENCRYPT option to be negotiated once authentication
          succeeds.  If the client does not support this, the server
          is willing to fall back to an encryption-optional mode.

          The client will now respond with the name of the
          user that it wants to log in as. ]

        IAC SB AUTHENTICATION NAME
        &quot;tjw&quot; IAC SE
        IAC SB AUTHENTICATION IS
        SRP CLIENT|ONE_WAY|ENCRYPT_USING_TELOPT AUTH
        IAC SE

        [ The server looks up the appropriate information for &quot;tjw&quot; and
          sends back the parameters in a PARAMS command.  The parameters
          consist of the values N, g, and s, each preceded with a two-
          byte size parameter. ]

                                         IAC SB AUTHENTICATION REPLY
                                         SRP CLIENT|ONE_WAY|
                                         ENCRYPT_USING_TELOPT PARAMS
                                         ss ss nn nn nn nn ...
                                         ss ss gg gg gg gg ...
                                         ss ss tt tt tt tt ...
                                         IAC SE







<span class="grey">Wu                          Standards Track                     [Page 4]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-5" ></span>
<span class="grey"><a href="/doc/html/rfc2944">RFC 2944</a>               Telnet Authentication: SRP         September 2000</span>


        [ Both sides send their exponential residues.  The client
          sends its value A and the server sends its value B.  In SRP,
          the CHALLENGE message may be computed but not sent before
          the EXP command.  ]

        IAC SB AUTHENTICATION IS
        SRP CLIENT|ONE_WAY|ENCRYPT_USING_TELOPT EXP
        aa aa aa aa aa aa aa aa ...
        IAC SE
                                         IAC SB AUTHENTICATION REPLY
                                         SRP CLIENT|ONE_WAY|
                                         ENCRYPT_USING_TELOPT CHALLENGE
                                         bb bb bb bb bb bb bb bb ...
                                         IAC SE

        [ The client sends its response to the server.  This is the
          message M in the SRP protocol, which proves possession of
          the session key by the client.

          Since ENCRYPT_USING_TELOPT is specified, the two octets
          of the authentication-type-pair are appended to the
          session key K before the hash for M is computed.  If
          the client and server had agreed upon a mode without
          the encryption flag set, nothing would be appended to K.

          Both this message and the server&#x27;s response are as long as
          the output of the hash; the length is 20 bytes for SHA-1. ]

        IAC SB AUTHENTICATION IS
        SRP CLIENT|ONE_WAY|ENCRYPT_USING_TELOPT RESPONSE
        xx xx xx xx xx xx xx xx ...
        IAC SE

        [ The server accepts the response and sends its own proof. ]

                                         IAC SB AUTHENTICATION REPLY
                                         SRP CLIENT|ONE_WAY|
                                         ENCRYPT_USING_TELOPT ACCEPT
                                         yy yy yy yy yy yy yy yy ...
                                         IAC SE











<span class="grey">Wu                          Standards Track                     [Page 5]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-6" ></span>
<span class="grey"><a href="/doc/html/rfc2944">RFC 2944</a>               Telnet Authentication: SRP         September 2000</span>


<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>. Security Considerations</span>

   The ability to negotiate a common authentication mechanism between
   client and server is a feature of the authentication option that
   should be used with caution.  When the negotiation is performed, no
   authentication has yet occurred.  Therefore, each system has no way
   of knowing whether or not it is talking to the system it intends.  An
   intruder could attempt to negotiate the use of an authentication
   system which is either weak, or already compromised by the intruder.

   Since SRP relies on the security of the underlying public-key
   cryptosystem, the modulus &quot;n&quot; should be large enough to resist
   brute-force attack.  A length of at least 1024 bits is recommended,
   and implementations should reject attempts to use moduli that are
   shorter than 512 bits, or attempts to use invalid moduli and
   generator parameters (non-safe-prime &quot;n&quot; or non-primitive &quot;g&quot;).

<span class="h2"><a class="selflink" id="section-6" href="#section-6">6</a>. IANA Considerations</span>

   The authentication type SRP and its associated suboption values are
   registered with IANA.  Any suboption values used to extend the
   protocol as described in this document must be registered with IANA
   before use.  IANA is instructed not to issue new suboption values
   without submission of documentation of their use.

<span class="h2"><a class="selflink" id="section-7" href="#section-7">7</a>. References</span>

   [<a id="ref-RFC2941">RFC2941</a>]   Ts&#x27;o, T. and J. Altman, &quot;Telnet Authentication Option&quot;,
               <a href="/doc/html/rfc2941">RFC 2941</a>, September 2000.

   [<a id="ref-SRP">SRP</a>]       T. Wu, &quot;The Secure Remote Password Protocol&quot;, In
               Proceedings of the 1998 ISOC Network and Distributed
               System Security Symposium, San Diego, CA, pp. 97-111.

   [<a id="ref-RFC2945">RFC2945</a>]   Wu, T., &quot;The SRP Authentication and Key Exchange System&quot;,
               <a href="/doc/html/rfc2945">RFC 2945</a>, September 2000.

<span class="h2"><a class="selflink" id="section-8" href="#section-8">8</a>. Author&#x27;s Address</span>

   Thomas Wu
   Stanford University
   Stanford, CA 94305

   EMail: tjw@cs.Stanford.EDU







<span class="grey">Wu                          Standards Track                     [Page 6]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-7" ></span>
<span class="grey"><a href="/doc/html/rfc2944">RFC 2944</a>               Telnet Authentication: SRP         September 2000</span>


<span class="h2"><a class="selflink" id="section-9" href="#section-9">9</a>.  Full Copyright Statement</span>

   Copyright (C) The Internet Society (2000).  All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assigns.

   This document and the information contained herein is provided on an
   &quot;AS IS&quot; basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.



















Wu                          Standards Track                     [Page 7]
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

