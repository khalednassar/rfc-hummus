<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    rfc7512
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.33.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.33.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/draft-pechanec-pkcs11uri/">
  <meta name="description" content="The PKCS #11 URI Scheme (RFC )">
  <script src="https://www.ietf.org/lib/dt/7.33.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.33.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.33.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.33.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bgblue"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc7512.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc7512.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/pdfrfc/rfc7512.txt.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/rfc7512/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/rfc7512/" title="Datatracker information for this document">Tracker</a>] [<a href="mailto:draft-pechanec-pkcs11uri@ietf.org?subject=draft-pechanec-pkcs11uri" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=draft-pechanec-pkcs11uri-21.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-pechanec-pkcs11uri-21.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-pechanec-pkcs11uri-21.txt" title="Run an idnits check of this document">Nits</a>]

From: <a href="/doc/html/draft-pechanec-pkcs11uri-21">draft-pechanec-pkcs11uri-21</a>                      Proposed Standard
                                                            <a class="text-warning" href="https://www.rfc-editor.org/errata_search.php?rfc=7512&amp;rec_status=0">Errata exist</a></pre>
      </div>
    

    <div class="draftcontent">
    <pre>Internet Engineering Task Force (IETF)                       J. Pechanec
Request for Comments: 7512                                     D. Moffat
Category: Standards Track                             Oracle Corporation
ISSN: 2070-1721                                               April 2015


                        <span class="h1">The PKCS #11 URI Scheme</span>

Abstract

   This memo specifies a PKCS #11 Uniform Resource Identifier (URI)
   Scheme for identifying PKCS #11 objects stored in PKCS #11 tokens and
   also for identifying PKCS #11 tokens, slots, or libraries.  The URI
   scheme is based on how PKCS #11 objects, tokens, slots, and libraries
   are identified in &quot;PKCS #11 v2.20: Cryptographic Token Interface
   Standard&quot;.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="/doc/html/rfc5741#section-2">Section&nbsp;2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7512">http://www.rfc-editor.org/info/rfc7512</a>.

Copyright Notice

   Copyright (c) 2015 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="/doc/html/bcp78">BCP 78</a> and the IETF Trust&#x27;s Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.






<span class="grey">Pechanec &amp; Moffat            Standards Track                    [Page 1]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-2" ></span>
<span class="grey"><a href="/doc/html/rfc7512">RFC 7512</a>                 The PKCS #11 URI Scheme              April 2015</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-2">2</a>
   <a href="#section-2">2</a>. PKCS #11 URI Scheme Definition ..................................<a href="#page-4">4</a>
      <a href="#section-2.1">2.1</a>. PKCS #11 URI Scheme Name ...................................<a href="#page-4">4</a>
      <a href="#section-2.2">2.2</a>. PKCS #11 URI Scheme Status .................................<a href="#page-4">4</a>
      <a href="#section-2.3">2.3</a>. PKCS #11 URI Scheme Syntax .................................<a href="#page-4">4</a>
      <a href="#section-2.4">2.4</a>. PKCS #11 URI Scheme Query Attribute Semantics ..............<a href="#page-9">9</a>
      <a href="#section-2.5">2.5</a>. PKCS #11 URI Matching Guidelines ..........................<a href="#page-11">11</a>
      <a href="#section-2.6">2.6</a>. PKCS #11 URI Comparison ...................................<a href="#page-12">12</a>
      <a href="#section-2.7">2.7</a>. Generating PKCS #11 URIs ..................................<a href="#page-14">14</a>
   <a href="#section-3">3</a>. Examples of PKCS #11 URIs ......................................<a href="#page-14">14</a>
   <a href="#section-4">4</a>. IANA Considerations ............................................<a href="#page-17">17</a>
      <a href="#section-4.1">4.1</a>. URI Scheme Registration ...................................<a href="#page-17">17</a>
   <a href="#section-5">5</a>. Internationalization Considerations ............................<a href="#page-18">18</a>
   <a href="#section-6">6</a>. Security Considerations ........................................<a href="#page-18">18</a>
   <a href="#section-7">7</a>. References .....................................................<a href="#page-19">19</a>
      <a href="#section-7.1">7.1</a>. Normative References ......................................<a href="#page-19">19</a>
      <a href="#section-7.2">7.2</a>. Informative References ....................................<a href="#page-19">19</a>
   Contributors ......................................................<a href="#page-20">20</a>
   Authors&#x27; Addresses ................................................<a href="#page-20">20</a>

<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>.  Introduction</span>

   &quot;PKCS #11 v2.20: Cryptographic Token Interface Standard&quot; [<a href="#ref-PKCS11" title="&quot;PKCS #11 v2.20: Cryptographic Token Interface Standard&quot;">PKCS11</a>]
   specifies an API, called Cryptoki, for devices that hold
   cryptographic information and perform cryptographic functions.
   Cryptoki (pronounced &quot;crypto-key&quot; and short for &quot;cryptographic token
   interface&quot;) follows a simple object-based approach, addressing the
   goals of technology independence (any kind of device may be used) and
   resource sharing (multiple applications may access multiple devices),
   presenting applications with a common, logical view of the device --
   a cryptographic token.

   It is desirable for applications or libraries that work with PKCS #11
   tokens to accept a common identifier that consumers could use to
   identify an existing PKCS #11 storage object in a PKCS #11 token, an
   existing token itself, a slot, or an existing Cryptoki library (also
   called a producer, module, or provider).  The set of storage object
   types that can be stored in a PKCS #11 token includes a certificate;
   a data object; and a public, private, or secret key.  These objects
   can be uniquely identifiable via the PKCS #11 URI scheme defined in
   this document.  The set of attributes describing a storage object can
   contain an object label, its type, and its ID.  The set of attributes
   that identifies a PKCS #11 token can contain a token label,
   manufacturer name, serial number, and token model.  Attributes that
   can identify a slot are a slot ID, description, and manufacturer.
   Attributes that can identify a Cryptoki library are a library



<span class="grey">Pechanec &amp; Moffat            Standards Track                    [Page 2]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-3" ></span>
<span class="grey"><a href="/doc/html/rfc7512">RFC 7512</a>                 The PKCS #11 URI Scheme              April 2015</span>


   manufacturer, description, and version.  Library attributes may be
   necessary to use if more than one Cryptoki library provides a token
   and/or PKCS #11 objects of the same name.  A set of query attributes
   is provided as well.

   A PKCS #11 URI cannot identify other objects defined in the
   specification [<a href="#ref-PKCS11" title="&quot;PKCS #11 v2.20: Cryptographic Token Interface Standard&quot;">PKCS11</a>] aside from storage objects.  For example,
   objects not identifiable by a PKCS #11 URI include a hardware feature
   and mechanism.  Note that a Cryptoki library does not have to provide
   for storage objects at all.  The URI can still be used to identify a
   specific PKCS #11 token, slot, or an API producer in such a case.

   A subset of existing PKCS #11 structure members and object attributes
   was chosen to uniquely identify a PKCS #11 storage object, token,
   slot, or library in a configuration file, on a command line, or in a
   configuration property of something else.  Should there be a need for
   a more complex information exchange on PKCS #11 entities, a different
   means of data marshalling should be chosen accordingly.

   A PKCS #11 URI is not intended to be used to create new PKCS #11
   objects in tokens or to create PKCS #11 tokens.  It is solely to be
   used to identify and work with existing storage objects, tokens, and
   slots through the PKCS #11 API, or to identify Cryptoki libraries
   themselves.

   The URI scheme defined in this document is designed specifically with
   a mapping to the PKCS #11 API in mind.  The URI scheme definition
   uses the scheme, path, and query components defined in the &quot;Uniform
   Resource Identifier (URI): Generic Syntax&quot; [<a href="/doc/html/rfc3986" title="&quot;Uniform Resource Identifier (URI): Generic Syntax&quot;">RFC3986</a>] document.  The
   URI scheme does not use the hierarchical element for a naming
   authority in the path since the authority part could not be mapped to
   PKCS #11 API elements.  The URI scheme does not use the fragment
   component.

   If an application has no access to a producer or producers of the
   PKCS #11 API, the query component module attributes can be used.
   However, the PKCS #11 URI consumer can always decide to provide its
   own adequate user interface to locate and load PKCS #11 API
   producers.

   The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;,
   &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;MAY&quot;, and &quot;OPTIONAL&quot; in this
   document are to be interpreted as described in [<a href="/doc/html/rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].








<span class="grey">Pechanec &amp; Moffat            Standards Track                    [Page 3]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-4" ></span>
<span class="grey"><a href="/doc/html/rfc7512">RFC 7512</a>                 The PKCS #11 URI Scheme              April 2015</span>


<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  PKCS #11 URI Scheme Definition</span>

   In accordance with [<a href="/doc/html/rfc4395" title="&quot;Guidelines and Registration Procedures for New URI Schemes&quot;">RFC4395</a>], this section provides the information
   required to register the PKCS #11 URI scheme.

<span class="h3"><a class="selflink" id="section-2.1" href="#section-2.1">2.1</a>.  PKCS #11 URI Scheme Name</span>

   pkcs11

<span class="h3"><a class="selflink" id="section-2.2" href="#section-2.2">2.2</a>.  PKCS #11 URI Scheme Status</span>

   Permanent

<span class="h3"><a class="selflink" id="section-2.3" href="#section-2.3">2.3</a>.  PKCS #11 URI Scheme Syntax</span>

   A PKCS #11 URI is a sequence of attribute value pairs separated by a
   semicolon that form a one-level path component, optionally followed
   by a query.  Except for the value of the &quot;id&quot; attribute defined later
   in this section, these attribute value pairs and query components are
   composed entirely of textual data and therefore SHOULD all first be
   encoded as octets according to the UTF-8 character encoding
   [<a href="/doc/html/rfc3629" title="&quot;UTF-8, a transformation format of ISO 10646&quot;">RFC3629</a>], in accordance with <a href="/doc/html/rfc3986#section-2.5">Section&nbsp;2.5 of [RFC3986]</a>; then, only
   those octets that do not correspond to characters in the unreserved
   set or to permitted characters from the reserved set SHOULD be
   percent-encoded.  Note that the value of the &quot;id&quot; attribute SHOULD
   NOT be encoded as UTF-8 because it can contain non-textual data,
   instead it SHOULD be entirely percent-encoded.  See important caveats
   in Sections <a href="#section-2.5">2.5</a> and <a href="#section-5">5</a> regarding working with UTF-8 strings containing
   characters outside the US-ASCII character set.

   Grammar rules &quot;unreserved&quot; and &quot;pct-encoded&quot; in the PKCS #11 URI
   scheme definition below are imported from [<a href="/doc/html/rfc3986" title="&quot;Uniform Resource Identifier (URI): Generic Syntax&quot;">RFC3986</a>].  As a special
   case, note that according to <a href="/doc/html/rfc3986#appendix-A">Appendix&nbsp;A of [RFC3986]</a>, a space must be
   percent-encoded.

   The PKCS #11 specification imposes various limitations on the value
   of attributes, be it a more restrictive character set for the
   &quot;serial&quot; attribute or fixed-size buffers for almost all the others,
   including &quot;token&quot;, &quot;manufacturer&quot;, and &quot;model&quot; attributes.  The
   syntax of the PKCS #11 URI scheme does not impose such limitations.
   However, if the consumer of a PKCS #11 URI encounters values that
   would not be accepted by the PKCS #11 specification, it MUST refuse
   the URI as invalid.

   A PKCS #11 URI takes the following form (for explanation of Augmented
   BNF, see [<a href="/doc/html/rfc5234" title="&quot;Augmented BNF for Syntax Specifications: ABNF&quot;">RFC5234</a>]):





<span class="grey">Pechanec &amp; Moffat            Standards Track                    [Page 4]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-5" ></span>
<span class="grey"><a href="/doc/html/rfc7512">RFC 7512</a>                 The PKCS #11 URI Scheme              April 2015</span>


 pk11-URI             = &quot;pkcs11:&quot; pk11-path [ &quot;?&quot; pk11-query ]
 ; Path component and its attributes.  Path may be empty.
 pk11-path            = [ pk11-pattr *(&quot;;&quot; pk11-pattr) ]
 pk11-pattr           = pk11-token / pk11-manuf / pk11-serial /
                        pk11-model / pk11-lib-manuf /
                        pk11-lib-ver / pk11-lib-desc /
                        pk11-object / pk11-type / pk11-id /
                        pk11-slot-desc / pk11-slot-manuf /
                        pk11-slot-id / pk11-v-pattr
 ; Query component and its attributes.  Query may be empty.
 pk11-qattr           = pk11-pin-source / pk11-pin-value /
                        pk11-module-name / pk11-module-path /
                        pk11-v-qattr
 pk11-query           = [ pk11-qattr *(&quot;&amp;&quot; pk11-qattr) ]
 ; <a href="/doc/html/rfc3986#section-2.2">Section&nbsp;2.2 of [RFC3986]</a> mandates all potentially reserved characters
 ; that do not conflict with actual delimiters of the URI do not have
 ; to be percent-encoded.
 pk11-res-avail       = &quot;:&quot; / &quot;[&quot; / &quot;]&quot; / &quot;@&quot; / &quot;!&quot; / &quot;$&quot; /
                        &quot;&#x27;&quot; / &quot;(&quot; / &quot;)&quot; / &quot;*&quot; / &quot;+&quot; / &quot;,&quot; / &quot;=&quot;
 pk11-path-res-avail  = pk11-res-avail / &quot;&amp;&quot;
 ; &quot;/&quot; and &quot;?&quot; in the query component MAY be unencoded but &quot;&amp;&quot; MUST
 ; be encoded since it functions as a delimiter within the component.
 pk11-query-res-avail = pk11-res-avail / &quot;/&quot; / &quot;?&quot; / &quot;|&quot;
 pk11-pchar           = unreserved / pk11-path-res-avail / pct-encoded
 pk11-qchar           = unreserved / pk11-query-res-avail / pct-encoded
 pk11-token           = &quot;token&quot; &quot;=&quot; *pk11-pchar
 pk11-manuf           = &quot;manufacturer&quot; &quot;=&quot; *pk11-pchar
 pk11-serial          = &quot;serial&quot; &quot;=&quot; *pk11-pchar
 pk11-model           = &quot;model&quot; &quot;=&quot; *pk11-pchar
 pk11-lib-manuf       = &quot;library-manufacturer&quot; &quot;=&quot; *pk11-pchar
 pk11-lib-desc        = &quot;library-description&quot; &quot;=&quot; *pk11-pchar
 pk11-lib-ver         = &quot;library-version&quot; &quot;=&quot; 1*DIGIT [ &quot;.&quot; 1*DIGIT ]
 pk11-object          = &quot;object&quot; &quot;=&quot; *pk11-pchar
 pk11-type            = &quot;type&quot; &quot;=&quot; ( &quot;public&quot; / &quot;private&quot; / &quot;cert&quot; /
                        &quot;secret-key&quot; / &quot;data&quot; )
 pk11-id              = &quot;id&quot; &quot;=&quot; *pk11-pchar
 pk11-slot-manuf      = &quot;slot-manufacturer&quot; &quot;=&quot; *pk11-pchar
 pk11-slot-desc       = &quot;slot-description&quot; &quot;=&quot; *pk11-pchar
 pk11-slot-id         = &quot;slot-id&quot; &quot;=&quot; 1*DIGIT
 pk11-pin-source      = &quot;pin-source&quot; &quot;=&quot; *pk11-qchar
 pk11-pin-value       = &quot;pin-value&quot; &quot;=&quot; *pk11-qchar
 pk11-module-name     = &quot;module-name&quot; &quot;=&quot; *pk11-qchar
 pk11-module-path     = &quot;module-path&quot; &quot;=&quot; *pk11-qchar
 pk11-v-attr-nm-char  = ALPHA / DIGIT / &quot;-&quot; / &quot;_&quot;
 ; The permitted value of a vendor-specific attribute is based on
 ; whether the attribute is used in the path or in the query.
 pk11-v-pattr         = 1*pk11-v-attr-nm-char &quot;=&quot; *pk11-pchar
 pk11-v-qattr         = 1*pk11-v-attr-nm-char &quot;=&quot; *pk11-qchar



<span class="grey">Pechanec &amp; Moffat            Standards Track                    [Page 5]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-6" ></span>
<span class="grey"><a href="/doc/html/rfc7512">RFC 7512</a>                 The PKCS #11 URI Scheme              April 2015</span>


   The URI path component contains attributes that identify a resource
   in a one-level hierarchy provided by Cryptoki producers.  The query
   component can contain a few attributes that may be needed to retrieve
   the resource identified by the URI path component.  Attributes in the
   path component are delimited by the &#x27;;&#x27; character, attributes in the
   query component use &#x27;&amp;&#x27; as a delimiter.

   Both path and query components MAY contain vendor-specific
   attributes.  Such attribute names MUST NOT clash with existing
   attribute names.  Note that in accordance with [<a href="#ref-BCP178" title="&quot;Deprecating the &quot;">BCP178</a>], the
   previously used convention of starting vendor attributes with an &quot;x-&quot;
   prefix is now deprecated.

   The general &#x27;/&#x27; delimiter MUST be percent-encoded in the path
   component so that generic URI parsers never split the path component
   into multiple segments.  It MAY be unencoded in the query component.
   The delimiter &#x27;?&#x27;  MUST be percent-encoded in the path component
   since the PKCS #11 URI scheme uses a query component.  The delimiter
   &#x27;#&#x27; MUST be always percent-encoded so that generic URI parsers do not
   treat a hash as a beginning of a fragment identifier component.  All
   other generic delimiters MAY be used unencoded (&#x27;:&#x27;, &#x27;[&#x27;, &#x27;]&#x27;, and
   &#x27;@&#x27;) in a PKCS #11 URI.

   The following table presents mapping between the PKCS #11 URI path
   component attributes and the PKCS #11 API structure members and
   object attributes.  Given that PKCS #11 URI users may be quite
   ignorant about the PKCS #11 specification, the mapping is a product
   of a necessary compromise between how precisely the URI attribute
   names are mapped to the names in the specification and the ease of
   use and understanding of the URI scheme.

   +----------------------+---------------------+----------------------+
   | URI component path   | Attribute           | PKCS #11             |
   | attribute name       | represents          | specification        |
   |                      |                     | counterpart          |
   +----------------------+---------------------+----------------------+
   | id                   | key identifier for  | &quot;CKA_ID&quot; object      |
   |                      | object              | attribute            |
   +----------------------+---------------------+----------------------+
   | library-description  | character-string    | &quot;libraryDescription&quot; |
   |                      | description of the  | member of CK_INFO    |
   |                      | library             | structure.  It is a  |
   |                      |                     | UTF-8 string.        |








<span class="grey">Pechanec &amp; Moffat            Standards Track                    [Page 6]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-7" ></span>
<span class="grey"><a href="/doc/html/rfc7512">RFC 7512</a>                 The PKCS #11 URI Scheme              April 2015</span>


   +----------------------+---------------------+----------------------+
   | library-manufacturer | ID of the Cryptoki  | &quot;manufacturerID&quot;     |
   |                      | library             | member of the        |
   |                      | manufacturer        | CK_INFO structure.   |
   |                      |                     | It is a UTF-8        |
   |                      |                     | string.              |
   +----------------------+---------------------+----------------------+
   | library-version      | Cryptoki library    | &quot;libraryVersion&quot;     |
   |                      | version number      | member of the        |
   |                      |                     | CK_INFO structure.   |
   +----------------------+---------------------+----------------------+
   | manufacturer         | ID of the token     | &quot;manufacturerID&quot;     |
   |                      | manufacturer        | member of            |
   |                      |                     | CK_TOKEN_INFO        |
   |                      |                     | structure.  It is a  |
   |                      |                     | UTF-8 string.        |
   +----------------------+---------------------+----------------------+
   | model                | token model         | &quot;model&quot; member of    |
   |                      |                     | CK_TOKEN_INFO        |
   |                      |                     | structure.  It is a  |
   |                      |                     | UTF-8 string.        |
   +----------------------+---------------------+----------------------+
   | object               | description (name)  | &quot;CKA_LABEL&quot; object   |
   |                      | of the object       | attribute.  It is a  |
   |                      |                     | UTF-8 string.        |
   +----------------------+---------------------+----------------------+
   | serial               | character-string    | &quot;serialNumber&quot;       |
   |                      | serial number of    | member of            |
   |                      | the token           | CK_TOKEN_INFO        |
   |                      |                     | structure.           |
   +----------------------+---------------------+----------------------+
   | slot-description     | slot description    | &quot;slotDescription&quot;    |
   |                      |                     | member of            |
   |                      |                     | CK_SLOT_INFO         |
   |                      |                     | structure.  It is a  |
   |                      |                     | UTF-8 string.        |
   +----------------------+---------------------+----------------------+
   | slot-id              | Cryptoki-assigned   | decimal number of    |
   |                      | value that          | &quot;CK_SLOT_ID&quot; type.   |
   |                      | identifies a slot   |                      |
   +----------------------+---------------------+----------------------+
   | slot-manufacturer    | ID of the slot      | &quot;manufacturerID&quot;     |
   |                      | manufacturer        | member of            |
   |                      |                     | CK_SLOT_INFO         |
   |                      |                     | structure.  It is a  |
   |                      |                     | UTF-8 string.        |





<span class="grey">Pechanec &amp; Moffat            Standards Track                    [Page 7]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-8" ></span>
<span class="grey"><a href="/doc/html/rfc7512">RFC 7512</a>                 The PKCS #11 URI Scheme              April 2015</span>


   +----------------------+---------------------+----------------------+
   | token                | application-defined | &quot;label&quot; member of    |
   |                      | label, assigned     | the CK_TOKEN_INFO    |
   |                      | during token        | structure.  It is a  |
   |                      | initialization      | UTF-8 string.        |
   +----------------------+---------------------+----------------------+
   | type                 | object class (type) | &quot;CKA_CLASS&quot; object   |
   |                      |                     | attribute.           |
   +----------------------+---------------------+----------------------+

          Table 1: Mapping between URI Path Component Attributes
                     and PKCS #11 Specification Names

   The following table presents mapping between the &quot;type&quot; attribute
   values and corresponding PKCS #11 object classes.

                +-----------------+-----------------------+
                | Attribute value | PKCS #11 object class |
                +-----------------+-----------------------+
                | cert            | CKO_CERTIFICATE       |
                | data            | CKO_DATA              |
                | private         | CKO_PRIVATE_KEY       |
                | public          | CKO_PUBLIC_KEY        |
                | secret-key      | CKO_SECRET_KEY        |
                +-----------------+-----------------------+

               Table 2: Mapping between the &quot;type&quot; Attribute
                        and PKCS #11 Object Classes

   The query component attribute &quot;pin-source&quot; specifies where the
   application or library should find the normal user&#x27;s token PIN, the
   &quot;pin-value&quot; attribute provides the normal user&#x27;s PIN value directly,
   if needed, and the &quot;module-name&quot; and &quot;module-path&quot; attributes modify
   default settings for accessing PKCS #11 providers.  For the
   definition of a &quot;normal user&quot;, see [<a href="#ref-PKCS11" title="&quot;PKCS #11 v2.20: Cryptographic Token Interface Standard&quot;">PKCS11</a>].

   The ABNF rules above are a best-effort definition, and this paragraph
   specifies additional constraints.  A PKCS #11 URI MUST NOT contain
   duplicate attributes of the same name in the URI path component.  It
   means that each attribute may be present at most once in the PKCS #11
   URI path component.  Aside from the query attributes defined in this
   document, duplicate (vendor) attributes MAY be present in the URI
   query component and it is up to the URI consumer to decide on how to
   deal with such duplicates.

   As stated earlier in this section, the value of the &quot;id&quot; attribute
   can contain non-textual data.  This is because the corresponding PKCS
   #11 &quot;CKA_ID&quot; object attribute can contain arbitrary binary data.



<span class="grey">Pechanec &amp; Moffat            Standards Track                    [Page 8]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-9" ></span>
<span class="grey"><a href="/doc/html/rfc7512">RFC 7512</a>                 The PKCS #11 URI Scheme              April 2015</span>


   Therefore, the whole value of the &quot;id&quot; attribute SHOULD be percent-
   encoded.

   The &quot;library-version&quot; attribute represents the major and minor
   version number of the library and its format is &quot;M.N&quot;.  Both numbers
   are one byte in size; see the &quot;libraryVersion&quot; member of the CK_INFO
   structure in [<a href="#ref-PKCS11" title="&quot;PKCS #11 v2.20: Cryptographic Token Interface Standard&quot;">PKCS11</a>] for more information.  Value &quot;M&quot; for the
   attribute MUST be interpreted as &quot;M&quot; for the major and &quot;0&quot; for the
   minor version of the library.  If the attribute is present, the major
   version number is REQUIRED.  Both &quot;M&quot; and &quot;N&quot; MUST be decimal
   numbers.

   Slot ID is a Cryptoki-assigned number that is not guaranteed to be
   stable across PKCS #11 module initializations.  However, there are
   certain libraries and modules that provide stable slot identifiers.
   For these cases, when the slot description and manufacturer ID is not
   sufficient to uniquely identify a specific reader, the slot ID MAY be
   used to increase the precision of the token identification.  In other
   scenarios, using the slot IDs is likely to cause usability issues.

   An empty PKCS #11 URI path component attribute that does allow for an
   empty value matches a corresponding structure member or an object
   attribute with an empty value.  Note that according to the PKCS #11
   specification [<a href="#ref-PKCS11" title="&quot;PKCS #11 v2.20: Cryptographic Token Interface Standard&quot;">PKCS11</a>], empty character values in a PKCS #11 API
   producer must be padded with spaces and should not be NULL
   terminated.

<span class="h3"><a class="selflink" id="section-2.4" href="#section-2.4">2.4</a>.  PKCS #11 URI Scheme Query Attribute Semantics</span>

   An application can always ask for a PIN by any means it decides to.
   What is more, in order not to limit PKCS #11 URI portability, the
   &quot;pin-source&quot; attribute value format and interpretation is left to be
   implementation specific.  However, the following rules SHOULD be
   followed in descending order for the value of the &quot;pin-source&quot;
   attribute:

   o  If the value represents a URI, it SHOULD be treated as an object
      containing the PIN.  Such a URI may be &quot;file:&quot;, &quot;https:&quot;, another
      PKCS #11 URI, or something else.

   o  If the value contains &quot;|&lt;absolute-command-path&gt;&quot;, the
      implementation SHOULD read the PIN from the output of an
      application specified with absolute path &quot;&lt;absolute-command-
      path&gt;&quot;.  Note that character &quot;|&quot; representing a pipe does not have
      to be percent-encoded in the query component of a PKCS #11 URI.

   o  Interpret the value as needed in an implementation-dependent way.




<span class="grey">Pechanec &amp; Moffat            Standards Track                    [Page 9]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-10" ></span>
<span class="grey"><a href="/doc/html/rfc7512">RFC 7512</a>                 The PKCS #11 URI Scheme              April 2015</span>


   If a URI contains both &quot;pin-source&quot; and &quot;pin-value&quot; query attributes,
   the URI SHOULD be refused as invalid.

   Use of the &quot;pin-value&quot; attribute may have security-related
   consequences.  <a href="#section-6">Section 6</a> should be consulted before this attribute is
   ever used.  Standard percent-encoding rules SHOULD be followed for
   the attribute value.

   A consumer of PKCS #11 URIs MAY accept query component attributes
   &quot;module-name&quot; and &quot;module-path&quot; in order to modify default settings
   for accessing a PKCS #11 provider or providers.

   Processing the URI query module attributes SHOULD follow these rules:

   o  The attribute &quot;module-name&quot; SHOULD contain a case-insensitive PKCS
      #11 module name (not path nor filename) without system-specific
      affixes; said affix could be a &quot;.so&quot; or &quot;.DLL&quot; suffix, or a &quot;lib&quot;
      prefix, for example.  Not using system-specific affixes is
      expected to increase portability of PKCS #11 URIs among different
      systems.  A URI consumer searching for PKCS #11 modules SHOULD use
      a system or application-specific locations to find modules based
      on the name provided in the attribute.

   o  The attribute &quot;module-path&quot; SHOULD contain a system-specific
      absolute path to the PKCS #11 module or a system-specific absolute
      path to the directory of where PKCS #11 modules are located.  For
      security reasons, a URI with a relative path in this attribute
      SHOULD be rejected.

   o  The URI consumer MAY refuse to accept either of the attributes, or
      both.  If use of the attribute present in the URI string is not
      accepted, a warning message SHOULD be presented to the provider of
      the URI and system-specific module locations SHOULD be used.

   o  If either of the module attributes is present, only those modules
      found matching these query attributes SHOULD be used to search for
      an entity represented by the URI.

   o  The use of the module attributes does not suppress matching of any
      other URI path component attributes present in a URI.

   o  The semantics of using both attributes in the same URI string is
      implementation specific but such use SHOULD be avoided.  Attribute
      &quot;module-name&quot; is preferred to &quot;module-path&quot; due to its system-
      independent nature, but the latter may be more suitable for
      development and debugging.





<span class="grey">Pechanec &amp; Moffat            Standards Track                   [Page 10]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-11" ></span>
<span class="grey"><a href="/doc/html/rfc7512">RFC 7512</a>                 The PKCS #11 URI Scheme              April 2015</span>


   o  A URI MUST NOT contain multiple module attributes of the same
      name.

   Use of the module attributes may have security-related consequences.
   <a href="#section-6">Section 6</a> should be consulted before these attributes are ever used.

   A word &quot;module&quot; was chosen over a word &quot;library&quot; in these query
   attribute names to avoid confusion with semantically different
   library attributes used in the URI path component.

<span class="h3"><a class="selflink" id="section-2.5" href="#section-2.5">2.5</a>.  PKCS #11 URI Matching Guidelines</span>

   A PKCS #11 URI can identify PKCS #11 storage objects, tokens, slots,
   or Cryptoki libraries.  Note that since a URI may identify four
   different types of entities, the context within which the URI is used
   may be needed to determine the type.  For example, a URI with only
   library attributes may either represent all objects in all tokens in
   all Cryptoki libraries identified by the URI, all tokens in those
   libraries, or just the libraries.

   The following guidelines can help a PKCS #11 URI consumer (e.g., an
   application accepting PKCS #11 URIs) to match the URI with the
   desired resource.

   o  The consumer needs to know whether the URI is to identify PKCS #11
      storage object(s), token(s), slot(s), or Cryptoki producer(s).

   o  If the consumer is willing to accept query component module
      attributes, only those PKCS #11 providers matching these
      attributes SHOULD be worked with.  See <a href="#section-2.4">Section 2.4</a> for more
      information.

   o  An unrecognized attribute in the URI path component, including a
      vendor-specific attribute, SHOULD result in an empty set of
      matched resources.  The consumer can consider whether an error
      message presented to the user is appropriate in such a case.

   o  An unrecognized attribute in the URI query SHOULD be ignored.  The
      consumer can consider whether a warning message presented to the
      user is appropriate in such a case.

   o  An attribute not present in the URI path component but known to a
      consumer matches everything.  Each additional attribute present in
      the URI path component further restricts the selection.







<span class="grey">Pechanec &amp; Moffat            Standards Track                   [Page 11]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-12" ></span>
<span class="grey"><a href="/doc/html/rfc7512">RFC 7512</a>                 The PKCS #11 URI Scheme              April 2015</span>


   o  A logical extension of the above is that a URI with an empty path
      component matches everything.  For example, if used to identify
      storage objects, it matches all accessible objects in all tokens
      provided by all relevant PKCS #11 API producers.

   o  Note that use of PIN attributes may change the set of storage
      objects visible to the consumer.

   o  In addition to query component attributes defined in this
      document, vendor-specific query attributes may contain further
      information about how to perform the selection or other related
      information.

   As noted in <a href="#section-5">Section 5</a>, the PKCS #11 specification is not clear about
   how to normalize UTF-8-encoded Unicode characters [<a href="/doc/html/rfc3629" title="&quot;UTF-8, a transformation format of ISO 10646&quot;">RFC3629</a>].  For
   that reason, it is RECOMMENDED not to use characters outside the US-
   ASCII character set for labels and names.  However, those who
   discover a need to use such characters should be cautious,
   conservative, and expend extra effort to be sure they know what they
   are doing and that failure to do so may create both operational and
   security risks.  It means that when matching UTF-8 string-based
   attributes (see Table 1) with characters outside the US-ASCII
   repertoire, normalizing all UTF-8 strings before string comparison
   may be the only safe approach.  For example, for objects (keys), it
   means that PKCS #11 attribute search template would only contain
   attributes that are not UTF-8 strings and another pass through
   returned objects is then needed for UTF-8 string comparison after the
   normalization is applied.

<span class="h3"><a class="selflink" id="section-2.6" href="#section-2.6">2.6</a>.  PKCS #11 URI Comparison</span>

   Comparison of two URIs is a way of determining whether the URIs are
   equivalent without comparing the actual resource to which the URIs
   point.  The comparison of URIs aims to minimize false negatives while
   strictly avoiding false positives.  When working with UTF-8 strings
   with characters outside the US-ASCII character sets, see important
   caveats in Sections <a href="#section-2.5">2.5</a> and <a href="#section-5">5</a>.

   Two PKCS #11 URIs are said to be equal if URIs as character strings
   are identical as specified in <a href="/doc/html/rfc3986#section-6.2.1">Section&nbsp;6.2.1 of [RFC3986]</a>, or if both
   of the following rules are fulfilled:

   o  The set of attributes present in the URI is equal.  Note that the
      ordering of attributes in the URI string is not significant for
      the mechanism of comparison.

   o  The values of respective attributes are equal based on rules
      specified below



<span class="grey">Pechanec &amp; Moffat            Standards Track                   [Page 12]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-13" ></span>
<span class="grey"><a href="/doc/html/rfc7512">RFC 7512</a>                 The PKCS #11 URI Scheme              April 2015</span>


   The rules for comparing values of respective attributes are:

   o  The values of path component attributes &quot;library-description&quot;,
      &quot;library-manufacturer&quot;, &quot;manufacturer&quot;, &quot;model&quot;, &quot;object&quot;,
      &quot;serial&quot;, &quot;slot-description&quot;, &quot;slot-manufacturer&quot;, &quot;token&quot;,
      &quot;type&quot;, and the query component attribute &quot;module-name&quot; MUST be
      compared using a simple string comparison, as specified in
      <a href="/doc/html/rfc3986#section-6.2.1">Section&nbsp;6.2.1 of [RFC3986]</a>, after the case and the percent-
      encoding normalization were both applied as specified in
      <a href="/doc/html/rfc3986#section-6.2.2">Section&nbsp;6.2.2 of [RFC3986]</a>.

   o  The value of the attribute &quot;id&quot; MUST be compared using the simple
      string comparison after all bytes are percent-encoded using
      uppercase letters for digits A-F.

   o  The value of the attribute &quot;library-version&quot; MUST be processed as
      a specific scheme-based normalization permitted by <a href="/doc/html/rfc3986#section-6.2.3">Section&nbsp;6.2.3
      of [RFC3986]</a>.  The value MUST be split into a major and minor
      version with character &#x27;.&#x27; (dot) serving as a delimiter.  A
      library-version &quot;M&quot; MUST be treated as &quot;M&quot; for the major version
      and &quot;0&quot; for the minor version.  Then, resulting minor and major
      version numbers MUST be separately compared numerically.

   o  The value of the attribute &quot;slot-id&quot; MUST be processed as a
      specific scheme-based normalization permitted by <a href="/doc/html/rfc3986#section-6.2.3">Section&nbsp;6.2.3 of
      [RFC3986]</a> and compared numerically.

   o  The value of &quot;pin-source&quot;, if containing a &quot;file:&quot; URI or
      &quot;|&lt;absolute-command-path&gt;&quot;, MUST be compared using the simple
      string comparison after the full syntax-based normalization, as
      specified in <a href="/doc/html/rfc3986#section-6.2.2">Section&nbsp;6.2.2 of [RFC3986]</a>, is applied.  If the value
      of the &quot;pin-source&quot; attribute is believed to be overloaded, the
      case and percent-encoding normalization SHOULD be applied before
      the values are compared, but the exact mechanism of comparison is
      left to the application.

   o  The value of the attribute &quot;module-path&quot; MUST be compared using
      the simple string comparison after the full syntax-based
      normalization, as specified in <a href="/doc/html/rfc3986#section-6.2.2">Section&nbsp;6.2.2 of [RFC3986]</a>, is
      applied.

   o  When comparing vendor-specific attributes, the case and percent-
      encoding normalization, as specified in <a href="/doc/html/rfc3986#section-6.2.2">Section&nbsp;6.2.2 of
      [RFC3986]</a>, SHOULD be applied before the values are compared, but
      the exact mechanism of such a comparison is left to the
      application.





<span class="grey">Pechanec &amp; Moffat            Standards Track                   [Page 13]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-14" ></span>
<span class="grey"><a href="/doc/html/rfc7512">RFC 7512</a>                 The PKCS #11 URI Scheme              April 2015</span>


<span class="h3"><a class="selflink" id="section-2.7" href="#section-2.7">2.7</a>.  Generating PKCS #11 URIs</span>

   When generating URIs for PKCS #11 resources, the exact set of
   attributes used in a URI is inherently context specific.  A PKCS #11
   URI template [<a href="/doc/html/rfc6570" title="&quot;URI Template&quot;">RFC6570</a>] support MAY be provided by a URI-generating
   application to list URIs to access the same resource(s) again if the
   template captured the necessary context.

<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>.  Examples of PKCS #11 URIs</span>

   This section contains some examples of how PKCS #11 token objects,
   tokens, slots, and libraries can be identified using the PKCS #11 URI
   scheme.  Note that in some of the following examples, line breaks and
   spaces were inserted for better readability.  As specified in
   <a href="/doc/html/rfc3986#appendix-C">Appendix&nbsp;C of [RFC3986]</a>, whitespace SHOULD be ignored when extracting
   the URI.  Also note that all spaces that are part of the URIs are
   percent-encoded, as specified in <a href="/doc/html/rfc3986#appendix-A">Appendix&nbsp;A of [RFC3986]</a>.

   An empty PKCS #11 URI might be useful to PKCS #11 consumers.  See
   <a href="#section-2.5">Section 2.5</a> for more information on semantics of such a URI.

     pkcs11:

   One of the simplest and most useful forms might be a PKCS #11 URI
   that specifies only an object label and its type.  The default token
   is used so the URI does not specify it.  Note that when specifying
   public objects, a token PIN may not be required.

     pkcs11:object=my-pubkey;type=public

   When a private key is specified, either the &quot;pin-source&quot; attribute,
   &quot;pin-value&quot;, or an application-specific method would be usually used.
   Note that &#x27;/&#x27; is not percent-encoded in the &quot;pin-source&quot; attribute
   value since this attribute is part of the query component, not the
   path component, and thus is separated by &#x27;?&#x27; from the rest of the
   URI.

     pkcs11:object=my-key;type=private?pin-source=file:/etc/token

   The following example identifies a certificate in the software token.
   Note the use of an empty value for the attribute &quot;serial&quot;, which
   matches only empty &quot;serialNumber&quot; member of the &quot;CK_TOKEN_INFO&quot;
   structure.  Also note that the &quot;id&quot; attribute value is entirely
   percent-encoded, as recommended.  While &#x27;,&#x27; is in the reserved set,
   it does not have to be percent-encoded since it does not conflict
   with any sub-delimiters used.  The &#x27;#&#x27; character, as in &quot;The Software
   PKCS #11 Softtoken&quot;, MUST be percent-encoded.




<span class="grey">Pechanec &amp; Moffat            Standards Track                   [Page 14]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-15" ></span>
<span class="grey"><a href="/doc/html/rfc7512">RFC 7512</a>                 The PKCS #11 URI Scheme              April 2015</span>


     pkcs11:token=The%20Software%20PKCS%2311%20Softtoken;
            manufacturer=Snake%20Oil,%20Inc.;
            model=1.0;
            object=my-certificate;
            type=cert;
            id=%69%95%3E%5C%F4%BD%EC%91;
            serial=
            ?pin-source=file:/etc/token_pin

   The next example covers how to use the &quot;module-name&quot; query attribute.
   Considering that the module is located in the /usr/lib/
   libmypkcs11.so.1 file, the attribute value is &quot;mypkcs11&quot;, meaning
   only the module name without the full path and without the platform-
   specific &quot;lib&quot; prefix and &quot;.so.1&quot; suffix.

     pkcs11:object=my-sign-key;
            type=private
            ?module-name=mypkcs11

   The following example covers how to use the &quot;module-path&quot; query
   attribute.  The attribute may be useful if a user needs to provide
   the key via a PKCS #11 module stored on a removable media, for
   example.  Getting the PIN to access the private key here is left to
   be application specific.

     pkcs11:object=my-sign-key;
            type=private
            ?module-path=/mnt/libmypkcs11.so.1

   In the context of where a token is expected, the token can be
   identified without specifying any PKCS #11 objects.  A PIN might
   still be needed in the context of listing all objects in the token,
   for example.  <a href="#section-6">Section 6</a> should be consulted before the &quot;pin-value&quot;
   attribute is ever used.

     pkcs11:token=Software%20PKCS%2311%20softtoken;
            manufacturer=Snake%20Oil,%20Inc.
            ?pin-value=the-pin

   In the context where a slot is expected, the slot can be identified
   without specifying any PKCS #11 objects in any token that may be
   inserted in the slot.

     pkcs11:slot-description=Sun%20Metaslot







<span class="grey">Pechanec &amp; Moffat            Standards Track                   [Page 15]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-16" ></span>
<span class="grey"><a href="/doc/html/rfc7512">RFC 7512</a>                 The PKCS #11 URI Scheme              April 2015</span>


   The Cryptoki library alone can be also identified without specifying
   a PKCS #11 token or object.

     pkcs11:library-manufacturer=Snake%20Oil,%20Inc.;
            library-description=Soft%20Token%20Library;
            library-version=1.23

   The following example shows an attribute value with a semicolon.  In
   such a case, it MUST be percent-encoded.  The token attribute value
   MUST be read as &quot;My token; created by Joe&quot;.  Lowercase letters MAY be
   used in percent-encoding, as shown below in the &quot;id&quot; attribute value,
   but note that Sections <a href="#section-2.1">2.1</a> and <a href="#section-6.2.2.1">6.2.2.1</a> of [<a href="/doc/html/rfc3986" title="&quot;Uniform Resource Identifier (URI): Generic Syntax&quot;">RFC3986</a>] state that all
   percent-encoded characters SHOULD use the uppercase hexadecimal
   digits.  More specifically, if the URI string were to be compared,
   the algorithm defined in <a href="#section-2.6">Section 2.6</a> explicitly requires percent-
   encoding to use the uppercase digits A-F in the &quot;id&quot; attribute
   values.  And as explained in <a href="#section-2.3">Section 2.3</a>, library version &quot;3&quot; MUST be
   interpreted as &quot;3&quot; for the major and &quot;0&quot; for the minor version of the
   library.

     pkcs11:token=My%20token%25%20created%20by%20Joe;
            library-version=3;
            id=%01%02%03%Ba%dd%Ca%fe%04%05%06

   If there is any need to include a literal &quot;%;&quot; substring, for
   example, both characters MUST be escaped.  The token value MUST be
   read as &quot;A name with a substring %;&quot;.

     pkcs11:token=A%20name%20with%20a%20substring%20%25%3B;
            object=my-certificate;
            type=cert

   The next example includes a small A with acute in the token name.  It
   MUST be encoded in octets according to the UTF-8 character encoding
   and then percent-encoded.  Given that a small A with acute is U+225
   Unicode code point, the UTF-8 encoding is 195 161 in decimal, and
   that is &quot;%C3%A1&quot; in percent-encoding.  See also <a href="#section-5">Section 5</a> on the use
   of characters outside the US-ASCII character set for labels.

     pkcs11:token=Name%20with%20a%20small%20A%20with%20acute:%20%C3%A1;
            object=my-certificate;
            type=cert









<span class="grey">Pechanec &amp; Moffat            Standards Track                   [Page 16]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-17" ></span>
<span class="grey"><a href="/doc/html/rfc7512">RFC 7512</a>                 The PKCS #11 URI Scheme              April 2015</span>


   Both the path and query components MAY contain vendor-specific
   attributes.  Attributes in the query component MUST be delimited by
   &#x27;&amp;&#x27;.

     pkcs11:token=my-token;
            object=my-certificate;
            type=cert;
            vendor-aaa=value-a
            ?pin-source=file:/etc/token_pin
            &amp;vendor-bbb=value-b

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>.  IANA Considerations</span>

<span class="h3"><a class="selflink" id="section-4.1" href="#section-4.1">4.1</a>.  URI Scheme Registration</span>

   This document moves the &quot;pkcs11&quot; URI scheme from the &quot;Provisional URI
   Schemes&quot; registry to the &quot;Permanent URI Schemes&quot; registry.  The
   registration request complies with [<a href="/doc/html/rfc4395" title="&quot;Guidelines and Registration Procedures for New URI Schemes&quot;">RFC4395</a>].

      URI scheme name: pkcs11

      URI scheme status: permanent

      URI scheme syntax: Defined in <a href="/doc/html/rfc7512#section-2.3">Section&nbsp;2.3 of [RFC7512]</a>.

      URI scheme semantics: Defined in <a href="/doc/html/rfc7512#section-1">Section&nbsp;1 of [RFC7512]</a>.

      Encoding considerations: See Sections <a href="#section-2.3">2.3</a> and <a href="#section-5">5</a> of [<a href="/doc/html/rfc7512">RFC7512</a>].

      Applications/protocols that use this URI scheme name: For general
      information, see <a href="/doc/html/rfc7512#section-1">Section&nbsp;1 of [RFC7512]</a>.  A list of known
      consumers of the PKCS #11 URI include GnuTLS, Gnome, p11-kit,
      Oracle Solaris 11 and higher, OpenSC, OpenConnect, and FreeIPA.

      Interoperability considerations: See <a href="/doc/html/rfc7512#section-5">Section&nbsp;5 of [RFC7512]</a>.

      Security considerations: See <a href="/doc/html/rfc7512#section-6">Section&nbsp;6 of [RFC7512]</a>.

      Contact: Jan Pechanec &lt;Jan.Pechanec@Oracle.com&gt;, Darren Moffat
      &lt;Darren.Moffat@Oracle.com&gt;

      Author/Change Controller: IESG &lt;iesg@ietf.org&gt;

      References: [<a href="/doc/html/rfc7512">RFC7512</a>]







<span class="grey">Pechanec &amp; Moffat            Standards Track                   [Page 17]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-18" ></span>
<span class="grey"><a href="/doc/html/rfc7512">RFC 7512</a>                 The PKCS #11 URI Scheme              April 2015</span>


<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>.  Internationalization Considerations</span>

   The PKCS #11 specification does not specify a canonical form for
   strings of characters of the CK_UTF8CHAR type.  This presents the
   usual false negative and false positive (aliasing) concerns that
   arise when dealing with unnormalized strings.  Because all PKCS #11
   items are local and local security is assumed, these concerns are
   mainly about usability and interoperability.

   In order to improve the user experience, it is RECOMMENDED that
   applications that create PKCS #11 objects or label tokens not use
   characters outside the US-ASCII character set for the labels.  If
   that is not possible, labels SHOULD be normalized to Normalization
   Form C (NFC) [<a href="#ref-UAX15" title="&quot;Unicode Standard Annex #15: Unicode Normalization Forms&quot;">UAX15</a>].  For the same reason, PKCS #11 libraries, slots
   (token readers), and tokens SHOULD use US-ASCII characters only for
   their names, and if that is not possible, they SHOULD normalize their
   names to NFC.  When listing PKCS #11 libraries, slots, tokens, and/or
   objects, an application SHOULD normalize their names to NFC if
   characters outside of the US-ASCII character set are expected.  When
   matching PKCS #11 URIs to libraries, slots, tokens, and/or objects,
   applications MAY convert names to a chosen normalization form before
   the string comparison for matching, as those might predate these
   recommendations.  See also <a href="#section-2.5">Section 2.5</a>.

<span class="h2"><a class="selflink" id="section-6" href="#section-6">6</a>.  Security Considerations</span>

   There are general security considerations for URI schemes discussed
   in <a href="/doc/html/rfc3986#section-7">Section&nbsp;7 of [RFC3986]</a>.

   From those security considerations, <a href="/doc/html/rfc3986#section-7.1">Section&nbsp;7.1 of [RFC3986]</a> applies
   since there is no guarantee that the same PKCS #11 URI will always
   identify the same object, token, slot, or a library in the future.

   <a href="/doc/html/rfc3986#section-7.2">Section&nbsp;7.2 of [RFC3986]</a> applies since by accepting query component
   attributes &quot;module-name&quot; or &quot;module-path&quot;, the consumer potentially
   allows loading of arbitrary code into a process.

   <a href="/doc/html/rfc3986#section-7.5">Section&nbsp;7.5 of [RFC3986]</a> applies since a PKCS #11 URI may be used in
   world-readable command-line arguments to run applications, stored in
   public configuration files, or otherwise used in clear text.  For
   that reason, the &quot;pin-value&quot; attribute should only be used if the URI
   string itself is protected with the same level of security as the
   token PIN itself otherwise is.

   The PKCS #11 specification does not provide means to authenticate
   devices to users; it only authenticates users to tokens.  Instead,
   local and physical security are demanded: the user must be in
   possession of their tokens, and the system into whose slots the



<span class="grey">Pechanec &amp; Moffat            Standards Track                   [Page 18]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-19" ></span>
<span class="grey"><a href="/doc/html/rfc7512">RFC 7512</a>                 The PKCS #11 URI Scheme              April 2015</span>


   users&#x27; tokens are inserted must be secure.  As a result, the usual
   security considerations regarding normalization do not arise.  For
   the same reason, confusable script issues also do not arise.
   Nonetheless, if use of characters outside the US-ASCII character set
   is required, it is best to normalize to NFC all strings appearing in
   PKCS #11 API elements.  See also <a href="#section-5">Section 5</a>.

<span class="h2"><a class="selflink" id="section-7" href="#section-7">7</a>.  References</span>

<span class="h3"><a class="selflink" id="section-7.1" href="#section-7.1">7.1</a>.  Normative References</span>

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., &quot;Key words for use in RFCs to Indicate
              Requirement Levels&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc2119">RFC 2119</a>, March 1997,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC3629">RFC3629</a>]  Yergeau, F., &quot;UTF-8, a transformation format of ISO
              10646&quot;, STD 63, <a href="/doc/html/rfc3629">RFC 3629</a>, November 2003,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3629">http://www.rfc-editor.org/info/rfc3629</a>&gt;.

   [<a id="ref-RFC3986">RFC3986</a>]  Berners-Lee, T., Fielding, R., and L. Masinter, &quot;Uniform
              Resource Identifier (URI): Generic Syntax&quot;, STD 66, <a href="/doc/html/rfc3986">RFC</a>
              <a href="/doc/html/rfc3986">3986</a>, January 2005,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3986">http://www.rfc-editor.org/info/rfc3986</a>&gt;.

   [<a id="ref-RFC5234">RFC5234</a>]  Crocker, D., Ed. and P. Overell, &quot;Augmented BNF for Syntax
              Specifications: ABNF&quot;, STD 68, <a href="/doc/html/rfc5234">RFC 5234</a>, January 2008,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5234">http://www.rfc-editor.org/info/rfc5234</a>&gt;.

<span class="h3"><a class="selflink" id="section-7.2" href="#section-7.2">7.2</a>.  Informative References</span>

   [<a id="ref-BCP178">BCP178</a>]   Saint-Andre, P., Crocker, D., and M. Nottingham,
              &quot;Deprecating the &quot;X-&quot; Prefix and Similar Constructs in
              Application Protocols&quot;, <a href="/doc/html/rfc6648">RFC 6648</a>, <a href="/doc/html/bcp178">BCP 178</a>, June 2012,
              &lt;<a href="http://www.rfc-editor.org/info/bcp178">http://www.rfc-editor.org/info/bcp178</a>&gt;.

   [<a id="ref-PKCS11">PKCS11</a>]   RSA Laboratories, &quot;PKCS #11 v2.20: Cryptographic Token
              Interface Standard&quot;, Public Key Cryptography Standards
              PKCS#11-v2.20, June 2004.

   [<a id="ref-RFC4395">RFC4395</a>]  Hansen, T., Hardie, T., and L. Masinter, &quot;Guidelines and
              Registration Procedures for New URI Schemes&quot;, <a href="/doc/html/bcp35">BCP 35</a>, <a href="/doc/html/rfc4395">RFC</a>
              <a href="/doc/html/rfc4395">4395</a>, February 2006,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4395">http://www.rfc-editor.org/info/rfc4395</a>&gt;.

   [<a id="ref-RFC6570">RFC6570</a>]  Gregorio, J., Fielding, R., Hadley, M., Nottingham, M.,
              and D. Orchard, &quot;URI Template&quot;, <a href="/doc/html/rfc6570">RFC 6570</a>, March 2012,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6570">http://www.rfc-editor.org/info/rfc6570</a>&gt;.




<span class="grey">Pechanec &amp; Moffat            Standards Track                   [Page 19]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-20" ></span>
<span class="grey"><a href="/doc/html/rfc7512">RFC 7512</a>                 The PKCS #11 URI Scheme              April 2015</span>


   [<a id="ref-UAX15">UAX15</a>]    Davis, M., Ed. and K. Whistler, Ed., &quot;Unicode Standard
              Annex #15: Unicode Normalization Forms&quot;, Version Unicode
              7.0.0, June 2014, &lt;<a href="http://unicode.org/reports/tr15/">http://unicode.org/reports/tr15/</a>&gt;.

Contributors

   Stef Walter, Nikos Mavrogiannopoulos, Nico Williams, Dan Winship,
   Jaroslav Imrich, and Mark Phalan contributed to the development of
   this document.  Shawn Emery shepherded the document.

Authors&#x27; Addresses

   Jan Pechanec
   Oracle Corporation
   4180 Network Circle
   Santa Clara, CA 95054
   United States

   EMail: Jan.Pechanec@Oracle.com
   URI:   <a href="http://www.oracle.com">http://www.oracle.com</a>


   Darren J. Moffat
   Oracle Corporation
   Oracle Parkway
   Thames Valley Park
   Reading  RG6 1RA
   United Kingdom

   EMail: Darren.Moffat@Oracle.com
   URI:   <a href="http://www.oracle.com">http://www.oracle.com</a>




















Pechanec &amp; Moffat            Standards Track                   [Page 20]
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

