<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    rfc8951
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.33.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.33.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/draft-ietf-lamps-rfc7030est-clarify/">
  <meta name="description" content="Clarification of Enrollment over Secure Transport (EST): Transfer Encodings and ASN.1 (RFC )">
  <script src="https://www.ietf.org/lib/dt/7.33.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.33.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.33.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.33.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bgblue"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc8951.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc8951.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/rfc8951.xml" title="XML source for this document">xml</a>|<a href="https://www.rfc-editor.org/rfc/rfc8951.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/rfc8951/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/rfc8951/" title="Datatracker information for this document">Tracker</a>] [<a href="/group/lamps/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-lamps-rfc7030est-clarify@ietf.org?subject=draft-ietf-lamps-rfc7030est-clarify" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=draft-ietf-lamps-rfc7030est-clarify-10.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-ietf-lamps-rfc7030est-clarify-10.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-ietf-lamps-rfc7030est-clarify-10.txt" title="Run an idnits check of this document">Nits</a>]

From: <a href="/doc/html/draft-ietf-lamps-rfc7030est-clarify-10">draft-ietf-lamps-rfc7030est-clarify-10</a>           Proposed Standard</pre>
      </div>
    

    <div class="draftcontent">
    <pre>Internet Engineering Task Force (IETF)                     M. Richardson
Request for Comments: 8951                      Sandelman Software Works
Updates: <a href="/doc/html/rfc7030">7030</a>                                                  T. Werner
Category: Standards Track                                        Siemens
ISSN: 2070-1721                                                   W. Pan
                                                     Huawei Technologies
                                                           November 2020


   <span class="h1">Clarification of Enrollment over Secure Transport (EST): Transfer</span>
                          <span class="h1">Encodings and ASN.1</span>

Abstract

   This document updates <a href="/doc/html/rfc7030">RFC 7030</a>: Enrollment over Secure Transport to
   resolve some errata that were reported and that have proven to cause
   interoperability issues when <a href="/doc/html/rfc7030">RFC 7030</a> was extended.

   This document deprecates the specification of &quot;Content-Transfer-
   Encoding&quot; headers for Enrollment over Secure Transport (EST)
   endpoints.  This document fixes some syntactical errors in ASN.1 that
   were present.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="/doc/html/rfc7841#section-2">Section&nbsp;2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="https://www.rfc-editor.org/info/rfc8951">https://www.rfc-editor.org/info/rfc8951</a>.

Copyright Notice

   Copyright (c) 2020 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="/doc/html/bcp78">BCP 78</a> and the IETF Trust&#x27;s Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction
   2.  Terminology
   3.  Changes to EST Endpoint Processing
     3.1.  White Space Processing
     3.2.  Changes to <a href="/doc/html/rfc7030#section-4">Section&nbsp;4 of RFC 7030</a>
       3.2.1.  <a href="#section-4.1.3">Section 4.1.3</a>
       3.2.2.  <a href="#section-4.3.1">Section 4.3.1</a>
       3.2.3.  <a href="#section-4.3.2">Section 4.3.2</a>
       3.2.4.  <a href="#section-4.4.2">Section 4.4.2</a>
       3.2.5.  <a href="#section-4.5.2">Section 4.5.2</a>
   4.  Clarification of ASN.1 for Certificate Attribute Set
   5.  Clarification of Error Messages for Certificate Enrollment
           Operations
     5.1.  Updating <a href="#section-4.2.3">Section 4.2.3</a>: Simple Enroll and Re-enroll
           Response
     5.2.  Updating <a href="#section-4.4.2">Section 4.4.2</a>: Server-Side Key Generation Response
   6.  Privacy Considerations
   7.  Security Considerations
   8.  IANA Considerations
   9.  References
     9.1.  Normative References
     9.2.  Informative References
   <a href="#appendix-A">Appendix A</a>.  ASN.1 Module
   Acknowledgements
   Authors&#x27; Addresses

<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>.  Introduction</span>

   Enrollment over Secure Transport (EST) is defined in [<a href="/doc/html/rfc7030" title="&quot;Enrollment over Secure Transport&quot;">RFC7030</a>].  The
   EST specification defines a number of HTTP endpoints for certificate
   enrollment and management.  The details of the transaction were
   defined in terms of MIME headers, as defined in [<a href="/doc/html/rfc2045" title="&quot;Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies&quot;">RFC2045</a>], rather
   than in terms of the HTTP protocol, as defined in [<a href="/doc/html/rfc7230" title="&quot;Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing&quot;">RFC7230</a>] and
   [<a href="/doc/html/rfc7231" title="&quot;Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content&quot;">RFC7231</a>].

   [<a id="ref-RFC2616">RFC2616</a>] and later <a href="/doc/html/rfc7231#appendix-A.5">Appendix&nbsp;A.5 of [RFC7231]</a> have text specifically
   deprecating Content-Transfer-Encoding.  However, [<a href="/doc/html/rfc7030" title="&quot;Enrollment over Secure Transport&quot;">RFC7030</a>]
   incorrectly uses this header.

   Any updates to [<a href="/doc/html/rfc7030" title="&quot;Enrollment over Secure Transport&quot;">RFC7030</a>] to bring it in line with HTTP processing
   risk changing the on-wire protocol in a way that is not backwards
   compatible.  However, reports from implementers suggest that many
   implementations do not send the Content-Transfer-Encoding, and many
   of them ignore it.  The consequence is that simply deprecating the
   header would remain compatible with current implementations.

   [<a id="ref-BRSKI">BRSKI</a>] extends [<a href="/doc/html/rfc7030" title="&quot;Enrollment over Secure Transport&quot;">RFC7030</a>], adding new functionality.  Interop testing
   of the protocol has revealed that unusual processing called out in
   [<a href="/doc/html/rfc7030" title="&quot;Enrollment over Secure Transport&quot;">RFC7030</a>] causes confusion.

   EST is currently specified as part of [<a href="#ref-IEC62351" title="&quot;Power systems management and associated information exchange - Data and communications security - Part 9: Cyber security key management for power system equipment&quot;">IEC62351</a>] and is widely used
   in government, utilities, and financial markets today.

   This document, therefore, revises [<a href="/doc/html/rfc7030" title="&quot;Enrollment over Secure Transport&quot;">RFC7030</a>] to reflect the field
   reality, deprecating the extraneous field.

   This document deals with errata numbers [<a href="#ref-errata4384">errata4384</a>], [<a href="#ref-errata5107">errata5107</a>],
   [<a href="#ref-errata5108">errata5108</a>], and [<a href="#ref-errata5904">errata5904</a>].

   This document deals with [<a href="#ref-errata5107">errata5107</a>] and [<a href="#ref-errata5904">errata5904</a>] in <a href="#section-3">Section 3</a>.
   [<a href="#ref-errata5108">errata5108</a>] is dealt with in <a href="#section-5">Section 5</a>.  [<a href="#ref-errata4384">errata4384</a>] is closed by
   correcting the ASN.1 Module in <a href="#section-4">Section 4</a>.

<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  Terminology</span>

   The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;,
   &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;NOT RECOMMENDED&quot;, &quot;MAY&quot;, and
   &quot;OPTIONAL&quot; in this document are to be interpreted as described in
   <a href="/doc/html/bcp14">BCP 14</a> [<a href="/doc/html/rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>] [<a href="/doc/html/rfc8174" title="&quot;Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words&quot;">RFC8174</a>] when, and only when, they appear in all
   capitals, as shown here.

<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>.  Changes to EST Endpoint Processing</span>

   Sections <a href="#section-4.1.3">4.1.3</a> (CA Certificates Response, /cacerts), 4.3.1 and 4.3.2
   (Full CMC, /fullcmc), 4.4.2 (Server-Side Key Generation,
   /serverkeygen), and 4.5.2 (CSR Attributes, /csrattrs) of [<a href="/doc/html/rfc7030" title="&quot;Enrollment over Secure Transport&quot;">RFC7030</a>]
   specify the use of base64 encoding with a Content-Transfer-Encoding
   for requests and responses.

   This document updates [<a href="/doc/html/rfc7030" title="&quot;Enrollment over Secure Transport&quot;">RFC7030</a>] to require the POST request and
   payload response of all endpoints using base64 encoding, as specified
   in <a href="/doc/html/rfc4648#section-4">Section&nbsp;4 of [RFC4648]</a>.  In both cases, the Distinguished Encoding
   Rules (DER) [<a href="#ref-X.690" title="&quot;Information Technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)&quot;">X.690</a>] are used to produce the input for the base64
   encoding routine.  This format is to be used regardless of any
   Content-Transfer-Encoding header, and any value in such a header MUST
   be ignored.

<span class="h3"><a class="selflink" id="section-3.1" href="#section-3.1">3.1</a>.  White Space Processing</span>

   Note that &quot;base64&quot; as used in the HTTP [<a href="/doc/html/rfc2616" title="&quot;Hypertext Transfer Protocol -- HTTP/1.1&quot;">RFC2616</a>] does not permit
   CRLF, while the &quot;base64&quot; used in MIME [<a href="/doc/html/rfc2045" title="&quot;Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies&quot;">RFC2045</a>] does.  This
   specification clarifies that despite what [<a href="/doc/html/rfc2616" title="&quot;Hypertext Transfer Protocol -- HTTP/1.1&quot;">RFC2616</a>] says, white space
   including CR, LF, spaces (ASCII 32), and tabs (ASCII 9) SHOULD be
   tolerated by receivers.  Senders are not required to insert any kind
   of white space.

<span class="h3"><a class="selflink" id="section-3.2" href="#section-3.2">3.2</a>.  Changes to <a href="/doc/html/rfc7030#section-4">Section&nbsp;4 of RFC 7030</a></span>

<span class="h4"><a class="selflink" id="section-3.2.1" href="#section-3.2.1">3.2.1</a>.  <a href="#section-4.1.3">Section 4.1.3</a></span>

   Replace:

   |  A successful response MUST be a certs-only CMC Simple PKI
   |  Response, as defined in [<a href="/doc/html/rfc5272" title="&quot;Certificate Management over CMS (CMC)&quot;">RFC5272</a>], containing the certificates
   |  described in the following paragraph.  The HTTP content-type of
   |  &quot;application/pkcs7-mime&quot; is used.  The Simple PKI Response is sent
   |  with a Content-Transfer-Encoding of &quot;base64&quot; [<a href="/doc/html/rfc2045" title="&quot;Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies&quot;">RFC2045</a>].

   with:

   |  A successful response MUST be a certs-only CMC Simple PKI
   |  Response, as defined in [<a href="/doc/html/rfc5272" title="&quot;Certificate Management over CMS (CMC)&quot;">RFC5272</a>], containing the certificates
   |  described in the following paragraph.  The HTTP content-type of
   |  &quot;application/pkcs7-mime&quot; is used.  The CMC Simple PKI Response is
   |  encoded in base64 [<a href="/doc/html/rfc4648" title="&quot;The Base16, Base32, and Base64 Data Encodings&quot;">RFC4648</a>].

<span class="h4"><a class="selflink" id="section-3.2.2" href="#section-3.2.2">3.2.2</a>.  <a href="#section-4.3.1">Section 4.3.1</a></span>

   Replace:

   |  If the HTTP POST to /fullcmc is not a valid Full PKI Request, the
   |  server MUST reject the message.  The HTTP content-type used is
   |  &quot;application/pkcs7-mime&quot; with an smime-type parameter &quot;CMC-
   |  request&quot;, as specified in [<a href="/doc/html/rfc5273" title="&quot;Certificate Management over CMS (CMC): Transport Protocols&quot;">RFC5273</a>].  The body of the message is
   |  the binary value of the encoding of the PKI Request with a
   |  Content-Transfer-Encoding of &quot;base64&quot; [<a href="/doc/html/rfc2045" title="&quot;Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies&quot;">RFC2045</a>].

   with:

   |  If the HTTP POST to /fullcmc is not a valid Full PKI Request, the
   |  server MUST reject the message.  The HTTP content-type used is
   |  &quot;application/pkcs7-mime&quot; with an smime-type parameter &quot;CMC-
   |  request&quot;, as specified in [<a href="/doc/html/rfc5273" title="&quot;Certificate Management over CMS (CMC): Transport Protocols&quot;">RFC5273</a>].  The body of the message is
   |  encoded in base64 [<a href="/doc/html/rfc4648" title="&quot;The Base16, Base32, and Base64 Data Encodings&quot;">RFC4648</a>].

<span class="h4"><a class="selflink" id="section-3.2.3" href="#section-3.2.3">3.2.3</a>.  <a href="#section-4.3.2">Section 4.3.2</a></span>

   Replace:

   |  The body of the message is the binary value of the encoding of the
   |  PKI Response with a Content-Transfer-Encoding of &quot;base64&quot;
   |  [<a href="/doc/html/rfc2045" title="&quot;Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies&quot;">RFC2045</a>].

   with:

   |  The body of the message is the base64 [<a href="/doc/html/rfc4648" title="&quot;The Base16, Base32, and Base64 Data Encodings&quot;">RFC4648</a>] encoding of the
   |  PKI Response.

<span class="h4"><a class="selflink" id="section-3.2.4" href="#section-3.2.4">3.2.4</a>.  <a href="#section-4.4.2">Section 4.4.2</a></span>

   Replace:

   |  An &quot;application/pkcs8&quot; part consists of the base64-encoded DER-
   |  encoded [<a href="#ref-X.690" title="&quot;Information Technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)&quot;">X.690</a>] PrivateKeyInfo with a Content-Transfer-Encoding of
   |  &quot;base64&quot; [<a href="/doc/html/rfc2045" title="&quot;Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies&quot;">RFC2045</a>].

   with:

   |  An &quot;application/pkcs8&quot; part consists of the base64-encoded, DER-
   |  encoded [<a href="#ref-X.690" title="&quot;Information Technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)&quot;">X.690</a>] PrivateKeyInfo.

   Replace:

   |  In all three additional encryption cases, the EnvelopedData is
   |  returned in the response as an &quot;application/pkcs7-mime&quot; part with
   |  an smime-type parameter of &quot;server-generated-key&quot; and a Content-
   |  Transfer-Encoding of &quot;base64&quot;.

   with:

   |  In all three additional encryption cases, the EnvelopedData is
   |  returned in the response as an &quot;application/pkcs7-mime&quot; part with
   |  an smime-type parameter of &quot;server-generated-key&quot;.  It is base64
   |  encoded [<a href="/doc/html/rfc4648" title="&quot;The Base16, Base32, and Base64 Data Encodings&quot;">RFC4648</a>].

<span class="h4"><a class="selflink" id="section-3.2.5" href="#section-3.2.5">3.2.5</a>.  <a href="#section-4.5.2">Section 4.5.2</a></span>

   This section is updated in its entirety in <a href="#section-4">Section 4</a>.

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>.  Clarification of ASN.1 for Certificate Attribute Set</span>

   <a href="/doc/html/rfc7030#section-4.5.2">Section&nbsp;4.5.2 of [RFC7030]</a> is to be replaced with the following text:

   |  4.5.2 CSR Attributes Response
   |
   |  If locally configured policy for an authenticated EST client
   |  indicates a CSR Attributes Response is to be provided, the server
   |  response MUST include an HTTP 200 response code.  An HTTP response
   |  code of 204 or 404 indicates that a CSR Attributes Response is not
   |  available.  Regardless of the response code, the EST server and CA
   |  MAY reject any subsequent enrollment requests for any reason,
   |  e.g., incomplete CSR attributes in the request.
   |
   |  Responses to attribute request messages MUST be encoded as the
   |  content-type of &quot;application/csrattrs&quot; and are to be &quot;base64&quot;
   |  [<a href="/doc/html/rfc4648" title="&quot;The Base16, Base32, and Base64 Data Encodings&quot;">RFC4648</a>] encoded.  The syntax for application/csrattrs body is as
   |  follows:
   |
   |     CsrAttrs ::= SEQUENCE SIZE (0..MAX) OF AttrOrOID
   |
   |     AttrOrOID ::= CHOICE {
   |       oid        OBJECT IDENTIFIER,
   |       attribute  Attribute {{AttrSet}} }
   |
   |     AttrSet ATTRIBUTE ::= { ... }
   |
   |  An EST server includes zero or more OIDs or attributes [<a href="/doc/html/rfc2986" title="&quot;PKCS #10: Certification Request Syntax Specification Version 1.7&quot;">RFC2986</a>]
   |  that it requests the client to use in the certification request.
   |  The client MUST ignore any OID or attribute it does not recognize.
   |  When the server encodes CSR attributes as an empty SEQUENCE, it
   |  means that the server has no specific additional information it
   |  desires in a client certification request (this is functionally
   |  equivalent to an HTTP response code of 204 or 404).
   |
   |  If the CA requires a particular cryptographic algorithm or use of
   |  a particular signature scheme (e.g., certification of a public key
   |  based on a certain elliptic curve or signing using a certain hash
   |  algorithm), it MUST provide that information in the CSR Attribute
   |  Response.  If an EST server requires the linking of identity and
   |  POP information (see <a href="#section-3.5">Section 3.5</a>), it MUST include the
   |  challengePassword OID in the CSR Attributes Response.
   |
   |  The structure of the CSR Attributes Response SHOULD, to the
   |  greatest extent possible, reflect the structure of the CSR it is
   |  requesting.  Requests to use a particular signature scheme (e.g.,
   |  using a particular hash function) are represented as an OID to be
   |  reflected in the SignatureAlgorithm of the CSR.  Requests to use a
   |  particular cryptographic algorithm (e.g., certification of a
   |  public key based on a certain elliptic curve) are represented as
   |  an attribute, to be reflected as the AlgorithmIdentifier of the
   |  SubjectPublicKeyInfo, with a type indicating the algorithm and the
   |  values indicating the particular parameters specific to the
   |  algorithm.  Requests for descriptive information from the client
   |  are made by an attribute, to be represented as Attributes of the
   |  CSR, with a type indicating the [<a href="/doc/html/rfc2985" title="&quot;PKCS #9: Selected Object Classes and Attribute Types Version 2.0&quot;">RFC2985</a>] extensionRequest and the
   |  values indicating the particular attributes desired to be included
   |  in the resulting certificate&#x27;s extensions.
   |
   |  The sequence is Distinguished Encoding Rules (DER) encoded [<a href="#ref-X.690" title="&quot;Information Technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)&quot;">X.690</a>]
   |  and then base64 encoded (<a href="/doc/html/rfc4648#section-4">Section&nbsp;4 of [RFC4648]</a>).  The resulting
   |  text forms the application/csrattr body, without headers.
   |
   |  For example, if a CA requests that a client a) submit a
   |  certification request containing the challengePassword (indicating
   |  that linking of identity and POP information is requested; see
   |  <a href="#section-3.5">Section 3.5</a>), b) submit an extensionRequest with the Media Access
   |  Control (MAC) address [<a href="/doc/html/rfc2307" title="&quot;An Approach for Using LDAP as a Network Information Service&quot;">RFC2307</a>] of the client, and c) use the
   |  secp384r1 elliptic curve to sign using the SHA384 hash function,
   |  then it takes the following:
   |
   |         OID:        challengePassword (1.2.840.113549.1.9.7)
   |
   |         Attribute:  type = extensionRequest (1.2.840.113549.1.9.14)
   |                     value = macAddress (1.3.6.1.1.1.1.22)
   |
   |         Attribute:  type = id-ecPublicKey (1.2.840.10045.2.1)
   |                     value = secp384r1 (1.3.132.0.34)
   |
   |         OID:        ecdsaWithSHA384 (1.2.840.10045.4.3.3)
   |
   |  and encodes them into an ASN.1 SEQUENCE to produce:
   |
   |   30 41 06 09 2a 86 48 86 f7 0d 01 09 07 30 12 06 07 2a 86 48 ce 3d
   |   02 01 31 07 06 05 2b 81 04 00 22 30 16 06 09 2a 86 48 86 f7 0d 01
   |   09 0e 31 09 06 07 2b 06 01 01 01 01 16 06 08 2a 86 48 ce 3d 04 03
   |   03
   |
   |  and then base64 encodes the resulting ASN.1 SEQUENCE to produce:
   |
   |    MEEGCSqGSIb3DQEJBzASBgcqhkjOPQIBMQcGBSuBBAAiMBYGCSqGSIb3DQEJDjEJ
   |    BgcrBgEBAQEWBggqhkjOPQQDAw==

<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>.  Clarification of Error Messages for Certificate Enrollment</span>
<span class="h2">    Operations</span>

   [<a id="ref-errata5108">errata5108</a>] clarifies what format the error messages are to be in.
   Previously, a client might be confused into believing that an error
   returned with type text/plain was not intended to be an error.

<span class="h3"><a class="selflink" id="section-5.1" href="#section-5.1">5.1</a>.  Updating <a href="#section-4.2.3">Section 4.2.3</a>: Simple Enroll and Re-enroll Response</span>

   Replace:

   |  If the content-type is not set, the response data MUST be a
   |  plaintext human-readable error message containing explanatory
   |  information describing why the request was rejected (for example,
   |  indicating that CSR attributes are incomplete).

   with:

   |  If the content-type is not set, the response data MUST be a
   |  plaintext human-readable error message containing explanatory
   |  information describing why the request was rejected (for example,
   |  indicating that CSR attributes are incomplete).  Servers MAY use
   |  the &quot;text/plain&quot; content-type [<a href="/doc/html/rfc2046" title="&quot;Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types&quot;">RFC2046</a>] for human-readable errors.

<span class="h3"><a class="selflink" id="section-5.2" href="#section-5.2">5.2</a>.  Updating <a href="#section-4.4.2">Section 4.4.2</a>: Server-Side Key Generation Response</span>

   Replace:

   |  If the content-type is not set, the response data MUST be a
   |  plaintext human-readable error message.

   with:

   |  If the content-type is not set, the response data MUST be a
   |  plaintext human-readable error message.  Servers MAY use the
   |  &quot;text/plain&quot; content-type [<a href="/doc/html/rfc2046" title="&quot;Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types&quot;">RFC2046</a>] for human-readable errors.

<span class="h2"><a class="selflink" id="section-6" href="#section-6">6</a>.  Privacy Considerations</span>

   This document does not disclose any additional identities that either
   an active or passive observer would see with [<a href="/doc/html/rfc7030" title="&quot;Enrollment over Secure Transport&quot;">RFC7030</a>].

<span class="h2"><a class="selflink" id="section-7" href="#section-7">7</a>.  Security Considerations</span>

   This document clarifies an existing security mechanism.  It does not
   create any new protocol mechanisms.

   All security considerations from [<a href="/doc/html/rfc7030" title="&quot;Enrollment over Secure Transport&quot;">RFC7030</a>] also apply to the
   clarifications described in this document.

<span class="h2"><a class="selflink" id="section-8" href="#section-8">8</a>.  IANA Considerations</span>

   The ASN.1 module in <a href="#appendix-A">Appendix A</a> of this document makes use of object
   identifiers (OIDs).

   IANA has registered an OID for id-mod-est-2019 (1.3.6.1.5.5.7.0.98)
   in the &quot;SMI Security for PKIX Module Identifier&quot; registry for the
   ASN.1 module.

   The OID for the Asymmetric Decryption Key Identifier
   (1.2.840.113549.1.9.16.2.54) was previously defined in [<a href="/doc/html/rfc7030" title="&quot;Enrollment over Secure Transport&quot;">RFC7030</a>].
   IANA has updated the Reference column for the Asymmetric Decryption
   Key Identifier attribute to also include a reference to this
   document.

<span class="h2"><a class="selflink" id="section-9" href="#section-9">9</a>.  References</span>

<span class="h3"><a class="selflink" id="section-9.1" href="#section-9.1">9.1</a>.  Normative References</span>

   [<a id="ref-errata4384">errata4384</a>]
              RFC Errata, Erratum ID 4384, <a href="/doc/html/rfc7030">RFC 7030</a>,
              &lt;<a href="https://www.rfc-editor.org/errata/eid4384">https://www.rfc-editor.org/errata/eid4384</a>&gt;.

   [<a id="ref-errata5107">errata5107</a>]
              RFC Errata, Erratum ID 5107, <a href="/doc/html/rfc7030">RFC 7030</a>,
              &lt;<a href="https://www.rfc-editor.org/errata/eid5107">https://www.rfc-editor.org/errata/eid5107</a>&gt;.

   [<a id="ref-errata5108">errata5108</a>]
              RFC Errata, Erratum ID 5108, <a href="/doc/html/rfc7030">RFC 7030</a>,
              &lt;<a href="https://www.rfc-editor.org/errata/eid5108">https://www.rfc-editor.org/errata/eid5108</a>&gt;.

   [<a id="ref-errata5904">errata5904</a>]
              RFC Errata, Erratum ID 5904, <a href="/doc/html/rfc7030">RFC 7030</a>,
              &lt;<a href="https://www.rfc-editor.org/errata/eid5904">https://www.rfc-editor.org/errata/eid5904</a>&gt;.

   [<a id="ref-IEC62351">IEC62351</a>] International Electrotechnical Commission, &quot;Power systems
              management and associated information exchange - Data and
              communications security - Part 9: Cyber security key
              management for power system equipment&quot;, ISO/
              IEC 62351-9:2017, May 2017.

   [<a id="ref-RFC2045">RFC2045</a>]  Freed, N. and N. Borenstein, &quot;Multipurpose Internet Mail
              Extensions (MIME) Part One: Format of Internet Message
              Bodies&quot;, <a href="/doc/html/rfc2045">RFC 2045</a>, DOI 10.17487/RFC2045, November 1996,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2045">https://www.rfc-editor.org/info/rfc2045</a>&gt;.

   [<a id="ref-RFC2046">RFC2046</a>]  Freed, N. and N. Borenstein, &quot;Multipurpose Internet Mail
              Extensions (MIME) Part Two: Media Types&quot;, <a href="/doc/html/rfc2046">RFC 2046</a>,
              DOI 10.17487/RFC2046, November 1996,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2046">https://www.rfc-editor.org/info/rfc2046</a>&gt;.

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., &quot;Key words for use in RFCs to Indicate
              Requirement Levels&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc2119">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC2986">RFC2986</a>]  Nystrom, M. and B. Kaliski, &quot;PKCS #10: Certification
              Request Syntax Specification Version 1.7&quot;, <a href="/doc/html/rfc2986">RFC 2986</a>,
              DOI 10.17487/RFC2986, November 2000,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2986">https://www.rfc-editor.org/info/rfc2986</a>&gt;.

   [<a id="ref-RFC4648">RFC4648</a>]  Josefsson, S., &quot;The Base16, Base32, and Base64 Data
              Encodings&quot;, <a href="/doc/html/rfc4648">RFC 4648</a>, DOI 10.17487/RFC4648, October 2006,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4648">https://www.rfc-editor.org/info/rfc4648</a>&gt;.

   [<a id="ref-RFC5272">RFC5272</a>]  Schaad, J. and M. Myers, &quot;Certificate Management over CMS
              (CMC)&quot;, <a href="/doc/html/rfc5272">RFC 5272</a>, DOI 10.17487/RFC5272, June 2008,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5272">https://www.rfc-editor.org/info/rfc5272</a>&gt;.

   [<a id="ref-RFC5273">RFC5273</a>]  Schaad, J. and M. Myers, &quot;Certificate Management over CMS
              (CMC): Transport Protocols&quot;, <a href="/doc/html/rfc5273">RFC 5273</a>,
              DOI 10.17487/RFC5273, June 2008,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5273">https://www.rfc-editor.org/info/rfc5273</a>&gt;.

   [<a id="ref-RFC5912">RFC5912</a>]  Hoffman, P. and J. Schaad, &quot;New ASN.1 Modules for the
              Public Key Infrastructure Using X.509 (PKIX)&quot;, <a href="/doc/html/rfc5912">RFC 5912</a>,
              DOI 10.17487/RFC5912, June 2010,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5912">https://www.rfc-editor.org/info/rfc5912</a>&gt;.

   [<a id="ref-RFC6268">RFC6268</a>]  Schaad, J. and S. Turner, &quot;Additional New ASN.1 Modules
              for the Cryptographic Message Syntax (CMS) and the Public
              Key Infrastructure Using X.509 (PKIX)&quot;, <a href="/doc/html/rfc6268">RFC 6268</a>,
              DOI 10.17487/RFC6268, July 2011,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6268">https://www.rfc-editor.org/info/rfc6268</a>&gt;.

   [<a id="ref-RFC7030">RFC7030</a>]  Pritikin, M., Ed., Yee, P., Ed., and D. Harkins, Ed.,
              &quot;Enrollment over Secure Transport&quot;, <a href="/doc/html/rfc7030">RFC 7030</a>,
              DOI 10.17487/RFC7030, October 2013,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7030">https://www.rfc-editor.org/info/rfc7030</a>&gt;.

   [<a id="ref-RFC8174">RFC8174</a>]  Leiba, B., &quot;Ambiguity of Uppercase vs Lowercase in <a href="/doc/html/rfc2119">RFC</a>
              <a href="/doc/html/rfc2119">2119</a> Key Words&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc8174">RFC 8174</a>, DOI 10.17487/RFC8174,
              May 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.

   [<a id="ref-X.680">X.680</a>]    ITU-T, &quot;Information technology -- Abstract Syntax Notation
              One (ASN.1): Specification of basic notation&quot;, ITU-T
              Recommendation X.680, ISO/IEC 8824-1:2015, August 2015,
              &lt;<a href="https://www.itu.int/rec/T-REC-X.680-201508-I/en">https://www.itu.int/rec/T-REC-X.680-201508-I/en</a>&gt;.

   [<a id="ref-X.681">X.681</a>]    ITU-T, &quot;Information Technology - Abstract Syntax Notation
              One (ASN.1): Information object specification&quot;, ITU-T
              Recommendation X.681, ISO/IEC 8824-2:2015, August 2015,
              &lt;<a href="https://www.itu.int/rec/T-REC-X.681">https://www.itu.int/rec/T-REC-X.681</a>&gt;.

   [<a id="ref-X.682">X.682</a>]    ITU-T, &quot;Information Technology - Abstract Syntax Notation
              One (ASN.1): Constraint specification&quot;, ITU-T
              Recommendation X.682, ISO/IEC 8824-3:2015, August 2015,
              &lt;<a href="https://www.itu.int/rec/T-REC-X.682">https://www.itu.int/rec/T-REC-X.682</a>&gt;.

   [<a id="ref-X.683">X.683</a>]    ITU-T, &quot;Information Technology - Abstract Syntax Notation
              One (ASN.1): Parameterization of ASN.1 specifications&quot;,
              ITU-T Recommendation X.683, ISO/IEC 8824-4:2015, August
              2015, &lt;<a href="https://www.itu.int/rec/T-REC-X.683">https://www.itu.int/rec/T-REC-X.683</a>&gt;.

   [<a id="ref-X.690">X.690</a>]    ITU-T, &quot;Information Technology - ASN.1 encoding rules:
              Specification of Basic Encoding Rules (BER), Canonical
              Encoding Rules (CER) and Distinguished Encoding Rules
              (DER)&quot;, ITU-T Recommendation X.690, ISO/IEC 8825-1:2015,
              August 2015, &lt;<a href="https://www.itu.int/rec/T-REC-X.690">https://www.itu.int/rec/T-REC-X.690</a>&gt;.

<span class="h3"><a class="selflink" id="section-9.2" href="#section-9.2">9.2</a>.  Informative References</span>

   [<a id="ref-BRSKI">BRSKI</a>]    Pritikin, M., Richardson, M. C., Eckert, T., Behringer, M.
              H., and K. Watsen, &quot;Bootstrapping Remote Secure Key
              Infrastructures (BRSKI)&quot;, Work in Progress, Internet-
              Draft, <a href="/doc/html/draft-ietf-anima-bootstrapping-keyinfra-45">draft-ietf-anima-bootstrapping-keyinfra-45</a>, 11
              November 2020, &lt;<a href="https://tools.ietf.org/html/draft-ietf-anima-bootstrapping-keyinfra-45">https://tools.ietf.org/html/draft-ietf-</a>
              <a href="https://tools.ietf.org/html/draft-ietf-anima-bootstrapping-keyinfra-45">anima-bootstrapping-keyinfra-45</a>&gt;.

   [<a id="ref-RFC2307">RFC2307</a>]  Howard, L., &quot;An Approach for Using LDAP as a Network
              Information Service&quot;, <a href="/doc/html/rfc2307">RFC 2307</a>, DOI 10.17487/RFC2307,
              March 1998, &lt;<a href="https://www.rfc-editor.org/info/rfc2307">https://www.rfc-editor.org/info/rfc2307</a>&gt;.

   [<a id="ref-RFC2616">RFC2616</a>]  Fielding, R., Gettys, J., Mogul, J., Frystyk, H.,
              Masinter, L., Leach, P., and T. Berners-Lee, &quot;Hypertext
              Transfer Protocol -- HTTP/1.1&quot;, <a href="/doc/html/rfc2616">RFC 2616</a>,
              DOI 10.17487/RFC2616, June 1999,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2616">https://www.rfc-editor.org/info/rfc2616</a>&gt;.

   [<a id="ref-RFC2985">RFC2985</a>]  Nystrom, M. and B. Kaliski, &quot;PKCS #9: Selected Object
              Classes and Attribute Types Version 2.0&quot;, <a href="/doc/html/rfc2985">RFC 2985</a>,
              DOI 10.17487/RFC2985, November 2000,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2985">https://www.rfc-editor.org/info/rfc2985</a>&gt;.

   [<a id="ref-RFC7230">RFC7230</a>]  Fielding, R., Ed. and J. Reschke, Ed., &quot;Hypertext Transfer
              Protocol (HTTP/1.1): Message Syntax and Routing&quot;,
              <a href="/doc/html/rfc7230">RFC 7230</a>, DOI 10.17487/RFC7230, June 2014,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7230">https://www.rfc-editor.org/info/rfc7230</a>&gt;.

   [<a id="ref-RFC7231">RFC7231</a>]  Fielding, R., Ed. and J. Reschke, Ed., &quot;Hypertext Transfer
              Protocol (HTTP/1.1): Semantics and Content&quot;, <a href="/doc/html/rfc7231">RFC 7231</a>,
              DOI 10.17487/RFC7231, June 2014,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7231">https://www.rfc-editor.org/info/rfc7231</a>&gt;.

<span class="h2"><a class="selflink" id="appendix-A" href="#appendix-A">Appendix A</a>.  ASN.1 Module</span>

   This annex provides the normative ASN.1 definitions for the
   structures described in this specification using ASN.1 as defined in
   [<a href="#ref-X.680" title="&quot;Information technology -- Abstract Syntax Notation One (ASN.1): Specification of basic notation&quot;">X.680</a>], [<a href="#ref-X.681" title="&quot;Information Technology - Abstract Syntax Notation One (ASN.1): Information object specification&quot;">X.681</a>], [<a href="#ref-X.682" title="&quot;Information Technology - Abstract Syntax Notation One (ASN.1): Constraint specification&quot;">X.682</a>], and [<a href="#ref-X.683" title="&quot;Information Technology - Abstract Syntax Notation One (ASN.1): Parameterization of ASN.1 specifications&quot;">X.683</a>].

   The ASN.1 modules makes imports from the ASN.1 modules in [<a href="/doc/html/rfc5912" title="&quot;New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX)&quot;">RFC5912</a>]
   and [<a href="/doc/html/rfc6268" title="&quot;Additional New ASN.1 Modules for the Cryptographic Message Syntax (CMS) and the Public Key Infrastructure Using X.509 (PKIX)&quot;">RFC6268</a>].

   There is no ASN.1 Module in [<a href="/doc/html/rfc7030" title="&quot;Enrollment over Secure Transport&quot;">RFC7030</a>].  This module has been created
   by combining the lines that are contained in the document body.

   PKIXEST-2019
        { iso(1) identified-organization(3) dod(6)
          internet(1) security(5) mechanisms(5) pkix(7)
          id-mod(0) id-mod-est-2019(98) }

   DEFINITIONS IMPLICIT TAGS ::=
   BEGIN

   -- EXPORTS ALL --

   IMPORTS

   Attribute
   FROM CryptographicMessageSyntax-2010  -- [<a href="/doc/html/rfc6268" title="&quot;Additional New ASN.1 Modules for the Cryptographic Message Syntax (CMS) and the Public Key Infrastructure Using X.509 (PKIX)&quot;">RFC6268</a>]
         { iso(1) member-body(2) us(840) rsadsi(113549)
           pkcs(1) pkcs-9(9) smime(16) modules(0)
            id-mod-cms-2009(58) }

   ATTRIBUTE
   FROM PKIX-CommonTypes-2009 -- [<a href="/doc/html/rfc5912" title="&quot;New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX)&quot;">RFC5912</a>]
       { iso(1) identified-organization(3) dod(6) internet(1)
         security(5) mechanisms(5) pkix(7) id-mod(0)
         id-mod-pkixCommon-02(57) } ;


   -- CSR Attributes

   CsrAttrs ::= SEQUENCE SIZE (0..MAX) OF AttrOrOID

   AttrOrOID ::= CHOICE {
      oid        OBJECT IDENTIFIER,
      attribute  Attribute {{AttrSet}} }

   AttrSet ATTRIBUTE ::= { ... }


   -- Asymmetric Decrypt Key Identifier Attribute

   aa-asymmDecryptKeyID ATTRIBUTE ::=
       { TYPE AsymmetricDecryptKeyIdentifier
         IDENTIFIED BY id-aa-asymmDecryptKeyID }

   id-aa-asymmDecryptKeyID OBJECT IDENTIFIER ::= { iso(1)
       member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
       smime(16) aa(2) 54 }

   AsymmetricDecryptKeyIdentifier ::= OCTET STRING

   END

Acknowledgements

   Huawei Technologies supported the efforts of Wei Pan and Michael
   Richardson.

   The ASN.1 Module was assembled by Russ Housley and formatted by Sean
   Turner.  Russ Housley provided editorial review.

Authors&#x27; Addresses

   Michael Richardson
   Sandelman Software Works

   Email: mcr+ietf@sandelman.ca


   Thomas Werner
   Siemens

   Email: thomas-werner@siemens.com


   Wei Pan
   Huawei Technologies

   Email: william.panwei@huawei.com
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

