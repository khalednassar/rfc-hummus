<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    rfc8419
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.33.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.33.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/draft-ietf-curdle-cms-eddsa-signatures/">
  <meta name="description" content="Use of Edwards-Curve Digital Signature Algorithm (EdDSA) Signatures in the Cryptographic Message Syntax (CMS) (RFC )">
  <script src="https://www.ietf.org/lib/dt/7.33.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.33.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.33.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.33.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bgblue"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc8419.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc8419.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/pdfrfc/rfc8419.txt.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/rfc8419/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/rfc8419/" title="Datatracker information for this document">Tracker</a>] [<a href="/group/curdle/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-curdle-cms-eddsa-signatures@ietf.org?subject=draft-ietf-curdle-cms-eddsa-signatures" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=draft-ietf-curdle-cms-eddsa-signatures-08.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-ietf-curdle-cms-eddsa-signatures-08.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-ietf-curdle-cms-eddsa-signatures-08.txt" title="Run an idnits check of this document">Nits</a>]

From: <a href="/doc/html/draft-ietf-curdle-cms-eddsa-signatures-08">draft-ietf-curdle-cms-eddsa-signatures-08</a>        Proposed Standard
                                                            <a class="text-warning" href="https://www.rfc-editor.org/errata_search.php?rfc=8419&amp;rec_status=0">Errata exist</a></pre>
      </div>
    

    <div class="draftcontent">
    <pre>Internet Engineering Task Force (IETF)                        R. Housley
Request for Comments: 8419                                Vigil Security
Category: Standards Track                                    August 2018
ISSN: 2070-1721


  <span class="h1">Use of Edwards-Curve Digital Signature Algorithm (EdDSA) Signatures</span>
               <span class="h1">in the Cryptographic Message Syntax (CMS)</span>

Abstract

   This document specifies the conventions for using the Edwards-curve
   Digital Signature Algorithm (EdDSA) for curve25519 and curve448 in
   the Cryptographic Message Syntax (CMS).  For each curve, EdDSA
   defines the PureEdDSA and HashEdDSA modes.  However, the HashEdDSA
   mode is not used with the CMS.  In addition, no context string is
   used with the CMS.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="/doc/html/rfc7841#section-2">Section&nbsp;2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="https://www.rfc-editor.org/info/rfc8419">https://www.rfc-editor.org/info/rfc8419</a>.

Copyright Notice

   Copyright (c) 2018 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="/doc/html/bcp78">BCP 78</a> and the IETF Trust&#x27;s Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.





<span class="grey">Housley                      Standards Track                    [Page 1]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-2" ></span>
<span class="grey"><a href="/doc/html/rfc8419">RFC 8419</a>             Using EdDSA Signatures with CMS         August 2018</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-2">2</a>
      <a href="#section-1.1">1.1</a>. Terminology ................................................<a href="#page-2">2</a>
      <a href="#section-1.2">1.2</a>. ASN.1 ......................................................<a href="#page-2">2</a>
   <a href="#section-2">2</a>. EdDSA Signature Algorithm .......................................<a href="#page-3">3</a>
      <a href="#section-2.1">2.1</a>. Algorithm Identifiers ......................................<a href="#page-3">3</a>
      <a href="#section-2.2">2.2</a>. EdDSA Algorithm Identifiers ................................<a href="#page-3">3</a>
      <a href="#section-2.3">2.3</a>. Message Digest Algorithm Identifiers .......................<a href="#page-4">4</a>
      <a href="#section-2.4">2.4</a>. EdDSA Signatures ...........................................<a href="#page-4">4</a>
   <a href="#section-3">3</a>. Signed-data Conventions .........................................<a href="#page-5">5</a>
      <a href="#section-3.1">3.1</a>. Signed-data Conventions with Signed Attributes .............<a href="#page-5">5</a>
      <a href="#section-3.2">3.2</a>. Signed-data Conventions without Signed Attributes ..........<a href="#page-6">6</a>
   <a href="#section-4">4</a>. Implementation Considerations ...................................<a href="#page-6">6</a>
   <a href="#section-5">5</a>. Security Considerations .........................................<a href="#page-6">6</a>
   <a href="#section-6">6</a>. IANA Considerations .............................................<a href="#page-7">7</a>
   <a href="#section-7">7</a>. References ......................................................<a href="#page-7">7</a>
      <a href="#section-7.1">7.1</a>. Normative References .......................................<a href="#page-7">7</a>
      <a href="#section-7.2">7.2</a>. Informative References .....................................<a href="#page-8">8</a>
   Acknowledgments ....................................................<a href="#page-9">9</a>
   Author&#x27;s Address ...................................................<a href="#page-9">9</a>

<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>.  Introduction</span>

   This document specifies the conventions for using the Edwards-curve
   Digital Signature Algorithm (EdDSA) [<a href="/doc/html/rfc8032" title="&quot;Edwards-Curve Digital Signature Algorithm (EdDSA)&quot;">RFC8032</a>] for curve25519
   [<a href="#ref-CURVE25519" title="&quot;Curve25519: new Diffie-Hellman speed records&quot;">CURVE25519</a>] and curve448 [<a href="#ref-CURVE448" title="&quot;Ed448-Goldilocks, a new elliptic curve&quot;">CURVE448</a>] with the Cryptographic Message
   Syntax (CMS) [<a href="/doc/html/rfc5652" title="&quot;Cryptographic Message Syntax (CMS)&quot;">RFC5652</a>] signed-data content type.  For each curve,
   [<a href="/doc/html/rfc8032" title="&quot;Edwards-Curve Digital Signature Algorithm (EdDSA)&quot;">RFC8032</a>] defines the PureEdDSA and HashEdDSA modes; however, the
   HashEdDSA mode is not used with the CMS.  In addition, no context
   string is used with CMS.  EdDSA with curve25519 is referred to as
   &quot;Ed25519&quot;, and EdDSA with curve448 is referred to as &quot;Ed448&quot;.  The
   CMS conventions for PureEdDSA with Ed25519 and Ed448 are described in
   this document.

<span class="h3"><a class="selflink" id="section-1.1" href="#section-1.1">1.1</a>.  Terminology</span>

   The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;,
   &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;NOT RECOMMENDED&quot;, &quot;MAY&quot;, and
   &quot;OPTIONAL&quot; in this document are to be interpreted as described in
   <a href="/doc/html/bcp14">BCP 14</a> [<a href="/doc/html/rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>] [<a href="/doc/html/rfc8174" title="&quot;Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words&quot;">RFC8174</a>] when, and only when, they appear in all
   capitals, as shown here.

<span class="h3"><a class="selflink" id="section-1.2" href="#section-1.2">1.2</a>.  ASN.1</span>

   CMS values are generated using ASN.1 [<a href="#ref-X680" title="&quot;Information technology -- Abstract Syntax Notation One (ASN.1): Specification of basic notation&quot;">X680</a>], which uses the Basic
   Encoding Rules (BER) and the Distinguished Encoding Rules (DER)
   [<a href="#ref-X690" title="&quot;Information technology -- ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)&quot;">X690</a>].



<span class="grey">Housley                      Standards Track                    [Page 2]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-3" ></span>
<span class="grey"><a href="/doc/html/rfc8419">RFC 8419</a>             Using EdDSA Signatures with CMS         August 2018</span>


<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  EdDSA Signature Algorithm</span>

   The Edwards-curve Digital Signature Algorithm (EdDSA) [<a href="/doc/html/rfc8032" title="&quot;Edwards-Curve Digital Signature Algorithm (EdDSA)&quot;">RFC8032</a>] is a
   variant of Schnorr&#x27;s signature system with (possibly twisted) Edwards
   curves.  Ed25519 is intended to operate at around the 128-bit
   security level; Ed448 is intended to operate at around the 224-bit
   security level.

   One of the parameters of the EdDSA algorithm is the &quot;prehash&quot;
   function.  This may be the identity function, resulting in an
   algorithm called &quot;PureEdDSA&quot;, or a collision-resistant hash function,
   resulting in an algorithm called &quot;HashEdDSA&quot;.  In most situations,
   the CMS SignedData includes signed attributes, including the message
   digest of the content.  Since HashEdDSA offers no benefit when signed
   attributes are present, only PureEdDSA is used with the CMS.

<span class="h3"><a class="selflink" id="section-2.1" href="#section-2.1">2.1</a>.  Algorithm Identifiers</span>

   Each algorithm is identified by an object identifier, and the
   algorithm identifier may contain parameters if needed.

   The ALGORITHM definition is repeated here for convenience:

      ALGORITHM ::= CLASS {
          &amp;id    OBJECT IDENTIFIER UNIQUE,
          &amp;Type  OPTIONAL }
        WITH SYNTAX {
          OID &amp;id [PARMS &amp;Type] }

<span class="h3"><a class="selflink" id="section-2.2" href="#section-2.2">2.2</a>.  EdDSA Algorithm Identifiers</span>

   The EdDSA signature algorithm is defined in [<a href="/doc/html/rfc8032" title="&quot;Edwards-Curve Digital Signature Algorithm (EdDSA)&quot;">RFC8032</a>], and the
   conventions for encoding the public key are defined in [<a href="/doc/html/rfc8410" title="&quot;Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure&quot;">RFC8410</a>].

   The id-Ed25519 and id-Ed448 object identifiers are used to identify
   EdDSA public keys in certificates.  The object identifiers are
   specified in [<a href="/doc/html/rfc8410" title="&quot;Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure&quot;">RFC8410</a>], and they are repeated here for convenience:

      sigAlg-Ed25519  ALGORITHM  ::=  { OID id-Ed25519 }

      sigAlg-Ed448    ALGORITHM  ::=  { OID id-Ed448 }

      id-Ed25519  OBJECT IDENTIFIER  ::=  { 1 3 101 112 }

      id-Ed448    OBJECT IDENTIFIER  ::=  { 1 3 101 113 }






<span class="grey">Housley                      Standards Track                    [Page 3]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-4" ></span>
<span class="grey"><a href="/doc/html/rfc8419">RFC 8419</a>             Using EdDSA Signatures with CMS         August 2018</span>


<span class="h3"><a class="selflink" id="section-2.3" href="#section-2.3">2.3</a>.  Message Digest Algorithm Identifiers</span>

   When the signer includes signed attributes, a message digest
   algorithm is used to compute the message digest on the eContent
   value.  When signing with Ed25519, the message digest algorithm MUST
   be SHA-512 [<a href="#ref-FIPS180" title="&quot;Secure Hash Standard (SHS)&quot;">FIPS180</a>].  Additional information on SHA-512 is available
   in [<a href="/doc/html/rfc6234" title="&quot;US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)&quot;">RFC6234</a>].  When signing with Ed448, the message digest algorithm
   MUST be SHAKE256 [<a href="#ref-FIPS202" title="&quot;SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions&quot;">FIPS202</a>] with a 512-bit output value.

   Signing with Ed25519 uses SHA-512 as part of the signing operation,
   and signing with Ed448 uses SHAKE256 as part of the signing
   operation.

   For convenience, the object identifiers and parameter syntax for
   these algorithms are repeated here:

      hashAlg-SHA-512  ALGORITHM  ::=  { OID id-sha512 }

      hashAlg-SHAKE256  ALGORITHM  ::=  { OID id-shake256 }
      hashAlg-SHAKE256-LEN  ALGORITHM  ::=  { OID id-shake256-len
                              PARMS ShakeOutputLen }

      hashalgs  OBJECT IDENTIFIER  ::=  { joint-iso-itu-t(2)
                              country(16) us(840) organization(1)
                              gov(101) csor(3) nistalgorithm(4) 2 }

      id-sha512  OBJECT IDENTIFIER  ::=  { hashAlgs 3 }

      id-shake256  OBJECT IDENTIFIER  ::=  { hashAlgs 12 }

      id-shake256-len  OBJECT IDENTIFIER  ::=  { hashAlgs 18 }

      ShakeOutputLen  ::=  INTEGER  -- Output length in bits

   When using the id-sha512 or id-shake256 algorithm identifier, the
   parameters MUST be absent.

   When using the id-shake256-len algorithm identifier, the parameters
   MUST be present, and the parameter MUST contain 512, encoded as a
   positive integer value.

<span class="h3"><a class="selflink" id="section-2.4" href="#section-2.4">2.4</a>.  EdDSA Signatures</span>

   The id-Ed25519 and id-Ed448 object identifiers are also used for
   signature values.  When used to identify signature algorithms, the
   AlgorithmIdentifier parameters field MUST be absent.





<span class="grey">Housley                      Standards Track                    [Page 4]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-5" ></span>
<span class="grey"><a href="/doc/html/rfc8419">RFC 8419</a>             Using EdDSA Signatures with CMS         August 2018</span>


   The data to be signed is processed using PureEdDSA, and then a
   private key operation generates the signature value.  As described in
   <a href="/doc/html/rfc8032#section-3.3">Section&nbsp;3.3 of [RFC8032]</a>, the signature value is the opaque value
   ENC(R) || ENC(S), where || represents concatenation.  As described in
   <a href="/doc/html/rfc5652#section-5.3">Section&nbsp;5.3 of [RFC5652]</a>, the signature value is ASN.1 encoded as an
   OCTET STRING and included in the signature field of SignerInfo.

<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>.  Signed-data Conventions</span>

   The processing depends on whether the signer includes signed
   attributes.

   The inclusion of signed attributes is preferred, but the conventions
   for signed-data without signed attributes are provided for
   completeness.

<span class="h3"><a class="selflink" id="section-3.1" href="#section-3.1">3.1</a>.  Signed-data Conventions with Signed Attributes</span>

   The SignedData digestAlgorithms field includes the identifiers of the
   message digest algorithms used by one or more signer.  There MAY be
   any number of elements in the collection, including zero.  When
   signing with Ed25519, the digestAlgorithm SHOULD include id-sha512,
   and if present, the algorithm parameters field MUST be absent.  When
   signing with Ed448, the digestAlgorithm SHOULD include
   id-shake256-len, and if present, the algorithm parameters field MUST
   also be present, and the parameter MUST contain 512, encoded as a
   positive integer value.

   The SignerInfo digestAlgorithm field includes the identifier of the
   message digest algorithms used by the signer.  When signing with
   Ed25519, the digestAlgorithm MUST be id-sha512, and the algorithm
   parameters field MUST be absent.  When signing with Ed448, the
   digestAlgorithm MUST be id-shake256-len, the algorithm parameters
   field MUST be present, and the parameter MUST contain 512, encoded as
   a positive integer value.

   The SignerInfo signedAttributes MUST include the message-digest
   attribute as specified in <a href="/doc/html/rfc5652#section-11.2">Section&nbsp;11.2 of [RFC5652]</a>.  When signing
   with Ed25519, the message-digest attribute MUST contain the message
   digest computed over the eContent value using SHA-512.  When signing
   with Ed448, the message-digest attribute MUST contain the message
   digest computed over the eContent value using SHAKE256 with an output
   length of 512 bits.

   The SignerInfo signatureAlgorithm field MUST contain either
   id-Ed25519 or id-Ed448, depending on the elliptic curve that was used
   by the signer.  The algorithm parameters field MUST be absent.




<span class="grey">Housley                      Standards Track                    [Page 5]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-6" ></span>
<span class="grey"><a href="/doc/html/rfc8419">RFC 8419</a>             Using EdDSA Signatures with CMS         August 2018</span>


   The SignerInfo signature field contains the octet string resulting
   from the EdDSA private key signing operation.

<span class="h3"><a class="selflink" id="section-3.2" href="#section-3.2">3.2</a>.  Signed-data Conventions without Signed Attributes</span>

   The SignedData digestAlgorithms field includes the identifiers of the
   message digest algorithms used by one or more signer.  There MAY be
   any number of elements in the collection, including zero.  When
   signing with Ed25519, the list of identifiers MAY include id-sha512,
   and if present, the algorithm parameters field MUST be absent.  When
   signing with Ed448, the list of identifiers MAY include id-shake256,
   and if present, the algorithm parameters field MUST be absent.

   The SignerInfo digestAlgorithm field includes the identifier of the
   message digest algorithms used by the signer.  When signing with
   Ed25519, the digestAlgorithm MUST be id-sha512, and the algorithm
   parameters field MUST be absent.  When signing with Ed448, the
   digestAlgorithm MUST be id-shake256, and the algorithm parameters
   field MUST be absent.

      NOTE: Either id-sha512 or id-shake256 is used as part to the
      private key signing operation.  However, the private key signing
      operation does not take a message digest computed with one of
      these algorithms as an input.

   The SignerInfo signatureAlgorithm field MUST contain either
   id-Ed25519 or id-Ed448, depending on the elliptic curve that was used
   by the signer.  The algorithm parameters field MUST be absent.

   The SignerInfo signature field contains the octet string resulting
   from the EdDSA private key signing operation.

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>.  Implementation Considerations</span>

   The EdDSA specification [<a href="/doc/html/rfc8032" title="&quot;Edwards-Curve Digital Signature Algorithm (EdDSA)&quot;">RFC8032</a>] includes the following warning.  It
   deserves highlighting, especially when signed-data is used without
   signed attributes and the content to be signed might be quite large:

      PureEdDSA requires two passes over the input.  Many existing APIs,
      protocols, and environments assume digital signature algorithms
      only need one pass over the input and may have API or bandwidth
      concerns supporting anything else.

<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>.  Security Considerations</span>

   Implementations must protect the EdDSA private key.  Compromise of
   the EdDSA private key may result in the ability to forge signatures.




<span class="grey">Housley                      Standards Track                    [Page 6]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-7" ></span>
<span class="grey"><a href="/doc/html/rfc8419">RFC 8419</a>             Using EdDSA Signatures with CMS         August 2018</span>


   The generation of EdDSA private key relies on random numbers.  The
   use of inadequate pseudo-random number generators (PRNGs) to generate
   these values can result in little or no security.  An attacker may
   find it much easier to reproduce the PRNG environment that produced
   the keys, searching the resulting small set of possibilities, rather
   than brute-force searching the whole key space.  The generation of
   quality random numbers is difficult.  <a href="/doc/html/rfc4086">RFC 4086</a> [<a href="#ref-RANDOM" title="&quot;Randomness Requirements for Security&quot;">RANDOM</a>] offers
   important guidance in this area.

   Unlike DSA and Elliptic Curve Digital Signature Algorithm (ECDSA),
   EdDSA does not require the generation of a random value for each
   signature operation.

   Using the same private key with different algorithms has the
   potential to leak extra information about the private key to an
   attacker.  For this reason, the same private key SHOULD NOT be used
   with more than one set of EdDSA parameters, although it appears that
   there are no security concerns when using the same private key with
   PureEdDSA and HashEdDSA [<a href="/doc/html/rfc8032" title="&quot;Edwards-Curve Digital Signature Algorithm (EdDSA)&quot;">RFC8032</a>].

   When computing signatures, the same hash function SHOULD be used for
   all operations.  This reduces the number of failure points in the
   signature process.

<span class="h2"><a class="selflink" id="section-6" href="#section-6">6</a>.  IANA Considerations</span>

   This document has no IANA actions.

<span class="h2"><a class="selflink" id="section-7" href="#section-7">7</a>.  References</span>

<span class="h3"><a class="selflink" id="section-7.1" href="#section-7.1">7.1</a>.  Normative References</span>

   [<a id="ref-FIPS180">FIPS180</a>]    National Institute of Standards and Technology, &quot;Secure
                Hash Standard (SHS)&quot;, FIPS PUB 180-4,
                DOI 10.6028/NIST.FIPS.180-4, August 2015.

   [<a id="ref-FIPS202">FIPS202</a>]    National Institute of Standards and Technology, &quot;SHA-3
                Standard: Permutation-Based Hash and Extendable-Output
                Functions&quot;, FIPS PUB 202, DOI 10.6028/NIST.FIPS.202,
                August 2015.

   [<a id="ref-RFC2119">RFC2119</a>]    Bradner, S., &quot;Key words for use in RFCs to Indicate
                Requirement Levels&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc2119">RFC 2119</a>,
                DOI 10.17487/RFC2119, March 1997,
                &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.






<span class="grey">Housley                      Standards Track                    [Page 7]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-8" ></span>
<span class="grey"><a href="/doc/html/rfc8419">RFC 8419</a>             Using EdDSA Signatures with CMS         August 2018</span>


   [<a id="ref-RFC5652">RFC5652</a>]    Housley, R., &quot;Cryptographic Message Syntax (CMS)&quot;,
                STD 70, <a href="/doc/html/rfc5652">RFC 5652</a>, DOI 10.17487/RFC5652, September 2009,
                &lt;<a href="https://www.rfc-editor.org/info/rfc5652">https://www.rfc-editor.org/info/rfc5652</a>&gt;.

   [<a id="ref-RFC8032">RFC8032</a>]    Josefsson, S. and I. Liusvaara, &quot;Edwards-Curve Digital
                Signature Algorithm (EdDSA)&quot;, <a href="/doc/html/rfc8032">RFC 8032</a>,
                DOI 10.17487/RFC8032, January 2017,
                &lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;.

   [<a id="ref-RFC8174">RFC8174</a>]    Leiba, B., &quot;Ambiguity of Uppercase vs Lowercase in <a href="/doc/html/rfc2119">RFC</a>
                <a href="/doc/html/rfc2119">2119</a> Key Words&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc8174">RFC 8174</a>, DOI 10.17487/RFC8174,
                May 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.

   [<a id="ref-RFC8410">RFC8410</a>]    Josefsson, S. and J. Schaad, &quot;Algorithm Identifiers for
                Ed25519, Ed448, X25519, and X448 for Use in the Internet
                X.509 Public Key Infrastructure&quot;, <a href="/doc/html/rfc8410">RFC 8410</a>,
                DOI 10.17487/RFC8410, August 2018,
                &lt;<a href="https://www.rfc-editor.org/info/rfc8410">https://www.rfc-editor.org/info/rfc8410</a>&gt;.

   [<a id="ref-X680">X680</a>]       ITU-T, &quot;Information technology -- Abstract Syntax
                Notation One (ASN.1): Specification of basic notation&quot;,
                ITU-T Recommendation X.680, ISO/IEC 8824-1, August 2015,
                &lt;<a href="https://www.itu.int/rec/T-REC-X.680/en">https://www.itu.int/rec/T-REC-X.680/en</a>&gt;.

   [<a id="ref-X690">X690</a>]       ITU-T, &quot;Information technology -- ASN.1 encoding rules:
                Specification of Basic Encoding Rules (BER), Canonical
                Encoding Rules (CER) and Distinguished Encoding Rules
                (DER)&quot;, ITU-T Recommendation X.690, ISO/IEC 8825-1,
                August 2015, &lt;<a href="https://www.itu.int/rec/T-REC-X.690/en">https://www.itu.int/rec/T-REC-X.690/en</a>&gt;.

<span class="h3"><a class="selflink" id="section-7.2" href="#section-7.2">7.2</a>.  Informative References</span>

   [<a id="ref-CURVE25519">CURVE25519</a>] Bernstein, D., &quot;Curve25519: new Diffie-Hellman speed
                records&quot;, DOI 10.1007/11745853_14, February 2006,
                &lt;<a href="http://cr.yp.to/ecdh.html">http://cr.yp.to/ecdh.html</a>&gt;.

   [<a id="ref-CURVE448">CURVE448</a>]   Hamburg, M., &quot;Ed448-Goldilocks, a new elliptic curve&quot;,
                June 2015, &lt;<a href="http://eprint.iacr.org/2015/625">http://eprint.iacr.org/2015/625</a>&gt;.

   [<a id="ref-RANDOM">RANDOM</a>]     Eastlake 3rd, D., Schiller, J., and S. Crocker,
                &quot;Randomness Requirements for Security&quot;, <a href="/doc/html/bcp106">BCP 106</a>,
                <a href="/doc/html/rfc4086">RFC 4086</a>, DOI 10.17487/RFC4086, June 2005,
                &lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;.

   [<a id="ref-RFC6234">RFC6234</a>]    Eastlake 3rd, D. and T. Hansen, &quot;US Secure Hash
                Algorithms (SHA and SHA-based HMAC and HKDF)&quot;, <a href="/doc/html/rfc6234">RFC 6234</a>,
                DOI 10.17487/RFC6234, May 2011,
                &lt;<a href="https://www.rfc-editor.org/info/rfc6234">https://www.rfc-editor.org/info/rfc6234</a>&gt;.



<span class="grey">Housley                      Standards Track                    [Page 8]</span></pre>
<hr class='noprint'/><!--NewPage--><pre class='newpage'><span id="page-9" ></span>
<span class="grey"><a href="/doc/html/rfc8419">RFC 8419</a>             Using EdDSA Signatures with CMS         August 2018</span>


Acknowledgements

   Many thanks to Jim Schaad, Daniel Migault, and Adam Roach for the
   careful review and comments.  Thanks to Quynh Dang for coordinating
   the object identifiers assignment by NIST.

Author&#x27;s Address

   Russ Housley
   918 Spring Knoll Drive
   Herndon, VA  20170
   United States of America

   Email: housley@vigilsec.com





































Housley                      Standards Track                    [Page 9]
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

