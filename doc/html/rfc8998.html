<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    rfc8998
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.33.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.33.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/draft-yang-tls-tls13-sm-suites/">
  <meta name="description" content="ShangMi (SM) Cipher Suites for TLS 1.3 (RFC )">
  <script src="https://www.ietf.org/lib/dt/7.33.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.33.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.33.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.33.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bgorange"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc8998.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc8998.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/rfc8998.xml" title="XML source for this document">xml</a>|<a href="https://www.rfc-editor.org/rfc/rfc8998.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/rfc8998/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/rfc8998/" title="Datatracker information for this document">Tracker</a>] [<a href="mailto:draft-yang-tls-tls13-sm-suites@ietf.org?subject=draft-yang-tls-tls13-sm-suites" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=draft-yang-tls-tls13-sm-suites-06.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-yang-tls-tls13-sm-suites-06.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-yang-tls-tls13-sm-suites-06.txt" title="Run an idnits check of this document">Nits</a>]

From: <a href="/doc/html/draft-yang-tls-tls13-sm-suites-06">draft-yang-tls-tls13-sm-suites-06</a>                    Informational</pre>
      </div>
    

    <div class="draftcontent">
    <pre>Independent Submission                                           P. Yang
Request for Comments: 8998                                     Ant Group
Category: Informational                                       March 2021
ISSN: 2070-1721


                 <span class="h1">ShangMi (SM) Cipher Suites for TLS 1.3</span>

Abstract

   This document specifies how to use the ShangMi (SM) cryptographic
   algorithms with Transport Layer Security (TLS) protocol version 1.3.

   The use of these algorithms with TLS 1.3 is not endorsed by the IETF.
   The SM algorithms are becoming mandatory in China, so this document
   provides a description of how to use the SM algorithms with TLS 1.3
   and specifies a profile of TLS 1.3 so that implementers can produce
   interworking implementations.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This is a contribution to the RFC Series, independently of any other
   RFC stream.  The RFC Editor has chosen to publish this document at
   its discretion and makes no statement about its value for
   implementation or deployment.  Documents approved for publication by
   the RFC Editor are not candidates for any level of Internet Standard;
   see <a href="/doc/html/rfc7841#section-2">Section&nbsp;2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="https://www.rfc-editor.org/info/rfc8998">https://www.rfc-editor.org/info/rfc8998</a>.

Copyright Notice

   Copyright (c) 2021 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="/doc/html/bcp78">BCP 78</a> and the IETF Trust&#x27;s Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.

Table of Contents

   1.  Introduction
     1.1.  The SM Algorithms
     1.2.  Terminology
   2.  Algorithm Identifiers
   3.  Algorithm Definitions
     3.1.  TLS Versions
     3.2.  Authentication
       3.2.1.  SM2 Signature Scheme
     3.3.  Key Exchange
       3.3.1.  Hello Messages
       3.3.2.  CertificateRequest
       3.3.3.  Certificate
       3.3.4.  CertificateVerify
     3.4.  Key Scheduling
     3.5.  Cipher
       3.5.1.  AEAD_SM4_GCM
       3.5.2.  AEAD_SM4_CCM
   4.  IANA Considerations
   5.  Security Considerations
   6.  References
     6.1.  Normative References
     6.2.  Informative References
   <a href="#appendix-A">Appendix A</a>.  Test Vectors
     A.1.  SM4-GCM Test Vectors
     A.2.  SM4-CCM Test Vectors
   Contributors
   Author&#x27;s Address

<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>.  Introduction</span>

   This document describes two new cipher suites, a signature algorithm
   and a key exchange mechanism for the Transport Layer Security (TLS)
   protocol version 1.3 (TLS 1.3) ([<a href="/doc/html/rfc8446" title="&quot;The Transport Layer Security (TLS) Protocol Version 1.3&quot;">RFC8446</a>]).  These all utilize
   several ShangMi (SM) cryptographic algorithms to fulfill the
   authentication and confidentiality requirements of TLS 1.3.  The new
   cipher suites are as follows (see also <a href="#section-2">Section 2</a>):

      CipherSuite TLS_SM4_GCM_SM3 = { 0x00, 0xC6 };
      CipherSuite TLS_SM4_CCM_SM3 = { 0x00, 0xC7 };

   For a more detailed introduction to SM cryptographic algorithms,
   please see <a href="#section-1.1">Section 1.1</a>.  These cipher suites follow the TLS 1.3
   requirements.  Specifically, all the cipher suites use SM4 in either
   Galois/Counter (GCM) mode or Counter with CBC-MAC (CCM) mode to meet
   the needs of TLS 1.3 to have an encryption algorithm that is
   Authenticated Encryption with Associated Data (AEAD) capable.  The
   key exchange mechanism utilizes Elliptic Curve Diffie-Hellman
   Ephemeral (ECDHE) over the SM2 elliptic curve, and the signature
   algorithm combines the SM3 hash function and the SM2 elliptic curve
   signature scheme.

   For details about how these mechanisms negotiate shared encryption
   keys, authenticate the peer(s), and protect the record structure,
   please see <a href="#section-3">Section 3</a>.

   The cipher suites, signature algorithm, and key exchange mechanism
   defined in this document are not recommended by the IETF.  The SM
   algorithms are becoming mandatory in China, so this document provides
   a description of how to use them with TLS 1.3 and specifies a profile
   of TLS 1.3 so that implementers can produce interworking
   implementations.

<span class="h3"><a class="selflink" id="section-1.1" href="#section-1.1">1.1</a>.  The SM Algorithms</span>

   Several different SM cryptographic algorithms are used to integrate
   with TLS 1.3, including SM2 for authentication, SM4 for encryption,
   and SM3 as the hash function.

   SM2 is a set of cryptographic algorithms based on elliptic curve
   cryptography, including a digital signature, public key encryption
   and key exchange scheme.  In this document, only the SM2 digital
   signature algorithm and basic key exchange scheme are involved, which
   have already been added to ISO/IEC 14888-3:2018 [<a href="#ref-ISO-SM2" title="">ISO-SM2</a>] (as well as
   to [<a href="#ref-GBT.32918.2-2016">GBT.32918.2-2016</a>]).  SM4 is a block cipher defined in
   [<a href="#ref-GBT.32907-2016">GBT.32907-2016</a>] and now is being standardized by ISO to ISO/IEC
   18033-3:2010 [<a href="#ref-ISO-SM4" title="&quot;Information technology -- Security techniques -- Encryption algorithms -- Part 3: Block ciphers&quot;">ISO-SM4</a>].  SM3 is a hash function that produces an
   output of 256 bits.  SM3 has already been accepted by ISO in ISO/IEC
   10118-3:2018 [<a href="#ref-ISO-SM3" title="&quot;IT Security techniques -- Hash-functions -- Part 3: Dedicated hash-functions&quot;">ISO-SM3</a>] and has also been described by
   [<a href="#ref-GBT.32905-2016">GBT.32905-2016</a>].

<span class="h3"><a class="selflink" id="section-1.2" href="#section-1.2">1.2</a>.  Terminology</span>

   The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;,
   &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;NOT RECOMMENDED&quot;, &quot;MAY&quot;, and
   &quot;OPTIONAL&quot; in this document are to be interpreted as described in
   <a href="/doc/html/bcp14">BCP 14</a> [<a href="/doc/html/rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>] [<a href="/doc/html/rfc8174" title="&quot;Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words&quot;">RFC8174</a>] when, and only when, they appear in all
   capitals, as shown here.

   Although this document is not an IETF Standards Track publication, it
   adopts the conventions for normative language to provide clarity of
   instruction to the implementer and to indicate requirement levels for
   compliant TLS 1.3 implementations.

<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  Algorithm Identifiers</span>

   The cipher suites defined here have the following identifiers:

      CipherSuite TLS_SM4_GCM_SM3 = { 0x00, 0xC6 };
      CipherSuite TLS_SM4_CCM_SM3 = { 0x00, 0xC7 };

   To accomplish a TLS 1.3 handshake, additional objects have been
   introduced along with the cipher suites as follows:

   *  The combination of the SM2 signature algorithm and SM3 hash
      function used in the Signature Algorithm extension is defined in
      <a href="/doc/html/rfc8446#appendix-B.3.1.3">Appendix&nbsp;B.3.1.3 of [RFC8446]</a>:

         SignatureScheme sm2sig_sm3 = { 0x0708 };

   *  The SM2 elliptic curve ID used in the Supported Groups extension
      is defined in <a href="/doc/html/rfc8446#appendix-B.3.1.4">Appendix&nbsp;B.3.1.4 of [RFC8446]</a>:

         NamedGroup curveSM2 = { 41 };

<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>.  Algorithm Definitions</span>

<span class="h3"><a class="selflink" id="section-3.1" href="#section-3.1">3.1</a>.  TLS Versions</span>

   The new cipher suites defined in this document are only applicable to
   TLS 1.3.  Implementations of this document MUST NOT apply these
   cipher suites to any older versions of TLS.

<span class="h3"><a class="selflink" id="section-3.2" href="#section-3.2">3.2</a>.  Authentication</span>

<span class="h4"><a class="selflink" id="section-3.2.1" href="#section-3.2.1">3.2.1</a>.  SM2 Signature Scheme</span>

   The Chinese government requires the use of the SM2 signature
   algorithm.  This section specifies the use of the SM2 signature
   algorithm as the authentication method for a TLS 1.3 handshake.

   The SM2 signature algorithm is defined in [<a href="#ref-ISO-SM2" title="">ISO-SM2</a>].  The SM2
   signature algorithm is based on elliptic curves.  The SM2 signature
   algorithm uses a fixed elliptic curve parameter set defined in
   [<a href="#ref-GBT.32918.5-2017">GBT.32918.5-2017</a>].  This curve is named &quot;curveSM2&quot; and has been
   assigned the value 41, as shown in <a href="#section-2">Section 2</a>.  Unlike other public
   key algorithms based on elliptic curve cryptography like the Elliptic
   Curve Digital Signature Algorithm (ECDSA), SM2 MUST NOT select other
   elliptic curves.  But it is acceptable to write test cases that use
   other elliptic curve parameter sets for SM2; see Annex F.14 of
   [<a href="#ref-ISO-SM2" title="">ISO-SM2</a>] as a reference.

   Implementations of the signature scheme and key exchange mechanism
   defined in this document MUST conform to what [<a href="#ref-GBT.32918.5-2017">GBT.32918.5-2017</a>]
   requires; that is to say, the only valid elliptic curve parameter set
   for the SM2 signature algorithm (a.k.a. curveSM2) is defined as
   follows:

   curveSM2:  A prime field of 256 bits.

   y^(2) = x^(3) + ax + b

      p  = FFFFFFFE FFFFFFFF FFFFFFFF FFFFFFFF
           FFFFFFFF 00000000 FFFFFFFF FFFFFFFF
      a  = FFFFFFFE FFFFFFFF FFFFFFFF FFFFFFFF
           FFFFFFFF 00000000 FFFFFFFF FFFFFFFC
      b  = 28E9FA9E 9D9F5E34 4D5A9E4B CF6509A7
           F39789F5 15AB8F92 DDBCBD41 4D940E93
      n  = FFFFFFFE FFFFFFFF FFFFFFFF FFFFFFFF
           7203DF6B 21C6052B 53BBF409 39D54123
      Gx = 32C4AE2C 1F198119 5F990446 6A39C994
           8FE30BBF F2660BE1 715A4589 334C74C7
      Gy = BC3736A2 F4F6779C 59BDCEE3 6B692153
           D0A9877C C62A4740 02DF32E5 2139F0A0

   The SM2 signature algorithm requests an identifier value when
   generating or verifying a signature.  In all uses except when a
   client of a server needs to verify a peer&#x27;s SM2 certificate in the
   Certificate message, an implementation of this document MUST use the
   following ASCII string value as the SM2 identifier when doing a TLS
   1.3 key exchange:

      TLSv1.3+GM+Cipher+Suite

   If either a client or a server needs to verify the peer&#x27;s SM2
   certificate contained in the Certificate message, then the following
   ASCII string value MUST be used as the SM2 identifier according to
   [<a href="#ref-GMT.0009-2012">GMT.0009-2012</a>]:

      1234567812345678

   Expressed as octets, this is:

      0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38,
      0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38

   In practice, the SM2 identifier used in a certificate signature
   depends on the certificate authority (CA) who signs that certificate.
   CAs may choose values other than the ones mentioned above.
   Implementations of this document SHOULD confirm this information by
   themselves.

<span class="h3"><a class="selflink" id="section-3.3" href="#section-3.3">3.3</a>.  Key Exchange</span>

<span class="h4"><a class="selflink" id="section-3.3.1" href="#section-3.3.1">3.3.1</a>.  Hello Messages</span>

   The use of the algorithms defined by this document is negotiated
   during the TLS handshake with information exchanged in the Hello
   messages.

<span class="h5"><a class="selflink" id="section-3.3.1.1" href="#section-3.3.1.1">3.3.1.1</a>.  ClientHello</span>

   To use the cipher suites defined by this document, a TLS 1.3 client
   includes the new cipher suites in the &quot;cipher_suites&quot; array of the
   ClientHello structure defined in <a href="/doc/html/rfc8446#section-4.1.2">Section&nbsp;4.1.2 of [RFC8446]</a>.

   Other requirements of this TLS 1.3 profile on the extensions of
   ClientHello message are as follows:

   *  For the supported_groups extension, &quot;curveSM2&quot; MUST be included.

   *  For the signature_algorithms extension, &quot;sm2sig_sm3&quot; MUST be
      included.

   *  For the signature_algorithms_cert extension (if present),
      &quot;sm2sig_sm3&quot; MUST be included.

   *  For the key_share extension, a KeyShareEntry for the &quot;curveSM2&quot;
      group MUST be included.

<span class="h5"><a class="selflink" id="section-3.3.1.2" href="#section-3.3.1.2">3.3.1.2</a>.  ServerHello</span>

   If a TLS 1.3 server receives a ClientHello message containing the
   algorithms defined in this document, it MAY choose to use them.  If
   so, then the server MUST put one of the new cipher suites defined in
   this document into its ServerHello&#x27;s &quot;cipher_suites&quot; array and
   eventually send it to the client side.

   A TLS 1.3 server&#x27;s choice of what cipher suite to use depends on the
   configuration of the server.  For instance, a TLS 1.3 server may or
   not be configured to include the new cipher suites defined in this
   document.  Typical TLS 1.3 server applications also provide a
   mechanism that configures the cipher suite preference on the server
   side.  If a server is not configured to use the cipher suites defined
   in this document, it SHOULD choose another cipher suite in the list
   that the TLS 1.3 client provides; otherwise, the server MUST abort
   the handshake with an &quot;illegal_parameter&quot; alert.

   The following extension MUST conform to the new requirements:

   *  For the key_share extension, a KeyShareEntry with SM2-related
      values MUST be added if the server wants to conform to this
      profile.

<span class="h4"><a class="selflink" id="section-3.3.2" href="#section-3.3.2">3.3.2</a>.  CertificateRequest</span>

   If a CertificateRequest message is sent by the server to require the
   client to send its certificate for authentication purposes, for
   conformance to this profile, the following is REQUIRED:

   *  The only valid signature algorithm present in
      &quot;signature_algorithms&quot; extension MUST be &quot;sm2sig_sm3&quot;.  That is to
      say, if the server chooses to conform to this profile, the
      signature algorithm for the client&#x27;s certificate MUST use the SM2/
      SM3 procedure specified by this document.

<span class="h4"><a class="selflink" id="section-3.3.3" href="#section-3.3.3">3.3.3</a>.  Certificate</span>

   When a server sends the Certificate message containing the server
   certificate to the client side, several new rules are added that will
   affect the certificate selection:

   *  The public key in the certificate MUST be a valid SM2 public key.

   *  The signature algorithm used by the CA to sign the current
      certificate MUST be &quot;sm2sig_sm3&quot;.

   *  The certificate MUST be capable of signing; e.g., the
      digitalSignature bit of X.509&#x27;s Key Usage extension is set.

<span class="h4"><a class="selflink" id="section-3.3.4" href="#section-3.3.4">3.3.4</a>.  CertificateVerify</span>

   In the CertificateVerify message, the signature algorithm MUST be
   &quot;sm2sig_sm3&quot;, indicating that the hash function MUST be SM3 and the
   signature algorithm MUST be SM2.

<span class="h3"><a class="selflink" id="section-3.4" href="#section-3.4">3.4</a>.  Key Scheduling</span>

   As described in <a href="#section-1.1">Section 1.1</a>, SM2 is actually a set of cryptographic
   algorithms, including one key exchange protocol that defines methods
   such as key derivation function, etc.  This document does not define
   an SM2 key exchange protocol, and an SM2 key exchange protocol SHALL
   NOT be used in the key exchange steps defined in <a href="#section-3.3">Section 3.3</a>.
   Implementations of this document MUST always conform to what TLS 1.3
   [<a href="/doc/html/rfc8446" title="&quot;The Transport Layer Security (TLS) Protocol Version 1.3&quot;">RFC8446</a>] and its successors require regarding the key derivation and
   related methods.

<span class="h3"><a class="selflink" id="section-3.5" href="#section-3.5">3.5</a>.  Cipher</span>

   The new cipher suites introduced in this document add two new AEAD
   encryption algorithms, AEAD_SM4_GCM and AEAD_SM4_CCM, which stand for
   SM4 cipher in Galois/Counter mode and SM4 cipher [<a href="#ref-GBT.32907-2016">GBT.32907-2016</a>] in
   Counter with CBC-MAC mode, respectively.  The hash function for both
   cipher suites is SM3 ([<a href="#ref-ISO-SM3" title="&quot;IT Security techniques -- Hash-functions -- Part 3: Dedicated hash-functions&quot;">ISO-SM3</a>]).

   This section defines the AEAD_SM4_GCM and AEAD_SM4_CCM AEAD
   algorithms in a style similar to what [<a href="/doc/html/rfc5116" title="&quot;An Interface and Algorithms for Authenticated Encryption&quot;">RFC5116</a>] used to define AEAD
   ciphers based on the AES cipher.

<span class="h4"><a class="selflink" id="section-3.5.1" href="#section-3.5.1">3.5.1</a>.  AEAD_SM4_GCM</span>

   The AEAD_SM4_GCM authenticated encryption algorithm works as
   specified in [<a href="#ref-GCM" title="&quot;Recommendation for Block Cipher Modes of Operation: Galois/Counter Mode (GCM) and GMAC&quot;">GCM</a>], using SM4 as the block cipher, by providing the
   key, nonce, plaintext, and associated data to that mode of operation.
   An authentication tag conforming to the requirements of TLS 1.3 as
   specified in <a href="/doc/html/rfc8446#section-5.2">Section&nbsp;5.2 of [RFC8446]</a> MUST be constructed using the
   details in the TLS record header.  The additional data input that
   forms the authentication tag MUST be the TLS record header.  The
   AEAD_SM4_GCM ciphertext is formed by appending the authentication tag
   provided as an output to the GCM encryption operation to the
   ciphertext that is output by that operation.  AEAD_SM4_GCM has four
   inputs: an SM4 key, an initialization vector (IV), a plaintext
   content, and optional additional authenticated data (AAD).
   AEAD_SM4_GCM generates two outputs: a ciphertext and message
   authentication code (also called an authentication tag).  To have a
   common set of terms for AEAD_SM4_GCM and AEAD_SM4_CCM, the
   AEAD_SM4_GCM IV is referred to as a nonce in the remainder of this
   document.  A simple test vector of AEAD_SM4_GCM and AEAD_SM4_CCM is
   given in <a href="#appendix-A">Appendix A</a> of this document.

   The nonce is generated by the party performing the authenticated
   encryption operation.  Within the scope of any authenticated
   encryption key, the nonce value MUST be unique.  That is, the set of
   nonce values used with any given key MUST NOT contain any duplicates.
   Using the same nonce for two different messages encrypted with the
   same key destroys the security properties of GCM mode.  To generate
   the nonce, implementations of this document MUST conform to TLS 1.3
   (see <a href="/doc/html/rfc8446#section-5.3">[RFC8446], Section&nbsp;5.3</a>).

   The input and output lengths are as follows:

      The SM4 key length is 16 octets.

      The max plaintext length is 2^(36) - 31 octets.

      The max AAD length is 2^(61) - 1 octets.

      The nonce length is 12 octets.

      The authentication tag length is 16 octets.

      The max ciphertext length is 2^(36) - 15 octets.

   A security analysis of GCM is available in [<a href="#ref-MV04" title="&quot;The Security and Performance of the Galois/Counter Mode of Operation&quot;">MV04</a>].

<span class="h4"><a class="selflink" id="section-3.5.2" href="#section-3.5.2">3.5.2</a>.  AEAD_SM4_CCM</span>

   The AEAD_SM4_CCM authenticated encryption algorithm works as
   specified in [<a href="#ref-CCM" title="&quot;Recommendation for Block Cipher Modes of Operation: the CCM Mode for Authentication and Confidentiality&quot;">CCM</a>] using SM4 as the block cipher.  AEAD_SM4_CCM has
   four inputs: an SM4 key, a nonce, a plaintext, and optional
   additional authenticated data (AAD).  AEAD_SM4_CCM generates two
   outputs: a ciphertext and a message authentication code (also called
   an authentication tag).  The formatting and counter generation
   functions are as specified in <a href="#appendix-A">Appendix A</a> of [<a href="#ref-CCM" title="&quot;Recommendation for Block Cipher Modes of Operation: the CCM Mode for Authentication and Confidentiality&quot;">CCM</a>], and the values of
   the parameters identified in that appendix are as follows:

      The nonce length n is 12.

      The tag length t is 16.

      The value of q is 3.

   An authentication tag is also used in AEAD_SM4_CCM.  The generation
   of the authentication tag MUST conform to TLS 1.3 (See <a href="/doc/html/rfc8446#section-5.2">[RFC8446],
   Section&nbsp;5.2</a>).  The AEAD_SM4_CCM ciphertext is formed by appending the
   authentication tag provided as an output to the CCM encryption
   operation to the ciphertext that is output by that operation.  The
   input and output lengths are as follows:

      The SM4 key length is 16 octets.

      The max plaintext length is 2^(24) - 1 octets.

      The max AAD length is 2^(64) - 1 octets.

      The max ciphertext length is 2^(24) + 15 octets.

   To generate the nonce, implementations of this document MUST conform
   to TLS 1.3 (see <a href="/doc/html/rfc8446#section-5.3">[RFC8446], Section&nbsp;5.3</a>).

   A security analysis of CCM is available in [<a href="#ref-J02" title="&quot;On the Security of CTR + CBC-MAC&quot;">J02</a>].

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>.  IANA Considerations</span>

   IANA has assigned the values {0x00,0xC6} and {0x00,0xC7} with the
   names &quot;TLS_SM4_GCM_SM3&quot; and &quot;TLS_SM4_CCM_SM3&quot; to the &quot;TLS Cipher
   Suites&quot; registry with this document as reference:

    +===========+=================+=========+=============+===========+
    | Value     | Description     | DTLS-OK | Recommended | Reference |
    +===========+=================+=========+=============+===========+
    | 0x00,0xC6 | TLS_SM4_GCM_SM3 | No      | No          | <a href="/doc/html/rfc8998">RFC 8998</a>  |
    +-----------+-----------------+---------+-------------+-----------+
    | 0x00,0xC7 | TLS_SM4_CCM_SM3 | No      | No          | <a href="/doc/html/rfc8998">RFC 8998</a>  |
    +-----------+-----------------+---------+-------------+-----------+

                                  Table 1

   IANA has assigned the value 0x0708 with the name &quot;sm2sig_sm3&quot; to the
   &quot;TLS SignatureScheme&quot; registry:

            +========+=============+=============+===========+
            |  Value | Description | Recommended | Reference |
            +========+=============+=============+===========+
            | 0x0708 | sm2sig_sm3  | No          | <a href="/doc/html/rfc8998">RFC 8998</a>  |
            +--------+-------------+-------------+-----------+

                                 Table 2

   IANA has assigned the value 41 with the name &quot;curveSM2&quot; to the &quot;TLS
   Supported Groups&quot; registry:

        +=======+=============+=========+=============+===========+
        | Value | Description | DTLS-OK | Recommended | Reference |
        +=======+=============+=========+=============+===========+
        |    41 | curveSM2    | No      | No          | <a href="/doc/html/rfc8998">RFC 8998</a>  |
        +-------+-------------+---------+-------------+-----------+

                                  Table 3

<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>.  Security Considerations</span>

   At the time of writing, there are no known weak keys for SM
   cryptographic algorithms SM2, SM3 and SM4, and no security issues
   have been found for these algorithms.

   A security analysis of GCM is available in [<a href="#ref-MV04" title="&quot;The Security and Performance of the Galois/Counter Mode of Operation&quot;">MV04</a>].

   A security analysis of CCM is available in [<a href="#ref-J02" title="&quot;On the Security of CTR + CBC-MAC&quot;">J02</a>].

<span class="h2"><a class="selflink" id="section-6" href="#section-6">6</a>.  References</span>

<span class="h3"><a class="selflink" id="section-6.1" href="#section-6.1">6.1</a>.  Normative References</span>

   [<a id="ref-CCM">CCM</a>]      Dworkin, M., &quot;Recommendation for Block Cipher Modes of
              Operation: the CCM Mode for Authentication and
              Confidentiality&quot;, Special Publication 800-38C,
              DOI 10.6028/NIST.SP.800-38C, May 2004,
              &lt;<a href="http://csrc.nist.gov/publications/nistpubs/800-38C/SP800-38C.pdf">http://csrc.nist.gov/publications/nistpubs/800-38C/</a>
              <a href="http://csrc.nist.gov/publications/nistpubs/800-38C/SP800-38C.pdf">SP800-38C.pdf</a>&gt;.

   [<a id="ref-GCM">GCM</a>]      Dworkin, M., &quot;Recommendation for Block Cipher Modes of
              Operation: Galois/Counter Mode (GCM) and GMAC&quot;, Special
              Publication 800-38D, DOI 10.6028/NIST.SP.800-38D, November
              2007, &lt;<a href="http://csrc.nist.gov/publications/nistpubs/800-38D/SP-800-38D.pdf">http://csrc.nist.gov/publications/nistpubs/800-38D/</a>
              <a href="http://csrc.nist.gov/publications/nistpubs/800-38D/SP-800-38D.pdf">SP-800-38D.pdf</a>&gt;.

   [<a id="ref-ISO-SM2">ISO-SM2</a>]  International Organization for Standardization, &quot;IT
              Security techniques -- Digital signatures with appendix --
              Part 3: Discrete logarithm based mechanisms&quot;, ISO/
              IEC 14888-3:2018, November 2018,
              &lt;<a href="https://www.iso.org/standard/76382.html">https://www.iso.org/standard/76382.html</a>&gt;.

   [<a id="ref-ISO-SM3">ISO-SM3</a>]  International Organization for Standardization, &quot;IT
              Security techniques -- Hash-functions -- Part 3: Dedicated
              hash-functions&quot;, ISO/IEC 10118-3:2018, October 2018,
              &lt;<a href="https://www.iso.org/standard/67116.html">https://www.iso.org/standard/67116.html</a>&gt;.

   [<a id="ref-ISO-SM4">ISO-SM4</a>]  International Organization for Standardization,
              &quot;Information technology -- Security techniques --
              Encryption algorithms -- Part 3: Block ciphers&quot;, ISO/
              IEC 18033-3:2010, December 2010,
              &lt;<a href="https://www.iso.org/standard/54531.html">https://www.iso.org/standard/54531.html</a>&gt;.

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., &quot;Key words for use in RFCs to Indicate
              Requirement Levels&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc2119">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC5116">RFC5116</a>]  McGrew, D., &quot;An Interface and Algorithms for Authenticated
              Encryption&quot;, <a href="/doc/html/rfc5116">RFC 5116</a>, DOI 10.17487/RFC5116, January 2008,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5116">https://www.rfc-editor.org/info/rfc5116</a>&gt;.

   [<a id="ref-RFC8174">RFC8174</a>]  Leiba, B., &quot;Ambiguity of Uppercase vs Lowercase in <a href="/doc/html/rfc2119">RFC</a>
              <a href="/doc/html/rfc2119">2119</a> Key Words&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc8174">RFC 8174</a>, DOI 10.17487/RFC8174,
              May 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.

   [<a id="ref-RFC8446">RFC8446</a>]  Rescorla, E., &quot;The Transport Layer Security (TLS) Protocol
              Version 1.3&quot;, <a href="/doc/html/rfc8446">RFC 8446</a>, DOI 10.17487/RFC8446, August 2018,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;.

<span class="h3"><a class="selflink" id="section-6.2" href="#section-6.2">6.2</a>.  Informative References</span>

   [<a id="ref-GBT.32905-2016">GBT.32905-2016</a>]
              Standardization Administration of China, &quot;Information
              security technology --- SM3 cryptographic hash algorithm&quot;,
              GB/T 32905-2016, March 2017, &lt;<a href="http://www.gmbz.org.cn/upload/2018-07-24/1532401392982079739.pdf">http://www.gmbz.org.cn/</a>
              <a href="http://www.gmbz.org.cn/upload/2018-07-24/1532401392982079739.pdf">upload/2018-07-24/1532401392982079739.pdf</a>&gt;.

   [<a id="ref-GBT.32907-2016">GBT.32907-2016</a>]
              Standardization Administration of the People&#x27;s Republic of
              China, &quot;Information security technology -- SM4 block
              cipher algorithm&quot;, GB/T 32907-2016, March 2017,
              &lt;<a href="http://www.gmbz.org.cn/upload/2018-04-04/1522788048733065051.pdf">http://www.gmbz.org.cn/</a>
              <a href="http://www.gmbz.org.cn/upload/2018-04-04/1522788048733065051.pdf">upload/2018-04-04/1522788048733065051.pdf</a>&gt;.

   [<a id="ref-GBT.32918.2-2016">GBT.32918.2-2016</a>]
              Standardization Administration of the People&#x27;s Republic of
              China, &quot;Information security technology --- Public key
              cryptographic algorithm SM2 based on elliptic curves ---
              Part 2: Digital signature algorithm&quot;, GB/T 32918.2-2016,
              March 2017, &lt;<a href="http://www.gmbz.org.cn/upload/2018-07-24/1532401673138056311.pdf">http://www.gmbz.org.cn/</a>
              <a href="http://www.gmbz.org.cn/upload/2018-07-24/1532401673138056311.pdf">upload/2018-07-24/1532401673138056311.pdf</a>&gt;.

   [<a id="ref-GBT.32918.5-2017">GBT.32918.5-2017</a>]
              Standardization Administration of the People&#x27;s Republic of
              China, &quot;Information security technology --- Public key
              cryptographic algorithm SM2 based on elliptic curves ---
              Part 5: Parameter definition&quot;, GB/T 32918.5-2017, December
              2017, &lt;<a href="http://www.gmbz.org.cn/upload/2018-07-24/1532401863206085511.pdf">http://www.gmbz.org.cn/</a>
              <a href="http://www.gmbz.org.cn/upload/2018-07-24/1532401863206085511.pdf">upload/2018-07-24/1532401863206085511.pdf</a>&gt;.

   [<a id="ref-GMT.0009-2012">GMT.0009-2012</a>]
              State Cryptography Administration, &quot;SM2 cryptography
              algorithm application specification&quot;, GM/T 0009-2012,
              November 2012, &lt;<a href="http://www.gmbz.org.cn/main/viewfile/2018011001400692565.html">http://www.gmbz.org.cn/main/</a>
              <a href="http://www.gmbz.org.cn/main/viewfile/2018011001400692565.html">viewfile/2018011001400692565.html</a>&gt;.

   [<a id="ref-J02">J02</a>]      Jonsson, J., &quot;On the Security of CTR + CBC-MAC&quot;,
              DOI 10.1007/3-540-36492-7_7, February 2003,
              &lt;<a href="https://link.springer.com/chapter/10.1007%2F3-540-36492-7_7">https://link.springer.com/</a>
              <a href="https://link.springer.com/chapter/10.1007%2F3-540-36492-7_7">chapter/10.1007%2F3-540-36492-7_7</a>&gt;.

   [<a id="ref-MV04">MV04</a>]     McGrew, D. and J. Viega, &quot;The Security and Performance of
              the Galois/Counter Mode of Operation&quot;,
              DOI 10.1007/978-3-540-30556-9_27, December 2004,
              &lt;<a href="http://eprint.iacr.org/2004/193">http://eprint.iacr.org/2004/193</a>&gt;.

<span class="h2"><a class="selflink" id="appendix-A" href="#appendix-A">Appendix A</a>.  Test Vectors</span>

   All values are in hexadecimal and are in network byte order (big
   endian).

<span class="h3"><a class="selflink" id="appendix-A.1" href="#appendix-A.1">A.1</a>.  SM4-GCM Test Vectors</span>

   Initialization Vector:   00001234567800000000ABCD
   Key:                     0123456789ABCDEFFEDCBA9876543210
   Plaintext:               AAAAAAAAAAAAAAAABBBBBBBBBBBBBBBB
                            CCCCCCCCCCCCCCCCDDDDDDDDDDDDDDDD
                            EEEEEEEEEEEEEEEEFFFFFFFFFFFFFFFF
                            EEEEEEEEEEEEEEEEAAAAAAAAAAAAAAAA
   Associated Data:         FEEDFACEDEADBEEFFEEDFACEDEADBEEFABADDAD2
   CipherText:              17F399F08C67D5EE19D0DC9969C4BB7D
                            5FD46FD3756489069157B282BB200735
                            D82710CA5C22F0CCFA7CBF93D496AC15
                            A56834CBCF98C397B4024A2691233B8D
   Authentication Tag:      83DE3541E4C2B58177E065A9BF7B62EC

<span class="h3"><a class="selflink" id="appendix-A.2" href="#appendix-A.2">A.2</a>.  SM4-CCM Test Vectors</span>

   Initialization Vector:   00001234567800000000ABCD
   Key:                     0123456789ABCDEFFEDCBA9876543210
   Plaintext:               AAAAAAAAAAAAAAAABBBBBBBBBBBBBBBB
                            CCCCCCCCCCCCCCCCDDDDDDDDDDDDDDDD
                            EEEEEEEEEEEEEEEEFFFFFFFFFFFFFFFF
                            EEEEEEEEEEEEEEEEAAAAAAAAAAAAAAAA
   Associated Data:         FEEDFACEDEADBEEFFEEDFACEDEADBEEFABADDAD2
   CipherText:              48AF93501FA62ADBCD414CCE6034D895
                            DDA1BF8F132F042098661572E7483094
                            FD12E518CE062C98ACEE28D95DF4416B
                            ED31A2F04476C18BB40C84A74B97DC5B
   Authentication Tag:      16842D4FA186F56AB33256971FA110F4

Contributors

   Qin Long
   Ant Group

   Email: zhuolong.lq@antfin.com


   Kepeng Li
   Ant Group

   Email: kepeng.lkp@antfin.com


   Ke Zeng
   Ant Group

   Email: william.zk@antfin.com


   Han Xiao
   Ant Group

   Email: han.xiao@antfin.com


   Zhi Guan
   Peking University

   Email: guan@pku.edu.cn


Author&#x27;s Address

   Paul Yang
   Ant Group
   No. 77 Xueyuan Road
   Hangzhou
   310000
   China

   Phone: +86-571-2688-8888
   Email: kaishen.yy@antfin.com
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

