<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    rfc8904
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.33.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.33.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/draft-vesely-authmethod-dnswl/">
  <meta name="description" content="DNS Whitelist (DNSWL) Email Authentication Method Extension (RFC )">
  <script src="https://www.ietf.org/lib/dt/7.33.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.33.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.33.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.33.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bgorange"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc8904.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc8904.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/rfc8904.xml" title="XML source for this document">xml</a>|<a href="https://www.rfc-editor.org/rfc/rfc8904.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/rfc8904/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/rfc8904/" title="Datatracker information for this document">Tracker</a>] [<a href="mailto:draft-vesely-authmethod-dnswl@ietf.org?subject=draft-vesely-authmethod-dnswl" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=draft-vesely-authmethod-dnswl-16.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-vesely-authmethod-dnswl-16.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-vesely-authmethod-dnswl-16.txt" title="Run an idnits check of this document">Nits</a>]

From: <a href="/doc/html/draft-vesely-authmethod-dnswl-16">draft-vesely-authmethod-dnswl-16</a>                     Informational</pre>
      </div>
    

    <div class="draftcontent">
    <pre>Independent Submission                                         A. Vesely
Request for Comments: 8904                                September 2020
Category: Informational
ISSN: 2070-1721


      <span class="h1">DNS Whitelist (DNSWL) Email Authentication Method Extension</span>

Abstract

   This document describes an email authentication method compliant with
   <a href="/doc/html/rfc8601">RFC 8601</a>.  The method consists of looking up the sender&#x27;s IP address
   in a DNS whitelist.  This document provides information in case the
   method is seen in the field, suggests a useful practice, and
   registers the relevant keywords.

   This document does not consider blacklists.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This is a contribution to the RFC Series, independently of any other
   RFC stream.  The RFC Editor has chosen to publish this document at
   its discretion and makes no statement about its value for
   implementation or deployment.  Documents approved for publication by
   the RFC Editor are not candidates for any level of Internet Standard;
   see <a href="/doc/html/rfc7841#section-2">Section&nbsp;2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="https://www.rfc-editor.org/info/rfc8904">https://www.rfc-editor.org/info/rfc8904</a>.

Copyright Notice

   Copyright (c) 2020 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="/doc/html/bcp78">BCP 78</a> and the IETF Trust&#x27;s Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.

Table of Contents

   1.  Introduction
   2.  Method Details
   3.  TXT Record Contents
   4.  IANA Considerations
     4.1.  Email Authentication Methods
     4.2.  Email Authentication Property Type
     4.3.  Email Authentication Result Names
   5.  Security Considerations
     5.1.  Over-Quota Signaling
     5.2.  Security of DNSSEC Validation
     5.3.  Inherited Security Considerations
   6.  References
     6.1.  Normative References
     6.2.  Informative References
   <a href="#appendix-A">Appendix A</a>.  Example
   <a href="#appendix-B">Appendix B</a>.  Known Implementation
   <a href="#appendix-C">Appendix C</a>.  Future Possibilities of the &#x27;dns&#x27; ptype
   Author&#x27;s Address

<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>.  Introduction</span>

   One of the many checks that mail servers carry out is to query DNS
   whitelists (DNSWLs).  That method is fully discussed in [<a href="/doc/html/rfc5782" title="&quot;DNS Blacklists and Whitelists&quot;">RFC5782</a>].
   The DNS [<a href="/doc/html/rfc1034" title="&quot;Domain names - concepts and facilities&quot;">RFC1034</a>] lookup is based on the connecting client&#x27;s IP
   address, IPv4 or IPv6, and returns zero or more A records.  The
   latter are IPv4 IP addresses in the range 127.0.0.0/8.  Depending on
   the query, TXT records with varying content can also be retrieved.
   Query examples are given in <a href="#appendix-A">Appendix A</a>.

   Since the IP address is known as soon as the connection is accepted,
   this check can occur very early in an SMTP transaction.  Its result
   can be used to counterweight policies that typically occur at early
   stages too, such as the Sender Policy Framework (SPF) (the last
   paragraph of <a href="/doc/html/rfc7208#appendix-D.3">Appendix&nbsp;D.3 of [RFC7208]</a> is also illustrated in
   <a href="#appendix-A">Appendix A</a>).  In addition, the result of a DNSWL lookup can be used
   at later stages; for example, a delivery agent can use it to learn
   the trustworthiness of a mail relay in order to estimate the
   spamminess of an email message.  The latter possibility needs a place
   to collect query results for downstream use, which is precisely what
   the Authentication-Results header field aims to provide.

   Results often contain additional data, encoded according to DNSWL-
   specific criteria.  The method described in this document considers
   only whitelists -- one of the major branches described by [<a href="/doc/html/rfc5782" title="&quot;DNS Blacklists and Whitelists&quot;">RFC5782</a>].
   There are also blacklists/blocklists (DNSBLs) and combined lists.
   Since they all have the same structure, the abbreviation DNSxL is
   used to mean any.  The core procedures of a Mail Transfer Agent (MTA)
   tend to be quite general, leaving particular cases to be handled by
   add-on modules.  In the case of combined lists, the boundary MTA (see
   [<a href="/doc/html/rfc5598" title="&quot;Internet Mail Architecture&quot;">RFC5598</a>]), which carries out the check and possibly stores the
   result, has to be able to discern at least the color of each entry,
   as that is required to make accept/reject decisions.  This document
   provides for storing the result when the DNSxL record to be reported
   is a whitelisting one.

   Data conveyed in A and TXT records can be stored as properties of the
   method.  The meaning of such data varies widely at the mercy of the
   list operator; hence, the queried zone has to be stored as well.
   Mail site operators who configure their MTAs to query specific DNWSLs
   marry the policies of those lists, as, in effect, they become
   tantamount to local policies, albeit outsourced.  Downstream agents
   who know DNSWL-specific encoding and understand the meaning of that
   data can use it to make delivery or display decisions.  For example,
   a mail filter that detects heuristic evidence of a scam can
   counterweight such information with the trustworthiness score encoded
   in the A response so as to protect against false positives.  Mail
   User Agents (MUAs) can display those results or use them to decide
   how to report abusive messages, if configured to do so.

   This document describes a usage of TXT fields consistent with other
   authentication methods, namely to serve the domain name in the TXT
   record.  That way, a downstream filter could also consider whether
   the sending agent is aligned with the author domain, with semantics
   similar to [<a href="/doc/html/rfc7489" title="&quot;Domain-based Message Authentication, Reporting, and Conformance (DMARC)&quot;">RFC7489</a>].

   At the time of this writing, this method is implemented by Courier-
   MTA [<a href="#ref-Courier-MTA">Courier-MTA</a>].  An outline of the implementation is given in
   <a href="#appendix-B">Appendix B</a>.

<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  Method Details</span>

   The result of the method states how the query did, up to the
   interpretation of the returned data.

   The method has four possible results:

   pass:        The query successfully returned applicable records.
                This result is usually accompanied by one or both of the
                policy properties described below.  Since the list is
                configured as a DNSWL, agents unable to interpret list-
                specific properties can still derive a positive value
                from the fact that the sender is whitelisted.

   none:        The query worked but yielded no A record or returned
                NXDOMAIN, so the sender is not whitelisted.

   temperror:   The DNS evaluation could not be completed due to some
                error that is likely transient in nature, such as a
                temporary DNS error (e.g., a DNS RCODE of 2, commonly
                known as SERVFAIL) or other error condition.  A later
                attempt may produce a final result.

   permerror:   The DNS evaluation cannot work because test entries
                don&#x27;t work (that is, DNSWL is broken) or because queries
                are over quota (reported by a DNS RCODE of 5, commonly
                known as REFUSED, or by a DNSWL-specific property
                (policy.ip, defined below) with the same meaning).  A
                later attempt is unlikely to produce a final result.
                Human intervention is required.

   Note that there is no &quot;fail&quot; result.

   The following ptype.property items define how the data provided by
   the whitelist lookup can be saved.

   dns.zone:    DNSWL query root domain, which defines the meaning of
                the policy.ip property below.  Note that an MTA can use
                a local mirror with a different name.  The name stored
                here has to be the best available reference for all
                foreseeable downstream consumers.  Setting dns.zone to
                the global zone makes the result intelligible even if
                the message is handed outside of the internal network.

   policy.ip:   The bit mask value received in type A response, in
                dotted quad notation.  Multiple entries can be arranged
                in a quoted, comma-separated list (quotes are necessary
                because commas are not allowed in a token).

   policy.txt:  The TXT record, if any.  Multiple records are
                concatenated in the usual way (explained, for example,
                in <a href="/doc/html/rfc7208#section-3.3">Section&nbsp;3.3 of [RFC7208]</a>).  See <a href="#section-3">Section 3</a> for the
                resulting content and query options.

   dns.sec:     This is a generic property stating whether the relevant
                data was validated using DNSSEC [<a href="/doc/html/rfc4033" title="&quot;DNS Security Introduction and Requirements&quot;">RFC4033</a>].  For the
                present method, the relevant data consists of the
                reported policy properties above or, if the method
                result is &quot;none&quot;, its nonexistence.  This property has
                three possible values:

                yes:  DNSSEC validation confirms the integrity of data.
                      <a href="#section-5.2">Section 5.2</a> considers how that is related to the
                      DNS response.

                no:   The data is not signed.  See <a href="#section-5.2">Section 5.2</a>.

                na:   Not applicable.  No DNSSEC validation can be
                      performed, possibly because the lookup is run
                      through a different means than a security-aware
                      DNS resolver.  This does not necessarily imply
                      less security.  In particular, &quot;na&quot; is used if the
                      data was downloaded in bulk and then loaded on a
                      local nameserver, which is the case of an MTA
                      querying a local zone different from the reported
                      dns.zone.  DNS errors, including validation
                      errors, can also report &quot;na&quot;.  This is also the
                      value assumed by default.

<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>.  TXT Record Contents</span>

   According to [<a href="/doc/html/rfc5782" title="&quot;DNS Blacklists and Whitelists&quot;">RFC5782</a>], TXT records describe the reason why IP
   addresses are listed in a DNSWL.  An example of a DNSWL whose TXT
   records contain the domain name of the organization assignee of the
   sending IP is given in <a href="#appendix-B">Appendix B</a>.  The domain name would correspond
   to the DNS domain name used by or within the Administrative
   Management Domain (ADMD) operating the relevant MTA, sometimes called
   the &quot;organizational domain&quot;.  In that case, the authentication
   provided by this method is equivalent to a DomainKeys Identified Mail
   (DKIM) signature [<a href="/doc/html/rfc6376" title="&quot;DomainKeys Identified Mail (DKIM) Signatures&quot;">RFC6376</a>] or an SPF check host [<a href="/doc/html/rfc7208" title="&quot;Sender Policy Framework (SPF) for Authorizing Use of Domains in Email, Version 1&quot;">RFC7208</a>], if the
   DNSWL is trusted.

   According to a DNSWL&#x27;s policy, attributing responsibility of an IP
   address to an organization may require something more than a mere PTR
   record consistency.  If no domain names can be responsibly associated
   to a given IP address, for example, because the IP address was added
   without direct involvement of the organization concerned, DNSWLs can
   use a subdomain of .INVALID [<a href="/doc/html/rfc2606" title="&quot;Reserved Top Level DNS Names&quot;">RFC2606</a>] where the leftmost label hints
   at why an address is whitelisted.  For example, if the address
   192.0.2.38 was added by the list managers solely based on their
   knowledge, the corresponding TXT record might be AUTOPROMOTED.INVALID
   so as to avoid explicitly identifying an entity that didn&#x27;t opt in.

   Following the example of Multicast DNS (see the second paragraph of
   <a href="/doc/html/rfc6762#section-16">Section&nbsp;16 of [RFC6762]</a>), names containing non-ASCII characters can
   be encoded in UTF-8 [<a href="/doc/html/rfc3629" title="&quot;UTF-8, a transformation format of ISO 10646&quot;">RFC3629</a>] using the Normalization Form C [<a href="#ref-NFC" title="&quot;Unicode Normalization Forms&quot;">NFC</a>],
   as described in &quot;Unicode Format for Network Interchange&quot; [<a href="/doc/html/rfc5198" title="&quot;Unicode Format for Network Interchange&quot;">RFC5198</a>].
   Inclusion of unaltered UTF-8 TXT values in the header entails an
   environment compatible with Email Address Internationalization (EAI)
   [<a href="/doc/html/rfc6530" title="&quot;Overview and Framework for Internationalized Email&quot;">RFC6530</a>].

   DNS queries with a QTYPE of ANY may lead to inconsistent replies,
   depending on the cache status.  In addition, ANY is not &quot;all&quot;, and
   the provisions for queries that have QTYPE=ANY [<a href="/doc/html/rfc8482" title="&quot;Providing Minimal-Sized Responses to DNS Queries That Have QTYPE=ANY&quot;">RFC8482</a>] don&#x27;t cover
   DNSxLs.  A mail server can issue two simultaneous queries, A and TXT.
   Otherwise, a downstream filter can issue a TXT query on its own, if
   it knows that an A query was successful and that the DNSWL serves
   useful TXT records.  It is unlikely that TXT records exist if a query
   for QTYPE A brought a result of &quot;none&quot;.

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>.  IANA Considerations</span>

   IANA maintains the &quot;Email Authentication Parameters&quot; registry with
   several subregistries.  IANA has made the assignments set out in the
   following sections.

<span class="h3"><a class="selflink" id="section-4.1" href="#section-4.1">4.1</a>.  Email Authentication Methods</span>

   IANA has created four new entries in the &quot;Email Authentication
   Methods&quot; registry as follows.

   +======+===========+======+========+=================+======+=======+
   |Method|Definition |ptype |property|Value            |Status|Version|
   +======+===========+======+========+=================+======+=======+
   |dnswl |<a href="/doc/html/rfc8904">RFC 8904</a>   |dns   |zone    |DNSWL publicly   |active|   1   |
   |      |           |      |        |accessible query |      |       |
   |      |           |      |        |root domain      |      |       |
   +------+-----------+------+--------+-----------------+------+-------+
   |dnswl |<a href="/doc/html/rfc8904">RFC 8904</a>   |policy|ip      |type A response  |active|   1   |
   |      |           |      |        |received (or a   |      |       |
   |      |           |      |        |quoted, comma-   |      |       |
   |      |           |      |        |separated list   |      |       |
   |      |           |      |        |thereof)         |      |       |
   +------+-----------+------+--------+-----------------+------+-------+
   |dnswl |<a href="/doc/html/rfc8904">RFC 8904</a>   |policy|txt     |type TXT query   |active|   1   |
   |      |           |      |        |response         |      |       |
   +------+-----------+------+--------+-----------------+------+-------+
   |dnswl |<a href="/doc/html/rfc8904">RFC 8904</a>   |dns   |sec     |one of &quot;yes&quot; for |active|   1   |
   |      |           |      |        |DNSSEC           |      |       |
   |      |           |      |        |authenticated    |      |       |
   |      |           |      |        |data, &quot;no&quot; for   |      |       |
   |      |           |      |        |not signed, or   |      |       |
   |      |           |      |        |&quot;na&quot; for not     |      |       |
   |      |           |      |        |applicable       |      |       |
   +------+-----------+------+--------+-----------------+------+-------+

                                  Table 1

<span class="h3"><a class="selflink" id="section-4.2" href="#section-4.2">4.2</a>.  Email Authentication Property Type</span>

   IANA has created a new entry in the &quot;Email Authentication Property
   Types&quot; registry as follows.

        +=======+============+====================================+
        | ptype | Definition | Description                        |
        +=======+============+====================================+
        | dns   | <a href="/doc/html/rfc8904">RFC 8904</a>   | The property being reported        |
        |       |            | belongs to the Domain Name System. |
        +-------+------------+------------------------------------+

                                  Table 2

<span class="h3"><a class="selflink" id="section-4.3" href="#section-4.3">4.3</a>.  Email Authentication Result Names</span>

   IANA has created four new entries in the &quot;Email Authentication Result
   Names&quot; registry as follows.

           +=============+===========+===============+========+
           | Auth Method | Code      | Specification | Status |
           +=============+===========+===============+========+
           | dnswl       | pass      | <a href="/doc/html/rfc8904">RFC 8904</a>      | active |
           +-------------+-----------+---------------+--------+
           | dnswl       | none      | <a href="/doc/html/rfc8904">RFC 8904</a>      | active |
           +-------------+-----------+---------------+--------+
           | dnswl       | temperror | <a href="/doc/html/rfc8904">RFC 8904</a>      | active |
           +-------------+-----------+---------------+--------+
           | dnswl       | permerror | <a href="/doc/html/rfc8904">RFC 8904</a>      | active |
           +-------------+-----------+---------------+--------+

                                 Table 3

<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>.  Security Considerations</span>

<span class="h3"><a class="selflink" id="section-5.1" href="#section-5.1">5.1</a>.  Over-Quota Signaling</span>

   Some DNSWLs that provide for free access below a given quota are
   known to return special codes to signal that the quota has been
   exceeded (for example, 127.0.0.255).  If the MTA cannot interpret
   that value, that case results in a false positive.  It can accept
   messages that it would otherwise reject.  A DNSWL-specific module
   would realize this fact and call for human intervention.

   Returning an RCODE 5 (REFUSED) conveys the concept that the query is
   &quot;unauthorized&quot; and human intervention required.

<span class="h3"><a class="selflink" id="section-5.2" href="#section-5.2">5.2</a>.  Security of DNSSEC Validation</span>

   The dns.sec property is meant to be as secure as DNSSEC results.  It
   makes sense to use it in an environment where the DNSSEC validation
   can succeed.

   <a href="/doc/html/rfc4033#section-7">Section&nbsp;7 of [RFC4033]</a> examines various ways of setting up a stub
   resolver that either validates DNSSEC locally or trusts the
   validation provided through a secure channel.  For a different class,
   it is possible to set up a dedicated, caching, DNSSEC-enabled
   resolver reachable by the mail server through interprocess
   communication on 127.0.0.1.  In such cases, the property dns.sec=yes
   corresponds to the Authenticated Data (AD) bit in the DNS response
   header.

   When the response contains no DNSSEC data, a security-aware resolver
   seeks a signed proof of the nonexistence of a DS record at some
   delegation point.  If no error is returned, the zone is unsigned and
   dns.sec=no can be set.  The Security Considerations section of
   [<a href="/doc/html/rfc3225" title="&quot;Indicating Resolver Support of DNSSEC&quot;">RFC3225</a>] states:

   |  The absence of DNSSEC data in response to a query with the DO bit
   |  set MUST NOT be taken to mean no security information is available
   |  for that zone as the response may be forged or a non-forged
   |  response of an altered (DO bit cleared) query.

   If the application verifies the DNSSEC signatures on its own, it
   effectively behaves like a validating resolver and hence can set
   dns.sec correspondingly.

   When the data is downloaded in bulk and made available on a trusted
   channel without using DNSSEC, the application sets dns.sec=na or not
   at all.  For example, consider DNSWLs that publish bulk versions of
   their data duly signed using OpenPGP [<a href="/doc/html/rfc4880" title="&quot;OpenPGP Message Format&quot;">RFC4880</a>].  It is the
   responsibility of system administrators to authenticate the data by
   downloading and validating the signature.  The result of such
   validation is not reported using dns.sec.

<span class="h3"><a class="selflink" id="section-5.3" href="#section-5.3">5.3</a>.  Inherited Security Considerations</span>

   For DNSSEC, the considerations of <a href="/doc/html/rfc4033#section-12">Section&nbsp;12 of [RFC4033]</a> apply.

   All of the considerations described in <a href="/doc/html/rfc8601#section-7">Section&nbsp;7 of [RFC8601]</a> apply.
   That includes securing against tampering all the channels after the
   production of the Authentication-Results header field.

   In addition, the usual caveats apply about importing text from
   external online sources.  Although queried DNSWLs are well-known,
   trusted entities, it is suggested that TXT records be reported only
   if, upon inspection, their content is deemed actionable and their
   format compatible with the computing environment.

<span class="h2"><a class="selflink" id="section-6" href="#section-6">6</a>.  References</span>

<span class="h3"><a class="selflink" id="section-6.1" href="#section-6.1">6.1</a>.  Normative References</span>

   [<a id="ref-RFC2606">RFC2606</a>]  Eastlake 3rd, D. and A. Panitz, &quot;Reserved Top Level DNS
              Names&quot;, <a href="/doc/html/bcp32">BCP 32</a>, <a href="/doc/html/rfc2606">RFC 2606</a>, DOI 10.17487/RFC2606, June 1999,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2606">https://www.rfc-editor.org/info/rfc2606</a>&gt;.

   [<a id="ref-RFC5782">RFC5782</a>]  Levine, J., &quot;DNS Blacklists and Whitelists&quot;, <a href="/doc/html/rfc5782">RFC 5782</a>,
              DOI 10.17487/RFC5782, February 2010,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5782">https://www.rfc-editor.org/info/rfc5782</a>&gt;.

   [<a id="ref-RFC8601">RFC8601</a>]  Kucherawy, M., &quot;Message Header Field for Indicating
              Message Authentication Status&quot;, <a href="/doc/html/rfc8601">RFC 8601</a>,
              DOI 10.17487/RFC8601, May 2019,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8601">https://www.rfc-editor.org/info/rfc8601</a>&gt;.

<span class="h3"><a class="selflink" id="section-6.2" href="#section-6.2">6.2</a>.  Informative References</span>

   [<a id="ref-RFC1034">RFC1034</a>]  Mockapetris, P., &quot;Domain names - concepts and facilities&quot;,
              STD 13, <a href="/doc/html/rfc1034">RFC 1034</a>, DOI 10.17487/RFC1034, November 1987,
              &lt;<a href="https://www.rfc-editor.org/info/rfc1034">https://www.rfc-editor.org/info/rfc1034</a>&gt;.

   [<a id="ref-RFC3225">RFC3225</a>]  Conrad, D., &quot;Indicating Resolver Support of DNSSEC&quot;,
              <a href="/doc/html/rfc3225">RFC 3225</a>, DOI 10.17487/RFC3225, December 2001,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3225">https://www.rfc-editor.org/info/rfc3225</a>&gt;.

   [<a id="ref-RFC3629">RFC3629</a>]  Yergeau, F., &quot;UTF-8, a transformation format of ISO
              10646&quot;, STD 63, <a href="/doc/html/rfc3629">RFC 3629</a>, DOI 10.17487/RFC3629, November
              2003, &lt;<a href="https://www.rfc-editor.org/info/rfc3629">https://www.rfc-editor.org/info/rfc3629</a>&gt;.

   [<a id="ref-RFC4033">RFC4033</a>]  Arends, R., Austein, R., Larson, M., Massey, D., and S.
              Rose, &quot;DNS Security Introduction and Requirements&quot;,
              <a href="/doc/html/rfc4033">RFC 4033</a>, DOI 10.17487/RFC4033, March 2005,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4033">https://www.rfc-editor.org/info/rfc4033</a>&gt;.

   [<a id="ref-RFC4880">RFC4880</a>]  Callas, J., Donnerhacke, L., Finney, H., Shaw, D., and R.
              Thayer, &quot;OpenPGP Message Format&quot;, <a href="/doc/html/rfc4880">RFC 4880</a>,
              DOI 10.17487/RFC4880, November 2007,
              &lt;<a href="https://www.rfc-editor.org/info/rfc4880">https://www.rfc-editor.org/info/rfc4880</a>&gt;.

   [<a id="ref-RFC5198">RFC5198</a>]  Klensin, J. and M. Padlipsky, &quot;Unicode Format for Network
              Interchange&quot;, <a href="/doc/html/rfc5198">RFC 5198</a>, DOI 10.17487/RFC5198, March 2008,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5198">https://www.rfc-editor.org/info/rfc5198</a>&gt;.

   [<a id="ref-RFC5598">RFC5598</a>]  Crocker, D., &quot;Internet Mail Architecture&quot;, <a href="/doc/html/rfc5598">RFC 5598</a>,
              DOI 10.17487/RFC5598, July 2009,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5598">https://www.rfc-editor.org/info/rfc5598</a>&gt;.

   [<a id="ref-RFC6376">RFC6376</a>]  Crocker, D., Ed., Hansen, T., Ed., and M. Kucherawy, Ed.,
              &quot;DomainKeys Identified Mail (DKIM) Signatures&quot;, STD 76,
              <a href="/doc/html/rfc6376">RFC 6376</a>, DOI 10.17487/RFC6376, September 2011,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6376">https://www.rfc-editor.org/info/rfc6376</a>&gt;.

   [<a id="ref-RFC6530">RFC6530</a>]  Klensin, J. and Y. Ko, &quot;Overview and Framework for
              Internationalized Email&quot;, <a href="/doc/html/rfc6530">RFC 6530</a>, DOI 10.17487/RFC6530,
              February 2012, &lt;<a href="https://www.rfc-editor.org/info/rfc6530">https://www.rfc-editor.org/info/rfc6530</a>&gt;.

   [<a id="ref-RFC6762">RFC6762</a>]  Cheshire, S. and M. Krochmal, &quot;Multicast DNS&quot;, <a href="/doc/html/rfc6762">RFC 6762</a>,
              DOI 10.17487/RFC6762, February 2013,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6762">https://www.rfc-editor.org/info/rfc6762</a>&gt;.

   [<a id="ref-RFC7208">RFC7208</a>]  Kitterman, S., &quot;Sender Policy Framework (SPF) for
              Authorizing Use of Domains in Email, Version 1&quot;, <a href="/doc/html/rfc7208">RFC 7208</a>,
              DOI 10.17487/RFC7208, April 2014,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7208">https://www.rfc-editor.org/info/rfc7208</a>&gt;.

   [<a id="ref-RFC7489">RFC7489</a>]  Kucherawy, M., Ed. and E. Zwicky, Ed., &quot;Domain-based
              Message Authentication, Reporting, and Conformance
              (DMARC)&quot;, <a href="/doc/html/rfc7489">RFC 7489</a>, DOI 10.17487/RFC7489, March 2015,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7489">https://www.rfc-editor.org/info/rfc7489</a>&gt;.

   [<a id="ref-RFC8460">RFC8460</a>]  Margolis, D., Brotman, A., Ramakrishnan, B., Jones, J.,
              and M. Risher, &quot;SMTP TLS Reporting&quot;, <a href="/doc/html/rfc8460">RFC 8460</a>,
              DOI 10.17487/RFC8460, September 2018,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8460">https://www.rfc-editor.org/info/rfc8460</a>&gt;.

   [<a id="ref-RFC8482">RFC8482</a>]  Abley, J., Gudmundsson, O., Majkowski, M., and E. Hunt,
              &quot;Providing Minimal-Sized Responses to DNS Queries That
              Have QTYPE=ANY&quot;, <a href="/doc/html/rfc8482">RFC 8482</a>, DOI 10.17487/RFC8482, January
              2019, &lt;<a href="https://www.rfc-editor.org/info/rfc8482">https://www.rfc-editor.org/info/rfc8482</a>&gt;.

   [<a id="ref-Courier-MTA">Courier-MTA</a>]
              &quot;Courier Mail Server&quot;, &lt;<a href="https://www.courier-mta.org/">https://www.courier-mta.org/</a>&gt;.

   [<a id="ref-DNSWL">DNSWL</a>]    &quot;dnswl.org - E-Mail Reputation - Protect against false
              positives&quot;, &lt;<a href="https://www.dnswl.org/">https://www.dnswl.org/</a>&gt;.

   [<a id="ref-NFC">NFC</a>]      Whistler, K., Ed., &quot;Unicode Normalization Forms&quot;, Unicode
              Standard Annex 15, February 2020,
              &lt;<a href="https://www.unicode.org/reports/tr15/tr15-50.html">https://www.unicode.org/reports/tr15/tr15-50.html</a>&gt;.

<span class="h2"><a class="selflink" id="appendix-A" href="#appendix-A">Appendix A</a>.  Example</span>

   Delivered-To: recipient@example.org
   Return-Path: &lt;sender@example.com&gt;
   Authentication-Results: mta.example.org;
     dkim=pass (whitelisted) header.i=@example.com
   Authentication-Results: mta.example.org;
     dnswl=pass dns.zone=list.dnswl.example dns.sec=na
     policy.ip=127.0.10.1
     policy.txt=&quot;fwd.example https://dnswl.example/?d=fwd.example&quot;
   Received-SPF: fail (Address does not pass Sender Policy Framework)
     client-ip=2001:db8::2:1;
     envelope-from=&quot;sender@example.com&quot;;
     helo=mail.fwd.example;
     receiver=mta.example.org;
   Received: from mail.fwd.example (mail.fwd.example [2001:db8::2:1])
     (TLS: TLSv1/SSLv3,128bits,ECDHE-RSA-AES128-GCM-SHA256)
     by mta.example.org with ESMTPS; Thu, 03 Oct 2019 19:23:11 +0200
     id 00000000005DC044.000000005702D87C.000007FC

              Figure 1: Trace Fields at the Top of the Header

   The message went through a third party, fwd.example, which forwarded
   it to the final MTA.  The mail path was not arranged beforehand with
   the involved MTAs; it emerged spontaneously.  This message would not
   have made it to the target without whitelisting, because:

   *  the author domain published a strict SPF policy (-all),

   *  the forwarder did not alter the bounce address, and

   *  the target usually honors reject on fail, according to <a href="/doc/html/rfc7208#section-8.4">Section&nbsp;8.4
      of [RFC7208]</a>.

   However, the target also implemented the last paragraph of
   <a href="/doc/html/rfc7208#appendix-D.3">Appendix&nbsp;D.3 of [RFC7208]</a>.  Its behavior hinges on the following DNS
   entries:

     1.0.0.0.2.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.d.b.8.2.0.0.1.
                                                  list.dnswl.example.
          IN  A    127.0.10.1
          IN  TXT  &quot;fwd.example https://dnswl.example/?d=fwd.example&quot;

     Figure 2: DNS Resource Records for 2001:db8::2:1 (line breaks for
                             editorial reasons)

   If mail.fwd.example had connected from address 192.0.2.1, then the
   query name would have been &quot;1.2.0.192.list.dnswl.example&quot;.  See full
   description in [<a href="/doc/html/rfc5782" title="&quot;DNS Blacklists and Whitelists&quot;">RFC5782</a>].

   At connection time, because the remote IP address is whitelisted, the
   target MTA did not reject the message before DATA.  Instead, it
   recorded the SPF fail result and indicated the local policy mechanism
   that was applied in order to override that result.  Subsequent
   filtering verified DKIM [<a href="/doc/html/rfc6376" title="&quot;DomainKeys Identified Mail (DKIM) Signatures&quot;">RFC6376</a>].

   At later stages, mail filters can reject or quarantine the message
   based on its content.  A deeper knowledge of the policy values
   obtained from dnswl.example allows interpreting the values of
   policy.ip and weighing them against other factors so as to make
   better decisions.

<span class="h2"><a class="selflink" id="appendix-B" href="#appendix-B">Appendix B</a>.  Known Implementation</span>

   Implementation details mentioned in this section have been stable for
   several years.  Yet, this description is necessarily superficial,
   version dependent, and subject to change.

   Courier-MTA [<a href="#ref-Courier-MTA">Courier-MTA</a>] can be configured to look up DNSBLs and
   DNSWLs, with similar command-line switches:

   -block=zone[=displayzone][,var[/n.n.n.n][,msg]]
   -allow=zone[=displayzone][,var[/n.n.n.n[,]]]

   &quot;zone&quot; is the zone to be queried.

   &quot;displayzone&quot; is only used for -allow; it is the value to be set in
   the dns.zone property.

   &quot;var&quot; stands for the environment variable whose existence triggers a
   special action.  The default variable names result in a conventional
   behavior implemented by Courier-MTA.  By setting different
   environment variables, users can customize the behavior.
   Conventional behavior differs widely between -block and -allow.  The
   former rejects the message; the latter produces Authentication-
   Results header fields.

   The n.n.n.n IP address requires a precise A record response.  If not
   given, any response results in setting the corresponding variable.
   If given, variables are set only if the response matches exactly.
   Such syntax provides for a very limited interpretation of the
   information encoded in A records.  However, it is considered to be
   too complicated already.  Even specifying a range, an enumeration of
   values, or a regular expression would require something beyond what a
   normal user would be willing to manage.

   Finally, the trailing message, which overrides the 5xx SMTP reply for
   -block, is not used for -allow, except that its mere presence
   requires querying TXT records to be registered in policy.txt.

   SPF is part of Courier-MTA&#x27;s core.  It is configured separately and
   provides for an &quot;allowok&quot; keyword to indicate the choice to override
   rejection in case of SPF failure and -allow whitelisting.

   A customary whitelist is defined by DNSWL.org [<a href="#ref-DNSWL" title="&quot;dnswl.org - E-Mail Reputation - Protect against false positives&quot;">DNSWL</a>].  It serves A
   records encoded as follows:

   1st octet:  127.

   2nd octet:  0.

   3rd octet:  Category of business, 15 values.

   4th octet:  Trustworthiness/score, 4 values.

   They also serve TXT records containing the domain name followed by a
   URL pointing to further information about the relevant organization,
   such as what other IP addresses of theirs are being whitelisted.
   They don&#x27;t use UTF-8.

   DNSWL.org provides for free registration and free access below
   100,000 queries per day.  They use a special return code, 127.0.0.255
   as exemplified above, to signal that the quota has been exceeded.
   Although Courier-MTA itself does not recognize this return code, it
   has a mail filter (zdkimfilter, named after its main usage) that hard
   codes recognition of this code and the code for trustworthiness in
   the 4th octet.

<span class="h2"><a class="selflink" id="appendix-C" href="#appendix-C">Appendix C</a>.  Future Possibilities of the &#x27;dns&#x27; ptype</span>

   The description of the new ptype proposed in <a href="#section-4.2">Section 4.2</a> says, &quot;The
   property being reported belongs to the Domain Name System.&quot;  That
   definition can broadly include any tag found in a domain&#x27;s TXT
   record.  For example, designers of authentication methods can agree
   that within a resinfo of a given method, any dns ptype refers to tags
   in the relevant DNS record, unless otherwise specified.  So one could
   have, say:

   Authentication-Results: example.com;
     spf=pass smtp.mailfrom=example.net dns.sec=y;
     dkim=pass header.i=@example.org header.b=jIvx30NG dns.s=tlsrpt

   While dns.sec is defined above, albeit not for the spf method, the
   use of tlsrpt in the DKIM record is exemplified in <a href="/doc/html/rfc8460#section-3">Section&nbsp;3 of
   [RFC8460]</a>.  The tag s= is part of the DKIM TXT record, not to be
   confused with the selector s=, which is part of a DKIM signature.
   Just like the latter can be reported as header.s because the DKIM
   header field is in the message header, it may make sense to report
   the former as dns.s because the DKIM DNS record is in the DNS.

   NOTE: This is only a hint at what may become a consistent naming
   convention around the new ptype.  In any case, any new property using
   this ptype requires its own formal definition.  This document does
   NOT define the property dns.s=, let alone the service tlsrpt.

Author&#x27;s Address

   Alessandro Vesely
   v. L. Anelli 13
   20122 Milano MI
   Italy

   Email: vesely@tana.it
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

