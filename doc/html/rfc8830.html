<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    rfc8830
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.34.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.34.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/draft-ietf-mmusic-msid/">
  <meta name="description" content="WebRTC MediaStream Identification in the Session Description Protocol (RFC )">
  <script src="https://www.ietf.org/lib/dt/7.34.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.34.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bgblue"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc8830.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc8830.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/rfc8830.xml" title="XML source for this document">xml</a>|<a href="https://www.rfc-editor.org/rfc/rfc8830.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/rfc8830/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/rfc8830/" title="Datatracker information for this document">Tracker</a>] [<a href="/group/mmusic/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-mmusic-msid@ietf.org?subject=draft-ietf-mmusic-msid" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=draft-ietf-mmusic-msid-17.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-ietf-mmusic-msid-17.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-ietf-mmusic-msid-17.txt" title="Run an idnits check of this document">Nits</a>]

From: <a href="/doc/html/draft-ietf-mmusic-msid-17">draft-ietf-mmusic-msid-17</a>                        Proposed Standard</pre>
      </div>
    

    <div class="draftcontent">
    <pre>Internet Engineering Task Force (IETF)                     H. Alvestrand
Request for Comments: 8830                                        Google
Category: Standards Track                                   January 2021
ISSN: 2070-1721


 <span class="h1">WebRTC MediaStream Identification in the Session Description Protocol</span>

Abstract

   This document specifies a Session Description Protocol (SDP) grouping
   mechanism for RTP media streams that can be used to specify relations
   between media streams.

   This mechanism is used to signal the association between the SDP
   concept of &quot;media description&quot; and the Web Real-Time Communication
   (WebRTC) concept of MediaStream/MediaStreamTrack using SDP signaling.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="/doc/html/rfc7841#section-2">Section&nbsp;2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="https://www.rfc-editor.org/info/rfc8830">https://www.rfc-editor.org/info/rfc8830</a>.

Copyright Notice

   Copyright (c) 2021 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="/doc/html/bcp78">BCP 78</a> and the IETF Trust&#x27;s Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction
     1.1.  Terminology
     1.2.  Structure of This Document
     1.3.  Why a New Mechanism Is Needed
     1.4.  The WebRTC MediaStream
   2.  The MSID Mechanism
   3.  Procedures
     3.1.  Handling of Nonsignaled Tracks
     3.2.  Detailed Offer/Answer Procedures
       3.2.1.  Generating the Initial Offer
       3.2.2.  Answerer Processing of the Offer
       3.2.3.  Generating the Answer
       3.2.4.  Offerer Processing of the Answer
       3.2.5.  Modifying the Session
     3.3.  Example SDP Description
   4.  IANA Considerations
     4.1.  Attribute Registration in Existing Registries
   5.  Security Considerations
   6.  References
     6.1.  Normative References
     6.2.  Informative References
   <a href="#appendix-A">Appendix A</a>.  Design Considerations, Rejected Alternatives
   Acknowledgements
   Author&#x27;s Address

<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>.  Introduction</span>

<span class="h3"><a class="selflink" id="section-1.1" href="#section-1.1">1.1</a>.  Terminology</span>

   This document uses terminology from [<a href="/doc/html/rfc8825" title="&quot;Overview: Real-Time Protocols for Browser-Based Applications&quot;">RFC8825</a>].  In addition, the
   following terms are used as described below:

   RTP stream:  A stream of RTP packets containing media data [<a href="/doc/html/rfc7656" title="&quot;A Taxonomy of Semantics and Mechanisms for Real-Time Transport Protocol (RTP) Sources&quot;">RFC7656</a>].

   MediaStream:  An assembly of MediaStreamTracks
      [<a href="#ref-W3C.CR-mediacapture-streams">W3C.CR-mediacapture-streams</a>].  One MediaStream can contain
      multiple MediaStreamTracks, of the same or different types.

   MediaStreamTrack:  Defined in [<a href="#ref-W3C.CR-mediacapture-streams">W3C.CR-mediacapture-streams</a>] as a
      unidirectional flow of media data (either audio or video, but not
      both).  Corresponds to the [<a href="/doc/html/rfc7656" title="&quot;A Taxonomy of Semantics and Mechanisms for Real-Time Transport Protocol (RTP) Sources&quot;">RFC7656</a>] term &quot;source stream&quot;.  One
      MediaStreamTrack can be present in zero, one, or multiple
      MediaStreams.

   Media description:  Defined in [<a href="/doc/html/rfc4566" title="&quot;SDP: Session Description Protocol&quot;">RFC4566</a>] as a set of fields starting
      with an &quot;m=&quot; field and terminated by either the next &quot;m=&quot; field or
      the end of the session description.

   The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;,
   &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;NOT RECOMMENDED&quot;, &quot;MAY&quot;, and
   &quot;OPTIONAL&quot; in this document are to be interpreted as described in <a href="/doc/html/bcp14">BCP</a>
   <a href="/doc/html/bcp14">14</a> [<a href="/doc/html/rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>] [<a href="/doc/html/rfc8174" title="&quot;Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words&quot;">RFC8174</a>] when, and only when, they appear in all
   capitals, as shown here.

<span class="h3"><a class="selflink" id="section-1.2" href="#section-1.2">1.2</a>.  Structure of This Document</span>

   This document adds a new Session Description Protocol (SDP) [<a href="/doc/html/rfc4566" title="&quot;SDP: Session Description Protocol&quot;">RFC4566</a>]
   mechanism that can attach identifiers to the RTP streams and attach
   identifiers to the groupings they form.  It is designed for use with
   WebRTC [<a href="/doc/html/rfc8825" title="&quot;Overview: Real-Time Protocols for Browser-Based Applications&quot;">RFC8825</a>].

   <a href="#section-1.3">Section 1.3</a> gives the background on why a new mechanism is needed.

   <a href="#section-2">Section 2</a> gives the definition of the new mechanism.

   <a href="#section-3">Section 3</a> gives the necessary semantic information and procedures for
   using the &quot;msid&quot; attribute to signal the association of
   MediaStreamTracks to MediaStreams in support of the WebRTC API
   [<a href="#ref-W3C-WebRTC">W3C-WebRTC</a>].

<span class="h3"><a class="selflink" id="section-1.3" href="#section-1.3">1.3</a>.  Why a New Mechanism Is Needed</span>

   When media is carried by RTP [<a href="/doc/html/rfc3550" title="&quot;RTP: A Transport Protocol for Real-Time Applications&quot;">RFC3550</a>], each RTP stream is
   distinguished inside an RTP session by its Synchronization Source
   (SSRC); each RTP session is distinguished from all other RTP sessions
   by being on a different transport association (strictly speaking, two
   transport associations, one used for RTP and one used for the RTP
   Control Protocol (RTCP), unless RTP/RTCP multiplexing [<a href="/doc/html/rfc5761" title="&quot;Multiplexing RTP Data and Control Packets on a Single Port&quot;">RFC5761</a>] is
   used).

   SDP [<a href="/doc/html/rfc4566" title="&quot;SDP: Session Description Protocol&quot;">RFC4566</a>] gives a format for describing an SDP session that can
   contain multiple media descriptions.  According to the model used in
   [<a href="/doc/html/rfc8829" title="&quot;JavaScript Session Establishment Protocol (JSEP)&quot;">RFC8829</a>], each media description describes exactly one media source.
   If multiple media sources are carried in an RTP session, this is
   signaled using BUNDLE [<a href="/doc/html/rfc8843" title="&quot;Negotiating Media Multiplexing Using the Session Description Protocol (SDP)&quot;">RFC8843</a>]; if BUNDLE is not used, each media
   source is carried in its own RTP session.

   The SDP Grouping Framework [<a href="/doc/html/rfc5888" title="&quot;The Session Description Protocol (SDP) Grouping Framework&quot;">RFC5888</a>] can be used to group media
   descriptions.  However, for the use case of WebRTC, there is the need
   for an application to specify some application-level information
   about the association between the media description and the group.
   This is not possible using the SDP Grouping Framework.

<span class="h3"><a class="selflink" id="section-1.4" href="#section-1.4">1.4</a>.  The WebRTC MediaStream</span>

   The W3C WebRTC API specification [<a href="#ref-W3C-WebRTC">W3C-WebRTC</a>] specifies that
   communication between WebRTC entities is done via MediaStreams, which
   contain MediaStreamTracks.  A MediaStreamTrack is generally carried
   using a single SSRC in an RTP session, forming an RTP stream.  The
   collision of terminology is unfortunate.  There might possibly be
   additional SSRCs, possibly within additional RTP sessions, in order
   to support functionality like forward error correction or simulcast.
   These additional SSRCs are not affected by this specification.

   MediaStreamTracks are unidirectional; they carry media in one
   direction only.

   In the RTP specification, RTP streams are identified using the SSRC
   field.  Streams are grouped into RTP sessions and also carry a CNAME.
   Neither CNAME nor RTP session corresponds to a MediaStream.
   Therefore, the association of an RTP stream to MediaStreams need to
   be explicitly signaled.

   WebRTC defines a mapping (documented in [<a href="/doc/html/rfc8829" title="&quot;JavaScript Session Establishment Protocol (JSEP)&quot;">RFC8829</a>]) where one SDP
   media description is used to describe each MediaStreamTrack, and the
   BUNDLE mechanism [<a href="/doc/html/rfc8843" title="&quot;Negotiating Media Multiplexing Using the Session Description Protocol (SDP)&quot;">RFC8843</a>] is used to group MediaStreamTracks into
   RTP sessions.  Therefore, the need is to specify the identifier (ID)
   of the MediaStreamTrack and its associated MediaStream for each media
   description, which can be accomplished with a media-level SDP
   attribute.

   This usage is described in <a href="#section-3">Section 3</a>.

<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  The MSID Mechanism</span>

   This document defines a new SDP [<a href="/doc/html/rfc4566" title="&quot;SDP: Session Description Protocol&quot;">RFC4566</a>] media-level &quot;msid&quot;
   attribute.  This new attribute allows endpoints to associate RTP
   streams that are described in separate media descriptions with the
   right MediaStreams, as defined in [<a href="#ref-W3C-WebRTC">W3C-WebRTC</a>].  It also allows
   endpoints to carry an identifier for each MediaStreamTrack in its
   &quot;appdata&quot; field.

   The value of the &quot;msid&quot; attribute consists of an identifier and an
   optional &quot;appdata&quot; field.

   The name of the attribute is &quot;msid&quot;.

   The value of the attribute is specified by the following ABNF
   [<a href="/doc/html/rfc5234" title="&quot;Augmented BNF for Syntax Specifications: ABNF&quot;">RFC5234</a>] grammar:

     msid-value = msid-id [ SP msid-appdata ]
     msid-id = 1*64token-char ; see <a href="/doc/html/rfc4566">RFC 4566</a>
     msid-appdata = 1*64token-char  ; see <a href="/doc/html/rfc4566">RFC 4566</a>

   An example &quot;msid&quot; value for a group with the identifier &quot;examplefoo&quot;
   and application data &quot;examplebar&quot; might look like this:

     msid:examplefoo examplebar

   The identifier is a string of ASCII characters that are legal in a
   &quot;token&quot;, consisting of between 1 and 64 characters.

   Application data (msid-appdata) is carried on the same line as the
   identifier, separated from the identifier by a space.

   The identifier (&quot;msid-id&quot;) uniquely identifies a group within the
   scope of an SDP description.

   There may be multiple &quot;msid&quot; attributes in a single media
   description.  This represents the case where a single
   MediaStreamTrack is present in multiple MediaStreams; the value of
   &quot;msid-appdata&quot; MUST be identical for all occurrences.

   Multiple media descriptions with the same value for &quot;msid-id&quot; and
   &quot;msid-appdata&quot; are not permitted.

   Endpoints can update the associations between RTP streams as
   expressed by &quot;msid&quot; attributes at any time.

   The &quot;msid&quot; attributes depend on the association of RTP streams with
   media descriptions but do not depend on the association of RTP
   streams with RTP transports.  Therefore, their Mux Category (as
   defined in [<a href="/doc/html/rfc8859" title="&quot;A Framework for Session Description Protocol (SDP) Attributes When Multiplexing&quot;">RFC8859</a>]) is NORMAL; the process of deciding on &quot;msid&quot;
   attributes doesn&#x27;t have to take into consideration whether or not the
   RTP streams are bundled.

<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>.  Procedures</span>

   This section describes the procedures for associating media
   descriptions representing MediaStreamTracks within MediaStreams, as
   defined in [<a href="#ref-W3C-WebRTC">W3C-WebRTC</a>].

   In the Javascript API described in that specification, each
   MediaStream and MediaStreamTrack has an &quot;id&quot; attribute, which is a
   DOMString.

   The value of the &quot;msid-id&quot; field in the MSID consists of the &quot;id&quot;
   attribute of a MediaStream, as defined in the MediaStream&#x27;s WebIDL
   specification [<a href="#ref-WEBIDL" title="&quot;Web IDL&quot;">WEBIDL</a>].  The special value &quot;-&quot; indicates &quot;no
   MediaStream&quot;.

   The value of the &quot;msid-appdata&quot; field in the MSID, if present,
   consists of the &quot;id&quot; attribute of a MediaStreamTrack, as defined in
   the MediaStreamTrack&#x27;s WebIDL specification.

   When an SDP session description is updated, a specific &quot;msid-id&quot;
   value continues to refer to the same MediaStream, and a specific
   &quot;msid-appdata&quot; to the same MediaStreamTrack.  There is no memory
   apart from the currently valid SDP descriptions; if an MSID
   &quot;identifier&quot; value disappears from the SDP and appears in a later
   negotiation, it will be taken to refer to a new MediaStream.

   If the &quot;msid&quot; attribute does not conform to the ABNF given here, it
   SHOULD be ignored.

   The following is a high-level description of the rules for handling
   SDP updates.  Detailed procedures are located in <a href="#section-3.2">Section 3.2</a>.

   *  When a new MSID &quot;identifier&quot; value occurs in a session
      description, and it is not &quot;-&quot;, the recipient can signal to its
      application that a new MediaStream has been added.

   *  When a session description is updated to have media descriptions
      with an MSID &quot;identifier&quot; value, with one or more different
      &quot;appdata&quot; values, the recipient can signal to its application that
      new MediaStreamTracks have been added and note to which
      MediaStream they have been added.  This is done for each different
      MSID &quot;identifier&quot; value, including the special value &quot;-&quot;, which
      indicates that a MediaStreamTrack has been added with no
      corresponding MediaStream.

   *  If an MSID &quot;identifier&quot; value with no &quot;appdata&quot; value appears, it
      means that the sender did not inform the recipient of the desired
      identifier of the MediaStreamTrack, and the recipient will assign
      the &quot;id&quot; value of the created MediaStreamTrack on its own.  All
      MSIDs in a media section that do not have an &quot;appdata&quot; value are
      assumed to refer to the same MediaStreamTrack.

   *  When a session description is updated to no longer list any &quot;msid&quot;
      attribute on a specific media description, the recipient can
      signal to its application that the corresponding MediaStreamTrack
      has ended.

   In addition to signaling that the track is ended when its &quot;msid&quot;
   attribute disappears from the SDP, the track will also be signaled as
   being ended when all associated SSRCs have disappeared by the rules
   of [<a href="/doc/html/rfc3550" title="&quot;RTP: A Transport Protocol for Real-Time Applications&quot;">RFC3550</a>], Sections <a href="#section-6.3.4">6.3.4</a> (BYE packet received) and 6.3.5
   (timeout), or when the corresponding media description is disabled by
   setting the port number to zero.  Changing the direction of the media
   description (by setting &quot;sendonly&quot;, &quot;recvonly&quot;, or &quot;inactive&quot;
   attributes) will not end the MediaStreamTrack.

   The association between SSRCs and media descriptions is specified in
   [<a href="/doc/html/rfc8829" title="&quot;JavaScript Session Establishment Protocol (JSEP)&quot;">RFC8829</a>].

<span class="h3"><a class="selflink" id="section-3.1" href="#section-3.1">3.1</a>.  Handling of Nonsignaled Tracks</span>

   Entities that do not use the mechanism described in this document
   will not send the &quot;msid&quot; attribute and thus will not send information
   allowing the mapping of RTP packets to MediaStreams.  This means that
   there will be some incoming RTP packets for which the recipient has
   no predefined MediaStream ID value.

   Note that the handling described below is triggered by incoming RTP
   packets, not SDP negotiation.

   When communicating with entities that use the MSID mechanism, the
   only time incoming RTP packets can be received without an associated
   MediaStream ID value is when, after the initial negotiation, a
   negotiation is performed where the answerer adds a MediaStreamTrack
   to an already established connection and starts sending data before
   the answer is received by the offerer.  For initial negotiation,
   packets won&#x27;t flow until the Interactive Connectivity Establishment
   (ICE) candidates and fingerprints have been exchanged, so this is not
   an issue.

   The recipient of those packets will perform the following steps:

   *  When RTP packets are initially received, it will create an
      appropriate MediaStreamTrack based on the type of the media
      (carried in PayloadType) and use the MID RTP header extension
      [<a href="/doc/html/rfc8843" title="&quot;Negotiating Media Multiplexing Using the Session Description Protocol (SDP)&quot;">RFC8843</a>] (if present) to associate the RTP packets with a
      specific media section.

   *  If the connection is not in the RTCSignalingState &quot;stable&quot;, it
      will wait at this point.

   *  When the connection is in the RTCSignalingState &quot;stable&quot;, it will
      assign ID values.

   The following steps are performed to assign ID values:

   *  If there is an &quot;msid&quot; attribute, it will use that attribute to
      populate the &quot;id&quot; field of the MediaStreamTrack and associated
      MediaStreams, as described above.

   *  If there is no &quot;msid&quot; attribute, the identifier of the
      MediaStreamTrack will be set to a randomly generated string, and
      it will be signaled as being part of a MediaStream with the WebIDL
      &quot;label&quot; attribute set to &quot;Non-WebRTC stream&quot;.

   *  After deciding on the &quot;id&quot; field to be applied to the
      MediaStreamTrack, the track will be signaled to the user.

   The process above may involve a considerable amount of buffering
   before the &quot;stable&quot; state is entered.  If the implementation wishes
   to limit this buffering, it MUST signal to the user that media has
   been discarded.

   It follows from the above that MediaStreamTracks in the &quot;default&quot;
   MediaStream cannot be closed by removing the &quot;msid&quot; attribute; the
   application must instead signal these as closed when the SSRC
   disappears, either according to the rules of Sections <a href="#section-6.3.4">6.3.4</a> and <a href="#section-6.3.5">6.3.5</a>
   of [<a href="/doc/html/rfc3550" title="&quot;RTP: A Transport Protocol for Real-Time Applications&quot;">RFC3550</a>] or by disabling the media description by setting its
   port to zero.

<span class="h3"><a class="selflink" id="section-3.2" href="#section-3.2">3.2</a>.  Detailed Offer/Answer Procedures</span>

   These procedures are given in terms of sections recommended by
   [<a href="/doc/html/rfc3264" title="&quot;An Offer/Answer Model with Session Description Protocol (SDP)&quot;">RFC3264</a>].  They describe the actions to be taken in terms of
   MediaStreams and MediaStreamTracks; they do not include event
   signaling inside the application, which is described in the
   JavaScript Session Establishment Protocol (JSEP) [<a href="/doc/html/rfc8829" title="&quot;JavaScript Session Establishment Protocol (JSEP)&quot;">RFC8829</a>].

<span class="h4"><a class="selflink" id="section-3.2.1" href="#section-3.2.1">3.2.1</a>.  Generating the Initial Offer</span>

   For each media description in the offer, if there is an associated
   outgoing MediaStreamTrack, the offerer adds one &quot;a=msid&quot; attribute to
   the section for each MediaStream with which the MediaStreamTrack is
   associated.  The &quot;identifier&quot; field of the attribute is set to the
   WebIDL &quot;id&quot; attribute of the MediaStream.  If the sender wishes to
   signal identifiers for the MediaStreamTracks, the &quot;appdata&quot; field is
   set to the WebIDL &quot;id&quot; attribute of the MediaStreamTrack; otherwise,
   it is omitted.

<span class="h4"><a class="selflink" id="section-3.2.2" href="#section-3.2.2">3.2.2</a>.  Answerer Processing of the Offer</span>

   For each media description in the offer and each &quot;a=msid&quot; attribute
   in the media description, the receiver of the offer will perform the
   following steps:

   *  Extract the &quot;appdata&quot; field of the &quot;a=msid&quot; attribute, if present.

   *  If the &quot;appdata&quot; field exists: Check if a MediaStreamTrack with
      the same WebIDL &quot;id&quot; attribute as the &quot;appdata&quot; field already
      exists and is not in the &quot;ended&quot; state.  If such a
      MediaStreamTrack is not found, create it.

   *  If the &quot;appdata&quot; field does not exist, and a MediaStreamTrack is
      not associated with this media section, create a MediaStreamTrack
      and associate it with this media section for future use.

   *  Extract the &quot;identifier&quot; field of the &quot;a=msid&quot; attribute.

   *  Check if a MediaStream with the same WebIDL &quot;id&quot; attribute already
      exists.  If not, create it.

   *  Add the MediaStreamTrack to the MediaStream.

   *  Signal to the user that a new MediaStreamTrack is available.

<span class="h4"><a class="selflink" id="section-3.2.3" href="#section-3.2.3">3.2.3</a>.  Generating the Answer</span>

   The answer is generated in exactly the same manner as the offer.
   &quot;a=msid&quot; values in the offer do not influence the answer.

<span class="h4"><a class="selflink" id="section-3.2.4" href="#section-3.2.4">3.2.4</a>.  Offerer Processing of the Answer</span>

   The answer is processed in exactly the same manner as the offer.

<span class="h4"><a class="selflink" id="section-3.2.5" href="#section-3.2.5">3.2.5</a>.  Modifying the Session</span>

   On subsequent exchanges, precisely the same procedure as for the
   initial offer/answer is followed, but with one additional step in the
   parsing of the offer and answer:

   *  For each MediaStreamTrack that has been created as a result of
      previous offer/answer exchanges, and is not in the &quot;ended&quot; state,
      check to see if there is still an &quot;a=msid&quot; attribute in the
      present SDP whose &quot;appdata&quot; field is the same as the WebIDL &quot;id&quot;
      attribute of the track.

   *  If no such attribute is found, stop the MediaStreamTrack.  This
      will set its state to &quot;ended&quot;.

<span class="h3"><a class="selflink" id="section-3.3" href="#section-3.3">3.3</a>.  Example SDP Description</span>

   The following SDP description shows the representation of a WebRTC
   PeerConnection with two MediaStreams, each of which has one audio and
   one video track.  Only the parts relevant to the MSID are shown.

   Line wrapping, empty lines, and comments are added for clarity.  They
   are not part of the SDP.

   # First MediaStream - id is 4701...
   m=audio 56500 UDP/TLS/RTP/SAVPF 96 0 8 97 98
   a=msid:47017fee-b6c1-4162-929c-a25110252400
          f83006c5-a0ff-4e0a-9ed9-d3e6747be7d9

   m=video 56502 UDP/TLS/RTP/SAVPF 100 101
   a=msid:47017fee-b6c1-4162-929c-a25110252400
          b47bdb4a-5db8-49b5-bcdc-e0c9a23172e0

   # Second MediaStream - id is 6131....
   m=audio 56503 UDP/TLS/RTP/SAVPF 96 0 8 97 98
   a=msid:61317484-2ed4-49d7-9eb7-1414322a7aae
          b94006c5-cade-4e0a-9ed9-d3e6747be7d9

   m=video 56504 UDP/TLS/RTP/SAVPF 100 101
   a=msid:61317484-2ed4-49d7-9eb7-1414322a7aae
          f30bdb4a-1497-49b5-3198-e0c9a23172e0

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>.  IANA Considerations</span>

<span class="h3"><a class="selflink" id="section-4.1" href="#section-4.1">4.1</a>.  Attribute Registration in Existing Registries</span>

   IANA has registered the &quot;msid&quot; attribute in the &quot;att-field&quot; (media
   level only) registry within the &quot;Session Description Protocol (SDP)
   Parameters&quot; registry, according to the procedures of [<a href="/doc/html/rfc4566" title="&quot;SDP: Session Description Protocol&quot;">RFC4566</a>].

   The &quot;msid&quot; registration information is as follows:

   Contact name, email:  IETF, contacted via mmusic@ietf.org, or a
      successor address designated by IESG

   Attribute name:  msid

   Attribute syntax:

                msid-value = msid-id [ SP msid-appdata ]
                msid-id = 1*64token-char ; see <a href="/doc/html/rfc4566">RFC 4566</a>
                msid-appdata = 1*64token-char  ; see <a href="/doc/html/rfc4566">RFC 4566</a>

   Attribute semantics:  Described in <a href="/doc/html/rfc8830">RFC 8830</a>

   Attribute value:  msid-value

   Long-form attribute name:  MediaStream Identifier

   Usage level:  media

   Subject to charset:  The attribute value contains only ASCII
      characters and is therefore not subject to the charset attribute.

   Purpose:  The attribute can be used to signal the relationship
      between a WebRTC MediaStream and a set of media descriptions.

   O/A Procedures:  Described in <a href="/doc/html/rfc8830">RFC 8830</a>

   Appropriate values:  The details of appropriate values are given in
      <a href="/doc/html/rfc8830">RFC 8830</a> (this document).

   Mux Category:  NORMAL

   The Mux Category is defined in [<a href="/doc/html/rfc8859" title="&quot;A Framework for Session Description Protocol (SDP) Attributes When Multiplexing&quot;">RFC8859</a>].

<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>.  Security Considerations</span>

   An adversary with the ability to modify SDP descriptions has the
   ability to switch around tracks between MediaStreams.  This is a
   special case of the general security consideration that modification
   of SDP descriptions needs to be confined to entities trusted by the
   application.

   If implementing buffering as mentioned in <a href="#section-3.1">Section 3.1</a>, the amount of
   buffering should be limited to avoid memory exhaustion attacks.

   Careless generation of identifiers can leak privacy-sensitive
   information.  [<a href="#ref-W3C.CR-mediacapture-streams">W3C.CR-mediacapture-streams</a>] recommends that
   identifiers be generated using a Universally Unique IDentifier (UUID)
   class 3 or 4 as a basis, which avoids such leakage.

   No other attacks have been identified that depend on this mechanism.

<span class="h2"><a class="selflink" id="section-6" href="#section-6">6</a>.  References</span>

<span class="h3"><a class="selflink" id="section-6.1" href="#section-6.1">6.1</a>.  Normative References</span>

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., &quot;Key words for use in RFCs to Indicate
              Requirement Levels&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc2119">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC3550">RFC3550</a>]  Schulzrinne, H., Casner, S., Frederick, R., and V.
              Jacobson, &quot;RTP: A Transport Protocol for Real-Time
              Applications&quot;, STD 64, <a href="/doc/html/rfc3550">RFC 3550</a>, DOI 10.17487/RFC3550,
              July 2003, &lt;<a href="https://www.rfc-editor.org/info/rfc3550">https://www.rfc-editor.org/info/rfc3550</a>&gt;.

   [<a id="ref-RFC4566">RFC4566</a>]  Handley, M., Jacobson, V., and C. Perkins, &quot;SDP: Session
              Description Protocol&quot;, <a href="/doc/html/rfc4566">RFC 4566</a>, DOI 10.17487/RFC4566,
              July 2006, &lt;<a href="https://www.rfc-editor.org/info/rfc4566">https://www.rfc-editor.org/info/rfc4566</a>&gt;.

   [<a id="ref-RFC5234">RFC5234</a>]  Crocker, D., Ed. and P. Overell, &quot;Augmented BNF for Syntax
              Specifications: ABNF&quot;, STD 68, <a href="/doc/html/rfc5234">RFC 5234</a>,
              DOI 10.17487/RFC5234, January 2008,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5234">https://www.rfc-editor.org/info/rfc5234</a>&gt;.

   [<a id="ref-RFC8174">RFC8174</a>]  Leiba, B., &quot;Ambiguity of Uppercase vs Lowercase in <a href="/doc/html/rfc2119">RFC</a>
              <a href="/doc/html/rfc2119">2119</a> Key Words&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc8174">RFC 8174</a>, DOI 10.17487/RFC8174,
              May 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.

   [<a id="ref-RFC8829">RFC8829</a>]  Uberti, J., Jennings, C., and E. Rescorla, Ed.,
              &quot;JavaScript Session Establishment Protocol (JSEP)&quot;,
              <a href="/doc/html/rfc8829">RFC 8829</a>, DOI 10.17487/RFC8829, January 2021,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8829">https://www.rfc-editor.org/info/rfc8829</a>&gt;.

   [<a id="ref-RFC8859">RFC8859</a>]  Nandakumar, S., &quot;A Framework for Session Description
              Protocol (SDP) Attributes When Multiplexing&quot;, <a href="/doc/html/rfc8859">RFC 8859</a>,
              DOI 10.17487/RFC8859, January 2021,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8859">https://www.rfc-editor.org/info/rfc8859</a>&gt;.

   [<a id="ref-W3C-WebRTC">W3C-WebRTC</a>]
              Jennings, C., Boström, H., and J-I. Bruaroey, &quot;WebRTC 1.0:
              Real-time Communication Between Browsers&quot;, W3C Proposed
              Recommendation, &lt;<a href="https://www.w3.org/TR/webrtc/">https://www.w3.org/TR/webrtc/</a>&gt;.

   [<a id="ref-W3C.CR-mediacapture-streams">W3C.CR-mediacapture-streams</a>]
              Jennings, C., Aboba, B., Bruaroey, J.-I., and H. Boström,
              &quot;Media Capture and Streams&quot;, W3C Candidate Recommendation,
              &lt;<a href="https://www.w3.org/TR/mediacapture-streams/">https://www.w3.org/TR/mediacapture-streams/</a>&gt;.

<span class="h3"><a class="selflink" id="section-6.2" href="#section-6.2">6.2</a>.  Informative References</span>

   [<a id="ref-RFC3264">RFC3264</a>]  Rosenberg, J. and H. Schulzrinne, &quot;An Offer/Answer Model
              with Session Description Protocol (SDP)&quot;, <a href="/doc/html/rfc3264">RFC 3264</a>,
              DOI 10.17487/RFC3264, June 2002,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3264">https://www.rfc-editor.org/info/rfc3264</a>&gt;.

   [<a id="ref-RFC5761">RFC5761</a>]  Perkins, C. and M. Westerlund, &quot;Multiplexing RTP Data and
              Control Packets on a Single Port&quot;, <a href="/doc/html/rfc5761">RFC 5761</a>,
              DOI 10.17487/RFC5761, April 2010,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5761">https://www.rfc-editor.org/info/rfc5761</a>&gt;.

   [<a id="ref-RFC5888">RFC5888</a>]  Camarillo, G. and H. Schulzrinne, &quot;The Session Description
              Protocol (SDP) Grouping Framework&quot;, <a href="/doc/html/rfc5888">RFC 5888</a>,
              DOI 10.17487/RFC5888, June 2010,
              &lt;<a href="https://www.rfc-editor.org/info/rfc5888">https://www.rfc-editor.org/info/rfc5888</a>&gt;.

   [<a id="ref-RFC7656">RFC7656</a>]  Lennox, J., Gross, K., Nandakumar, S., Salgueiro, G., and
              B. Burman, Ed., &quot;A Taxonomy of Semantics and Mechanisms
              for Real-Time Transport Protocol (RTP) Sources&quot;, <a href="/doc/html/rfc7656">RFC 7656</a>,
              DOI 10.17487/RFC7656, November 2015,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7656">https://www.rfc-editor.org/info/rfc7656</a>&gt;.

   [<a id="ref-RFC8825">RFC8825</a>]  Alvestrand, H., &quot;Overview: Real-Time Protocols for
              Browser-Based Applications&quot;, <a href="/doc/html/rfc8825">RFC 8825</a>,
              DOI 10.17487/RFC8825, January 2021,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8825">https://www.rfc-editor.org/info/rfc8825</a>&gt;.

   [<a id="ref-RFC8843">RFC8843</a>]  Holmberg, C., Alvestrand, H., and C. Jennings,
              &quot;Negotiating Media Multiplexing Using the Session
              Description Protocol (SDP)&quot;, <a href="/doc/html/rfc8843">RFC 8843</a>,
              DOI 10.17487/RFC8843, January 2021,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8843">https://www.rfc-editor.org/info/rfc8843</a>&gt;.

   [<a id="ref-WEBIDL">WEBIDL</a>]   Chen, E. and T. Gu, &quot;Web IDL&quot;, W3C Editor&#x27;s Draft, August
              2020, &lt;<a href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>&gt;.

<span class="h2"><a class="selflink" id="appendix-A" href="#appendix-A">Appendix A</a>.  Design Considerations, Rejected Alternatives</span>

   One suggested mechanism has been to use CNAME instead of a new
   attribute.  This was abandoned because CNAME identifies a
   synchronization context; one can imagine both wanting to have tracks
   from the same synchronization context in multiple MediaStreams and
   wanting to have tracks from multiple synchronization contexts within
   one MediaStream (but the latter is impossible, since a MediaStream is
   defined to impose synchronization on its members).

   Another suggestion has been to put the &quot;msid&quot; value within an
   attribute of RTCP SR (sender report) packets.  This doesn&#x27;t offer the
   ability to know that you have seen all the tracks currently
   configured for a MediaStream.

   A suggestion that survived for a number of drafts of this document
   was to define MSID as a generic mechanism, where the particular
   semantics of this usage of the mechanism would be defined by an
   &quot;a=wms-semantic&quot; attribute.  This was removed in April 2015.

Acknowledgements

   This note is based on sketches from, among others, Justin Uberti and
   Cullen Jennings.

   Special thanks to Flemming Andreasen, Ben Campbell, Miguel Garcia,
   Martin Thomson, Ted Hardie, Adam Roach, Magnus Westerlund, Alissa
   Cooper, Sue Hares, and Paul Kyzivat for their work in reviewing this
   document, with many specific language suggestions.

Author&#x27;s Address

   Harald Alvestrand
   Google
   Kungsbron 2
   SE-11122 Stockholm
   Sweden

   Email: harald@alvestrand.no
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

