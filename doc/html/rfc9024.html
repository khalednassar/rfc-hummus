<!DOCTYPE html> 

<!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/htmlized_base.html -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
  
    rfc9024
  
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

  @media only screen 
    and (min-width: 992px)
    and (max-width: 1199px) {
      body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 768px)
    and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-width: 480px)
    and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
  @media only screen 
    and (min-device-width : 375px) 
    and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
  @media only screen 
    and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
      font-weight: bold;
            /* line-height: 0pt; */
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
      font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
  .pre {
      white-space: pre;
      font-family: monospace;
  }
  .header{
      font-weight: bold;
  }
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        @media print {
            body {
                margin-top: 5em;
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
  @media screen {
      .grey, .grey a:link, .grey a:visited {
    color: #777;
      }
            .meta-info {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .pad {
                padding-top: 7px;
                line-height: 24px;
                padding-bottom: 4px;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
  }
    
     

.bgwhite  { background-color: white; }
.bgred    { background-color: #F44; }
.bggrey   { background-color: #666; }
.bgbrown  { background-color: #840; }            
.bgorange { background-color: #FA0; }
.bgyellow { background-color: #EE0; }
.bgmagenta{ background-color: #F4F; }
.bgblue   { background-color: #66F; }
.bgcyan   { background-color: #4DD; }
.bggreen  { background-color: #4F4; }

.draftcontent { margin-top:0px !important;}


    </style>

    <!--[if lt IE 9]>
        <script src="https://www.ietf.org/lib/dt/7.34.0/html5shiv/html5shiv.min.js"></script>
        <script src="https://www.ietf.org/lib/dt/7.34.0/respond/dest/respond.min.js"></script>
    <![endif]-->
    
  <link rel="alternate" type="application/atom+xml" title="Document changes" href="/feed/document-changes/draft-ietf-detnet-tsn-vpn-over-mpls/">
  <meta name="description" content="Deterministic Networking (DetNet) Data Plane: IEEE 802.1 Time-Sensitive Networking over MPLS (RFC )">
  <script src="https://www.ietf.org/lib/dt/7.34.0/d3/d3.min.js"></script>
  <script src="https://www.ietf.org/lib/dt/7.34.0/jquery/jquery.min.js"></script>


    
    <link rel="shortcut icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/ietf-icon-blue3.png">
    
    <link rel="apple-touch-icon" href="https://www.ietf.org/lib/dt/7.34.0/ietf/images/apple-touch-icon.png">
  </head>

  <body style="padding-top: 0;">

	  <div class="content" id="content">
        
  <!-- template: /a/www/ietf-datatracker/web/ietf/templates/doc/document_html.html -->
 
  <div class="rfcmarkup">
    <div class="noprint" style="height: 6px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showLegend();"
         onmouseout="hideLegend()"
         style="height: 6px; min-height: 6px; width: 96ex; position: absolute; margin-top:0; "
         class="meta-info bgblue"
         title="Click for colour legend." >&nbsp;</div>
      <div id="legend"
           class="meta-info noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showLegend();"
           onmouseout="hideLegend();">
      </div>
    </div>

    
      <div class="noprint">
	 <pre class="pre meta-info">[<a href="https://datatracker.ietf.org" title="Document search and retrieval page">Search</a>] [<a href="https://www.rfc-editor.org/rfc/rfc9024.txt" title="Plaintext version of this document">txt</a>|<a href="https://www.rfc-editor.org/rfc/rfc9024.html" title="HTML version of this document, from XML2RFC">html</a>|<a href="https://www.rfc-editor.org/rfc/rfc9024.xml" title="XML source for this document">xml</a>|<a href="https://www.rfc-editor.org/rfc/rfc9024.pdf" title="PDF version of this document">pdf</a>|<a href="/doc/rfc9024/bibtex" title="BibTex entry for this document">bibtex</a>] [<a href="/doc/rfc9024/" title="Datatracker information for this document">Tracker</a>] [<a href="/group/detnet/" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-detnet-tsn-vpn-over-mpls@ietf.org?subject=draft-ietf-detnet-tsn-vpn-over-mpls" title="Send email to the document authors">Email</a>] [<a href="https://www.ietf.org/rfcdiff?difftype=--hwdiff&url2=draft-ietf-detnet-tsn-vpn-over-mpls-07.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://www.ietf.org/rfcdiff?url2=draft-ietf-detnet-tsn-vpn-over-mpls-07.txt" title="Side-by-side diff">Diff2</a>] [<a href="https://www.ietf.org/tools/idnits?url=https://www.ietf.org/archive/id/draft-ietf-detnet-tsn-vpn-over-mpls-07.txt" title="Run an idnits check of this document">Nits</a>]

From: <a href="/doc/html/draft-ietf-detnet-tsn-vpn-over-mpls-07">draft-ietf-detnet-tsn-vpn-over-mpls-07</a>           Proposed Standard</pre>
      </div>
    

    <div class="draftcontent">
    <pre>Internet Engineering Task Force (IETF)                     B. Varga, Ed.
Request for Comments: 9024                                     J. Farkas
Category: Standards Track                                       Ericsson
ISSN: 2070-1721                                                 A. Malis
                                                        Malis Consulting
                                                               S. Bryant
                                                  Futurewei Technologies
                                                                D. Fedyk
                                                 LabN Consulting, L.L.C.
                                                               June 2021


Deterministic Networking (DetNet) Data Plane: IEEE 802.1 Time-Sensitive
                          Networking over MPLS

Abstract

   This document specifies the Deterministic Networking data plane when
   Time-Sensitive Networking (TSN) networks are interconnected over a
   DetNet MPLS network.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="/doc/html/rfc7841#section-2">Section&nbsp;2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="https://www.rfc-editor.org/info/rfc9024">https://www.rfc-editor.org/info/rfc9024</a>.

Copyright Notice

   Copyright (c) 2021 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="/doc/html/bcp78">BCP 78</a> and the IETF Trust&#x27;s Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction
   2.  Terminology
     2.1.  Terms Used in This Document
     2.2.  Abbreviations
     2.3.  Requirements Language
   3.  IEEE 802.1 TSN over DetNet MPLS Data Plane Scenario
   4.  DetNet MPLS Data Plane
     4.1.  Overview
     4.2.  TSN over DetNet MPLS Encapsulation
   5.  TSN over MPLS Data Plane Procedures
     5.1.  Edge Node TSN Procedures
     5.2.  Edge Node DetNet Service Proxy Procedures
     5.3.  Edge Node DetNet Service and Forwarding Sub-Layer
           Procedures
   6.  Controller Plane (Management and Control) Considerations
   7.  Security Considerations
   8.  IANA Considerations
   9.  References
     9.1.  Normative References
     9.2.  Informative References
   Acknowledgements
   Authors&#x27; Addresses

<span class="h2"><a class="selflink" id="section-1" href="#section-1">1</a>.  Introduction</span>

   The Time-Sensitive Networking Task Group (TSN TG) within the IEEE
   802.1 Working Group deals with deterministic services through IEEE
   802 networks.  Deterministic Networking (DetNet) defined by the IETF
   is a service that can be offered by an L3 network to DetNet flows.
   General background and concepts of DetNet can be found in [<a href="/doc/html/rfc8655" title="&quot;Deterministic Networking Architecture&quot;">RFC8655</a>].

   This document specifies the use of a DetNet MPLS network to
   interconnect TSN nodes/network segments.  The DetNet MPLS data plane
   is defined in [<a href="/doc/html/rfc8964" title="&quot;Deterministic Networking (DetNet) Data Plane: MPLS&quot;">RFC8964</a>].

<span class="h2"><a class="selflink" id="section-2" href="#section-2">2</a>.  Terminology</span>

<span class="h3"><a class="selflink" id="section-2.1" href="#section-2.1">2.1</a>.  Terms Used in This Document</span>

   This document uses the terminology and concepts established in the
   DetNet architecture [<a href="/doc/html/rfc8655" title="&quot;Deterministic Networking Architecture&quot;">RFC8655</a>] [<a href="/doc/html/rfc8938" title="&quot;Deterministic Networking (DetNet) Data Plane Framework&quot;">RFC8938</a>] [<a href="/doc/html/rfc8964" title="&quot;Deterministic Networking (DetNet) Data Plane: MPLS&quot;">RFC8964</a>].  TSN-specific
   terms are defined in the TSN TG of the IEEE 802.1 Working Group.  The
   reader is assumed to be familiar with these documents and their
   terminology.

<span class="h3"><a class="selflink" id="section-2.2" href="#section-2.2">2.2</a>.  Abbreviations</span>

   The following abbreviations are used in this document:

   AC            Attachment Circuit

   CE            Customer Edge equipment

   d-CW          DetNet Control Word

   DetNet        Deterministic Networking

   DF            DetNet Flow

   FRER          Frame Replication and Elimination for Redundancy (TSN
                 function)

   L2            Layer 2

   L2VPN         Layer 2 Virtual Private Network

   L3            Layer 3

   LSP           Label Switched Path

   LSR           Label Switching Router

   MPLS          Multiprotocol Label Switching

   MPLS-TE       Multiprotocol Label Switching - Traffic Engineering

   NSP           Native Service Processing

   OAM           Operations, Administration, and Maintenance

   PE            Provider Edge

   PREOF         Packet Replication, Elimination and Ordering Functions

   PW            Pseudowire

   S-PE          Switching Provider Edge

   T-PE          Terminating Provider Edge

   TSN           Time-Sensitive Network

<span class="h3"><a class="selflink" id="section-2.3" href="#section-2.3">2.3</a>.  Requirements Language</span>

   The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;,
   &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;NOT RECOMMENDED&quot;, &quot;MAY&quot;, and
   &quot;OPTIONAL&quot; in this document are to be interpreted as described in
   <a href="/doc/html/bcp14">BCP 14</a> [<a href="/doc/html/rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>] [<a href="/doc/html/rfc8174" title="&quot;Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words&quot;">RFC8174</a>] when, and only when, they appear in all
   capitals, as shown here.

<span class="h2"><a class="selflink" id="section-3" href="#section-3">3</a>.  IEEE 802.1 TSN over DetNet MPLS Data Plane Scenario</span>

   Figure 1 shows IEEE 802.1 TSN end stations operating over a TSN-aware
   DetNet service running over an MPLS network.  DetNet edge nodes sit
   at the boundary of a DetNet domain.  They are responsible for mapping
   non-DetNet-aware L2 traffic to DetNet services.  They also support
   the imposition and disposition of the required DetNet encapsulation.
   These are functionally similar to PW T-PE nodes, which use MPLS-TE
   LSPs.  In this example, TSN Streams are simple applications over
   DetNet flows.  The specifics of this operation are discussed later in
   this document.

      TSN           Edge          Transit         Edge          TSN
   End System       Node           Node           Node       End System
                   (T-PE)         (LSR)          (T-PE)

   +----------+                                             +----------+
   |   TSN    | &lt;-------- End-to-End TSN Service ---------&gt; |   TSN    |
   |  Applic. |                                             |  Applic. |
   +----------+  +.........+                   +.........+  +----------+
   |          |  | \S-Proxy:                   :S-Proxy/ |  |          |
   |   TSN    |  |   +.+---+&lt;-- DetNet flow --&gt;+---+ |   |  |   TSN    |
   |          |  |TSN| |Svc|                   |Svc| |TSN|  |          |
   +----------+  +---+ +---+    +----------+   +---+ +---+  +----------+
   |   L2     |  | L2| |Fwd|    |Forwarding|   |Fwd| |L2 |  |   L2     |
   +------.---+  +-.-+ +-.-+    +---.----.-+   +--.+ +-.-+  +---.------+
          :  Link  :     /  ,-----.  \   :  Link  :   /  ,-----. \
          +........+     +-[  Sub- ]-+   +........+   +-[  TSN  ]-+
                           [Network]                    [Network]
                            `-----&#x27;                      `-----&#x27;

                       |&lt;------ DetNet MPLS ------&gt;|
           |&lt;---------------------- TSN   ---------------------&gt;|

              Figure 1: A TSN over DetNet MPLS-Enabled Network

   In this example, edge nodes provide a service proxy function that
   &quot;associates&quot; the DetNet flows and native flows (i.e., TSN Streams) at
   the edge of the DetNet domain.  TSN Streams are treated as App-flows
   for DetNet.  The whole DetNet domain behaves as a TSN relay node for
   the TSN Streams.  The service proxy behaves as a port of that TSN
   relay node.

   Figure 2 illustrates how DetNet can provide services for IEEE 802.1
   TSN end systems, CE1 and CE2, over a DetNet-enabled MPLS network.
   Edge nodes E1 and E2 insert and remove the required DetNet data plane
   encapsulation.  The &#x27;X&#x27; in the edge nodes and relay node, R1,
   represent a potential DetNet compound flow packet replication and
   elimination point.  This conceptually parallels L2VPN services and
   could leverage existing related solutions as discussed below.

        TSN    |&lt;------- End-to-End DetNet Service ------&gt;|  TSN
       Service |         Transit          Transit         | Service
   TSN  (AC)   |        |&lt;-Tnl-&gt;|        |&lt;-Tnl-&gt;|        |  (AC)  TSN
   End    |    V        V    1  V        V   2   V        V   |    End
   System |    +--------+       +--------+       +--------+   |  System
   +---+  |    |   E1   |=======|   R1   |=======|   E2   |   |   +---+
   |   |--|----|._X_....|..DF1..|.._ _...|..DF3..|...._X_.|---|---|   |
   |CE1|  |    |    \   |       |   X    |       |   /    |   |   |CE2|
   |   |       |     \_.|..DF2..|._/ \_..|..DF4..|._/     |       |   |
   +---+       |        |=======|        |=======|        |       +---+
       ^       +--------+       +--------+       +--------+       ^
       |        Edge Node       Relay Node        Edge Node       |
       |          (T-PE)           (S-PE)          (T-PE)         |
       |                                                          |
       |&lt;- TSN -&gt; &lt;------- TSN over DetNet MPLS -------&gt; &lt;- TSN -&gt;|
       |                                                          |
       |&lt;-------- Time-Sensitive Networking (TSN) Service -------&gt;|

       X   = Service protection
       DFx = DetNet member flow x over a TE LSP
           AC  = Attachment Circuit
           Tnl = Tunnel

                    Figure 2: IEEE 802.1TSN over DetNet

<span class="h2"><a class="selflink" id="section-4" href="#section-4">4</a>.  DetNet MPLS Data Plane</span>

<span class="h3"><a class="selflink" id="section-4.1" href="#section-4.1">4.1</a>.  Overview</span>

   The basic approach defined in [<a href="/doc/html/rfc8964" title="&quot;Deterministic Networking (DetNet) Data Plane: MPLS&quot;">RFC8964</a>] supports the DetNet service
   sub-layer based on existing PW encapsulations and mechanisms and
   supports the DetNet forwarding sub-layer based on existing MPLS
   Traffic Engineering encapsulations and mechanisms.

   A node operating on a DetNet flow in the DetNet service sub-layer,
   i.e., a node processing a DetNet packet that has the S-Label as top
   of stack, uses the local context associated with that S-Label.  For
   example, a received F-Label can be used to determine what local
   DetNet operation(s) is applied to that packet.  An S-Label may be
   unique when taken from the platform label space [<a href="/doc/html/rfc3031" title="&quot;Multiprotocol Label Switching Architecture&quot;">RFC3031</a>], which
   would enable correct DetNet flow identification regardless of which
   input interface or LSP the packet arrives on.  The service sub-layer
   functions (i.e., PREOF) use a DetNet control word (d-CW).

   The DetNet MPLS data plane builds on MPLS Traffic Engineering
   encapsulations and mechanisms to provide a forwarding sub-layer that
   is responsible for providing resource allocation and explicit routes.
   The forwarding sub-layer is supported by one or more forwarding
   labels (F-Labels).

   DetNet edge/relay nodes are DetNet service sub-layer aware,
   understand the particular needs of DetNet flows, and provide both
   DetNet service and forwarding sub-layer functions.  They add, remove,
   and process d-CWs, S-Labels, and F-Labels as needed.  MPLS DetNet
   nodes and transit nodes include DetNet forwarding sub-layer functions
   -- notably, support for explicit routes and resource allocation to
   eliminate (or reduce) congestion loss and jitter.  Unlike other
   DetNet node types, transit nodes provide no service sub-layer
   processing.

<span class="h3"><a class="selflink" id="section-4.2" href="#section-4.2">4.2</a>.  TSN over DetNet MPLS Encapsulation</span>

   The basic encapsulation approach is to treat a TSN Stream as an App-
   flow from the DetNet MPLS perspective.  The corresponding example is
   shown in Figure 3.  Note that three example flows are shown in the
   figure.

                /-&gt;     +------+  +------+  +------+   TSN      ^ ^
       MPLS     |       |  X   |  |  X   |  |  X   |&lt;- Appli    : :
     App-Flow &lt;-+       +------+  +------+  +------+   cation   : :(1)
                |       |TSN-L2|  |TSN-L2|  |TSN-L2|            : v
                \-&gt; +---+======+--+======+--+======+-----+      :
                        | d-CW |  | d-CW |  | d-CW |            :
     DetNet-MPLS        +------+  +------+  +------+            :(2)
                        |Labels|  |Labels|  |Labels|            v
                    +---+======+--+======+--+======+-----+
     Link/Sub-Network   |  L2  |  | TSN  |  | UDP  |
                        +------+  +------+  +------+
                                            |  IP  |
                                            +------+
                                            |  L2  |
                                            +------+
         (1) TSN Stream
         (2) DetNet MPLS Flow

         Figure 3: Examples of TSN over MPLS Encapsulation Formats

   In the figure, &quot;Application&quot; indicates the application payload
   carried by the TSN network.  &quot;MPLS App-Flow&quot; indicates that the TSN
   Stream is the payload from the perspective of the DetNet MPLS data
   plane defined in [<a href="/doc/html/rfc8964" title="&quot;Deterministic Networking (DetNet) Data Plane: MPLS&quot;">RFC8964</a>].  A single DetNet MPLS flow can aggregate
   multiple TSN Streams.

      |  Note: Network fragmentation for DetNet is not supported and
      |  MUST be avoided.  The reason for this is that network
      |  fragmentation is not consistent with the packet delivery times
      |  needed for DetNet.  Therefore, when IP is used as the sub-
      |  network, IPv6 fragmentation MUST NOT be used, and IPv4 packets
      |  MUST be sent with the DF bit set.  This means that the network
      |  operator MUST ensure that all the DetNet encapsulation overhead
      |  plus the maximum TSN App-flow frame size does not exceed the
      |  DetNet network&#x27;s MTU.

<span class="h2"><a class="selflink" id="section-5" href="#section-5">5</a>.  TSN over MPLS Data Plane Procedures</span>

   The description of edge node procedures and functions for TSN over
   DetNet MPLS scenarios follows the concepts from [<a href="/doc/html/rfc3985" title="&quot;Pseudo Wire Emulation Edge-to-Edge (PWE3) Architecture&quot;">RFC3985</a>] and covers
   the edge node components shown in Figure 1.  In this section, the
   following procedures of DetNet edge nodes are described:

   *  TSN related (<a href="#section-5.1">Section 5.1</a>)

   *  DetNet Service Proxy (<a href="#section-5.2">Section 5.2</a>)

   *  DetNet service and forwarding sub-layer (<a href="#section-5.3">Section 5.3</a>)

   The subsections describe procedures for forwarding packets by DetNet
   edge nodes, where such packets are received from either directly
   connected CEs (TSN nodes) or some other DetNet edge nodes.

<span class="h3"><a class="selflink" id="section-5.1" href="#section-5.1">5.1</a>.  Edge Node TSN Procedures</span>

   The TSN TG of the IEEE 802.1 Working Group has defined (and is
   defining) a number of amendments to [<a href="#ref-IEEE8021Q">IEEE8021Q</a>] that provide zero
   congestion loss and bounded latency in bridged networks.
   [<a href="#ref-IEEE8021CB">IEEE8021CB</a>] defines packet replication and elimination functions for
   a TSN network.

   The implementation of a TSN entity (i.e., TSN packet processing
   functions) must be compliant with the relevant IEEE 802.1 standards.

   TSN-specific functions are executed on the data received by the
   DetNet edge node from the connected CE before being forwarded to
   connected CE(s) or presented to the DetNet service proxy function for
   transmission across the DetNet domain.  TSN-specific functions are
   also executed on the data received from a DetNet PW by a PE before
   the data is output on the AC(s).

   The TSN packet processing function(s) of edge nodes (T-PE) belongs to
   the NSP [<a href="/doc/html/rfc3985" title="&quot;Pseudo Wire Emulation Edge-to-Edge (PWE3) Architecture&quot;">RFC3985</a>] block.  This is similar to other functionalities
   being defined by standards bodies other than the IETF (for example,
   in the case of Ethernet, stripping, overwriting, or adding VLAN tags,
   etc.).  Depending on the TSN role of the edge node in the end-to-end
   TSN service, selected TSN functions are supported.

   When a PE receives a packet from a CE on a given AC with DetNet
   service, it first checks via Stream identification (see Clause 6 of
   [<a href="#ref-IEEE8021CB">IEEE8021CB</a>] and [<a href="#ref-IEEEP8021CBdb">IEEEP8021CBdb</a>]) whether the packet belongs to a
   configured TSN Stream (i.e., App-flow from the DetNet perspective).
   If no Stream ID is matched and no other (VPN) service is configured
   for the AC, then the packet MUST be dropped.  If there is a matching
   TSN Stream, then the Stream-ID-specific TSN functions are executed
   (e.g., ingress policing, header field manipulation in the case of
   active Stream identification, FRER, etc.).  Source Media Access
   Control (MAC) lookup may also be used for local MAC address learning.

   If the PE decides to forward the packet, the packet MUST be forwarded
   according to the TSN-Stream-specific configuration to connected CE(s)
   (in case of local bridging) and/or to the DetNet service proxy (in
   case of forwarding to remote CE(s)).  If there are no TSN-Stream-
   specific forwarding configurations, the PE MUST flood the packet to
   other locally attached CE(s) and to the DetNet service proxy.  If the
   administrative policy on the PE does not allow flooding, the PE MUST
   drop the packet.

   When a TSN entity of the PE receives a packet from the DetNet service
   proxy, it first checks via Stream identification (see Clause 6 of
   [<a href="#ref-IEEE8021CB">IEEE8021CB</a>] and [<a href="#ref-IEEEP8021CBdb">IEEEP8021CBdb</a>]) whether the packet belongs to a
   configured TSN Stream.  If no Stream ID is matched, then the packet
   is dropped.  If there is a matching TSN Stream, then the Stream-ID-
   specific TSN functions are executed (e.g., header field manipulation
   in case of active Stream identification, FRER, etc.).  Source MAC
   lookup may also be used for local MAC address learning.

   If the PE decides to forward the packet, the packet is forwarded
   according to the TSN-Stream-specific configuration to connected
   CE(s).  If there are no TSN-Stream-specific forwarding
   configurations, the PE floods the packet to locally attached CE(s).
   If the administrative policy on the PE does not allow flooding, the
   PE drops the packet.

   Implementations of this document SHALL use management and control
   information to ensure TSN-specific functions of the edge node
   according to the expectations of the connected TSN network.

<span class="h3"><a class="selflink" id="section-5.2" href="#section-5.2">5.2</a>.  Edge Node DetNet Service Proxy Procedures</span>

   The service proxy function maps between App-flows and DetNet flows.
   The DetNet edge node TSN entity MUST support the TSN Stream
   identification functions (as defined in Clause 6 of [<a href="#ref-IEEE8021CB">IEEE8021CB</a>] and
   [<a href="#ref-IEEEP8021CBdb">IEEEP8021CBdb</a>]) and the related managed objects (as defined in
   Clause 9 of [<a href="#ref-IEEE8021CB">IEEE8021CB</a>] and [<a href="#ref-IEEEP8021CBdb">IEEEP8021CBdb</a>]) to recognize the
   packets related to App-flow.  The service proxy presents TSN Streams
   as an App-flow to a DetNet flow.

   When a DetNet service proxy receives a packet from the TSN entity, it
   MUST check whether such an App-flow is present in its mapping table.
   If present, it associates the internal DetNet flow ID to the packet
   and MUST forward it to the DetNet service and forwarding sub-layers.
   If no match is found, it MUST drop the packet.

   When a DetNet service proxy receives a packet from the DetNet service
   and forwarding sub-layers, it MUST be forwarded to the edge node TSN
   entity.

   Implementations of this document SHALL use management and control
   information to map a TSN Stream to a DetNet flow.  N:1 mapping
   (aggregating multiple TSN Streams in a single DetNet flow) SHALL be
   supported.  The management or control function that provisions flow
   mapping SHALL ensure that adequate resources are allocated and
   configured to fulfill the service requirements of the mapped flows.

   Due to the (intentional) similarities of the DetNet PREOF and TSN
   FRER functions, service protection function interworking is possible
   between the TSN and the DetNet domains.  Such service protection
   interworking scenarios might require copying of sequence number
   fields from TSN (L2) to PW (MPLS) encapsulation.  However, such
   interworking is out of scope in this document and is left for further
   study.

<span class="h3"><a class="selflink" id="section-5.3" href="#section-5.3">5.3</a>.  Edge Node DetNet Service and Forwarding Sub-Layer Procedures</span>

   In the design presented in [<a href="/doc/html/rfc8964" title="&quot;Deterministic Networking (DetNet) Data Plane: MPLS&quot;">RFC8964</a>], an MPLS service label (the
   S-Label), similar to a PW label [<a href="/doc/html/rfc3985" title="&quot;Pseudo Wire Emulation Edge-to-Edge (PWE3) Architecture&quot;">RFC3985</a>], is used to identify both
   the DetNet flow identity and the MPLS payload type.  The DetNet
   sequence number is carried in the d-CW, which carries the Data/OAM
   discriminator as well.  In [<a href="/doc/html/rfc8964" title="&quot;Deterministic Networking (DetNet) Data Plane: MPLS&quot;">RFC8964</a>], two sequence number sizes are
   supported: a 16-bit sequence number and a 28-bit sequence number.

   PREOF functions and the provided service recovery are available only
   within the DetNet domain as the DetNet flow ID and the DetNet
   sequence number are not valid outside the DetNet network.  MPLS
   (DetNet) edge nodes terminate all related information elements
   encoded in the MPLS labels.

   When a PE receives a packet from the service proxy function, it MUST
   handle the packet as defined in [<a href="/doc/html/rfc8964" title="&quot;Deterministic Networking (DetNet) Data Plane: MPLS&quot;">RFC8964</a>].

   When a PE receives an MPLS packet from a remote PE, then, after
   processing the MPLS label stack, if the top MPLS label ends up being
   a DetNet S-Label that was advertised by this node, then the PE MUST
   forward the packet according to the configured DetNet service and
   forwarding sub-layer rules to other PE nodes or via the DetNet
   service proxy function towards locally connected CE(s).

   For further details on DetNet service and forwarding sub-layers, see
   [<a href="/doc/html/rfc8964" title="&quot;Deterministic Networking (DetNet) Data Plane: MPLS&quot;">RFC8964</a>].

<span class="h2"><a class="selflink" id="section-6" href="#section-6">6</a>.  Controller Plane (Management and Control) Considerations</span>

   Information related to TSN Stream(s) to DetNet flow mapping is
   required only for the service proxy function of MPLS (DetNet) edge
   nodes.  From the data plane perspective, there is no practical
   difference based on the origin of flow-mapping-related information
   (management plane or control plane).

   The following summarizes the set of information that is needed to
   configure TSN over DetNet MPLS:

   *  TSN-related configuration information according to the TSN role of
      the DetNet MPLS node, as per [<a href="#ref-IEEE8021Q">IEEE8021Q</a>], [<a href="#ref-IEEE8021CB">IEEE8021CB</a>], and
      [<a href="#ref-IEEEP8021CBdb">IEEEP8021CBdb</a>].

   *  DetNet MPLS-related configuration information according to the
      DetNet role of the DetNet MPLS node, as per [<a href="/doc/html/rfc8964" title="&quot;Deterministic Networking (DetNet) Data Plane: MPLS&quot;">RFC8964</a>].

   *  App-flow identification information to map received TSN Stream(s)
      to the DetNet flow.  Parameters of TSN Stream identification are
      defined in [<a href="#ref-IEEE8021CB">IEEE8021CB</a>] and [<a href="#ref-IEEEP8021CBdb">IEEEP8021CBdb</a>].

   This information MUST be provisioned per DetNet flow.

   Mappings between DetNet and TSN management and control planes are out
   of scope of the document.  Some of the challenges are highlighted
   below.

   MPLS DetNet edge nodes are a member of both the DetNet domain and the
   connected TSN network.  From the TSN network perspective, the MPLS
   (DetNet) edge node has a &quot;TSN relay node&quot; role, so TSN-specific
   management and control plane functionalities must be implemented.
   There are many similarities in the management plane techniques used
   in DetNet and TSN, but that is not the case for the control plane
   protocols.  For example, RSVP-TE and MSRP behave differently.
   Therefore, management and control plane design is an important aspect
   of scenarios where mapping between DetNet and TSN is required.

   Note that as the DetNet network is just a portion of the end-to-end
   TSN path (i.e., single hop from the Ethernet perspective), some
   parameters (e.g., delay) may differ significantly.  Since there is no
   interworking function, the bandwidth of the DetNet network is assumed
   to be set large enough to handle all TSN flows it will support.  At
   the egress of the DetNet domain, the MPLS headers are stripped, and
   the TSN flow continues on as a normal TSN flow.

   In order to use a DetNet network to interconnect TSN segments, TSN-
   specific information must be converted to DetNet-domain-specific
   information.  TSN Stream ID(s) and stream-related parameters/
   requirements must be converted to a DetNet flow ID and flow-related
   parameters/requirements.

   In some cases, it may be challenging to determine some information
   related to the egress-node.  For example, it may be not trivial to
   locate the egress point/interface of a TSN Stream with a multicast
   destination MAC address.  Such scenarios may require interaction
   between control and management plane functions and between DetNet and
   TSN domains.

   Mapping between DetNet flow identifiers and TSN Stream identifiers,
   if not provided explicitly, can be done by the service proxy function
   of an MPLS (DetNet) edge node locally based on information provided
   for the configuration of the TSN Stream identification functions
   (e.g., Mask-and-Match Stream identification).

   Triggering the setup/modification of a DetNet flow in the DetNet
   network is an example where management and/or control plane
   interactions are required between the DetNet and the TSN network.

   Configuration of TSN-specific functions (e.g., FRER) inside the TSN
   network is a TSN-domain-specific decision and may not be visible in
   the DetNet domain.  Service protection interworking scenarios are
   left for further study.

<span class="h2"><a class="selflink" id="section-7" href="#section-7">7</a>.  Security Considerations</span>

   Security considerations for DetNet are described in detail in
   [<a href="#ref-DETNET-SEC">DETNET-SEC</a>].  General security considerations are described in
   [<a href="/doc/html/rfc8655" title="&quot;Deterministic Networking Architecture&quot;">RFC8655</a>].

   Considerations specific to the DetNet MPLS data plane are summarized
   and described in [<a href="/doc/html/rfc8964" title="&quot;Deterministic Networking (DetNet) Data Plane: MPLS&quot;">RFC8964</a>], including any application flow types.
   This document focuses on a scenario where TSN Streams are the
   application flows for DetNet, which is already covered by those
   DetNet MPLS data plane security considerations.

<span class="h2"><a class="selflink" id="section-8" href="#section-8">8</a>.  IANA Considerations</span>

   This document has no IANA actions.

<span class="h2"><a class="selflink" id="section-9" href="#section-9">9</a>.  References</span>

<span class="h3"><a class="selflink" id="section-9.1" href="#section-9.1">9.1</a>.  Normative References</span>

   [<a id="ref-IEEE8021CB">IEEE8021CB</a>]
              IEEE, &quot;Standard for Local and metropolitan area networks
              -- Frame Replication and Elimination for Reliability&quot;,
              IEEE 802.1CB-2017, DOI 10.1109/IEEESTD.2017.8091139,
              October 2017,
              &lt;<a href="https://ieeexplore.ieee.org/document/8091139">https://ieeexplore.ieee.org/document/8091139</a>&gt;.

   [<a id="ref-IEEEP8021CBdb">IEEEP8021CBdb</a>]
              IEEE, &quot;Draft Standard for Local and metropolitan area
              networks - Frame Replication and Elimination for
              Reliability - Amendment: Extended Stream Identification
              Functions&quot;, IEEE P802.1CBdb D1.3, April 2021,
              &lt;<a href="https://1.ieee802.org/tsn/802-1cbdb">https://1.ieee802.org/tsn/802-1cbdb</a>&gt;.

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., &quot;Key words for use in RFCs to Indicate
              Requirement Levels&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc2119">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC3031">RFC3031</a>]  Rosen, E., Viswanathan, A., and R. Callon, &quot;Multiprotocol
              Label Switching Architecture&quot;, <a href="/doc/html/rfc3031">RFC 3031</a>,
              DOI 10.17487/RFC3031, January 2001,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3031">https://www.rfc-editor.org/info/rfc3031</a>&gt;.

   [<a id="ref-RFC8174">RFC8174</a>]  Leiba, B., &quot;Ambiguity of Uppercase vs Lowercase in <a href="/doc/html/rfc2119">RFC</a>
              <a href="/doc/html/rfc2119">2119</a> Key Words&quot;, <a href="/doc/html/bcp14">BCP 14</a>, <a href="/doc/html/rfc8174">RFC 8174</a>, DOI 10.17487/RFC8174,
              May 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.

   [<a id="ref-RFC8655">RFC8655</a>]  Finn, N., Thubert, P., Varga, B., and J. Farkas,
              &quot;Deterministic Networking Architecture&quot;, <a href="/doc/html/rfc8655">RFC 8655</a>,
              DOI 10.17487/RFC8655, October 2019,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8655">https://www.rfc-editor.org/info/rfc8655</a>&gt;.

   [<a id="ref-RFC8938">RFC8938</a>]  Varga, B., Ed., Farkas, J., Berger, L., Malis, A., and S.
              Bryant, &quot;Deterministic Networking (DetNet) Data Plane
              Framework&quot;, <a href="/doc/html/rfc8938">RFC 8938</a>, DOI 10.17487/RFC8938, November 2020,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8938">https://www.rfc-editor.org/info/rfc8938</a>&gt;.

   [<a id="ref-RFC8964">RFC8964</a>]  Varga, B., Ed., Farkas, J., Berger, L., Malis, A., Bryant,
              S., and J. Korhonen, &quot;Deterministic Networking (DetNet)
              Data Plane: MPLS&quot;, <a href="/doc/html/rfc8964">RFC 8964</a>, DOI 10.17487/RFC8964, January
              2021, &lt;<a href="https://www.rfc-editor.org/info/rfc8964">https://www.rfc-editor.org/info/rfc8964</a>&gt;.

<span class="h3"><a class="selflink" id="section-9.2" href="#section-9.2">9.2</a>.  Informative References</span>

   [<a id="ref-DETNET-SEC">DETNET-SEC</a>]
              Grossman, E., Ed., Mizrahi, T., and A. Hacker,
              &quot;Deterministic Networking (DetNet) Security
              Considerations&quot;, Work in Progress, Internet-Draft, <a href="/doc/html/draft-ietf-detnet-security-16">draft-</a>
              <a href="/doc/html/draft-ietf-detnet-security-16">ietf-detnet-security-16</a>, 2 March 2021,
              &lt;<a href="https://tools.ietf.org/html/draft-ietf-detnet-security-16">https://tools.ietf.org/html/draft-ietf-detnet-security-</a>
              <a href="https://tools.ietf.org/html/draft-ietf-detnet-security-16">16</a>&gt;.

   [<a id="ref-IEEE8021Q">IEEE8021Q</a>]
              IEEE, &quot;Standard for Local and Metropolitan Area Networks--
              Bridges and Bridged Networks&quot;, IEEE Std. 802.1Q-2018,
              DOI 10.1109/IEEESTD.2018.8403927, July 2018,
              &lt;<a href="https://ieeexplore.ieee.org/document/8403927">https://ieeexplore.ieee.org/document/8403927</a>&gt;.

   [<a id="ref-RFC3985">RFC3985</a>]  Bryant, S., Ed. and P. Pate, Ed., &quot;Pseudo Wire Emulation
              Edge-to-Edge (PWE3) Architecture&quot;, <a href="/doc/html/rfc3985">RFC 3985</a>,
              DOI 10.17487/RFC3985, March 2005,
              &lt;<a href="https://www.rfc-editor.org/info/rfc3985">https://www.rfc-editor.org/info/rfc3985</a>&gt;.

Acknowledgements

   The authors wish to thank Norman Finn, Lou Berger, Craig Gunther,
   Christophe Mangin, and Jouni Korhonen for their various contributions
   to this work.

Authors&#x27; Addresses

   Balázs Varga (editor)
   Ericsson
   Budapest
   Magyar Tudosok krt. 11.
   1117
   Hungary

   Email: balazs.a.varga@ericsson.com


   János Farkas
   Ericsson
   Budapest
   Magyar Tudosok krt. 11.
   1117
   Hungary

   Email: janos.farkas@ericsson.com


   Andrew G. Malis
   Malis Consulting

   Email: agmalis@gmail.com


   Stewart Bryant
   Futurewei Technologies

   Email: sb@stewartbryant.com


   Don Fedyk
   LabN Consulting, L.L.C.

   Email: dfedyk@labn.net
</pre>
    </div>

  </div>


        
	  </div>

	

	

    </div>

      
      <script>$(".visible-nojs").removeClass("visible-nojs");</script>
      <script>$(".hidden-nojs").removeClass("hidden-nojs");</script>
      
    <script type="text/javascript"><!--
    var legend_html = "Colour legend:<br /> \
     <table> \
        <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
        <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr> \
    </table>";
    function showLegend() {
        var elem = document.getElementById('legend');
        elem.innerHTML = legend_html
        elem.style.visibility='visible';
    }
    function hideLegend() {
        var elem = document.getElementById('legend');
        elem.style.visibility='hidden';
        elem.innerHTML = "";
    }
    // -->
    </script>

  </body>
</html>

